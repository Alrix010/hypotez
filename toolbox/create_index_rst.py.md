# Модуль `create_index_rst`

## Обзор

Модуль `create_index_rst` предназначен для автоматического создания файла `index.rst` в директории `docs` проекта. Этот файл используется для генерации документации Sphinx и содержит перечень всех Python-файлов (`.py`) в проекте, что позволяет Sphinx автоматически находить и включать их в документацию. Модуль рекурсивно обходит все поддиректории, начиная с указанной, и добавляет пути к найденным Python-файлам в `index.rst`.

## Подробней

Этот модуль автоматизирует процесс создания структуры документации для проектов на Python, использующих Sphinx. Он облегчает поддержку актуального списка всех модулей в проекте, что особенно полезно при большом количестве файлов и сложной структуре директорий. `index.rst` формируется в формате, требуемом Sphinx для создания дерева содержания.

## Функции

### `create_index_rst`

```python
def create_index_rst(start_dir: str) -> None:
    """ Рекурсивно обходит все поддиректории, начиная с указанной, считывает все файлы *.py
    и создает файл index.rst в директории `docs`, в котором перечислены все эти файлы в формате toctree. Ведет журнал процесса.

    Args:
        start_dir (str): Корневая директория, с которой начинается обход.

    Returns:
        None

    Example:
        >>> create_index_rst(os.getcwd())
    """
```

**Назначение**: Рекурсивно обходит все поддиректории, начиная с `start_dir`, находит все файлы с расширением `.py` и создает файл `index.rst` в директории `docs`. Этот файл содержит список всех найденных `.py` файлов в формате, пригодном для использования в Sphinx для создания дерева содержания.

**Параметры**:

- `start_dir` (str): Корневая директория, с которой начинается обход поддиректорий.

**Возвращает**:

- `None`: Функция ничего не возвращает.

**Как работает функция**:

1.  Определяет начальный путь (`start_path`) и путь к директории `docs` (`docs_dir`), а также путь к файлу `index.rst` (`index_file_path`).
2.  Проверяет существование директории `docs` и создает её, если она не существует.
3.  Открывает файл `index.rst` для записи и записывает в него заголовки, необходимые для Sphinx (`toctree`, `maxdepth`, `caption`).
4.  Использует `os.walk` для рекурсивного обхода всех поддиректорий, начиная с `start_path`.
5.  Для каждой директории создает список Python-файлов, исключая файлы, содержащие символы `(` или `)`.\
6.  Если найдены Python-файлы, формирует относительный путь к каждому файлу и записывает его в `index.rst`.
7.  Логирует информацию о процессе, используя модуль `logger` из `src.logger`.
8.  Обрабатывает исключения, которые могут возникнуть в процессе создания файла `index.rst`.

**Примеры**:

```python
import os
from pathlib import Path

# Предположим, что мы находимся в корневой директории проекта
start_dir = os.getcwd()
create_index_rst(start_dir)
# Будет создан или обновлен файл index.rst в директории docs,
# содержащий список всех Python файлов в проекте.

# Пример использования с указанием относительного пути
start_dir = "src"
create_index_rst(start_dir)
# Будет создан или обновлен файл index.rst в директории docs,
# начиная с директории src.
```

## Пример использования

```python
if __name__ == "__main__":
    create_index_rst(Path(header.__root__, 'src'))
```

В данном примере функция `create_index_rst` вызывается с путем, полученным из переменной `__root__` модуля `header` и поддиректории `src`. Это позволяет создать `index.rst` файл, содержащий список всех Python файлов, начиная с директории `src`.