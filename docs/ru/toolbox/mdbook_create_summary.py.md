# Модуль для создания SUMMARY.md

## Обзор

Модуль предназначен для автоматического создания или обновления файла `SUMMARY.md`, который используется в `mdBook` для структурирования содержания книги. Он рекурсивно обходит указанную директорию в поисках файлов с расширением `.md` и генерирует структуру глав и подглав на основе их расположения в файловой системе.

## Подробнее

Модуль `mdbook_create_summary.py` предоставляет функцию `make_summary`, которая облегчает создание содержания для книг, написанных с использованием `mdBook`. Он автоматически формирует структуру `SUMMARY.md` на основе файлов `.md`, находящихся в указанной директории.

## Функции

### `make_summary`

**Назначение**: Рекурсивно обходит папку с исходниками `.md` и создает файл `SUMMARY.md` с главами на основе этих файлов. Если файл `SUMMARY.md` уже существует, он будет перезаписан.

```python
def make_summary(src_dir: Path = src_path , summary_file: Path = summary_path) -> None:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.
    Если файл SUMMARY.md уже существует, он будет перезаписан.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
    
    How to use:
    -----------------------
    1. Убедитесь, что у вас есть папка с .md файлами (например, 'docs/gemini/consultant/ru/src').
    2. Убедитесь, что модуль `gs` правильно настроен для получения пути корневой директории.
    3. Запустите скрипт. Он автоматически создаст файл `SUMMARY.md` в указанной папке.
    4. Файл `SUMMARY.md` будет содержать список всех `.md` файлов в директории, структурированный в виде глав с вложениями.
    """
    ...
```

**Параметры**:

-   `src_dir` (Path): Путь к папке с исходными файлами `.md`. По умолчанию используется `src_path`.
-   `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`. По умолчанию используется `summary_path`.

**Возвращает**:

-   `None`: Функция ничего не возвращает.

**Как работает функция**:

1.  **Проверка наличия файла `SUMMARY.md`**:
    -   Функция проверяет, существует ли файл `SUMMARY.md` по указанному пути. Если файл не существует, выводится сообщение о создании нового файла. Если файл существует, выводится сообщение о том, что его содержимое будет перезаписано.
2.  **Открытие файла для записи**:
    -   Функция открывает файл `SUMMARY.md` в режиме записи с кодировкой UTF-8.
3.  **Запись заголовка**:
    -   В файл записывается заголовок `# Summary`, который обозначает начало файла `SUMMARY.md`.
4.  **Рекурсивный обход файлов**:
    -   Функция рекурсивно обходит все файлы с расширением `.md` в указанной директории.
5.  **Исключение самого файла `SUMMARY.md`**:
    -   Если найденный файл является самим файлом `SUMMARY.md`, он пропускается, чтобы избежать рекурсивной петли.
6.  **Формирование относительного пути и названия главы**:
    -   Вычисляется относительный путь к файлу относительно директории с исходниками (`src_dir`).
    -   Формируется название главы на основе имени файла, заменяя символы `_` на пробелы и переводя первую букву в верхний регистр.
7.  **Определение уровня вложенности**:
    -   Определяется уровень вложенности файла на основе количества символов `/` в относительном пути.
8.  **Запись главы в файл `SUMMARY.md`**:
    -   Формируется строка с отступами, названием главы и относительным путем к файлу, которая записывается в файл `SUMMARY.md`.
9.  **Вывод сообщения об успехе**:
    -   После завершения обхода всех файлов выводится сообщение об успешном создании или перезаписи файла `SUMMARY.md`.

**Примеры**:

```python
from pathlib import Path
from src import gs  # предполагается, что модуль gs предоставляет путь к корневой директории проекта

# Определяем пути к директории с .md файлами и файлу SUMMARY.md
src_path = Path(gs.path.root / 'docs' / 'gemini' / 'consultant' / 'ru' / 'src')
summary_path = src_path / 'SUMMARY.md'

# Создаем или перезаписываем файл SUMMARY.md
make_summary(src_path, summary_path)
```

В данном примере функция `make_summary` вызывается с указанием директории, в которой находятся файлы `.md`, и пути к файлу `SUMMARY.md`. Функция автоматически создаст или перезапишет файл `SUMMARY.md` с содержанием, отражающим структуру файлов `.md` в указанной директории.