# Модуль для сборки файла SUMMARY.md

## Обзор

Модуль предназначен для автоматического создания файла `SUMMARY.md`, который используется для формирования структуры книги в формате `mdbook`. Он рекурсивно обходит указанную директорию, фильтрует файлы по языку (русский или английский) и генерирует список глав для книги.

## Подробнее

Модуль облегчает процесс создания и обновления структуры документации, представленной в формате `mdbook`. Он автоматически генерирует файл `SUMMARY.md` на основе структуры каталогов и файлов с расширением `.md`, позволяя разработчикам сосредоточиться на содержании документации, а не на ее структуре. Поддерживается фильтрация файлов по языку, что позволяет создавать отдельные версии документации для разных языковых аудиторий.

## Функции

### `make_summary`

**Назначение**: Создает файл `SUMMARY.md`, рекурсивно обходя указанную директорию.

```python
def make_summary(docs_dir: Path, lang: str = 'en') -> None:
    """
    Создает файл SUMMARY.md, рекурсивно обходя папку.

    Args:
        docs_dir (Path): Путь к исходной директории 'src'.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Параметры**:

-   `docs_dir` (Path): Путь к исходной директории `'src'`.
-   `lang` (str): Язык фильтрации файлов. Возможные значения: `'ru'` или `'en'`. По умолчанию `'en'`.

**Возвращает**:

-   `None`: Функция ничего не возвращает.

**Как работает функция**:

1.  Функция формирует путь к файлу `SUMMARY.md` с помощью функции `prepare_summary_path`.
2.  Создает родительские директории для файла `SUMMARY.md`, если они не существуют.
3.  Вызывает функцию `_make_summary` для рекурсивного обхода директории и создания содержимого файла `SUMMARY.md`.

**Примеры**:

```python
from pathlib import Path

# Пример вызова функции make_summary
docs_dir = Path('./src')
make_summary(docs_dir, lang='ru')
```

### `_make_summary`

**Назначение**: Рекурсивно обходит папку и создает файл `SUMMARY.md` с главами на основе `.md` файлов.

```python
def _make_summary(src_dir: Path, summary_file: Path, lang: str = 'en') -> bool:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Параметры**:

-   `src_dir` (Path): Путь к папке с исходниками `.md`.
-   `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`.
-   `lang` (str): Язык фильтрации файлов. Возможные значения: `'ru'` или `'en'`. По умолчанию `'en'`.

**Возвращает**:

-   `bool`: `True`, если файл `SUMMARY.md` успешно создан или перезаписан, `False` в случае ошибки.

**Как работает функция**:

1.  Проверяет, существует ли файл `SUMMARY.md`, и, если да, выводит сообщение о его перезаписи.
2.  Открывает файл `SUMMARY.md` для записи в кодировке UTF-8.
3.  Записывает заголовок `# Summary\n\n` в файл.
4.  Рекурсивно обходит директорию `src_dir` в поисках файлов с расширением `.md`.
5.  Фильтрует файлы по языку в соответствии с параметром `lang`.
6.  Формирует относительный путь к файлу относительно родительской директории `src_dir`.
7.  Записывает строку в формате `- [{path.stem}]({relative_path.as_posix()})\n` в файл `SUMMARY.md` для каждого найденного файла.
8.  В случае возникновения ошибки выводит сообщение об ошибке и возвращает `False`.

**Примеры**:

```python
from pathlib import Path

# Пример вызова внутренней функции _make_summary
src_dir = Path('./src')
summary_file = Path('./docs/SUMMARY.md')
_make_summary(src_dir, summary_file, lang='ru')
```

### `prepare_summary_path`

**Назначение**: Формирует путь к файлу `SUMMARY.md`, заменяя часть пути `'src'` на `'docs'`.

```python
def prepare_summary_path(src_dir: Path, file_name: str = 'SUMMARY.md') -> Path:
    """
    Формирует путь к файлу, заменяя часть пути 'src' на 'docs' и добавляя имя файла.

    Args:
        src_dir (Path): Исходный путь с 'src'.
        file_name (str): Имя файла, который нужно создать. По умолчанию 'SUMMARY.md'.

    Returns:
        Path: Новый путь к файлу.
    """
    ...
```

**Параметры**:

-   `src_dir` (Path): Исходный путь с `'src'`.
-   `file_name` (str): Имя файла, который нужно создать. По умолчанию `'SUMMARY.md'`.

**Возвращает**:

-   `Path`: Новый путь к файлу.

**Как работает функция**:

1.  Формирует новый путь к файлу, заменяя часть пути `'src'` на `'docs'`.
2.  Возвращает новый путь к файлу.

**Примеры**:

```python
from pathlib import Path

# Пример вызова функции prepare_summary_path
src_dir = Path('./src')
summary_file = prepare_summary_path(src_dir)
print(summary_file)  # Вывод: ./docs/SUMMARY.md
```

## Параметры командной строки

При запуске модуля из командной строки можно указать следующие параметры:

-   `-lang` (str): Язык фильтрации файлов (`ru` или `en`). По умолчанию `en`.
-   `src_dir` (str): Путь к исходной директории `'src'`.

**Пример использования**:

```bash
python make_summary.py -lang ru src
```

В этом примере будет создан файл `SUMMARY.md` в директории `docs`, содержащий ссылки только на русские файлы (`*.ru.md`).