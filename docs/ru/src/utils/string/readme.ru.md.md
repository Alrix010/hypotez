# Модуль нормализации данных

## Обзор

Модуль `normalizer` предоставляет функциональность для нормализации различных типов данных, включая строки, булевы значения, целые числа и числа с плавающей запятой. Он также включает вспомогательные функции для обработки текста.

## Содержание

1.  [Обзор](#обзор)
2.  [Функции модуля](#функции-модуля)
    *   [normalize\_boolean](#normalize_boolean)
    *   [normalize\_string](#normalize_string)
    *   [normalize\_int](#normalize_int)
    *   [normalize\_float](#normalize_float)
    *   [remove\_line\_breaks](#remove_line_breaks)
    *   [remove\_html\_tags](#remove_html_tags)
    *   [remove\_special\_characters](#remove_special_characters)
    *   [normalize\_sql\_date](#normalize_sql_date)
3.  [Пример использования](#пример-использования)
4.  [Требования](#требования)

## Подробнее

Модуль предоставляет удобные утилиты для нормализации и обработки данных. Он может быть использован для:

*   Удаления HTML тегов из строк.
*   Преобразования строк в числовые или булевы значения.
*   Очистки строк от специальных символов.
*   Преобразования списков строк в одну нормализованную строку.

## Функции модуля

### `normalize_boolean`

**Назначение:** Преобразует входное значение в булево значение.

**Параметры:**

*   `input_data` (Any): Данные, которые могут представлять булево значение (строка, число, булев тип).

**Возвращает:**

*   `bool`: Преобразованное булево значение.

**Как работает функция:**

Функция `normalize_boolean` принимает входные данные любого типа и пытается преобразовать их в булево значение.  Поддерживаются различные типы входных данных, такие как строки (например, 'yes', 'no', 'true', 'false'), числа (0 и 1) и булевы значения. Если входные данные могут быть однозначно преобразованы в булево значение, функция возвращает соответствующее значение (`True` или `False`). В случае, если входные данные не могут быть интерпретированы как булево значение, функция возвращает `False`.

**Пример:**

```python
normalize_boolean('yes')  # Результат: True
normalize_boolean(0)      # Результат: False
```

### `normalize_string`

**Назначение:** Преобразует строку или список строк в нормализованную строку, удаляя лишние пробелы, HTML теги и специальные символы.

**Параметры:**

*   `input_data` (str | list): Строка или список строк.

**Возвращает:**

*   `str`: Очищенная строка в кодировке UTF-8.

**Как работает функция:**

Функция `normalize_string` принимает на вход строку или список строк. Она выполняет следующие действия:

1.  Если на вход передается список строк, функция объединяет их в одну строку.
2.  Удаляет HTML-теги из строки с использованием функции `remove_html_tags`.
3.  Удаляет символы новой строки с использованием функции `remove_line_breaks`.
4.  Удаляет специальные символы с использованием функции `remove_special_characters`.
5.  Удаляет начальные и конечные пробелы из строки.

В результате функция возвращает очищенную строку в кодировке UTF-8.

**Пример:**

```python
normalize_string(['  Example string  ', '<b>with HTML</b>'])  # Результат: 'Example string with HTML'
```

### `normalize_int`

**Назначение:** Преобразует входное значение в целое число.

**Параметры:**

*   `input_data` (str | int | float | Decimal): Число или его строковое представление.

**Возвращает:**

*   `int`: Преобразованное целое число.

**Как работает функция:**

Функция `normalize_int` принимает на вход числовое значение или его строковое представление. Она пытается преобразовать входное значение в целое число. Если входное значение является строкой, функция сначала удаляет из нее все нецифровые символы и пробелы. Если преобразование успешно, функция возвращает целое число. В противном случае, если преобразование не удается или входное значение не является числом или строкой, функция возвращает 0.

**Пример:**

```python
normalize_int('42')  # Результат: 42
normalize_int(3.14)  # Результат: 3
```

### `normalize_float`

**Назначение:** Преобразует входное значение в число с плавающей запятой.

**Параметры:**

*   `value` (Any): Число, строка или список чисел.

**Возвращает:**

*   `float | List[float] | None`: Число с плавающей запятой, список чисел с плавающей запятой или `None` в случае ошибки.

**Как работает функция:**

Функция `normalize_float` принимает на вход числовое значение, строку или список чисел и пытается преобразовать их в число с плавающей запятой.  Если на вход передается список, функция обрабатывает каждый элемент списка отдельно и возвращает список чисел с плавающей запятой. Если входное значение не может быть преобразовано в число, функция возвращает `None`.

**Пример:**

```python
normalize_float('3.14')         # Результат: 3.14
normalize_float([1, '2.5', 3])  # Результат: [1.0, 2.5, 3.0]
```

### `remove_line_breaks`

**Назначение:** Удаляет символы новой строки из строки.

**Параметры:**

*   `input_str` (str): Входная строка.

**Возвращает:**

*   `str`: Строка без символов новой строки.

**Как работает функция:**

Функция `remove_line_breaks` принимает на вход строку и удаляет из нее все символы новой строки (`\n`, `\r`). Функция возвращает строку без символов новой строки.

**Пример:**

```python
remove_line_breaks('String\\nwith line breaks\\r')  # Результат: 'String with line breaks'
```

### `remove_html_tags`

**Назначение:** Удаляет HTML теги из строки.

**Параметры:**

*   `input_html` (str): Входная строка с HTML тегами.

**Возвращает:**

*   `str`: Строка без HTML тегов.

**Как работает функция:**

Функция `remove_html_tags` принимает на вход строку, содержащую HTML-теги.  Она использует регулярное выражение для поиска и удаления всех HTML-тегов из строки.  Функция возвращает строку без HTML-тегов.

**Пример:**

```python
remove_html_tags('<p>Example text</p>')  # Результат: 'Example text'
```

### `remove_special_characters`

**Назначение:** Удаляет специальные символы из строки или списка строк.

**Параметры:**

*   `input_str` (str | list): Строка или список строк.

**Возвращает:**

*   `str | list`: Строка или список строк без специальных символов.

**Как работает функция:**

Функция `remove_special_characters` принимает на вход строку или список строк.  Она удаляет из входных данных все символы, которые не являются буквенно-цифровыми.  Если на вход передается список строк, функция обрабатывает каждую строку отдельно и возвращает список очищенных строк.

**Пример:**

```python
remove_special_characters('Hello@World!')  # Результат: 'HelloWorld'
```

### `normalize_sql_date`

**Назначение:** Преобразует строку или объект `datetime` в стандартный формат SQL даты (`YYYY-MM-DD`).

**Параметры:**

*   `input_data` (str | datetime): Строка или объект `datetime`, представляющий дату.

**Возвращает:**

*   `str`: Нормализованная дата в формате строки `YYYY-MM-DD`.

**Как работает функция:**

Функция `normalize_sql_date` принимает на вход строку или объект `datetime`, представляющий дату.  Если входные данные являются строкой, функция пытается преобразовать их в объект `datetime`.  Затем функция форматирует объект `datetime` в строку в формате `YYYY-MM-DD`.  Если входные данные уже имеют требуемый формат, функция возвращает их без изменений.

**Пример:**

```python
normalize_sql_date('2024-12-06')  # Результат: '2024-12-06'
normalize_sql_date(datetime(2024, 12, 6))  # Результат: '2024-12-06'
```

## Пример использования

```python
from src.utils.string.normalizer import normalize_string, normalize_boolean, normalize_int, normalize_float, normalize_sql_date

# Нормализация строки
clean_str = normalize_string(['<h1>Header</h1>', '  text with spaces  '])
print(clean_str)  # 'Header text with spaces'

# Нормализация булевого значения
is_active = normalize_boolean('Yes')
print(is_active)  # True

# Нормализация целого числа
integer_value = normalize_int('42')
print(integer_value)  # 42

# Нормализация числа с плавающей запятой
float_value = normalize_float('3.14159')
print(float_value)  # 3.14159

# Нормализация SQL даты
sql_date = normalize_sql_date('2024-12-06')
print(sql_date)  # '2024-12-06'
```

## Требования

*   Python 3.10 или выше.
*   Модуль `src.logger` для логирования.
*   Модуль используется в режиме разработки (``).

## Логирование

Все ошибки и предупреждения записываются через `logger`:

*   Ошибки записываются с использованием `logger.error`.
*   Неожиданные значения записываются с использованием `logger.debug` или `logger.warning`.