# Модуль для конвертации Markdown в словарь

## Обзор

Модуль `src.utils.convertors.md2dict` предназначен для преобразования строк в формате Markdown в структурированные словари. Он использует библиотеку `markdown2` для конвертации Markdown в HTML, а затем анализирует HTML для извлечения секций и содержимого.

## Подробней

Этот модуль полезен для обработки текстовых данных в формате Markdown, позволяя структурировать информацию для дальнейшего использования в программе. Он особенно полезен, когда необходимо анализировать документы Markdown и извлекать из них определенные секции или данные.

## Функции

### `md2html`

```python
def md2html(md_string: str, extras: List[str] = None) -> str:
    """
    Конвертирует строку Markdown в HTML.

    Args:
        md_string (str): Строка Markdown для конвертации.
        extras (list, optional): Список расширений markdown2. Defaults to None.

    Returns:
        str: HTML-представление Markdown.
    """
```

**Назначение**: Преобразует строку в формате Markdown в HTML.

**Параметры**:
   - `md_string` (str): Строка Markdown, которую необходимо преобразовать.
   - `extras` (List[str], optional): Список расширений для `markdown2`. По умолчанию `None`.

**Возвращает**:
   - `str`: HTML-представление входной Markdown-строки.

**Вызывает исключения**:
   - `Exception`: Если происходит ошибка при преобразовании Markdown в HTML. Ошибка логируется с использованием `logger.error`.

**Как работает функция**:
   - Функция принимает строку Markdown и, используя библиотеку `markdown2`, преобразует её в HTML.
   - Если указаны расширения (`extras`), они также передаются в функцию `markdown2` для расширенной обработки Markdown.
   - В случае возникновения ошибки во время преобразования, функция логирует ошибку и возвращает пустую строку.

**Примеры**:

```python
from src.utils.convertors.md import md2html

markdown_text = "# Заголовок 1\nЭто параграф."
html_text = md2html(markdown_text)
print(html_text)
# Вывод: '<h1 id="заголовок-1">Заголовок 1</h1>\n<p>Это параграф.</p>'

markdown_text = "**Жирный текст**"
html_text = md2html(markdown_text, extras=['bold'])
print(html_text)
# Вывод: '<p><strong>Жирный текст</strong></p>'
```

### `md2dict`

```python
def md2dict(md_string: str, extras: List[str] = None) -> Dict[str, list[str]]:
    """
    Конвертирует строку Markdown в структурированный словарь.

    Args:
        md_string (str): Строка Markdown для конвертации.
        extras (list, optional): Список расширений markdown2 для md2html. Defaults to None.

    Returns:
         Dict[str, list[str]]: Структурированное представление Markdown содержимого.
    """
```

**Назначение**: Преобразует строку Markdown в структурированный словарь, где ключи - заголовки секций, а значения - список содержимого секции.

**Параметры**:
   - `md_string` (str): Строка Markdown для конвертации.
   - `extras` (List[str], optional): Список расширений для `markdown2` при конвертации в HTML. По умолчанию `None`.

**Возвращает**:
   - `Dict[str, list[str]]`: Словарь, представляющий структурированное содержимое Markdown. Ключи - это заголовки секций, а значения - списки строк, составляющих содержимое этих секций.

**Вызывает исключения**:
   - `Exception`: Если происходит ошибка при парсинге Markdown в структурированный словарь. Ошибка логируется с использованием `logger.error`.

**Как работает функция**:

1. **Преобразование в HTML**:
   - Сначала Markdown преобразуется в HTML с использованием функции `md2html` и переданных расширений.
2. **Анализ HTML**:
   - Функция проходит по каждой строке HTML-кода.
   - Если строка является заголовком (`<h`), извлекается уровень заголовка и текст заголовка.
   - Заголовки первого уровня (`<h1>`) используются в качестве ключей секций в словаре.
   - Содержимое секций добавляется в список, соответствующий текущему заголовку.
3. **Создание словаря**:
   - Формируется словарь, где ключами являются заголовки секций, а значениями - списки содержимого этих секций.

**Примеры**:

```python
from src.utils.convertors.md import md2dict

markdown_text = """
# Заголовок 1
Это параграф в первой секции.
## Заголовок 2
Это параграф во второй секции.
"""
result_dict = md2dict(markdown_text)
print(result_dict)
# Вывод:
# {
#     'Заголовок 1': ['Это параграф в первой секции.'],
#     'Заголовок 2': ['Это параграф во второй секции.']
# }
```

```python
from src.utils.convertors.md import md2dict

markdown_text = """
# Секция 1
Текст секции 1.
## Подсекция 1.1
Текст подсекции 1.1.
# Секция 2
Текст секции 2.
"""
result_dict = md2dict(markdown_text)
print(result_dict)
# Вывод:
# {
#     'Секция 1': ['Текст секции 1.', 'Подсекция 1.1', 'Текст подсекции 1.1.'],
#     'Секция 2': ['Текст секции 2.']
# }