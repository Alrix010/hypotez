# Модуль `src.utils.convertors.ns`

## Обзор

Модуль предоставляет функции для преобразования объектов `SimpleNamespace` в различные форматы: словарь (`dict`), JSON, CSV, XML и XLS.

## Подробнее

Модуль содержит набор функций, предназначенных для преобразования объектов `SimpleNamespace` в различные форматы данных, такие как словари, JSON, CSV, XML и XLS. Это облегчает сериализацию и экспорт данных из объектов `SimpleNamespace` в форматы, удобные для хранения, передачи и обработки в других приложениях.

## Функции

### `ns2dict`

**Назначение**: Рекурсивно преобразует объект с парами "ключ-значение" в словарь. Обрабатывает пустые ключи, заменяя их пустой строкой.

**Параметры**:
- `obj` (Any): Объект для преобразования. Может быть `SimpleNamespace`, `dict` или любым объектом с аналогичной структурой.

**Возвращает**:
- `Dict[str, Any]`: Преобразованный словарь с обработанными вложенными структурами.

**Как работает функция**:
- Функция `ns2dict` принимает объект `obj` в качестве аргумента и преобразует его в словарь.
- Внутренняя функция `convert` рекурсивно обрабатывает значения, чтобы учесть вложенные структуры и пустые ключи.
- Если значение имеет атрибут `__dict__` (например, `SimpleNamespace` или пользовательские объекты), оно преобразуется в словарь, где ключи заменяются пустой строкой, если они пусты.
- Если значение является объектом, подобным словарю (имеет метод `items()`), оно также преобразуется в словарь с обработкой пустых ключей.
- Если значение является списком или другим итерируемым объектом, каждый элемент списка рекурсивно преобразуется.
- В противном случае возвращается исходное значение.

**Внутренние функции**:

#### `convert`

**Назначение**: Рекурсивно обрабатывает значения для учета вложенных структур и пустых ключей.

**Параметры**:
- `value` (Any): Значение для обработки.

**Возвращает**:
- `Any`: Преобразованное значение.

**Как работает функция**:

- Если значение имеет атрибут `__dict__` (например, `SimpleNamespace` или пользовательские объекты), оно преобразуется в словарь, где ключи заменяются пустой строкой, если они пусты.
- Если значение является объектом, подобным словарю (имеет метод `items()`), оно также преобразуется в словарь с обработкой пустых ключей.
- Если значение является списком или другим итерируемым объектом, каждый элемент списка рекурсивно преобразуется.
- В противном случае возвращается исходное значение.

**Примеры**:

```python
from types import SimpleNamespace
obj = SimpleNamespace(name="John", age=30, address=SimpleNamespace(city="New York", zip="10001"))
result = ns2dict(obj)
print(result)
# {'name': 'John', 'age': 30, 'address': {'city': 'New York', 'zip': '10001'}}
```

### `ns2csv`

**Назначение**: Преобразует объект `SimpleNamespace` в формат CSV.

**Параметры**:
- `ns_obj` (SimpleNamespace): Объект `SimpleNamespace` для преобразования.
- `csv_file_path` (str | Path): Путь для сохранения CSV-файла.

**Возвращает**:
- `bool`: `True`, если преобразование прошло успешно, `False` в противном случае.

**Как работает функция**:
- Функция `ns2csv` принимает объект `SimpleNamespace` `ns_obj` и путь к CSV-файлу `csv_file_path` в качестве аргументов.
- Преобразует `ns_obj` в словарь с помощью функции `ns2dict`.
- Сохраняет полученные данные в CSV-файл с помощью функции `save_csv_file` из модуля `src.utils.csv`.
- В случае возникновения исключения, логирует ошибку с использованием `logger.error`.

**Примеры**:

```python
from types import SimpleNamespace
from pathlib import Path

ns_obj = SimpleNamespace(name="John", age=30)
csv_file_path = "output.csv"
result = ns2csv(ns_obj, csv_file_path)
print(result)
# True
```

### `ns2xml`

**Назначение**: Преобразует объект `SimpleNamespace` в формат XML.

**Параметры**:
- `ns_obj` (SimpleNamespace): Объект `SimpleNamespace` для преобразования.
- `root_tag` (str): Корневой элемент для XML.

**Возвращает**:
- `str`: Результирующая XML-строка.

**Как работает функция**:
- Функция `ns2xml` принимает объект `SimpleNamespace` `ns_obj` и корневой тег `root_tag` в качестве аргументов.
- Преобразует `ns_obj` в словарь с помощью функции `ns2dict`.
- Преобразует словарь в XML-строку с помощью функции `xml2dict` из модуля `src.utils.convertors`.
- В случае возникновения исключения, логирует ошибку с использованием `logger.error`.

**Примеры**:

```python
from types import SimpleNamespace

ns_obj = SimpleNamespace(name="John", age=30)
result = ns2xml(ns_obj, root_tag="person")
print(result)
# <person><name>John</name><age>30</age></person>
```

### `ns2xls`

**Назначение**: Преобразует объект `SimpleNamespace` в формат XLS.

**Параметры**:
- `data` (SimpleNamespace): Объект `SimpleNamespace` для преобразования.
- `xls_file_path` (str | Path): Путь для сохранения XLS-файла.

**Возвращает**:
- `bool`: `True`, если преобразование прошло успешно, `False` в противном случае.

**Как работает функция**:
- Функция `ns2xls` принимает объект `SimpleNamespace` `data` и путь к XLS-файлу `xls_file_path` в качестве аргументов.
- Сохраняет данные в XLS-файл с помощью функции `save_xls_file` из модуля `src.utils.xls`.

**Примеры**:

```python
from types import SimpleNamespace
from pathlib import Path

data = SimpleNamespace(name="John", age=30)
xls_file_path = "output.xls"
result = ns2xls(data, xls_file_path)
print(result)
# True