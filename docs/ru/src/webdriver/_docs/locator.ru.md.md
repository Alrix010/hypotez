# Документация по локаторам и их взаимодействию с `executor`

## Обзор

В этом документе представлено описание структуры и принципов работы локаторов, используемых для взаимодействия с веб-элементами в проекте `hypotez`. Рассмотрены примеры локаторов, их ключи и взаимодействие с `executor` для выполнения различных действий на веб-страницах.

## Содержание

- [Обзор](#обзор)
- [Подробнее](#подробнее)
- [Примеры локаторов](#примеры-локаторов)
  - [1. `close_banner`](#1-close_banner)
  - [2. `id_manufacturer`](#2-id_manufacturer)
  - [3. `additional_images_urls`](#3-additional_images_urls)
  - [4. `default_image_url`](#4-default_image_url)
  - [5. `id_supplier`](#5-id_supplier)
- [Взаимодействие с `executor`](#взаимодействие-с-executor)

## Подробнее

Локаторы представляют собой конфигурационные объекты, определяющие, как находить и взаимодействовать с веб-элементами на странице. Эти объекты передаются в класс `ExecuteLocator` для выполнения различных действий, таких как клики, отправка текста, извлечение атрибутов и т.д.

Локаторы обеспечивают гибкость и удобство при автоматизации взаимодействия с веб-элементами, а `executor` отвечает за выполнение этих действий с учетом заданных параметров и условий.

## Примеры локаторов

### 1. `close_banner`

```json
"close_banner": {
  "attribute": null,
  "by": "XPATH",
  "selector": "//button[@id = 'closeXButton']",
  "if_list": "first",
  "use_mouse": false,
  "mandatory": false,
  "timeout": 0,
  "timeout_for_event": "presence_of_element_located",
  "event": "click()",
  "locator_description": "Закрываю pop-up окно, если оно не появилось - не страшно (`mandatory`:`false`)"
}
```

**Суть локатора**: Закрытие всплывающего окна (баннера), если оно присутствует на странице.

**Ключи**:

- `attribute`: Атрибут элемента, который необходимо извлечь (в данном случае не используется, поэтому `null`).
- `by`: Тип локатора, указывающий метод поиска элемента (в данном случае `XPATH`).
- `selector`: XPATH-выражение для поиска элемента (`//button[@id = 'closeXButton']`).
- `if_list`: Указывает, какой элемент из списка найденных элементов следует использовать (в данном случае `first`, т.е. первый элемент).
- `use_mouse`: Определяет, следует ли использовать мышь для выполнения действия (в данном случае `false`, т.е. не использовать).
- `mandatory`: Определяет, является ли выполнение действия обязательным (в данном случае `false`, т.е. действие не является обязательным).
- `timeout`: Максимальное время ожидания поиска элемента (в данном случае `0`, т.е. без ожидания).
- `timeout_for_event`: Условие ожидания перед выполнением действия (в данном случае `presence_of_element_located`, т.е. ожидание появления элемента).
- `event`: Событие, которое необходимо выполнить над элементом (в данном случае `click()`, т.е. клик по элементу).
- `locator_description`: Описание локатора.

**Взаимодействие с `executor`**:

- `executor` выполняет поиск элемента по заданному XPATH-выражению.
- Если элемент найден, `executor` выполняет клик по нему.
- Если элемент не найден, `executor` продолжает выполнение, так как действие не является обязательным (`mandatory: false`).

### 2. `id_manufacturer`

```json
"id_manufacturer": {
  "attribute": 11290,
  "by": "VALUE",
  "selector": null,
  "if_list": "first",
  "use_mouse": false,
  "mandatory": true,
  "timeout": 0,
  "timeout_for_event": "presence_of_element_located",
  "event": null,
  "locator_description": "id_manufacturer"
}
```

**Суть локатора**: Возврат значения, указанного в атрибуте `attribute`.

**Ключи**:

- `attribute`: Значение атрибута, которое необходимо вернуть (`11290`).
- `by`: Тип локатора (в данном случае `VALUE`, что означает, что поиск элемента не требуется).
- `selector`: Не используется, так как `by` установлен в `VALUE`.
- `if_list`: Указывает, какой элемент из списка найденных элементов следует использовать (в данном случае `first`, т.е. первый элемент).
- `use_mouse`: Определяет, следует ли использовать мышь для выполнения действия (в данном случае `false`, т.е. не использовать).
- `mandatory`: Определяет, является ли выполнение действия обязательным (в данном случае `true`, т.е. действие является обязательным).
- `timeout`: Максимальное время ожидания поиска элемента (в данном случае `0`, т.е. без ожидания).
- `timeout_for_event`: Условие ожидания перед выполнением действия (в данном случае `presence_of_element_located`, т.е. ожидание появления элемента).
- `event`: Событие, которое необходимо выполнить над элементом (в данном случае `null`, т.е. событие не требуется).
- `locator_description`: Описание локатора.

**Взаимодействие с `executor`**:

- `executor` возвращает значение, указанное в `attribute` (`11290`), без поиска элемента на странице.
- Так как `mandatory` установлен в `true`, `executor` выдаст ошибку, если значение `attribute` не определено.

### 3. `additional_images_urls`

```json
"additional_images_urls": {
  "attribute": "src",
  "by": "XPATH",
  "selector": "//ol[contains(@class, 'flex-control-thumbs')]//img",
  "if_list": "first",
  "use_mouse": false,
  "mandatory": false,
  "timeout": 0,
  "timeout_for_event": "presence_of_element_located",
  "event": null
}
```

**Суть локатора**: Извлечение URL-адресов дополнительных изображений.

**Ключи**:

- `attribute`: Атрибут элемента, значение которого необходимо извлечь (`src`, т.е. URL изображения).
- `by`: Тип локатора, указывающий метод поиска элемента (в данном случае `XPATH`).
- `selector`: XPATH-выражение для поиска элементов (`//ol[contains(@class, 'flex-control-thumbs')]//img`).
- `if_list`: Указывает, какой элемент из списка найденных элементов следует использовать (в данном случае `first`, т.е. первый элемент).
- `use_mouse`: Определяет, следует ли использовать мышь для выполнения действия (в данном случае `false`, т.е. не использовать).
- `mandatory`: Определяет, является ли выполнение действия обязательным (в данном случае `false`, т.е. действие не является обязательным).
- `timeout`: Максимальное время ожидания поиска элемента (в данном случае `0`, т.е. без ожидания).
- `timeout_for_event`: Условие ожидания перед выполнением действия (в данном случае `presence_of_element_located`, т.е. ожидание появления элемента).
- `event`: Событие, которое необходимо выполнить над элементом (в данном случае `null`, т.е. событие не требуется).

**Взаимодействие с `executor`**:

- `executor` выполняет поиск элементов по заданному XPATH-выражению.
- Для каждого найденного элемента `executor` извлекает значение атрибута `src` (URL изображения).
- Если элементы не найдены, `executor` продолжает выполнение, так как действие не является обязательным (`mandatory: false`).

### 4. `default_image_url`

```json
"default_image_url": {
  "attribute": null,
  "by": "XPATH",
  "selector": "//a[@id = 'mainpic']//img",
  "if_list": "first",
  "use_mouse": false,
  "timeout": 0,
  "timeout_for_event": "presence_of_element_located",
  "event": "screenshot()",
  "mandatory": true,
  "locator_description": "Внимание! в морлеви картинка получается через screenshot и возвращается как png (`bytes`)"
}
```

**Суть локатора**: Создание скриншота изображения по умолчанию.

**Ключи**:

- `attribute`: Атрибут элемента, который необходимо извлечь (в данном случае не используется, поэтому `null`).
- `by`: Тип локатора, указывающий метод поиска элемента (в данном случае `XPATH`).
- `selector`: XPATH-выражение для поиска элемента (`//a[@id = 'mainpic']//img`).
- `if_list`: Указывает, какой элемент из списка найденных элементов следует использовать (в данном случае `first`, т.е. первый элемент).
- `use_mouse`: Определяет, следует ли использовать мышь для выполнения действия (в данном случае `false`, т.е. не использовать).
- `timeout`: Максимальное время ожидания поиска элемента (в данном случае `0`, т.е. без ожидания).
- `timeout_for_event`: Условие ожидания перед выполнением действия (в данном случае `presence_of_element_located`, т.е. ожидание появления элемента).
- `event`: Событие, которое необходимо выполнить над элементом (в данном случае `screenshot()`, т.е. создание скриншота элемента).
- `mandatory`: Определяет, является ли выполнение действия обязательным (в данном случае `true`, т.е. действие является обязательным).
- `locator_description`: Описание локатора.

**Взаимодействие с `executor`**:

- `executor` выполняет поиск элемента по заданному XPATH-выражению.
- Если элемент найден, `executor` создает скриншот этого элемента.
- Если элемент не найден, `executor` выдает ошибку, так как действие является обязательным (`mandatory: true`).

### 5. `id_supplier`

```json
"id_supplier": {
  "attribute": "innerText",
  "by": "XPATH",
  "selector": "//span[@class = 'ltr sku-copy']",
  "if_list": "first",
  "use_mouse": false,
  "mandatory": true,
  "timeout": 0,
  "timeout_for_event": "presence_of_element_located",
  "event": null,
  "locator_description": "SKU morlevi"
}
```

**Суть локатора**: Извлечение текста, содержащегося внутри элемента, который содержит SKU.

**Ключи**:

- `attribute`: Атрибут элемента, значение которого необходимо извлечь (`innerText`, т.е. текст внутри элемента).
- `by`: Тип локатора, указывающий метод поиска элемента (в данном случае `XPATH`).
- `selector`: XPATH-выражение для поиска элемента (`//span[@class = 'ltr sku-copy']`).
- `if_list`: Указывает, какой элемент из списка найденных элементов следует использовать (в данном случае `first`, т.е. первый элемент).
- `use_mouse`: Определяет, следует ли использовать мышь для выполнения действия (в данном случае `false`, т.е. не использовать).
- `mandatory`: Определяет, является ли выполнение действия обязательным (в данном случае `true`, т.е. действие является обязательным).
- `timeout`: Максимальное время ожидания поиска элемента (в данном случае `0`, т.е. без ожидания).
- `timeout_for_event`: Условие ожидания перед выполнением действия (в данном случае `presence_of_element_located`, т.е. ожидание появления элемента).
- `event`: Событие, которое необходимо выполнить над элементом (в данном случае `null`, т.е. событие не требуется).
- `locator_description`: Описание локатора.

**Взаимодействие с `executor`**:

- `executor` выполняет поиск элемента по заданному XPATH-выражению.
- Если элемент найден, `executor` извлекает текст, содержащийся внутри этого элемента (`innerText`).
- Если элемент не найден, `executor` выдает ошибку, так как действие является обязательным (`mandatory: true`).

## Взаимодействие с `executor`

`executor` использует локаторы для выполнения различных действий на веб-странице. Основные шаги взаимодействия:

1. **Парсинг локатора**: Преобразование локатора в объект `SimpleNamespace`, если это необходимо.
2. **Поиск элемента**: Использование типа локатора (`by`) и селектора (`selector`) для поиска элемента на странице.
3. **Выполнение события**: Если указан ключ `event`, выполнение соответствующего действия (например, клик, создание скриншота).
4. **Извлечение атрибута**: Если указан ключ `attribute`, извлечение значения атрибута из найденного элемента.
5. **Обработка ошибок**: Если элемент не найден и действие не является обязательным (`mandatory: false`), продолжение выполнения. Если действие обязательно, выдача ошибки.