# Документация для класса `Supplier`

## Обзор

Класс `Supplier` является базовым классом для управления поставщиками данных в приложении `hypotez`. Он предоставляет структуру для взаимодействия с различными источниками данных, такими как Amazon, AliExpress, Walmart и другие. Этот класс обрабатывает инициализацию настроек, специфичных для поставщика, управляет сценариями для сбора данных и предоставляет методы для входа в систему и выполнения сценариев.

## Подробнее

Класс `Supplier` служит в качестве основы для управления сбором данных от различных поставщиков. Он определяет общие методы и атрибуты, которые могут использоваться или расширяться конкретными реализациями для разных поставщиков. Класс централизует управление поставщиками, включая конфигурацию, вход в систему и выполнение сценариев.

## Классы

### `Supplier`

**Описание**: Базовый класс для управления поставщиками данных.

**Атрибуты**:

- `supplier_id` (str): Уникальный идентификатор поставщика.
- `supplier_prefix` (str): Префикс поставщика, например, `aliexpress` или `amazon`.
- `supplier_settings` (dict): Настройки поставщика, загруженные из файла конфигурации.
- `locale` (str): Код локализации (например, `en` для английского, `ru` для русского).
- `price_rule` (str): Правило для расчета цен (например, добавление НДС или применение скидок).
- `related_modules` (module): Модуль, содержащий специфичные для поставщика функции.
- `scenario_files` (list): Список файлов сценариев для выполнения.
- `current_scenario` (dict): Текущий выполняемый сценарий.
- `login_data` (dict): Учетные данные для входа на сайт поставщика (если требуется).
- `locators` (dict): Локаторы для веб-элементов на сайте поставщика.
- `driver` (Driver): Веб-драйвер для взаимодействия с сайтом поставщика.
- `parsing_method` (str): Метод для парсинга данных (например, `webdriver`, `api`, `xls`, `csv`).

**Принцип работы**:

Класс `Supplier` действует как шаблон для управления сбором данных от различных поставщиков. Он определяет общие методы и атрибуты, которые могут использоваться или расширяться конкретными реализациями для разных поставщиков. Класс централизует управление поставщиками, включая конфигурацию, вход в систему и выполнение сценариев.

## Методы класса

### `__init__`

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs)
```

**Назначение**: Конструктор класса `Supplier`. Инициализирует атрибуты на основе префикса поставщика и других параметров.

**Параметры**:

- `supplier_prefix` (str): Префикс поставщика (например, 'aliexpress').
- `locale` (str): Локаль (язык) поставщика. По умолчанию 'en'.
- `webdriver` (str | Driver | bool): Веб-драйвер для взаимодействия с сайтом поставщика. Может быть строкой (например, 'chrome'), объектом `Driver` или булевым значением. По умолчанию 'default'.
- `*attrs`: Дополнительные атрибуты.
- `**kwargs`: Дополнительные именованные аргументы.

**Возвращает**:

- `None`

**Как работает функция**:

Метод `__init__` выполняет следующие действия:
1. Инициализирует префикс поставщика (`supplier_prefix`), который определяет, с каким поставщиком будет работать данный экземпляр класса.
2. Устанавливает локаль (`locale`), определяющую язык, используемый при взаимодействии с поставщиком.
3. Инициализирует веб-драйвер (`webdriver`), который будет использоваться для автоматизации взаимодействия с веб-сайтом поставщика. Если указано значение 'default', используется веб-драйвер по умолчанию.

**Примеры**:

```python
# Создание объекта Supplier для 'aliexpress' с английской локалью и драйвером Chrome по умолчанию
supplier = Supplier(supplier_prefix='aliexpress', locale='en')

# Создание объекта Supplier для 'amazon' с русской локалью и указанным веб-драйвером
supplier = Supplier(supplier_prefix='amazon', locale='ru', webdriver='chrome')
```

### `_payload`

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool
```

**Назначение**: Загружает специфичные для поставщика конфигурации, локаторы и инициализирует веб-драйвер.

**Параметры**:

- `webdriver` (str | Driver | bool): Веб-драйвер для взаимодействия с сайтом поставщика. Может быть строкой (например, 'chrome'), объектом `Driver` или булевым значением.
- `*attrs`: Дополнительные атрибуты.
- `**kwargs`: Дополнительные именованные аргументы.

**Возвращает**:

- `bool`: Возвращает `True`, если все сценарии успешно завершены.

**Как работает функция**:

Метод `_payload` выполняет следующие действия:

1. Загружает файлы конфигурации для поставщика, включая настройки и локаторы.
2. Инициализирует веб-драйвер, который будет использоваться для взаимодействия с сайтом поставщика.

**Примеры**:

```python
# Загрузка конфигурации с драйвером Chrome по умолчанию
success = supplier._payload(webdriver='chrome')

# Загрузка конфигурации с указанным объектом веб-драйвера
success = supplier._payload(webdriver=driver)
```

### `login`

```python
def login(self) -> bool
```

**Назначение**: Обрабатывает процесс входа на сайт поставщика, если требуется аутентификация.

**Параметры**:

- `None`

**Возвращает**:

- `bool`: Возвращает `True`, если вход выполнен успешно.

**Как работает функция**:

Метод `login` выполняет следующие действия:

1. Проверяет, требуется ли аутентификация для данного поставщика.
2. Если аутентификация требуется, выполняет вход на сайт поставщика, используя учетные данные, хранящиеся в `login_data`.

**Примеры**:

```python
# Выполнение входа на сайт поставщика
login_successful = supplier.login()
```

### `run_scenario_files`

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool
```

**Назначение**: Выполняет один или несколько файлов сценариев.

**Параметры**:

- `scenario_files` (str | List[str]): Путь к файлу сценария или список путей к файлам сценариев для выполнения. По умолчанию `None`.

**Возвращает**:

- `bool`: Возвращает `True`, если все сценарии успешно завершены.

**Как работает функция**:

Метод `run_scenario_files` выполняет следующие действия:

1. Получает список файлов сценариев для выполнения.
2. Выполняет каждый сценарий в списке.

**Примеры**:

```python
# Выполнение одного файла сценария
success = supplier.run_scenario_files('example_scenario.json')

# Выполнение списка файлов сценариев
success = supplier.run_scenario_files(['scenario1.json', 'scenario2.json'])
```

### `run_scenarios`

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool
```

**Назначение**: Выполняет один или несколько сценариев.

**Параметры**:

- `scenarios` (dict | list[dict]): Сценарий или список сценариев для выполнения.

**Возвращает**:

- `bool`: Возвращает `True`, если все сценарии успешно завершены.

**Как работает функция**:

Метод `run_scenarios` выполняет следующие действия:

1. Получает список сценариев для выполнения.
2. Выполняет каждый сценарий в списке.

**Примеры**:

```python
# Выполнение одного сценария
success = supplier.run_scenarios({'action': 'scrape', 'target': 'product_list'})

# Выполнение списка сценариев
success = supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}, {'action': 'validate', 'target': 'data'}])
```