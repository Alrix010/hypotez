# Модуль `Supplier`

## Обзор

Класс `Supplier` служит в качестве базового класса для управления поставщиками данных в вашем приложении. Он предоставляет фреймворк для взаимодействия с различными источниками данных, такими как Amazon, AliExpress, Walmart и другие. Этот класс обрабатывает инициализацию настроек поставщика, управляет сценариями сбора данных и предоставляет методы для входа в систему и выполнения сценариев.

## Подробней

Класс `Supplier` является основой для управления поставщиками данных в проекте. Он предоставляет общую структуру и функциональность, которую можно расширять и настраивать для конкретных поставщиков.

## Классы

### `Supplier`

**Описание**: Базовый класс для управления поставщиками данных.

**Атрибуты**:

- `supplier_id` (str): Уникальный идентификатор поставщика.
- `supplier_prefix` (str): Префикс поставщика, например, `aliexpress` или `amazon`.
- `supplier_settings` (dict): Настройки поставщика, загруженные из файла конфигурации.
- `locale` (str): Код локализации (например, `en` для английского, `ru` для русского).
- `price_rule` (str): Правило для расчета цен (например, добавление НДС или применение скидок).
- `related_modules` (module): Модуль, содержащий функции, специфичные для поставщика.
- `scenario_files` (List[str]): Список файлов сценариев для выполнения.
- `current_scenario` (dict): Текущий выполняемый сценарий.
- `login_data` (dict): Учетные данные для входа на сайт поставщика (если требуется).
- `locators` (dict): Локаторы для веб-элементов на сайте поставщика.
- `driver` (Driver): Веб-драйвер для взаимодействия с сайтом поставщика.
- `parsing_method` (str): Метод для парсинга данных (например, `webdriver`, `api`, `xls`, `csv`).

**Принцип работы**:

1.  **Инициализация**:
    При создании объекта класса `Supplier` метод `__init__` инициализирует префикс поставщика, локаль и веб-драйвер.
    ```python
    supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
    ```
2.  **Загрузка конфигурации**:
    Метод `_payload` загружает файлы конфигурации для поставщика, включая настройки, локаторы, и инициализирует веб-драйвер.
    ```python
    def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
        # Загружает файлы конфигурации и настраивает веб-драйвер
    ```
3.  **Вход в систему**:
    Метод `login` обрабатывает процесс аутентификации для веб-сайта поставщика.
    ```python
    supplier.login()
    ```
4.  **Выполнение сценариев**:

    *   Метод `run_scenario_files` запускает сценарии из списка файлов.

    ```python
    supplier.run_scenario_files(['example_scenario.json'])
    ```

    *   Метод `run_scenarios` запускает сценарии на основе определенных условий или задач.

    ```python
    supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
    ```

**Методы**:

- `__init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs)`
    - **Описание**: Конструктор класса, инициализирует атрибуты на основе префикса поставщика и других параметров.
    - **Параметры**:
        - `supplier_prefix` (str): Префикс поставщика.
        - `locale` (str): Локаль. По умолчанию 'en'.
        - `webdriver` (str | Driver | bool): Веб-драйвер. По умолчанию 'default'.
        - `*attrs`: Дополнительные атрибуты.
        - `**kwargs`: Дополнительные именованные аргументы.

- `_payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool`
    - **Описание**: Загружает конфигурации поставщика, локаторы и инициализирует веб-драйвер.
    - **Параметры**:
        - `webdriver` (str | Driver | bool): Веб-драйвер.
        - `*attrs`: Дополнительные атрибуты.
        - `**kwargs`: Дополнительные именованные аргументы.
    - **Возвращает**:
        - `bool`: `True`, если все сценарии успешно завершены.

- `login(self) -> bool`
    - **Описание**: Выполняет вход на сайт поставщика, если требуется аутентификация.
    - **Возвращает**:
        - `bool`: `True`, если вход выполнен успешно.

- `run_scenario_files(self, scenario_files: str | List[str] = None) -> bool`
    - **Описание**: Выполняет один или несколько файлов сценариев.
    - **Параметры**:
        - `scenario_files` (str | List[str]): Список файлов сценариев. По умолчанию `None`.
    - **Возвращает**:
        - `bool`: `True`, если все сценарии успешно завершены.

- `run_scenarios(self, scenarios: dict | list[dict]) -> bool`
    - **Описание**: Выполняет один или несколько сценариев.
    - **Параметры**:
        - `scenarios` (dict | list[dict]): Список сценариев.
    - **Возвращает**:
        - `bool`: `True`, если все сценарии успешно завершены.

## Примеры

```python
# Создание объекта Supplier для 'aliexpress'
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')

# Выполнение входа на сайт поставщика
supplier.login()

# Выполнение файлов сценариев
supplier.run_scenario_files(['example_scenario.json'])

# Или выполнение конкретных сценариев
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```

## Параметры класса

- `supplier_prefix` (str): Префикс поставщика, используемый для загрузки конфигурационных файлов и определения поведения поставщика.
- `locale` (str): Локаль, определяющая язык и региональные настройки для сбора данных.
- `webdriver` (str | Driver | bool): Веб-драйвер для взаимодействия с сайтом поставщика. Может быть экземпляром класса `Driver`, строкой, указывающей на тип драйвера, или булевым значением, указывающим, использовать ли веб-драйвер.
- `scenario_files` (str | List[str]): Список файлов сценариев, определяющих последовательность действий для сбора данных.
- `scenarios` (dict | list[dict]): Список сценариев, определяющих действия для сбора данных.

## Методы класса

### `__init__`

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs):
    """
    Инициализирует атрибуты на основе префикса поставщика и других параметров.

    Args:
        supplier_prefix (str): Префикс поставщика.
        locale (str): Локаль. По умолчанию 'en'.
        webdriver (str | Driver | bool): Веб-драйвер. По умолчанию 'default'.
        *attrs: Дополнительные атрибуты.
        **kwargs: Дополнительные именованные аргументы.
    """
```

### `_payload`

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
    """
    Загружает конфигурации поставщика, локаторы и инициализирует веб-драйвер.

    Args:
        webdriver (str | Driver | bool): Веб-драйвер.
        *attrs: Дополнительные атрибуты.
        **kwargs: Дополнительные именованные аргументы.

    Returns:
        bool: True, если конфигурация загружена успешно.
    """
```

### `login`

```python
def login(self) -> bool:
    """
    Выполняет вход на сайт поставщика, если требуется аутентификация.

    Returns:
        bool: True, если вход выполнен успешно.
    """
```

### `run_scenario_files`

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool:
    """
    Выполняет один или несколько файлов сценариев.

    Args:
        scenario_files (str | List[str]): Список файлов сценариев. По умолчанию None.

    Returns:
        bool: True, если все сценарии успешно завершены.
    """
```

### `run_scenarios`

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool:
    """
    Выполняет один или несколько сценариев.

    Args:
        scenarios (dict | list[dict]): Список сценариев.

    Returns:
        bool: True, если все сценарии успешно завершены.
    """
```

## Заключение

В заключение, класс `Supplier` предоставляет структурированный способ взаимодействия с поставщиками данных, управляя конфигурациями, выполняя входы в систему и выполняя сценарии сбора данных. Он служит основой, которую можно расширить для конкретных поставщиков, наследуя от этого базового класса и добавляя или переопределяя функциональность по мере необходимости.