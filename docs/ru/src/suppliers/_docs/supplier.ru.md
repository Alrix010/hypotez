# Модуль `Supplier`

## Обзор

Модуль содержит базовый класс `Supplier`, предназначенный для работы с поставщиками данных в приложении. Он предоставляет общие методы и атрибуты, которые могут быть использованы или переопределены конкретными реализациями поставщиков, такими как Amazon, AliExpress, Walmart и другие.

## Подробней

Класс `Supplier` служит основой для создания более специфичных классов для каждого поставщика данных. Он определяет общие свойства и методы, которые могут быть переопределены в конкретных реализациях для работы с различными сайтами и API.

## Классы

### `Supplier`

**Описание**: Базовый класс для работы с поставщиками данных.

**Наследует**: Отсутствует.

**Атрибуты**:
- `supplier_id` (str): Уникальный идентификатор поставщика.
- `supplier_prefix` (str): Префикс для поставщика, например, `aliexpress` или `amazon`.
- `supplier_settings` (dict): Настройки для поставщика, загруженные из файла конфигурации.
- `locale` (str): Код локализации (например, `en` для английского, `ru` для русского).
- `price_rule` (Any): Правило для расчета цены (например, добавление НДС или скидки).
- `related_modules` (ModuleType): Модуль, содержащий специфические для поставщика функции.
- `scenario_files` (List[str]): Список файлов сценариев, которые должны быть выполнены.
- `current_scenario` (str): Текущий сценарий выполнения.
- `login_data` (dict): Данные для входа на сайт поставщика (если требуется).
- `locators` (dict): Локаторы для веб-элементов на страницах сайта поставщика.
- `driver` (WebDriver): Веб-драйвер для взаимодействия с сайтом поставщика.
- `parsing_method` (str): Метод парсинга данных (например, `webdriver`, `api`, `xls`, `csv`).

**Принцип работы**:
Класс `Supplier` инкапсулирует общую логику взаимодействия с сайтом, настройку драйвера, управление сценариями и парсинг данных. Конкретные реализации поставщиков наследуют этот класс и добавляют свою специфическую логику.

**Методы**:

- `__init__`: Конструктор класса.
- `_payload`: Загружает настройки поставщика, конфигурационные файлы и инициализирует веб-драйвер.
- `login`: Выполняет вход на сайт поставщика (если требуется).
- `run_scenario_files`: Запускает выполнение файлов сценариев.
- `run_scenarios`: Запускает один или несколько сценариев.

## Методы класса

### `__init__`

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs)
```

**Назначение**: Инициализирует атрибуты класса `Supplier` на основе предоставленных параметров.

**Параметры**:
- `supplier_prefix` (str): Префикс поставщика (например, 'aliexpress').
- `locale` (str): Код локализации (например, 'en'). По умолчанию 'en'.
- `webdriver` (str | Driver | bool): Веб-драйвер для взаимодействия с сайтом. Может быть строкой ('default', 'chrome', и т.д.), экземпляром класса `Driver` или булевым значением. По умолчанию 'default'.
- `*attrs`: Произвольные позиционные аргументы.
- `**kwargs`: Произвольные именованные аргументы.

**Как работает функция**:
- Конструктор инициализирует префикс поставщика, локаль и веб-драйвер.
- Загружает настройки поставщика и инициализирует необходимые компоненты.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='ru', webdriver='chrome')
supplier = Supplier(supplier_prefix='amazon', locale='en', webdriver=True)
```

### `_payload`

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool
```

**Назначение**: Загружает настройки поставщика, конфигурационные файлы и инициализирует веб-драйвер.

**Параметры**:
- `webdriver` (str | Driver | bool): Веб-драйвер для взаимодействия с сайтом. Может быть строкой ('default', 'chrome', и т.д.), экземпляром класса `Driver` или булевым значением.
- `*attrs`: Произвольные позиционные аргументы.
- `**kwargs`: Произвольные именованные аргументы.

**Возвращает**:
- `bool`: Возвращает `True` в случае успешной загрузки и инициализации, иначе `False`.

**Как работает функция**:
- Загружает конфигурационные файлы и инициализирует веб-драйвер для указанного поставщика.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
result = supplier._payload(webdriver='firefox')
```

### `login`

```python
def login(self) -> bool
```

**Назначение**: Выполняет вход на сайт поставщика, если это необходимо.

**Возвращает**:
- `bool`: Возвращает `True`, если вход выполнен успешно, иначе `False`.

**Как работает функция**:
- Использует данные для входа на сайт поставщика и выполняет необходимые действия для аутентификации.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
supplier._payload(webdriver='chrome')
result = supplier.login()
```

### `run_scenario_files`

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool
```

**Назначение**: Запускает выполнение сценариев, определенных в указанных файлах.

**Параметры**:
- `scenario_files` (str | List[str]): Путь к файлу сценария или список путей к файлам сценариев. По умолчанию `None`.

**Возвращает**:
- `bool`: Возвращает `True`, если выполнение сценариев завершено успешно, иначе `False`.

**Как работает функция**:
- Читает файлы сценариев и выполняет действия, определенные в каждом сценарии.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
supplier._payload(webdriver='chrome')
result = supplier.run_scenario_files(['scenario1.json', 'scenario2.json'])
```

### `run_scenarios`

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool
```

**Назначение**: Запускает выполнение указанных сценариев.

**Параметры**:
- `scenarios` (dict | list[dict]): Словарь или список словарей, определяющих сценарии для выполнения.

**Возвращает**:
- `bool`: Возвращает `True`, если выполнение сценариев завершено успешно, иначе `False`.

**Как работает функция**:
- Выполняет действия, определенные в каждом сценарии.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress')
supplier._payload(webdriver='chrome')
scenarios = [{'action': 'scrape', 'target': 'product_list'}]
result = supplier.run_scenarios(scenarios)
```

## Параметры класса

- `supplier_prefix` (str): Префикс поставщика (например, 'aliexpress'). Используется для загрузки специфичных настроек и локаторов для данного поставщика.
- `locale` (str): Код локализации (например, 'en'). Определяет язык и региональные настройки, используемые при взаимодействии с сайтом поставщика.
- `webdriver` (str | Driver | bool): Веб-драйвер для взаимодействия с сайтом. Может быть строкой ('default', 'chrome', и т.д.), экземпляром класса `Driver` или булевым значением.

## Примеры

```python
# Создаем объект для поставщика 'aliexpress'
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')

# Выполняем вход на сайт поставщика
supplier.login()

# Запускаем сценарии из файлов
supplier.run_scenario_files(['example_scenario.json'])

# Или запускаем сценарии по определенным условиям
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```