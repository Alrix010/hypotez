# Модуль `Supplier`

## Обзор

Модуль определяет базовый класс `Supplier`, предназначенный для работы с различными поставщиками данных. Он предоставляет общую структуру и функциональность для взаимодействия с веб-сайтами поставщиков, загрузки конфигураций, входа на сайт и выполнения сценариев сбора данных.

## Подробнее

Класс `Supplier` является основой для создания классов, специфичных для каждого поставщика данных (например, Amazon, AliExpress, Walmart). Он содержит общие атрибуты и методы, необходимые для взаимодействия с сайтами поставщиков, такие как идентификатор поставщика, настройки, локализация, веб-драйвер и сценарии выполнения. Класс предоставляет методы для загрузки конфигураций, входа на сайт поставщика (если требуется) и выполнения сценариев сбора данных. Конкретные реализации поставщиков наследуют этот класс и добавляют свою специфическую логику.

## Классы

### `Supplier`

**Описание**: Базовый класс для работы с поставщиками данных.

**Наследует**: Нет.

**Атрибуты**:
- `supplier_id` (str): Уникальный идентификатор поставщика.
- `supplier_prefix` (str): Префикс для поставщика, например, `aliexpress` или `amazon`.
- `supplier_settings` (dict): Настройки для поставщика, загруженные из файла конфигурации.
- `locale` (str): Код локализации (например, `en` для английского, `ru` для русского).
- `price_rule` (Any): Правило для расчета цены (например, добавление НДС или скидки).
- `related_modules` (Any): Модуль, содержащий специфические для поставщика функции.
- `scenario_files` (List[str]): Список файлов сценариев, которые должны быть выполнены.
- `current_scenario` (str): Текущий сценарий выполнения.
- `login_data` (dict): Данные для входа на сайт поставщика (если требуется).
- `locators` (dict): Локаторы для веб-элементов на страницах сайта поставщика.
- `driver` (Driver): Веб-драйвер для взаимодействия с сайтом поставщика.
- `parsing_method` (str): Метод парсинга данных (например, `webdriver`, `api`, `xls`, `csv`).

**Принцип работы**:
Класс `Supplier` инициализируется с префиксом поставщика, локалью и веб-драйвером. В процессе инициализации загружаются настройки поставщика, конфигурационные файлы и инициализируется веб-драйвер. Класс предоставляет методы для входа на сайт поставщика, выполнения сценариев сбора данных и обработки полученных данных. Конкретные реализации поставщиков наследуют этот класс и добавляют свою специфическую логику.

**Методы**:
- `__init__`: Конструктор класса, инициализирующий атрибуты на основе префикса поставщика и других параметров.
- `_payload`: Загружает настройки поставщика, конфигурационные файлы и инициализирует веб-драйвер.
- `login`: Метод для выполнения входа на сайт поставщика (если требуется).
- `run_scenario_files`: Запускает выполнение файлов сценариев.
- `run_scenarios`: Запускает один или несколько сценариев.

## Методы класса

### `__init__`

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs) -> None:
    """
    Инициализирует экземпляр класса `Supplier`.

    Args:
        supplier_prefix (str): Префикс поставщика (например, 'aliexpress').
        locale (str, optional): Локаль поставщика. По умолчанию 'en'.
        webdriver (str | Driver | bool, optional): Тип веб-драйвера или экземпляр драйвера. По умолчанию 'default'.
        *attrs: Дополнительные атрибуты.
        **kwargs: Дополнительные именованные аргументы.

    Raises:
        NotImplementedError: Если метод не реализован в дочернем классе.
        Exception: Если возникает ошибка при инициализации.
    """
    ...
```
**Параметры**:
- `supplier_prefix` (str): Префикс поставщика (например, 'aliexpress').
- `locale` (str, optional): Локаль поставщика. По умолчанию 'en'.
- `webdriver` (str | Driver | bool, optional): Тип веб-драйвера или экземпляр драйвера. По умолчанию 'default'.
- `*attrs`: Дополнительные атрибуты.
- `**kwargs`: Дополнительные именованные аргументы.

**Как работает функция**:
Функция инициализирует экземпляр класса `Supplier`. В процессе инициализации устанавливается префикс поставщика, локаль и веб-драйвер. Вызывается метод `_payload` для загрузки настроек поставщика и инициализации веб-драйвера.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
```

### `_payload`

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
    """
    Загружает конфигурации поставщика и инициализирует веб-драйвер.

    Args:
        webdriver (str | Driver | bool): Тип веб-драйвера или экземпляр драйвера.
        *attrs: Дополнительные атрибуты.
        **kwargs: Дополнительные именованные аргументы.

    Returns:
        bool: `True`, если загрузка прошла успешно, `False` в противном случае.

    Raises:
        FileNotFoundError: Если файл конфигурации не найден.
        Exception: Если возникает ошибка при загрузке конфигурации.
    """
    ...
```

**Параметры**:
- `webdriver` (str | Driver | bool): Тип веб-драйвера или экземпляр драйвера.
- `*attrs`: Дополнительные атрибуты.
- `**kwargs`: Дополнительные именованные аргументы.

**Как работает функция**:
Функция загружает конфигурации поставщика, включая локаторы для страниц и сценарии выполнения. Инициализирует веб-драйвер для взаимодействия с сайтом поставщика.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
supplier._payload(webdriver='chrome')
```

### `login`

```python
def login(self) -> bool:
    """
    Выполняет вход на сайт поставщика.

    Returns:
        bool: `True`, если вход выполнен успешно, `False` в противном случае.

    Raises:
        NotImplementedError: Если метод не реализован в дочернем классе.
        Exception: Если возникает ошибка при входе на сайт.
    """
    ...
```

**Возвращает**:
- `bool`: `True`, если вход выполнен успешно, `False` в противном случае.

**Как работает функция**:
Функция выполняет процесс входа на сайт поставщика, если это требуется. Конкретная реализация входа зависит от поставщика и может включать заполнение форм, ввод логина и пароля, и другие действия.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
supplier.login()
```

### `run_scenario_files`

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool:
    """
    Запускает выполнение сценариев из файлов.

    Args:
        scenario_files (str | List[str], optional): Путь к файлу сценария или список путей к файлам сценариев. По умолчанию `None`.

    Returns:
        bool: `True`, если выполнение сценариев прошло успешно, `False` в противном случае.

    Raises:
        FileNotFoundError: Если файл сценария не найден.
        Exception: Если возникает ошибка при выполнении сценария.
    """
    ...
```

**Параметры**:
- `scenario_files` (str | List[str], optional): Путь к файлу сценария или список путей к файлам сценариев. По умолчанию `None`.

**Как работает функция**:
Функция запускает выполнение сценариев, определенных в файлах. Сценарии определяют, какие действия нужно выполнить (например, сбор данных).

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
supplier.run_scenario_files(['example_scenario.json'])
```

### `run_scenarios`

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool:
    """
    Запускает выполнение заданных сценариев.

    Args:
        scenarios (dict | list[dict]): Список сценариев для выполнения.

    Returns:
        bool: `True`, если выполнение сценариев прошло успешно, `False` в противном случае.

    Raises:
        Exception: Если возникает ошибка при выполнении сценария.
    """
    ...
```

**Параметры**:
- `scenarios` (dict | list[dict]): Список сценариев для выполнения.

**Как работает функция**:
Функция запускает выполнение заданных сценариев. Сценарии определяют, какие действия нужно выполнить (например, сбор данных).

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```