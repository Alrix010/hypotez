# Модуль `scenario.py`

## Обзор

Модуль `scenario.py` предназначен для сбора данных о товарах с сайта поставщика Amazon. Он содержит функции для получения списка категорий товаров, списка товаров в каждой категории и последующей обработки информации о товарах. Модуль является частью проекта `hypotez` и отвечает за взаимодействие с веб-драйвером для автоматизации сбора данных.

## Подробней

Модуль предоставляет функциональность для работы со страницами категорий поставщика Amazon, используя веб-драйвер. Он включает в себя следующие основные этапы:

1.  Сбор списка категорий товаров со страниц продавца.
2.  Сбор списка товаров, представленных в каждой категории.
3.  Итерация по списку товаров и передача URL страницы товара в функцию `grab_product_page()` для дальнейшей обработки.
    Обработка полей товара и передача управления классу `Product`.

## Функции

### `get_list_products_in_category`

```python
def get_list_products_in_category(s) -> list[str,str,None]:
    """Возвращает список URL товаров со страницы категории.

    Args:
        s: Supplier - экземпляр класса Supplier.

    Returns:
        list[str,str,None]: Список URL товаров или None.
    """
```

**Назначение**: Функция извлекает список URL товаров из текущей категории, используя веб-драйвер.

**Параметры**:

*   `s`: Экземпляр класса `Supplier`, содержащий информацию о поставщике, включая веб-драйвер и локаторы элементов страницы.

**Возвращает**:

*   `list[str,str,None]`: Список URL товаров, найденных на странице категории. Возвращает `None`, если список товаров не найден или произошла ошибка.

**Как работает функция**:

1.  Получает экземпляр веб-драйвера из объекта `s`.
2.  Извлекает локаторы для элементов страницы категории из `s.locators['category']`.
3.  Проверяет, что локаторы существуют. Если локаторы не найдены, функция записывает сообщение об ошибке в лог и завершается.
4.  Выполняет прокрутку страницы для загрузки всех элементов (если необходимо).
5.  Использует метод `execute_locator` веб-драйвера для поиска элементов, содержащих ссылки на товары.
6.  Проверяет, найдены ли ссылки на товары. Если ссылки не найдены, функция записывает предупреждение в лог и завершается.
7.  Преобразует результат, полученный от `execute_locator`, в список, если это строка.
8.  Записывает информационное сообщение в лог с количеством найденных товаров.
9.  Возвращает список URL товаров.

```python
    d = s.driver
    l: dict = s.locators['category']
    if not l:
        """ Много проверок, потому, что код можно запускать от лица разных ихполнителей: Supplier, Product, Scenario """
        logger.error(f"А где локаторы? {l}")
        return
    d.scroll()

    #TODO: Нет листалки

    list_products_in_category = d.execute_locator(l['product_links'])
    """ Собираю ссылки на товары.  """
    if not list_products_in_category:
        logger.warning('Нет ссылок на товары')
        return
    
    list_products_in_category = [list_products_in_category] if isinstance(list_products_in_category, str) else list_products_in_category


    logger.info(f""" Найдено {len(list_products_in_category)} товаров """)
    
    #""" Проверяю наличие товара в базе данных магазина """
    #for asin in list_products_in_category:
    #    _asin = asin.split(f'''/''')[-2]
    #    _sku = f'''{s.supplier_id}_{_asin}''' 
    #    if PrestaShopProduct.check(_sku) == False:
    #        """ Синтаксис для того, чтобы помнить,
    #        что я проверяю ОТСУТСТВИЕ товара в базе данных
    #        """
    #        continue
    #    else:
    #        """ Товар в базе данных """
    #        continue
            #TODO: Логику 
```

**Примеры**:

Пример вызова функции:

```python
supplier_instance = Supplier(...)
product_list = get_list_products_in_category(supplier_instance)
if product_list:
    for product_url in product_list:
        print(product_url)