# Модуль `graber.py`

## Обзор

Модуль `graber.py` предназначен для сбора значений полей на странице товара `etzmaleh.co.il`. Он содержит класс `Graber`, который наследует функциональность от родительского класса `Graber` (`Grbr`). Основная задача модуля - предоставить механизм для стандартизированного извлечения данных с веб-страниц товаров, при этом обеспечивая возможность переопределения стандартных методов обработки полей для особых случаев. Перед отправкой запроса к веб-драйверу, есть возможность выполнить предварительные действия с использованием декоратора.

## Подробней

Этот модуль является частью системы для автоматизированного сбора данных о товарах с веб-сайтов поставщиков. Он использует веб-драйвер для навигации по страницам товаров и извлечения информации о продуктах. Модуль предоставляет гибкую структуру, позволяющую настраивать процесс сбора данных для конкретного поставщика (`etzmaleh.co.il` в данном случае).

## Классы

### `Graber`

**Описание**: Класс `Graber` предназначен для захвата данных о товарах с сайта `etzmaleh.co.il`. Он наследует общую функциональность от класса `Graber` (`Grbr`) и предоставляет возможность переопределения методов для специфичной обработки полей.

**Наследует**:

- `Graber` (`Grbr`) из модуля `src.suppliers.graber`: Обеспечивает базовую функциональность для сбора данных.

**Атрибуты**:

- `supplier_prefix` (str): Префикс поставщика, используемый для идентификации.
- `driver`: (Driver) - драйвер, экземпляром которого является selenium-объект.

**Методы**:

- `__init__(self, driver: Driver, lang_index)`: Инициализирует экземпляр класса `Graber` с учетом префикса поставщика, веб-драйвера и индекса языка.

### `close_pop_up(value: Any = None)`

**Описание**: Функция-декоратор, предназначенная для закрытия всплывающих окон перед выполнением основной логики функции. В текущей версии закомментирована и предоставляет шаблон для реализации.

**Параметры**:

- `value` (Any, optional): Дополнительное значение для декоратора. По умолчанию `None`.

**Возвращает**:

- `Callable`: Декоратор, который оборачивает функцию.

**Как работает функция**:

1.  Определяет внутреннюю функцию `decorator`, которая принимает функцию `func` в качестве аргумента и возвращает обертку `wrapper`.
2.  Внутри `wrapper` происходит попытка выполнить локатор для закрытия всплывающего окна с использованием `Context.driver.execute_locator(Context.locator.close_pop_up)`.
3.  В случае возникновения ошибки выполнения локатора, информация об ошибке логируется с использованием `logger.debug`.
4.  После обработки всплывающего окна вызывается основная функция `func` с передачей аргументов и возвращается результат её выполнения.

## Методы класса

### `__init__(self, driver: Driver, lang_index)`

```python
def __init__(self, driver: Driver, lang_index):
    """Инициализация класса сбора полей товара."""
    self.supplier_prefix = 'etzmaleh'
    super().__init__(supplier_prefix=self.supplier_prefix, driver=driver, lang_index=lang_index)
    # Устанавливаем глобальные настройки через Context

    Context.locator_for_decorator = None # <- если будет уастановлено значение - то оно выполнится в декораторе `@close_pop_up`
```

**Назначение**: Инициализирует класс `Graber` для конкретного поставщика, устанавливает префикс поставщика и вызывает конструктор родительского класса.

**Параметры**:

- `driver` (Driver): Экземпляр веб-драйвера для управления браузером.
- `lang_index` (int): Индекс языка, используемый для локализации.

**Как работает функция**:

1.  Устанавливает атрибут `supplier_prefix` в значение `'etzmaleh'`, что идентифицирует поставщика.
2.  Вызывает конструктор родительского класса `Graber` (`Grbr`) с передачей префикса поставщика, экземпляра веб-драйвера и индекса языка.
3.  Устанавливает `Context.locator_for_decorator` в `None`. Если установить значение, оно выполнится в декораторе `@close_pop_up`.

**Примеры**:

```python
from src.webdriver.driver import Driver
from src.webdriver import Firefox

driver = Driver(Firefox)
graber = Graber(driver=driver, lang_index=1)
```
## Параметры класса

- `driver` (Driver): Экземпляр веб-драйвера, используемый для взаимодействия с веб-страницами.
- `lang_index` (int): Индекс языка, используемый для локализации контента.

## Дополнительные аспекты

-   В коде используется декоратор `@close_pop_up`, предназначенный для закрытия всплывающих окон. В текущей версии он закомментирован, но может быть активирован для выполнения предварительных действий перед сбором данных.
-   Используется модуль `Context` для установки глобальных настроек, таких как локатор для декоратора.
-   Для логирования используется модуль `logger` из `src.logger.logger`.