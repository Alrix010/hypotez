# Модуль `src.suppliers.ebay.graber`

## Обзор

Модуль `src.suppliers.ebay.graber` предназначен для сбора значений полей со страницы товара на сайте `ebay.com`. Он содержит класс `Graber`, который наследует функциональность от родительского класса `Graber` (`Grbr`). Этот класс специализируется на обработке полей, требующих нестандартного подхода, переопределяя соответствующие функции. В модуле также предусмотрен механизм предварительных действий перед отправкой запроса к веб-драйверу через декораторы.

## Подробней

Основная цель модуля - автоматизировать процесс извлечения информации о товарах с `ebay.com`. Он обеспечивает гибкость за счет возможности переопределения методов обработки полей, что позволяет адаптироваться к изменениям в структуре веб-страниц.  Используется для парсинга данных о товарах с сайта `ebay.com` и предварительной обработки данных с использованием декораторов для выполнения дополнительных действий, таких как закрытие всплывающих окон.

## Классы

### `Graber`

**Описание**: Класс `Graber` предназначен для захвата данных о товарах с сайта `ebay.com`. Он наследуется от класса `Graber` (`Grbr`) и содержит методы для извлечения и обработки информации с веб-страниц товаров.

**Наследует**:

- `Graber` (`Grbr`): Родительский класс, предоставляющий базовую функциональность для сбора данных с веб-страниц.

**Атрибуты**:

- `supplier_prefix` (str): Префикс поставщика, устанавливается как `'ebay'`.

**Методы**:

- `__init__(self, driver: Driver, lang_index)`: Инициализирует класс `Graber`, устанавливает префикс поставщика и вызывает конструктор родительского класса.

#### `__init__`

```python
def __init__(self, driver: Driver, lang_index):
    """Инициализация класса сбора полей товара."""
    ...
```

**Назначение**: Инициализация экземпляра класса `Graber`.

**Параметры**:

- `driver` (Driver): Инстанс веб-драйвера, используемый для взаимодействия с веб-страницами.
- `lang_index`: Индекс языка.

**Как работает функция**:

- Устанавливает атрибут `supplier_prefix` равным `'ebay'`.
- Вызывает конструктор родительского класса `Graber` (`Grbr`) с соответствующими параметрами.
- Устанавливает значение `Context.locator_for_decorator` в `None`. Это позволяет отключать выполнение декоратора `@close_pop_up`, если он не требуется.

## Переменные класса

- `supplier_prefix` (str): Префикс поставщика, используемый для идентификации поставщика в системе.

## Обзор кода
В данном коде определен класс `Graber`, предназначенный для сбора данных о товарах с сайта `ebay.com`. Класс наследуется от базового класса `Graber` (`Grbr`) и переопределяет некоторые методы для адаптации к специфике `ebay.com`.
В коде также присутствует закомментированный шаблон декоратора `close_pop_up`, предназначенного для закрытия всплывающих окон, который можно использовать для предварительной обработки страницы.

```python
from typing import Any
import header
from src.suppliers.graber import Graber as Grbr, Context, close_pop_up
from src.webdriver.driver import Driver
from src.logger.logger import logger
```
- `typing.Any`: Импортируется для аннотации типов, когда тип переменной может быть любым.
- `header`: Импортируется модуль `header`.
- `src.suppliers.graber.Graber`: Импортируется базовый класс `Graber` как `Grbr`, класс `Context` и декоратор `close_pop_up` из модуля `src.suppliers.graber`.
- `src.webdriver.driver.Driver`: Импортируется класс `Driver` для управления веб-драйвером.
- `src.logger.logger.logger`: Импортируется объект `logger` для логирования событий.

## Декораторы
```python
# def close_pop_up(value: Any = None) -> Callable:
#     """Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.
#
#     Args:
#         value (Any): Дополнительное значение для декоратора.
#
#     Returns:
#         Callable: Декоратор, оборачивающий функцию.
#     """
#     def decorator(func: Callable) -> Callable:
#         @wraps(func)
#         async def wrapper(*args, **kwargs):
#             try:
#                 # await Context.driver.execute_locator(Context.locator.close_pop_up)  # Await async pop-up close
#                 ...
#             except ExecuteLocatorException as e:
#                 logger.debug(f'Ошибка выполнения локатора: {e}')
#             return await func(*args, **kwargs)  # Await the main function
#         return wrapper
#     return decorator
```

Декоратор `close_pop_up` предназначен для закрытия всплывающих окон перед выполнением основной логики функции.

- **Параметры**:
  - `value` (Any, optional): Дополнительное значение для декоратора. По умолчанию `None`.
- **Как работает**:
  - Создает декоратор, который оборачивает функцию.
  - Внутри декоратора вызывается метод `Context.driver.execute_locator(Context.locator.close_pop_up)` для закрытия всплывающего окна.
  - Если возникает исключение `ExecuteLocatorException`, оно логируется с использованием `logger.debug`.
  - После выполнения (или неудачи) закрытия всплывающего окна вызывается основная функция.
```python
class Graber(Grbr):
    """Класс для операций захвата Morlevi."""
    supplier_prefix: str
```

## `Graber`
**Описание**: Класс `Graber` предназначен для захвата данных с сайта `ebay.com`.

- **Наследует**:
  - `Graber` (`Grbr`): Базовый класс для сбора данных.

### `Graber.__init__`
```python
def __init__(self, driver: Driver, lang_index):
    """Инициализация класса сбора полей товара."""
    self.supplier_prefix = 'ebay'
    super().__init__(supplier_prefix=self.supplier_prefix, driver=driver, lang_index=lang_index)
    Context.locator_for_decorator = None
```
- **Назначение**: Инициализация экземпляра класса `Graber`.
- **Параметры**:
  - `driver` (`Driver`): Инстанс веб-драйвера для управления браузером.
  - `lang_index`: Индекс языка.
- **Как работает**:
  - Устанавливает `self.supplier_prefix = 'ebay'`.
  - Вызывает конструктор родительского класса `Grbr` с параметрами `supplier_prefix`, `driver` и `lang_index`.
  - Устанавливает `Context.locator_for_decorator = None`, что позволяет отключать выполнение декоратора `@close_pop_up`, если он не требуется.
```python
Context.locator_for_decorator = None
```

- **Назначение**: Отключает выполнение декоратора `@close_pop_up`, если он не требуется.
- **Как работает**: Устанавливает значение `Context.locator_for_decorator` в `None`. Если это значение установлено, декоратор `@close_pop_up` не будет выполняться.