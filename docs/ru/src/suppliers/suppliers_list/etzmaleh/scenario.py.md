# Модуль scenario.py

## Обзор

Модуль предназначен для сбора информации о товарах с сайта поставщика etzmaleh.co.il через вебдрайвер. Он содержит функции для извлечения списка категорий товаров и списка товаров в каждой категории. Модуль является частью системы сбора данных о товарах и адаптирован для работы с особенностями структуры сайта данного поставщика.

## Подробней

Модуль выполняет следующие основные задачи:

- Сбор списка категорий товаров со страниц поставщика.
- Сбор списка товаров, представленных в каждой категории.
- Итерация по списку товаров и передача URL товара в функцию `grab_product_page()` (из другого модуля), которая отвечает за обработку информации о товаре.

Модуль использует вебдрайвер для взаимодействия с сайтом поставщика и получения необходимых данных.

## Функции

### `get_list_products_in_category(s)`

**Назначение**: Извлекает список URL товаров со страницы категории.

```python
def get_list_products_in_category (s) -> list[str, str, None]:
    """ Returns list of products urls from category page
    Если надо пролистстать - страницы категорий - листаю ??????

    Attrs:
        s - Supplier
    @returns
        list or one of products urls or None
    """
```

**Параметры**:

- `s` (Supplier): Объект поставщика, содержащий необходимые атрибуты, такие как драйвер (`driver`) и локаторы (`locators`).

**Возвращает**:

- `list[str, str, None]`: Список URL товаров, найденных на странице категории. Может вернуть `None`, если список товаров не найден.

**Как работает функция**:

1.  Извлекает драйвер (`d`) из объекта поставщика (`s`).
2.  Извлекает локаторы (`l`) для элементов категории из объекта поставщика.
3.  Выполняет закрытие баннера, используя локатор из объекта поставщика.
4.  Проверяет наличие локаторов (`l`). Если локаторы отсутствуют, регистрирует ошибку и возвращает `None`.
5.  Выполняет скролл страницы для загрузки всех элементов.
6.  Извлекает список URL товаров, используя локатор `product_links`.
7.  Если список URL товаров не найден, регистрирует предупреждение и возвращает `None`.
8.  Преобразует результат в список, если это строка.
9.  Регистрирует информацию о количестве найденных товаров.
10. Возвращает список URL товаров.

**Примеры**:

Примеры вызова функции могут выглядеть следующим образом (требуется создание фиктивного объекта `Supplier`):

```python
from unittest.mock import MagicMock

# Создаем фиктивный объект Supplier с необходимыми атрибутами
supplier_mock = MagicMock()
supplier_mock.driver = MagicMock()
supplier_mock.locators = {
    'category': {
        'product_links': {'by': 'xpath', 'selector': '//a[@class="product-link"]'}
    },
    'product': {
        'close_banner': {'by': 'xpath', 'selector': '//button[@class="close-banner"]'}
    }
}
supplier_mock.driver.execute_locator.return_value = ['https://example.com/product1', 'https://example.com/product2']
from src.logger.logger import logger
# Вызываем функцию с фиктивным объектом
result = get_list_products_in_category(supplier_mock)
print(result)
#Результат
#['https://example.com/product1', 'https://example.com/product2']
```

### `get_list_categories_from_site(s)`

**Назначение**: 
```python
def get_list_categories_from_site(s):
    ...
```

## Переменные

В данном коде используются следующие переменные:

-   `d`: Драйвер веб-браузера, используемый для навигации по сайту и взаимодействия с элементами на странице.
-   `l`: Локаторы элементов на странице, используемые для поиска и взаимодействия с этими элементами.
-   `list_products_in_category`: Список URL товаров, найденных на странице категории.
-   `s`: Объект, представляющий поставщика, с которым происходит взаимодействие.