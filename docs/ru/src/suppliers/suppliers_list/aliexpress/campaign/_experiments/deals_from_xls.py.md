# Модуль deals_from_xls.py

## Обзор

Модуль предназначен для парсинга XLS-таблиц, сгенерированных в личном кабинете portals.aliexpress.com. Он использует класс `DealsFromXLS` для извлечения информации о сделках и печати их.

## Подробней

Этот модуль предназначен для автоматической обработки данных о сделках, экспортированных из личного кабинета AliExpress. Он позволяет извлекать информацию о каждой сделке и использовать ее для дальнейшей обработки или анализа. Модуль использует класс `DealsFromXLS` из модуля `src.suppliers.suppliers_list.aliexpress` и модуль `printer` из `src.utils` для печати результатов.

## Подключение модуля `header`
В коде импортируется модуль `header`. В предоставленном коде не показано содержимое модуля `header`. Для корректной работы модуля `deals_from_xls.py` требуется, чтобы модуль `header` был доступен и содержал необходимые определения. Отсутствие информации о модуле `header` может привести к проблемам при выполнении данного кода.

## Функции

### `DealsFromXLS`

Класс для парсинга XLS-файлов с информацией о сделках с AliExpress.

**Описание**:
Класс `DealsFromXLS` предназначен для чтения и обработки данных о сделках, представленных в формате XLS. Он позволяет итерироваться по строкам файла, извлекая информацию о каждой сделке и преобразуя ее в удобный для использования формат.

**Методы**:

- `__init__(language: str, currency: str)`: Инициализирует экземпляр класса `DealsFromXLS` с указанием языка и валюты.
- `get_next_deal()`: Возвращает следующую сделку из XLS-файла в виде словаря.

### `__init__`

```python
def __init__(language: str, currency: str):
    """Инициализирует экземпляр класса DealsFromXLS.

    Args:
        language (str): Язык, используемый в XLS-файле.
        currency (str): Валюта, используемая в XLS-файле.
    """
    ...
```

### `get_next_deal`

```python
def get_next_deal() -> dict | None:
    """Извлекает информацию о следующей сделке из XLS-файла.

    Returns:
        dict | None: Словарь, содержащий информацию о сделке, или None, если сделок больше нет.
    """
    ...
```

### `pprint`

```python
from src.utils.printer import pprint
```

**Описание**:
Функция `pprint` используется для "красивой" печати данных о сделках в консоль.

**Параметры**:

- `print_data` (Any): Данные для печати. Может быть словарем, списком или строкой.
- `text_color` (str): Цвет текста при печати.
- `bg_color` (str): Цвет фона при печати.
- `font_style` (str): Стиль шрифта при печати.

**Примеры**:

```python
from src.utils.printer import pprint

deal_data = {"товар": "Example", "цена": 100}
pprint(deal_data, text_color="green")
```

### Основной цикл

В основной части кода создается экземпляр класса `DealsFromXLS` и итерируется по сделкам, извлекая и печатая информацию о каждой сделке с использованием функции `pprint`.

```python
deals_parser = DealsFromXLS(language='EN', currency='USD')

for deal in deals_parser.get_next_deal():
    pprint(deal)
    ...