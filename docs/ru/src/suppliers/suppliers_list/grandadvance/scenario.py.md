# Модуль `scenario.py`

## Обзор

Модуль `scenario.py` предназначен для сбора данных о товарах со страниц категорий поставщика Grandadvance с использованием веб-драйвера. Он содержит функции для получения списка категорий с сайта и списка товаров в каждой категории, а также управляет процессом обработки страниц товаров.

## Подробней

Этот модуль является частью системы обработки данных от поставщиков и предназначен для автоматического сбора информации о товарах. Он выполняет следующие основные задачи:

1.  **Сбор списка категорий** (`get_list_categories_from_site`): Получает список категорий товаров с сайта поставщика.
2.  **Сбор списка товаров в категории** (`get_list_products_in_category`): Получает список URL товаров, представленных на странице категории.
3.  **Обработка страниц товаров** (`grab_product_page`): Передает URL товара в функцию `grab_product_page()`, которая обрабатывает информацию о товаре и передает её классу `Product` для дальнейшей обработки.

## Функции

### `get_list_products_in_category`

```python
def get_list_products_in_category (s) -> list[str, str, None]:
    """ Returns list of products urls from category page
    Если надо пролистстать - страницы категорий - листаю ??????

    Attrs:
        s - Supplier
    @returns
        list or one of products urls or None
    """
    ...
```

**Назначение**: Функция извлекает список URL товаров со страницы категории.

**Параметры**:

*   `s` (Supplier): Объект поставщика, содержащий информацию о текущем поставщике и настройки веб-драйвера.

**Возвращает**:

*   `list[str, str, None]`: Список URL товаров на странице категории. Может возвращать `None`, если список товаров не найден.

**Как работает функция**:

1.  Извлекает объект веб-драйвера из объекта поставщика `s`.
2.  Извлекает локаторы элементов страницы категории из `s.locators['category']`.
3.  Вызывает `d.execute_locator()` для закрытия всплывающих баннеров, используя локаторы из `s.locators['product']['close_banner']`.
4.  Проверяет, что локаторы элементов категории не пусты. В случае, если локаторы не найдены, функция записывает ошибку в лог с помощью `logger.error` и возвращает `None`.
5.  Выполняет скроллинг страницы с помощью `d.scroll()`.
6.  Извлекает список ссылок на товары, используя локаторы `l['product_links']` и функцию `d.execute_locator()`.
7.  Проверяет, что список ссылок на товары не пуст. В случае, если ссылки не найдены, функция записывает предупреждение в лог с помощью `logger.warning` и возвращает `None`.
8.  Преобразует одиночную ссылку в список, если `list_products_in_category` является строкой.
9.  Записывает в лог количество найденных товаров с помощью `logger.info`.
10. Возвращает список URL товаров.

**Примеры**:

Пример вызова функции:

```python
from src.suppliers.suppliers_list.grandadvance.scenario import get_list_products_in_category
from src.suppliers.supplier import Supplier
from src.webdriver import Driver, Chrome

# Создание инстанса класса Supplier (требуется настроить параметры)
#driver = Driver(Chrome)
#supplier = Supplier(driver = driver, url='https://grandadvance.co.il/....')  # необходимо указать url категории

# Получение списка товаров
#products = get_list_products_in_category(supplier)

#if products:
#    for product_url in products:
#        print(product_url)
#else:
#    print("Товары не найдены")
```

### `get_list_categories_from_site`

```python
def get_list_categories_from_site(s):
    ...
```

**Назначение**: Функция извлекает список категорий товаров с сайта.

**Параметры**:

*   `s` (Supplier): Объект поставщика.

**Возвращает**:

*   `list[str]`: Список URL категорий товаров.

**Как работает функция**:

Описание отсутствует.