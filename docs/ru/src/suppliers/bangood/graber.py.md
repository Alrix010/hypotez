# Модуль для сбора данных с bangood.com

## Обзор

Модуль `src.suppliers.bangood.graber` предназначен для сбора данных о товарах с сайта [bangood.com](bangood.com). Он содержит класс `Graber`, который наследует функциональность класса `Graber` из модуля `src.suppliers.graber`. Основной задачей является извлечение и обработка информации о товарах, представленных на страницах bangood.com, с возможностью переопределения стандартных методов обработки полей для нестандартных ситуаций.

## Подробней

Этот модуль является частью системы для сбора и обработки данных о товарах из различных интернет-магазинов. Он специализируется на сайте bangood.com, используя веб-драйвер для навигации по страницам и извлечения данных. Важной особенностью является возможность предварительной обработки страницы перед извлечением данных с использованием декораторов, что позволяет, например, закрывать всплывающие окна.

## Классы

### `Graber`

**Описание**: Класс `Graber` предназначен для сбора информации о товарах с сайта bangood.com. Он наследует функциональность от базового класса `Graber` (`Grbr`) из модуля `src.suppliers.graber`, расширяя её для специфических нужд bangood.

**Наследует**:

-   `Graber` (`Grbr`) из модуля `src.suppliers.graber`.

**Атрибуты**:

-   `supplier_prefix` (str): Префикс поставщика, установлен в `'bangood'`. Используется для идентификации поставщика в системе.

**Методы**:

-   `__init__(driver: Driver, lang_index: int)`: Инициализирует экземпляр класса `Graber`, устанавливает префикс поставщика и вызывает конструктор родительского класса.

    **Принцип работы**:

    -   Устанавливает атрибут `supplier_prefix` в значение `'bangood'`.
    -   Вызывает метод `__init__` родительского класса `Graber` (`Grbr`) с указанием префикса поставщика, драйвера и индекса языка.
    -   Инициализирует `Context.locator_for_decorator` значением `None`. Если установить значение, оно будет выполнено в декораторе `@close_pop_up`.

### `close_pop_up`

```python
def close_pop_up(value: Any = None) -> Callable:
    """Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

    Args:
        value (Any): Дополнительное значение для декоратора.

    Returns:
        Callable: Декоратор, оборачивающий функцию.
    """
    def decorator(func: Callable) -> Callable:
        """Оборачивает функцию декоратором.

        Args:
            func (Callable): Функция для оборачивания.

        Returns:
            Callable: Обернутая функция.
        """
        @wraps(func)
        async def wrapper(*args, **kwargs):
            """Оборачивает функцию, выполняя предварительные действия до и после вызова основной функции.

            Args:
                *args: Позиционные аргументы функции.
                **kwargs: Ключевые аргументы функции.

            Returns:
                Any: Результат выполнения обернутой функции.

            Raises:
                ExecuteLocatorException: Если возникает ошибка при выполнении локатора.
            """
            try:
                # await Context.driver.execute_locator(Context.locator.close_pop_up)  # Await async pop-up close
                ...
            except ExecuteLocatorException as ex:
                logger.debug(f'Ошибка выполнения локатора: {ex}')
            return await func(*args, **kwargs)  # Await the main function
        return wrapper
    return decorator
```

**Назначение**: Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

**Параметры**:

-   `value` (Any, optional): Дополнительное значение для декоратора. По умолчанию `None`.

**Возвращает**:

-   `Callable`: Декоратор, оборачивающий функцию.

**Как работает функция**:

1.  Определяет внутреннюю функцию `decorator`, которая принимает функцию `func` в качестве аргумента и возвращает обертку `wrapper` для этой функции.
2.  Внутри `wrapper` используется блок `try...except` для обработки возможных исключений при выполнении локатора закрытия всплывающих окон.
3.  В случае возникновения исключения `ExecuteLocatorException`, информация об ошибке логируется с использованием `logger.debug`.
4.  Основная функция `func` вызывается с использованием `await`, и её результат возвращается.

**Внутренние функции**:

-   `decorator(func: Callable) -> Callable`: Функция-декоратор, оборачивающая переданную функцию `func`.
-   `wrapper(*args, **kwargs)`: Функция-обертка, выполняющая предварительные действия (закрытие всплывающих окон) перед вызовом основной функции.

## Методы класса

### `__init__(driver: Driver, lang_index: int)`

```python
def __init__(self, driver: Driver, lang_index: int):
    """Инициализация класса сбора полей товара.

    Args:
        driver (Driver): Драйвер веб-браузера для взаимодействия с сайтом.
        lang_index (int): Индекс языка для выбора локализации контента.
    """
    self.supplier_prefix = 'bangood'
    super().__init__(supplier_prefix=self.supplier_prefix, driver=driver, lang_index=lang_index)
    # Устанавливаем глобальные настройки через Context

    Context.locator_for_decorator = None # <- если будет уастановлено значение - то оно выполнится в декораторе `@close_pop_up`
```

**Назначение**: Инициализирует экземпляр класса `Graber` для сбора данных о товарах с сайта bangood.com.

**Параметры**:

-   `driver` (Driver): Драйвер веб-браузера для взаимодействия с сайтом.
-   `lang_index` (int): Индекс языка для выбора локализации контента.

**Как работает функция**:

1.  Устанавливает атрибут `supplier_prefix` в значение `'bangood'`, что идентифицирует данного грабера как специализирующегося на bangood.
2.  Вызывает конструктор родительского класса (`super().__init__(...)`), передавая необходимые параметры для инициализации базовой функциональности грабера.
3.  Устанавливает `Context.locator_for_decorator = None`, что позволяет при необходимости выполнить декоратор `@close_pop_up`.

**Примеры**:

```python
from src.webdriver.driver import Driver, Chrome
from src.suppliers.bangood.graber import Graber

# Пример создания экземпляра класса Graber
driver = Driver(Chrome)
lang_index = 0
graber = Graber(driver, lang_index)
```

## Параметры класса

-   `supplier_prefix` (str): Префикс поставщика, который всегда равен `'bangood'` для данного класса. Используется для идентификации поставщика в системе.
-   `driver` (Driver): Драйвер веб-браузера, используемый для взаимодействия с сайтом bangood.com.
-   `lang_index` (int): Индекс языка, используемый для выбора локализации контента на сайте bangood.com.