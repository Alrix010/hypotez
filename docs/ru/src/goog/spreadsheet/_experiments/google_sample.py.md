# src.goog.spreadsheet._experiments.google_sample

## Обзор

Модуль предоставляет пример работы с Google Sheets API через протокол `oauth2`. Он демонстрирует, как получить доступ к данным из Google Sheets, используя учетные данные пользователя.

## Подробней

Этот модуль содержит пример кода для взаимодействия с Google Sheets API. Он использует библиотеку `google-api-python-client` для установления соединения и выполнения запросов к Google Sheets. Для аутентификации используется протокол `oauth2`, который позволяет приложению получать доступ к данным пользователя с его разрешения.

## Классы

В данном модуле классы отсутствуют.

## Функции

### `main`

```python
def main():
    """
    Демонстрирует базовое использование Sheets API.
    Выводит значения из примера таблицы.
    """
```

**Назначение**: Функция `main` демонстрирует основной способ использования Google Sheets API. Она выполняет аутентификацию, получает данные из указанной таблицы и выводит их в консоль.

**Как работает функция**:

1.  **Аутентификация**:
    *   Функция пытается загрузить учетные данные из файла `token.json`, если он существует.
    *   Если файл не найден или учетные данные недействительны, происходит попытка обновления токена или запускается процесс аутентификации через `InstalledAppFlow`.
    *   Полученные учетные данные сохраняются в файл `token.json` для последующего использования.
2.  **Получение данных**:
    *   После успешной аутентификации создается экземпляр сервиса `sheets` с использованием полученных учетных данных.
    *   Вызывается метод `get` для получения данных из таблицы с указанным `spreadsheetId` и `range`.
    *   Полученные значения извлекаются из результата запроса.
3.  **Вывод данных**:
    *   Если данные не найдены, выводится сообщение "No data found.".
    *   Иначе, для каждой строки данных выводятся значения из первого и пятого столбцов (индексы 0 и 4).
4.  **Обработка ошибок**:
    *   Если в процессе выполнения возникает ошибка `HttpError`, информация об ошибке выводится в консоль.

**Примеры**:

```python
# Пример запуска функции main
main()
```
В данном примере функция `main` вызывается для демонстрации работы с Google Sheets API. В результате выполнения кода в консоль будут выведены значения из указанной таблицы Google Sheets.

```
Name, Major:
Anna, инженер
Petya, магестр
```

**Внутренние функции**:

Внутри функции `main` нет внутренних функций.