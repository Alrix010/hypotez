# Модуль `misc.py`

## Обзор

Модуль содержит различные вспомогательные функции, используемые в проекте `hypotez`.
Он включает функции для получения имени сущности, создания хешей, а также генерации и сброса уникальных идентификаторов.

## Подробней

Этот модуль предоставляет набор утилит, которые упрощают выполнение общих задач в проекте `hypotez`. Функции модуля обеспечивают обработку имен, создание уникальных идентификаторов и хеширование объектов.

## Функции

### `name_or_empty`

```python
def name_or_empty(named_entity: AgentOrWorld) -> str:
    """
    Возвращает имя указанного агента или среды, или пустую строку, если агент равен None.

    Args:
        named_entity (AgentOrWorld): Агент или среда, имя которой нужно получить.

    Returns:
        str: Имя агента или среды, или пустая строка, если агент равен None.
    """
    ...
```

**Назначение**: Функция `name_or_empty` принимает объект `named_entity` типа `AgentOrWorld` и возвращает его имя, если объект не `None`. Если объект `None`, функция возвращает пустую строку.

**Параметры**:
- `named_entity` (`AgentOrWorld`): Объект, имя которого нужно получить. Тип `AgentOrWorld` является объединением типов `TinyPerson` и `TinyWorld`.

**Возвращает**:
- `str`: Имя объекта или пустая строка.

**Как работает функция**:
1. Проверяет, является ли `named_entity` равным `None`.
2. Если `named_entity` равен `None`, возвращает пустую строку.
3. В противном случае возвращает атрибут `name` объекта `named_entity`.

**Примеры**:

```python
from typing import Union
class TinyPerson:
    name:str = 'PersonName'

class TinyWorld:
    name:str = 'WorldName'

AgentOrWorld = Union[TinyPerson, TinyWorld]
person: AgentOrWorld = TinyPerson()
world: AgentOrWorld = TinyWorld()
print(name_or_empty(person))  # Вывод: PersonName
print(name_or_empty(world))  # Вывод: WorldName
print(name_or_empty(None))  # Вывод: 
```

### `custom_hash`

```python
def custom_hash(obj) -> str:
    """
    Возвращает хеш для указанного объекта. Объект сначала преобразуется в строку,
    чтобы сделать его хешируемым. Этот метод является детерминированным,
    в отличие от встроенной функции hash().
    """
    ...
```

**Назначение**: Функция `custom_hash` принимает объект любого типа и возвращает его SHA-256 хеш в виде шестнадцатеричной строки. В отличие от встроенной функции `hash()`, эта функция является детерминированной, то есть всегда возвращает один и тот же хеш для одного и того же объекта.

**Параметры**:
- `obj`: Объект, для которого нужно вычислить хеш.

**Возвращает**:
- `str`: SHA-256 хеш объекта в виде шестнадцатеричной строки.

**Как работает функция**:
1. Преобразует входной объект в строку с помощью `str(obj)`.
2. Кодирует строку в байты с использованием кодировки UTF-8 (`.encode()`).
3. Вычисляет SHA-256 хеш байтовой строки с помощью `hashlib.sha256()`.
4. Преобразует хеш в шестнадцатеричную строку с помощью `.hexdigest()`.
5. Возвращает полученную шестнадцатеричную строку.

**Примеры**:

```python
print(custom_hash("hello"))  # Вывод: 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824
print(custom_hash(123))    # Вывод: a665a45920422f9d417e4867efdc4fb8a04a1f3fff219ca898a1c64873624a5b
print(custom_hash([1, 2, 3])) # Вывод: baa73940214cc89d3445447945e98e4079ff39d23953c2b307c67b889f9413b0
```

### `fresh_id`

```python
def fresh_id() -> int:
    """
    Возвращает новый ID для нового объекта. Это полезно для создания уникальных ID для объектов.
    """
    ...
```

**Назначение**: Функция `fresh_id` возвращает уникальный идентификатор (ID) для нового объекта. Она использует глобальный счетчик `_fresh_id_counter`, который увеличивается при каждом вызове функции.

**Возвращает**:
- `int`: Уникальный идентификатор.

**Как работает функция**:
1. Объявляет `_fresh_id_counter` как глобальную переменную, чтобы можно было изменять ее значение.
2. Увеличивает значение `_fresh_id_counter` на 1.
3. Возвращает новое значение `_fresh_id_counter`.

**Примеры**:

```python
print(fresh_id())  # Вывод: 1
print(fresh_id())  # Вывод: 2
print(fresh_id())  # Вывод: 3
```

### `reset_fresh_id`

```python
def reset_fresh_id():
    """
    Сбрасывает счетчик новых ID. Это полезно для целей тестирования.
    """
    ...
```

**Назначение**: Функция `reset_fresh_id` сбрасывает глобальный счетчик `_fresh_id_counter` в 0. Это полезно для целей тестирования, чтобы обеспечить предсказуемые значения идентификаторов.

**Как работает функция**:
1. Объявляет `_fresh_id_counter` как глобальную переменную, чтобы можно было изменять ее значение.
2. Устанавливает значение `_fresh_id_counter` равным 0.

**Примеры**:

```python
print(fresh_id())  # Вывод: 1
print(fresh_id())  # Вывод: 2
reset_fresh_id()
print(fresh_id())  # Вывод: 1