# Модуль тестирования базовых сценариев для Tiny Troupe
## Обзор
Модуль `test_basic_scenarios.py` содержит набор тестов для проверки основных сценариев использования библиотеки Tiny Troupe, предназначенной для моделирования поведения агентов в виртуальной среде. В частности, проверяется запуск и остановка симуляций, определение атрибутов агентов, взаимодействие агентов и использование инструментов.

## Подробнее
Модуль включает тесты для проверки жизненного цикла симуляции, от её инициализации до завершения, а также для проверки взаимодействия агентов с окружением и использования инструментов для выполнения задач. Он демонстрирует основные возможности библиотеки Tiny Troupe и служит примером для создания более сложных сценариев.
Расположен в `hypotez/src/endpoints/tiny_troupe/tests/scenarios/test_basic_scenarios.py`.

## Функции

### `test_basic_scenario_1`
```python
def test_basic_scenario_1():
    """
    Тестирует базовый сценарий симуляции с одним агентом.

    Args:
        None

    Returns:
        None

    Raises:
        AssertionError: Если состояние симуляции не соответствует ожидаемому.

    Example:
        >>> test_basic_scenario_1()
    """
```
**Как работает функция**:

1.  **Сброс состояния симуляции**: Начинается с вызова `control.reset()`, чтобы убедиться, что нет активных симуляций.
2.  **Проверка начального состояния**: Утверждается, что `control._current_simulations["default"]` имеет значение `None`, что указывает на отсутствие запущенной симуляции.
3.  **Запуск симуляции**: Вызывается `control.begin()` для запуска симуляции.
4.  **Проверка состояния после запуска**: Утверждается, что статус симуляции `control._current_simulations["default"].status` равен `Simulation.STATUS_STARTED`, что подтверждает успешный запуск.
5.  **Создание агента**: Создается агент `create_oscar_the_architect()`.
6.  **Определение атрибутов агента**: Агенту задаются атрибуты `age` и `nationality` с использованием метода `agent.define()`.
7.  **Проверка кэшированных данных**: Утверждается, что существуют кэшированные данные трассировки `control._current_simulations["default"].cached_trace` и трассировка выполнения `control._current_simulations["default"].execution_trace`.
8.  **Создание чекпоинта**: Вызывается `control.checkpoint()` для сохранения состояния симуляции.
9.  **Взаимодействие агента**: Агент взаимодействует с окружением с использованием метода `agent.listen_and_act("How are you doing??")`.
10. **Определение дополнительного атрибута агента**: Агенту задается атрибут `occupation`.
11. **Создание чекпоинта**: Вызывается `control.checkpoint()` для сохранения состояния симуляции.
12. **Завершение симуляции**: Вызывается `control.end()` для завершения симуляции.

```
Сброс симуляции
     │
     ├─> Проверка отсутствия активных симуляций
     │
     ├─> Запуск симуляции
     │
     ├─> Проверка статуса симуляции
     │
     ├─> Создание агента
     │
     ├─> Определение атрибутов агента
     │
     ├─> Проверка наличия кэшированных данных трассировки
     │
     ├─> Создание чекпоинта
     │
     ├─> Взаимодействие агента с окружением
     │
     ├─> Определение атрибута агента
     │
     ├─> Создание чекпоинта
     │
     └─> Завершение симуляции
```
### `test_tool_usage_1`
```python
def test_tool_usage_1():
    """
    Тестирует использование инструментов агентом для выполнения задач.

    Args:
        None

    Returns:
        None

    Raises:
        AssertionError: Если действие не содержит ожидаемый тип или файл не был создан.

    Example:
        >>> test_tool_usage_1()
    """
```
**Как работает функция**:

1.  **Определение папки для экспорта данных**: Создается переменная `data_export_folder`, содержащая путь к папке для экспорта данных.
2.  **Инициализация экспортера артефактов**: Создается экземпляр класса `ArtifactExporter` с указанием базовой папки для вывода.
3.  **Инициализация обогатителя**: Создается экземпляр класса `TinyEnricher`.
4.  **Инициализация факультета использования инструментов**: Создается экземпляр класса `TinyToolUse` с инструментом `TinyWordProcessor`, которому передаются экземпляры `ArtifactExporter` и `TinyEnricher`.
5.  **Создание агента**: Создается агент `lisa` с использованием функции `create_lisa_the_data_scientist()`.
6.  **Добавление факультета инструментов агенту**: Агенту добавляется факультет использования инструментов `tooluse_faculty`.
7.  **Взаимодействие агента с окружением**: Агент взаимодействует с окружением с использованием метода `lisa.listen_and_act()`, которому передается инструкция о поиске новой работы и написании резюме. Возвращаемые действия сохраняются в переменной `actions`.
8.  **Проверка типа действия**: Утверждается, что в списке действий `actions` содержится действие типа `WRITE_DOCUMENT`.
9.  **Проверка создания файлов**: Утверждается, что файлы резюме были созданы в различных форматах (`.docx`, `.json`, `.md`) в указанной папке для экспорта данных.

```
Определение папки для экспорта данных
     │
     ├─> Инициализация экспортера артефактов
     │
     ├─> Инициализация обогатителя
     │
     ├─> Инициализация факультета использования инструментов
     │
     ├─> Создание агента
     │
     ├─> Добавление факультета инструментов агенту
     │
     ├─> Взаимодействие агента с окружением
     │
     ├─> Проверка типа действия
     │
     └─> Проверка создания файлов