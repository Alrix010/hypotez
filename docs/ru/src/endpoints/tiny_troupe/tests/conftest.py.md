# Модуль для настройки и управления тестовыми опциями pytest
=========================================================

Модуль содержит функции для добавления и обработки опций командной строки pytest, которые позволяют управлять поведением тестов, таких как обновление кэша API, использование кэша и запуск примеров.

Пример использования
----------------------

```python
pytest --refresh_cache --use_cache --test_examples
```

## Обзор

Этот модуль предоставляет механизмы для управления параметрами тестирования, такими как обновление и использование кэша API, а также запуск примеров тестов. Он использует `pytest_addoption` для добавления опций командной строки и `pytest_generate_tests` для обработки этих опций и отображения информации о конфигурации теста.

## Подробнее

Этот код предназначен для настройки параметров тестирования в pytest. Он позволяет пользователям указывать, следует ли обновлять кэш API, использовать кэш API или запускать примеры тестов. Эти параметры могут быть полезны для управления временем выполнения тестов и обеспечения использования актуальных данных.

## Функции

### `pytest_addoption`

```python
def pytest_addoption(parser):
    """Добавляет опции командной строки для управления поведением тестов.

    Args:
        parser: Объект парсера опций pytest.

    Returns:
        None

    Raises:
        None
    """
    ...
```

**Назначение**: Добавляет опции командной строки для управления поведением тестов, такие как обновление кэша, использование кэша и запуск примеров.

**Параметры**:
- `parser`: Объект парсера опций pytest, который используется для добавления опций командной строки.

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют.

**Как работает функция**:
1. Функция `pytest_addoption` принимает объект парсера опций `parser` в качестве аргумента.
2. Она добавляет три опции командной строки:
    - `--refresh_cache`: Если указано, кэш API будет обновлен перед запуском тестов.
    - `--use_cache`: Если указано, тесты будут использовать кэш API, чтобы сократить количество вызовов API.
    - `--test_examples`: Если указано, все примеры будут перезапущены, чтобы убедиться, что они все еще работают.
3. Добавленные опции позволяют пользователю управлять поведением тестов через командную строку pytest.

**ASCII flowchart**:
```
A[Получение объекта парсера опций pytest]
|
B[Добавление опции --refresh_cache]
|
C[Добавление опции --use_cache]
|
D[Добавление опции --test_examples]
```

**Примеры**:

Запуск тестов с обновлением кэша API:
```bash
pytest --refresh_cache
```

Запуск тестов с использованием кэша API:
```bash
pytest --use_cache
```

Запуск тестов с перезапуском всех примеров:
```bash
pytest --test_examples
```

Запуск тестов с обновлением кэша API и перезапуском всех примеров:
```bash
pytest --refresh_cache --test_examples
```

### `pytest_generate_tests`

```python
def pytest_generate_tests(metafunc):
    """Обрабатывает опции командной строки и отображает информацию о конфигурации теста.

    Args:
        metafunc: Объект metafunc pytest, содержащий информацию о тесте.

    Returns:
        None

    Raises:
        None
    """
    ...
```

**Назначение**: Обрабатывает опции командной строки, полученные от пользователя, и устанавливает глобальные переменные, которые контролируют поведение тестов. Также выводит информацию о конфигурации теста для пользователя.

**Параметры**:
- `metafunc`: Объект metafunc pytest, содержащий информацию о тесте.

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют.

**Как работает функция**:
1. Функция `pytest_generate_tests` принимает объект `metafunc` pytest в качестве аргумента. Этот объект содержит информацию о тесте, который будет запущен.
2. Функция получает значения опций командной строки `--refresh_cache`, `--use_cache` и `--test_examples` с использованием `metafunc.config.getoption()`.
3. Полученные значения присваиваются глобальным переменным `refresh_cache`, `use_cache` и `test_examples`.
4. Функция извлекает имя тестового случая из `metafunc.function.__name__`.
5. Функция выводит информацию о конфигурации теста, включая имя тестового случая и значения опций `--refresh_cache`, `--use_cache` и `--test_examples`.

**ASCII flowchart**:
```
A[Получение объекта metafunc pytest]
|
B[Получение значения опции --refresh_cache из metafunc.config]
|
C[Получение значения опции --use_cache из metafunc.config]
|
D[Получение значения опции --test_examples из metafunc.config]
|
E[Присвоение значений глобальным переменным refresh_cache, use_cache и test_examples]
|
F[Извлечение имени тестового случая из metafunc.function.__name__]
|
G[Вывод информации о конфигурации теста]
```

**Примеры**:

Запуск тестов с опциями командной строки:
```bash
pytest --refresh_cache --use_cache --test_examples
```

Вывод информации о конфигурации теста:
```
Test case: test_example
  - refresh_cache: True
  - use_cache: True
  - test_examples: True