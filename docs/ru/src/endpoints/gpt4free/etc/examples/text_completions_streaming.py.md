# Модуль для демонстрации потоковой передачи текста с использованием g4f

## Обзор

Этот модуль демонстрирует, как использовать потоковую передачу текста с использованием библиотеки `g4f` как в синхронном, так и в асинхронном режимах. Он отправляет вопрос к модели `gpt-4` и выводит полученные ответы в режиме реального времени.

## Подробней

Модуль предназначен для демонстрации возможностей потоковой передачи библиотеки `g4f`. Он создает клиентов (`Client` и `AsyncClient`) для взаимодействия с моделью `gpt-4` и выводит результаты в консоль по мере их поступления. Это может быть полезно для задач, требующих немедленного отображения частичных результатов, таких как чат-боты или системы автоматического ответа.

## Функции

### `sync_stream`

```python
def sync_stream():
    """
    Отправляет вопрос к модели gpt-4 и выводит потоковый ответ синхронно.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Если происходит ошибка во время выполнения запроса.
    """
```

**Как работает функция**:

1. **Создание клиента**: Создается экземпляр класса `Client` для синхронного взаимодействия с API.
2. **Создание потока**: Вызывается метод `chat.completions.create` для создания потока ответов от модели `gpt-4`. Параметру `stream` присваивается значение `True`, что указывает на необходимость потоковой передачи.
3. **Обработка потока**: В цикле перебираются чанки (фрагменты) ответа, полученные из потока.
4. **Вывод чанков**: Если в чанке присутствует содержимое (`chunk.choices[0].delta.content`), оно выводится в консоль без добавления новой строки (`end=""`), что позволяет отображать ответ в режиме реального времени.

ASCII flowchart:

```
Создание клиента
    ↓
Создание потока запроса к gpt-4
    ↓
Начало цикла по чанкам из потока
    ↓
Проверка наличия содержимого в чанке
    ↓
Вывод содержимого в консоль
    ↓
Конец цикла
```

**Примеры**:

```python
sync_stream()
```

### `async_stream`

```python
async def async_stream():
    """
    Отправляет вопрос к модели gpt-4 и выводит потоковый ответ асинхронно.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Если происходит ошибка во время выполнения запроса.
    """
```

**Как работает функция**:

1. **Создание асинхронного клиента**: Создается экземпляр класса `AsyncClient` для асинхронного взаимодействия с API.
2. **Создание асинхронного потока**: Вызывается метод `chat.completions.create` для создания потока ответов от модели `gpt-4`. Параметру `stream` присваивается значение `True`, что указывает на необходимость потоковой передачи.
3. **Обработка асинхронного потока**: В асинхронном цикле перебираются чанки (фрагменты) ответа, полученные из потока.
4. **Вывод чанков**: Если в чанке присутствует содержимое (`chunk.choices[0].delta.content`), оно выводится в консоль без добавления новой строки (`end=""`), что позволяет отображать ответ в режиме реального времени.

ASCII flowchart:

```
Создание асинхронного клиента
    ↓
Создание асинхронного потока запроса к gpt-4
    ↓
Начало асинхронного цикла по чанкам из потока
    ↓
Проверка наличия содержимого в чанке
    ↓
Вывод содержимого в консоль
    ↓
Конец цикла
```

**Примеры**:

```python
asyncio.run(async_stream())
```

### `main`

```python
def main():
    """
    Выполняет синхронный и асинхронный потоки и выводит результаты.

    Args:
        None

    Returns:
        None

    Raises:
        Exception: Если происходит ошибка во время выполнения любого из потоков.
    """
```

**Как работает функция**:

1. **Вывод заголовка синхронного потока**: Выводит в консоль строку "Synchronous Stream:".
2. **Запуск синхронного потока**: Вызывает функцию `sync_stream()` для запуска синхронного потока и вывода результатов.
3. **Вывод разделителя**: Выводит в консоль две новые строки (`\\n\\n`) для разделения результатов синхронного и асинхронного потоков.
4. **Вывод заголовка асинхронного потока**: Выводит в консоль строку "Asynchronous Stream:".
5. **Запуск асинхронного потока**: Использует `asyncio.run()` для запуска асинхронной функции `async_stream()` и вывода результатов.

ASCII flowchart:

```
Вывод заголовка "Synchronous Stream:"
    ↓
Запуск sync_stream()
    ↓
Вывод разделителя "\n\n"
    ↓
Вывод заголовка "Asynchronous Stream:"
    ↓
Запуск asyncio.run(async_stream())
```

**Примеры**:

```python
main()