# Модуль для генерации таблиц в Markdown для документации провайдеров и моделей g4f

## Обзор

Модуль предназначен для автоматического создания Markdown-таблиц, содержащих информацию о различных провайдерах и моделях, используемых в библиотеке `g4f` (gpt4free). Он включает функции для проверки работоспособности провайдеров, извлечения информации о моделях, поддерживаемых каждым провайдером, и форматирования этих данных в виде таблиц Markdown.

## Подробнее

Модуль предоставляет функции для асинхронной проверки провайдеров, формирования таблиц с информацией о провайдерах (включая поддержку потоковой передачи, системных сообщений и истории сообщений), а также для создания таблиц с перечислением моделей и базовых провайдеров. Код активно использует асинхронность для повышения производительности при проверке большого количества провайдеров.

Основная цель этого модуля - упростить процесс документирования и поддержания актуальной информации о доступных провайдерах и моделях в библиотеке `g4f`. Сгенерированные таблицы предназначены для включения в документацию проекта.

## Функции

### `test_async`

```python
async def test_async(provider: ProviderType) -> bool:
    """Асинхронно проверяет работоспособность провайдера.

    Args:
        provider (ProviderType): Провайдер для проверки.

    Returns:
        bool: `True`, если провайдер работает, `False` в противном случае.
    """
```

**Назначение**: Асинхронная проверка работоспособности указанного провайдера.

**Параметры**:
- `provider` (ProviderType): Провайдер, который требуется проверить.

**Возвращает**:
- `bool`: Возвращает `True`, если провайдер отвечает и работает корректно, иначе `False`.

**Как работает функция**:
Функция принимает объект провайдера и пытается выполнить запрос к нему с использованием `ChatCompletion.create_async`. Если провайдер отвечает в течение заданного времени (30 секунд), функция возвращает `True`. В случае возникновения исключения, функция логирует ошибку и возвращает `False`.

**Примеры**:

```python
import asyncio
from g4f.providers import ChatgptAi
import pytest

@pytest.mark.asyncio
async def test_chatgptai():
    # Создание инстанса драйвера (пример с Chrome)
    assert await test_async(ChatgptAi) == True
```

### `test_async_list`

```python
def test_async_list(providers: list[ProviderType]) -> list:
    """Асинхронно проверяет список провайдеров.

    Args:
        providers (list[ProviderType]): Список провайдеров для проверки.

    Returns:
        list: Список результатов проверки для каждого провайдера.
    """
```

**Назначение**: Асинхронно проверяет список предоставленных провайдеров, используя функцию `test_async`.

**Параметры**:
- `providers` (list[ProviderType]): Список провайдеров, которые необходимо проверить.

**Возвращает**:
- `list`: Список булевых значений, где каждый элемент соответствует результату проверки соответствующего провайдера.

**Как работает функция**:
Функция принимает список провайдеров, итерируется по нему, вызывая `test_async` для каждого провайдера. Результаты выполнения `test_async` собираются в список и возвращаются.

**Примеры**:

```python
import asyncio
from g4f.providers import ChatgptAi, GptGo
import pytest

@pytest.mark.asyncio
async def test_chatgptai_gptgo():
    # Создание инстанса драйвера (пример с Chrome)
    assert await test_async_list([ChatgptAi, GptGo]) == [True, True]
```

### `print_providers`

```python
def print_providers() -> list:
    """Генерирует Markdown-таблицу с информацией о провайдерах.

    Returns:
        list: Список строк, представляющих Markdown-таблицу.
    """
```

**Назначение**: Формирует Markdown-таблицу, содержащую информацию о доступных провайдерах, их статусе, поддержке различных функций (например, потоковой передачи, системных сообщений) и моделях.

**Возвращает**:
- `list`: Список строк, представляющих Markdown-таблицу.

**Как работает функция**:
Функция выполняет следующие шаги:

1.  Фильтрует список провайдеров, оставляя только те, у которых атрибут `working` установлен в `True`.
2.  Асинхронно проверяет работоспособность каждого провайдера из отфильтрованного списка с использованием функции `test_async_list`.
3.  Формирует заголовки для двух типов провайдеров: "Free" (бесплатные) и "Auth" (требующие аутентификацию).
4.  Итерируется по списку провайдеров и генерирует строки Markdown для каждого провайдера, включая:
    *   Название провайдера.
    *   Ссылки на веб-сайт провайдера (если доступны).
    *   Статус провайдера (активный или неактивный).
    *   Поддержку аутентификации, потоковой передачи, системных сообщений и истории сообщений.
    *   Список поддерживаемых моделей (если провайдер реализует `ProviderModelMixin`).

**Примеры**:

```python
# Пример вызова функции
lines = print_providers()
for line in lines:
    print(line)
```

### `print_models`

```python
def print_models() -> list:
    """Генерирует Markdown-таблицу с информацией о моделях.

    Returns:
        list: Список строк, представляющих Markdown-таблицу.
    """
```

**Назначение**: Создает Markdown-таблицу, отображающую информацию о моделях, базовых провайдерах, провайдерах и веб-сайтах.

**Возвращает**:
- `list`: Список строк, представляющих Markdown-таблицу.

**Как работает функция**:
Функция выполняет следующие шаги:

1.  Определяет соответствия между именами базовых провайдеров и их полными названиями, а также URL-адреса провайдеров.
2.  Создает заголовки таблицы Markdown.
3.  Итерируется по списку моделей, определенных в `models.ModelUtils.convert`.
4.  Для каждой модели извлекает информацию о базовом провайдере, лучшем провайдере и формирует URL-адрес веб-сайта провайдера.
5.  Формирует строку Markdown с информацией о модели и добавляет ее в список строк.

**Примеры**:

```python
# Пример вызова функции
lines = print_models()
for line in lines:
    print(line)
```

### `print_image_models`

```python
def print_image_models() -> list:
    """Генерирует Markdown-таблицу с информацией о моделях для генерации изображений.

    Returns:
        list: Список строк, представляющих Markdown-таблицу.
    """
```

**Назначение**: Создает Markdown-таблицу с информацией о провайдерах, поддерживающих генерацию изображений, и соответствующих моделях.

**Возвращает**:
- `list`: Список строк, представляющих Markdown-таблицу.

**Как работает функция**:
Функция выполняет следующие шаги:

1.  Создает заголовки таблицы Markdown.
2.  Фильтрует список провайдеров, оставляя только те, которые работают и имеют атрибуты `image_models` или `vision_models`.
3.  Итерируется по отфильтрованному списку провайдеров и формирует строки Markdown для каждого провайдера, включая:
    *   Название провайдера.
    *   Список поддерживаемых моделей для генерации изображений.
    *   Информацию о поддержке vision models (моделей, работающих с изображениями).
    *   Ссылки на веб-сайт провайдера.

**Примеры**:

```python
# Пример вызова функции
lines = print_image_models()
for line in lines:
    print(line)