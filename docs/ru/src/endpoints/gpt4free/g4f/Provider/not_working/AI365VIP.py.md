# Модуль `AI365VIP`

## Обзор

Модуль предоставляет асинхронный доступ к API AI365VIP для генерации текста с использованием различных моделей, таких как `gpt-3.5-turbo` и `gpt-4o`. Он позволяет отправлять запросы к API и получать ответы в виде асинхронного генератора.

## Подробней

Модуль `AI365VIP` является частью проекта `hypotez` и предназначен для интеграции с API AI365VIP. Он использует библиотеку `aiohttp` для выполнения асинхронных HTTP-запросов. Модуль предоставляет класс `AI365VIP`, который наследуется от `AsyncGeneratorProvider` и `ProviderModelMixin`, что позволяет ему быть использованным в качестве провайдера для генерации текста.

## Классы

### `AI365VIP`

**Описание**: Класс для взаимодействия с API AI365VIP.

**Наследует**:
- `AsyncGeneratorProvider`: Обеспечивает асинхронную генерацию данных.
- `ProviderModelMixin`: Предоставляет функциональность для работы с моделями.

**Атрибуты**:
- `url` (str): URL API AI365VIP (`https://chat.ai365vip.com`).
- `api_endpoint` (str): Endpoint API для чата (`/api/chat`).
- `working` (bool): Указывает, работает ли провайдер (в данном случае `False`).
- `default_model` (str): Модель, используемая по умолчанию (`gpt-3.5-turbo`).
- `models` (List[str]): Список поддерживаемых моделей (`gpt-3.5-turbo`, `gpt-3.5-turbo-16k`, `gpt-4o`).
- `model_aliases` (Dict[str, str]): Псевдонимы моделей (например, `"gpt-3.5-turbo": "gpt-3.5-turbo-16k"`).

**Методы**:
- `create_async_generator`: Создает асинхронный генератор для получения ответов от API.

## Функции

### `create_async_generator`

```python
    @classmethod
    async def create_async_generator(
        cls,
        model: str,
        messages: Messages,
        proxy: str = None,
        **kwargs
    ) -> AsyncResult:
        """
        Создает асинхронный генератор для получения ответов от API AI365VIP.

        Args:
            model (str): Имя модели для использования.
            messages (Messages): Список сообщений для отправки в API.
            proxy (str, optional): URL прокси-сервера. По умолчанию `None`.
            **kwargs: Дополнительные аргументы.

        Returns:
            AsyncResult: Асинхронный генератор, выдающий части ответа от API.

        Raises:
            Exception: В случае ошибки при выполнении запроса.
        """
```

**Назначение**: Функция `create_async_generator` создает и возвращает асинхронный генератор, который отправляет сообщения к API AI365VIP и выдает чанки ответа.

**Параметры**:
- `cls`: Ссылка на класс `AI365VIP`.
- `model` (str): Имя модели, которую следует использовать для генерации ответа.
- `messages` (Messages): Список сообщений, которые отправляются в API для получения ответа.
- `proxy` (str, optional): URL прокси-сервера, если необходимо использовать прокси для подключения к API. По умолчанию `None`.
- `**kwargs`: Дополнительные параметры, которые могут быть переданы в API.

**Возвращает**:
- `AsyncResult`: Асинхронный генератор, который выдает чанки ответа от API.

**Вызывает исключения**:
- `aiohttp.ClientResponseError`: Возникает, если HTTP-ответ содержит код ошибки.

**Как работает функция**:

1.  **Определение заголовков**: Функция определяет заголовки HTTP-запроса, включая User-Agent, Content-Type и другие необходимые параметры.
2.  **Создание сессии**: Создается асинхронная сессия `aiohttp.ClientSession` с установленными заголовками.
3.  **Формирование данных**: Формируются данные для отправки в теле запроса, включая модель, сообщения, ключ и другие параметры.
4.  **Отправка запроса**: Отправляется POST-запрос к API AI365VIP с использованием асинхронной сессии и сформированных данных.
5.  **Обработка ответа**: Полученный ответ обрабатывается чанками, каждый из которых декодируется и выдается генератором.
6.  **Обработка ошибок**: В случае возникновения HTTP-ошибки вызывается исключение `response.raise_for_status()`.

```
    Определение заголовков запроса
    │
    V
    Создание асинхронной сессии aiohttp
    │
    V
    Формирование данных запроса (модель, сообщения)
    │
    V
    Отправка POST-запроса к API AI365VIP
    │
    V
    Получение ответа и обработка чанков
    │
    V
    Декодирование и выдача чанков ответа через генератор
```

**Примеры**:

```python
# Пример использования create_async_generator
messages = [{"role": "user", "content": "Привет, как дела?"}]
model = "gpt-3.5-turbo"

async def example():
    generator = await AI365VIP.create_async_generator(model=model, messages=messages)
    async for chunk in generator:
        print(chunk, end="")

# Запуск примера (необходим асинхронный контекст)
# await example()