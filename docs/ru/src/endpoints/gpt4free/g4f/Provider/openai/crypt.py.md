# Модуль crypt.py

## Обзор

Модуль `crypt.py` предоставляет функции для шифрования и дешифрования данных с использованием алгоритма AES. Он включает в себя функции для добавления отступов к данным, шифрования данных с использованием ключа и соли, удаления отступов и расшифровки данных.

## Подробнее

Модуль предназначен для обеспечения безопасности данных путем их шифрования перед передачей или хранением. Он использует комбинацию соли и ключа для создания уникального ключа шифрования для каждого сеанса, что усложняет взлом шифра.

## Функции

### `pad`

```python
def pad(data: str) -> bytes:
    """
    Добавляет отступы к входной строке данных, чтобы ее длина была кратна 16 байтам.

    Args:
        data (str): Строка для добавления отступов.

    Returns:
        bytes: Строка с добавленными отступами в виде байтов.

    Как работает функция:
    1. Преобразует входную строку `data` в байты.
    2. Вычисляет количество байтов, необходимых для дополнения, чтобы длина данных была кратна 16.
    3. Добавляет байты отступа к данным, где каждый байт имеет значение, равное количеству добавленных байтов.

    ```
    Данные в виде строки
    ↓
    Преобразование в байты
    ↓
    Вычисление отступа (padding)
    ↓
    Добавление отступа (padding) к байтам
    ↓
    Данные с отступами в виде байтов
    ```

    Примеры:
    >>> pad("example")
    b'example\\t\\t\\t\\t\\t\\t\\t\\t\\t'
    """
    ...
```

### `encrypt`

```python
def encrypt(data: str, key: str) -> str:
    """
    Шифрует данные с использованием алгоритма AES.

    Args:
        data (str): Данные для шифрования.
        key (str): Ключ шифрования.

    Returns:
        str: Зашифрованные данные в формате JSON.

    Как работает функция:

    1. Генерирует случайную соль (8 символов).
    2. Вычисляет ключ и вектор инициализации (IV) на основе ключа и соли, многократно хешируя их с использованием MD5.
    3. Дополняет данные с помощью функции `pad()`.
    4. Создает объект AES с вычисленным ключом и вектором инициализации.
    5. Шифрует дополненные данные.
    6. Кодирует зашифрованные данные в base64.
    7. Формирует JSON, содержащий зашифрованные данные, вектор инициализации и соль.

    ```
    Входные данные и ключ
    ↓
    Генерация соли
    ↓
    Вычисление ключа шифрования и вектора инициализации (IV) на основе ключа и соли
    ↓
    Дополнение данных (padding)
    ↓
    Шифрование данных с использованием AES
    ↓
    Кодирование зашифрованных данных в base64
    ↓
    Формирование JSON с зашифрованными данными, IV и солью
    ↓
    Вывод: JSON строка с зашифрованными данными
    ```

    Примеры:
    >>> encrypt("example", "secret_key")
    '{"ct": "...", "iv": "...", "s": "..."}'
    """
    ...
```

### `unpad`

```python
def unpad(data: bytes) -> bytes:
    """
    Удаляет отступы из входных байтов данных.

    Args:
        data (bytes): Байты данных для удаления отступов.

    Returns:
        bytes: Байты данных без отступов.

    Как работает функция:
    1. Извлекает значение отступа из последнего байта данных.
    2. Удаляет байты отступа на основе полученного значения.

    ```
    Данные с отступами в виде байтов
    ↓
    Извлечение значения отступа
    ↓
    Удаление отступа
    ↓
    Данные без отступов в виде байтов
    ```

    Примеры:
    >>> unpad(b'example\\t\\t\\t\\t\\t\\t\\t\\t\\t')
    b'example'
    """
    ...
```

### `decrypt`

```python
def decrypt(data: str, key: str) -> str:
    """
    Расшифровывает данные, зашифрованные с использованием алгоритма AES.

    Args:
        data (str): Зашифрованные данные в формате JSON.
        key (str): Ключ шифрования.

    Returns:
        str: Расшифрованные данные.

    Как работает функция:

    1. Декодирует входную строку JSON в словарь.
    2. Извлекает зашифрованные данные, вектор инициализации (IV) и соль из словаря.
    3. Декодирует зашифрованные данные из base64.
    4. Вычисляет ключ шифрования на основе ключа и соли, многократно хешируя их с использованием MD5.
    5. Создает объект AES с вычисленным ключом и вектором инициализации.
    6. Расшифровывает данные.
    7. Удаляет отступы с помощью функции `unpad()`.
    8. Декодирует расшифрованные данные из байтов в строку.

    ```
    Зашифрованные данные в формате JSON и ключ
    ↓
    Декодирование JSON
    ↓
    Извлечение зашифрованных данных, вектора инициализации (IV) и соли
    ↓
    Декодирование зашифрованных данных из base64
    ↓
    Вычисление ключа шифрования на основе ключа и соли
    ↓
    Расшифровка данных с использованием AES
    ↓
    Удаление отступов (unpadding)
    ↓
    Преобразование расшифрованных данных в строку
    ↓
    Вывод: Расшифрованные данные в виде строки
    ```

    Примеры:
    >>> encrypted_data = encrypt("example", "secret_key")
    >>> decrypt(encrypted_data, "secret_key")
    'example'
    """
    ...