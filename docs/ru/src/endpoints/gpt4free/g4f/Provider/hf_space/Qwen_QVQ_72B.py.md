# Модуль `Qwen_QVQ_72B`

## Обзор

Модуль `Qwen_QVQ_72B` предоставляет асинхронный интерфейс для взаимодействия с моделью Qwen QVQ-72B, размещенной на платформе Hugging Face Space. Он позволяет генерировать текст на основе предоставленных сообщений и изображений. Модуль поддерживает как текстовый ввод, так и мультимодальный ввод (текст + изображение).

## Подробней

Модуль предназначен для использования в асинхронных приложениях, требующих взаимодействия с большими языковыми моделями (LLM) для генерации текста. Он предоставляет удобный интерфейс для отправки запросов к API Qwen QVQ-72B и получения результатов в виде асинхронного генератора.

## Классы

### `Qwen_QVQ_72B`

**Описание**: Класс `Qwen_QVQ_72B` реализует взаимодействие с моделью Qwen QVQ-72B.
**Наследует**: `AsyncGeneratorProvider`, `ProviderModelMixin`

**Атрибуты**:
- `label` (str): Метка провайдера, отображаемая пользователю ("Qwen QVQ-72B").
- `url` (str): URL-адрес Hugging Face Space, где размещена модель.
- `api_endpoint` (str): URL-адрес API-endpoint для генерации текста.
- `working` (bool): Флаг, указывающий на работоспособность провайдера.
- `default_model` (str): Модель, используемая по умолчанию ("qwen-qvq-72b-preview").
- `default_vision_model` (str): Модель для обработки изображений, используемая по умолчанию.
- `model_aliases` (dict): Псевдонимы моделей.
- `vision_models` (list): Список моделей, поддерживающих обработку изображений.
- `models` (list): Список всех поддерживаемых моделей.

**Принцип работы**:
Класс использует `aiohttp.ClientSession` для отправки асинхронных запросов к API Hugging Face Space. Он поддерживает отправку текстовых запросов и мультимодальных запросов (текст + изображение). Для отправки изображений используется `FormData`. Результаты возвращаются в виде асинхронного генератора, который позволяет получать текст по частям.

## Методы класса

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls, model: str, messages: Messages,
    media: MediaListType = None,
    api_key: str = None, 
    proxy: str = None,
    **kwargs
) -> AsyncResult:
    """
    Создает асинхронный генератор для взаимодействия с моделью Qwen QVQ-72B.

    Args:
        cls (Qwen_QVQ_72B): Ссылка на класс.
        model (str): Название модели для использования.
        messages (Messages): Список сообщений для отправки в модель.
        media (MediaListType, optional): Список медиафайлов для отправки в модель. По умолчанию `None`.
        api_key (str, optional): API-ключ для доступа к модели. По умолчанию `None`.
        proxy (str, optional): Адрес прокси-сервера для использования. По умолчанию `None`.
        **kwargs: Дополнительные аргументы.

    Returns:
        AsyncResult: Асинхронный генератор, выдающий текст по частям.

    Raises:
        ResponseError: Если превышен лимит токенов GPU.
        RuntimeError: Если не удалось прочитать ответ от сервера.

    
    - Функция принимает параметры, необходимые для взаимодействия с моделью, такие как модель, сообщения, медиафайлы, API-ключ и прокси-сервер.
    - Если предоставлены медиафайлы, функция загружает их на сервер и получает URL-адрес изображения.
    - Функция формирует данные запроса в зависимости от наличия медиафайлов.
    - Функция отправляет POST-запрос к API-endpoint и получает event_id.
    - Функция отправляет GET-запрос к API-endpoint с event_id и получает результаты в виде чанков.
    - Функция обрабатывает чанки и выдает текст по частям с помощью асинхронного генератора.
    - Функция обрабатывает ошибки и исключения, возникающие в процессе взаимодействия с API.

    Внутренние функции:
    - Отсутствуют

    """
```

**Параметры**:
- `cls` (Qwen_QVQ_72B): Ссылка на класс.
- `model` (str): Название модели для использования.
- `messages` (Messages): Список сообщений для отправки в модель.
- `media` (MediaListType, optional): Список медиафайлов для отправки в модель. По умолчанию `None`.
- `api_key` (str, optional): API-ключ для доступа к модели. По умолчанию `None`.
- `proxy` (str, optional): Адрес прокси-сервера для использования. По умолчанию `None`.
- `**kwargs`: Дополнительные аргументы.

**Возвращает**:
- `AsyncResult`: Асинхронный генератор, выдающий текст по частям.

**Вызывает исключения**:
- `ResponseError`: Если превышен лимит токенов GPU.
- `RuntimeError`: Если не удалось прочитать ответ от сервера.

**Примеры**:

```python
# Пример использования с текстовым вводом:
messages = [{"role": "user", "content": "Hello, world!"}]
async for chunk in Qwen_QVQ_72B.create_async_generator(model="qwen-qvq-72b-preview", messages=messages):
    print(chunk)

# Пример использования с мультимодальным вводом (текст + изображение):
messages = [{"role": "user", "content": "What is in this image?"}]
media = [[b"...", "image.jpg"]]  # Замените b"..." на реальные байты изображения
async for chunk in Qwen_QVQ_72B.create_async_generator(model="qwen-qvq-72b-preview", messages=messages, media=media):
    print(chunk)
```