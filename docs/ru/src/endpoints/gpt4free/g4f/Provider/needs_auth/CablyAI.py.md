# Модуль `CablyAI`

## Обзор

Модуль `CablyAI` предоставляет класс `CablyAI`, который является подклассом `OpenaiTemplate` и предназначен для взаимодействия с API CablyAI. Этот класс содержит информацию о URL, необходимости аутентификации, поддержке потоковой передачи и системных сообщений.

## Подробней

Модуль содержит настройки для работы с CablyAI, включая URL для чата и авторизации, а также базовый URL для API. Класс `CablyAI` определяет, что для работы требуется аутентификация и поддерживает потоковую передачу данных и системные сообщения. Он также переопределяет метод `create_async_generator` для добавления специфичных заголовков авторизации и User-Agent. Этот модуль является частью системы, которая позволяет взаимодействовать с различными языковыми моделями через унифицированный интерфейс.

## Классы

### `CablyAI`

**Описание**: Класс `CablyAI` наследует `OpenaiTemplate` и предоставляет конфигурацию и методы для взаимодействия с API CablyAI.

**Наследует**:

- `OpenaiTemplate`: Предоставляет базовую функциональность для работы с API, подобными OpenAI.

**Атрибуты**:

- `url` (str): URL для доступа к чату CablyAI (`"https://cablyai.com/chat"`).
- `login_url` (str): URL для авторизации на CablyAI (`"https://cablyai.com"`).
- `api_base` (str): Базовый URL для API CablyAI (`"https://cablyai.com/v1"`).
- `working` (bool): Указывает, что провайдер находится в рабочем состоянии (`True`).
- `needs_auth` (bool): Указывает, что для работы с API требуется аутентификация (`True`).
- `supports_stream` (bool): Указывает, что поддерживается потоковая передача данных (`True`).
- `supports_system_message` (bool): Указывает, что поддерживаются системные сообщения (`True`).
- `supports_message_history` (bool): Указывает, что поддерживается история сообщений (`True`).

**Методы**:

- `create_async_generator`: Создает асинхронный генератор для взаимодействия с API CablyAI.

## Функции

### `create_async_generator`

```python
@classmethod
def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    api_key: str = None,
    stream: bool = False,
    **kwargs
) -> AsyncResult:
    """Создает асинхронный генератор для взаимодействия с API CablyAI.

    Args:
        cls (CablyAI): Класс `CablyAI`.
        model (str): Имя модели для использования.
        messages (Messages): Список сообщений для отправки.
        api_key (str, optional): Ключ API для аутентификации. По умолчанию `None`.
        stream (bool, optional): Флаг, указывающий, использовать ли потоковую передачу. По умолчанию `False`.
        **kwargs: Дополнительные аргументы.

    Returns:
        AsyncResult: Асинхронный результат.

    Raises:
        ModelNotSupportedError: Если указанная модель не поддерживается.

    """
```

**Назначение**:

Создает асинхронный генератор для взаимодействия с API CablyAI, добавляя необходимые заголовки для аутентификации и идентификации клиента.

**Параметры**:

- `cls` (CablyAI): Ссылка на класс `CablyAI`.
- `model` (str): Имя используемой модели.
- `messages` (Messages): Список сообщений для отправки в API.
- `api_key` (str, optional): Ключ API для аутентификации. По умолчанию `None`.
- `stream` (bool, optional): Флаг, определяющий, использовать ли потоковый режим. По умолчанию `False`.
- `**kwargs`: Дополнительные параметры, передаваемые в базовый метод.

**Возвращает**:

- `AsyncResult`: Объект, представляющий асинхронный результат операции.

**Вызывает исключения**:

- `ModelNotSupportedError`: Если указанная модель не поддерживается API CablyAI.

**Как работает функция**:

1. **Определение заголовков**: Создается словарь `headers`, содержащий необходимые заголовки для аутентификации и идентификации запроса. Включает `Accept`, `Accept-Language`, `Authorization` (с использованием предоставленного `api_key`), `Content-Type`, `Origin`, `Referer` и `User-Agent`.
2. **Вызов родительского метода**: Вызывается метод `create_async_generator` из класса `OpenaiTemplate` (родительского класса), передавая параметры, специфичные для CablyAI (включая заголовки).

```
    Определение заголовков
    │
    └──→ Вызов родительского метода (OpenaiTemplate.create_async_generator)
```

**Примеры**:

1.  Создание асинхронного генератора с использованием API-ключа:

```python
CablyAI.create_async_generator(model="gpt-3.5-turbo", messages=[{"role": "user", "content": "Hello"}], api_key="YOUR_API_KEY", stream=True)
```

В этом примере создается асинхронный генератор для модели "gpt-3.5-turbo" с использованием предоставленного API-ключа и включенным потоковым режимом.

2.  Создание асинхронного генератора без API-ключа (если это поддерживается):

```python
CablyAI.create_async_generator(model="gpt-3.5-turbo", messages=[{"role": "user", "content": "Hello"}], stream=False)
```

В этом примере создается асинхронный генератор для модели "gpt-3.5-turbo" без предоставления API-ключа и с выключенным потоковым режимом.