# Модуль типов для g4f-клиента

## Обзор

Этот модуль содержит определения типов, используемых в g4f-клиенте (GPT4Free), включая типы для работы с провайдерами изображений, прокси и итераторами ответов. Он определяет структуры данных для обмена сообщениями с различными поставщиками API и обеспечивает гибкость в настройке прокси-серверов.

## Подробнее

Модуль предназначен для стандартизации типов данных, используемых в g4f-клиенте, что упрощает интеграцию с различными провайдерами и обеспечивает единообразный интерфейс для работы с асинхронными и синхронными потоками данных. Определенные типы позволяют гибко настраивать прокси и работать с изображениями через различных поставщиков.

## Классы

### `Client`

**Описание**:
Класс `Client` предназначен для управления API-ключом и прокси-серверами, используемыми при взаимодействии с g4f.

**Принцип работы**:
Класс инициализируется с API-ключом и настройками прокси, после чего определяет используемый прокси-сервер, проверяя параметры прокси, переменные окружения и приоритеты протоколов.

**Атрибуты**:
- `api_key` (str): API-ключ для аутентификации.
- `proxies` (Proxies): Настройки прокси-сервера (может быть словарем или строкой).
- `proxy` (str): Активный прокси-сервер.

**Методы**:
- `get_proxy()`: Возвращает используемый прокси-сервер на основе конфигурации.

## Функции

### `Client.__init__`

```python
def __init__(
    self,
    api_key: str = None,
    proxies: Proxies = None,
    **kwargs
) -> None:
    """
    Инициализирует клиент с API-ключом и настройками прокси.

    Args:
        api_key (str, optional): API-ключ для аутентификации. По умолчанию `None`.
        proxies (Proxies, optional): Настройки прокси-сервера. По умолчанию `None`.
        **kwargs: Дополнительные параметры.

    Returns:
        None

    Raises:
        Нет
    """
```

**Назначение**:
Инициализация экземпляра класса `Client` с заданным API-ключом и настройками прокси.

**Параметры**:
- `api_key` (str, optional): API-ключ для аутентификации. По умолчанию `None`.
- `proxies` (Proxies, optional): Настройки прокси-сервера. Может быть словарем или строкой. По умолчанию `None`.
- `**kwargs`: Дополнительные параметры, которые могут быть переданы.

**Как работает функция**:

1. Устанавливает значение атрибута `api_key` равным переданному значению `api_key`.
2. Устанавливает значение атрибута `proxies` равным переданному значению `proxies`.
3. Вызывает метод `get_proxy()` для определения используемого прокси-сервера и устанавливает значение атрибута `proxy`.

**Примеры**:

```python
client1 = Client(api_key="ключ123", proxies={"https": "http://proxy.com"})
client2 = Client(proxies="http://proxy.com")
```

### `Client.get_proxy`

```python
def get_proxy(self) -> Union[str, None]:
    """
    Определяет и возвращает прокси-сервер для использования.

    Args:
        Нет

    Returns:
        Union[str, None]: Строка с адресом прокси-сервера или `None`, если прокси не настроен.

    Raises:
        Нет
    """
```

**Назначение**:
Определение и возврат прокси-сервера для использования.

**Возвращает**:
- `Union[str, None]`: Строка с адресом прокси-сервера или `None`, если прокси не настроен.

**Как работает функция**:

     Определение прокси-сервера
     |
     -- Проверка типа proxies
     |  isinstance(self.proxies, str)?
     |  Yes: возврат self.proxies
     |  No:
     |  |
     |  -- self.proxies is None?
     |  |  Yes: os.environ.get("G4F_PROXY")?
     |  |  No:
     |  |  |
     |  |  -- "all" in self.proxies?
     |  |  |  Yes: self.proxies["all"]
     |  |  |  No:
     |  |  |  |
     |  |  |  -- "https" in self.proxies?
     |  |  |  |  Yes: self.proxies["https"]
     |  |  |  |  No: return None
     |  |  |  |
     |  |  |  return None
     |  |  return os.environ.get("G4F_PROXY")
     |  return self.proxies

**Примеры**:

```python
client1 = Client(proxies="http://proxy.com")
print(client1.get_proxy())  # Вывод: http://proxy.com

client2 = Client(proxies={"https": "http://proxy.com"})
print(client2.get_proxy())  # Вывод: http://proxy.com

import os
os.environ["G4F_PROXY"] = "http://env_proxy.com"
client3 = Client()
print(client3.get_proxy())  # Вывод: http://env_proxy.com

client4 = Client(proxies={"all": "http://all_proxy.com"})
print(client4.get_proxy())  # Вывод: http://all_proxy.com

client5 = Client()
print(client5.get_proxy()) # Вывод: None, если переменная окружения G4F_PROXY не установлена