# Модуль для запуска рекламных кампаний в Facebook

## Обзор

Модуль `src.endpoints.advertisement.facebook.start_sergey` предназначен для автоматизированного запуска рекламных кампаний в Facebook. Он включает в себя функциональность для выбора групп, подготовки рекламных объявлений на разных языках и управления драйвером браузера для взаимодействия с Facebook.

## Подробней

Этот модуль разработан для автоматизации процесса размещения рекламы в Facebook, используя веб-драйвер для управления браузером и взаимодействия с платформой Facebook. Он поддерживает мультиязычность и позволяет запускать рекламные кампании, ориентированные на разные языковые группы.

## Функции

### `run_campaign`

```python
def run_campaign(d: Driver, promoter_name: str, campaigns: list | str, group_file_paths: list, language: str, currency: str):
    """Запуск рекламной кампании.

    Args:
        d (Driver): Экземпляр драйвера.
        promoter_name (str): Имя рекламодателя.
        campaigns (list): Список кампаний.
        group_file_paths (list): Пути к файлам с группами.
        language (str): Язык рекламной кампании.
        currency (str): Валюта рекламной кампании.
    """
    ...
```

**Назначение**: Запускает рекламную кампанию на Facebook.

**Параметры**:

- `d` (Driver): Экземпляр драйвера, используемый для управления браузером.
- `promoter_name` (str): Имя рекламодателя, используемое для идентификации в системе.
- `campaigns` (list | str): Список кампаний для запуска. Может быть как списком, так и строкой.
- `group_file_paths` (list): Список путей к файлам, содержащим информацию о группах Facebook, в которых будет размещена реклама.
- `language` (str): Язык рекламной кампании (например, "RU" для русского).
- `currency` (str): Валюта, используемая в рекламной кампании (например, "ILS" для израильского шекеля).

**Возвращает**: `None`

**Как работает функция**:

1.  Создает экземпляр класса `FacebookPromoter`, используя переданный драйвер и имя рекламодателя.
2.  Вызывает метод `run_campaigns` у экземпляра `FacebookPromoter` для запуска рекламной кампании с указанными параметрами (список кампаний, пути к файлам групп, категории групп для рекламы, язык и валюта).
3.  Отключает видео для рекламной кампании.

**ASCII схема работы функции**:

```
    Начало
    │
    ├───> Создание экземпляра FacebookPromoter
    │
    ├───> Запуск рекламной кампании через promoter.run_campaigns
    │
    └───> Конец
```

**Примеры**:

```python
from src.webdriver.driver import Driver, Chrome
# Пример с имитацией Driver
class MockDriver(Driver):
    def __init__(self):
        pass
    def get_url(self, url:str):
        print ('open url', url)
    def execute_locator(self, l:dict)->None:
        pass


d = MockDriver()
promoter_name = "kazarinov"
campaigns = ["kazarinov_ru"]
group_file_paths = ["sergey_pages.json"]
language = "RU"
currency = "ILS"
run_campaign(d, promoter_name, campaigns, group_file_paths, language, currency)
```

### `campaign_cycle`

```python
def campaign_cycle(d: Driver):
    """Цикл для управления запуском кампаний.

    Args:
        d (Driver): Экземпляр драйвера.
        aliexpress_adv (bool): Флаг для определения рекламодателя.
    """
    ...
```

**Назначение**: Управляет циклом запуска рекламных кампаний для разных языков и валют.

**Параметры**:

- `d` (Driver): Экземпляр драйвера для управления браузером.

**Возвращает**: `True` в случае успешного завершения цикла.

**Как работает функция**:

1.  Инициализирует списки путей к файлам групп для русского и иврита (`file_paths_ru` и `file_paths_he`), добавляя к ним пути к файлам рекламных объявлений.
2.  Определяет список словарей с парами язык-валюта (`language_currency_pairs`), которые будут использоваться для запуска кампаний.
3.  Перебирает пары язык-валюта из списка `language_currency_pairs`.
4.  Для каждой пары определяет список кампаний и запускает их с помощью функции `run_campaign`.
5.  Запускает рекламные кампании для AliExpress, используя имена каталогов в Google Drive в качестве списка кампаний.

**ASCII схема работы функции**:

```
Начало
│
├───> Инициализация путей к файлам групп и объявлений
│
├───> Определение пар язык-валюта
│
├───> Цикл по парам язык-валюта
│   │
│   ├───> Определение путей к файлам групп на основе языка
│   │
│   ├───> Запуск кампаний для текущего языка
│   │
│   └───> Запуск кампаний для AliExpress
│
└───> Возврат True
```

**Примеры**:

```python
from src.webdriver.driver import Driver, Chrome
# Пример с имитацией Driver
class MockDriver(Driver):
    def __init__(self):
        pass
    def get_url(self, url:str):
        print ('open url', url)
    def execute_locator(self, l:dict)->None:
        pass
d = MockDriver()
campaign_cycle(d)
```

### `main`

```python
def main():
    """Основная функция для запуска рекламных кампаний."""
    ...
```

**Назначение**: Основная функция для запуска рекламных кампаний.

**Параметры**: Отсутствуют.

**Возвращает**: `None`

**Как работает функция**:

1.  Инициализирует драйвер Chrome и открывает Facebook.
2.  Запускает бесконечный цикл, в котором проверяет интервал времени с помощью функции `interval`. Если функция `interval` возвращает `True`, засыпает на 1000 секунд.
3.  Вызывает функцию `campaign_cycle` для запуска рекламных кампаний.
4.  Логирует время засыпания и засыпает на случайное время от 30 до 360 секунд.
5.  Обрабатывает прерывание с клавиатуры (`KeyboardInterrupt`), логируя сообщение о прерывании кампании.

**ASCII схема работы функции**:

```
Начало
│
├───> Инициализация драйвера Chrome и открытие Facebook
│
├───> Бесконечный цикл
│   │
│   ├───> Проверка интервала времени (interval)
│   │   │
│   │   └───> Если интервал, то засыпание на 1000 секунд
│   │
│   ├───> Запуск цикла кампаний (campaign_cycle)
│   │
│   └───> Логирование и засыпание на случайное время
│
└───> Обработка прерывания с клавиатуры (KeyboardInterrupt)
```

**Примеры**:

```python
# Пример запуска функции main
if __name__ == "__main__":
    main()
```