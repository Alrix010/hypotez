# Модуль для сборки файла `summary.md`

## Обзор

Модуль предназначен для автоматического создания файла `SUMMARY.md`, используемого для компиляции документации посредством `mdbook`. Он рекурсивно обходит указанную директорию (`src`), фильтрует файлы по языку (русский или английский) и генерирует структуру глав в формате, требуемом `mdbook`.

## Подробнее

Модуль предоставляет функции для создания файла `SUMMARY.md`, который служит оглавлением для документации, собранной с помощью `mdbook`. Он позволяет фильтровать файлы по языку (русский или английский), чтобы включать в документацию только соответствующие файлы.
В коде используется модуль `header`, который определяет корневой путь проекта.

## Функции

### `make_summary`

**Назначение**: Создает файл `SUMMARY.md`, рекурсивно обходя указанную директорию.

**Параметры**:

-   `docs_dir` (Path): Путь к исходной директории `src`.
-   `lang` (str): Язык фильтрации файлов. Возможные значения: `ru` (русский) или `en` (английский). По умолчанию `en`.

**Возвращает**:

-   `None`: Функция ничего не возвращает.

**Как работает функция**:

1.  Функция формирует путь к файлу `SUMMARY.md` с использованием функции `prepare_summary_path`.
2.  Создает родительскую директорию для файла `SUMMARY.md`, если она не существует.
3.  Вызывает внутреннюю функцию `_make_summary` для рекурсивного обхода директории и создания содержимого файла `SUMMARY.md`.

**Примеры**:

```python
from pathlib import Path
# Допустим, что PROJECT_ROOT это Path('/путь/к/проекту')
docs_dir = Path('/путь/к/проекту/src')
make_summary(docs_dir, lang='ru')
```

### `_make_summary`

**Назначение**: Рекурсивно обходит указанную директорию и создает файл `SUMMARY.md` с главами на основе `.md` файлов.

**Параметры**:

-   `src_dir` (Path): Путь к папке с исходниками `.md`.
-   `summary_file` (Path): Полный путь к файлу `SUMMARY.md`.
-   `lang` (str): Язык фильтрации файлов. Возможные значения: `ru` или `en`.

**Возвращает**:

-   `bool`: `True` в случае успешного создания файла, `False` в случае ошибки.

**Как работает функция**:

1.  Проверяет, существует ли файл `SUMMARY.md`, и если да, выводит сообщение о том, что он будет перезаписан.
2.  Открывает файл `SUMMARY.md` для записи в кодировке UTF-8.
3.  Записывает заголовок `# Summary\n\n` в файл.
4.  Рекурсивно обходит все `.md` файлы в указанной директории.
5.  Игнорирует файл `SUMMARY.md`, чтобы избежать рекурсивной обработки самого себя.
6.  Фильтрует файлы по языку в соответствии с параметром `lang`:
    -   Если `lang` равен `ru`, пропускает файлы, не заканчивающиеся на `.ru.md`.
    -   Если `lang` равен `en`, пропускает файлы, заканчивающиеся на `.ru.md`.
7.  Формирует относительный путь к файлу относительно родительской директории `src_dir`.
8.  Записывает строку в формате `- [{path.stem}]({relative_path.as_posix()})\n` в файл `SUMMARY.md`.
9.  В случае возникновения исключения выводит сообщение об ошибке и возвращает `False`.

**Примеры**:

```python
from pathlib import Path
src_dir = Path('/путь/к/проекту/src')
summary_file = Path('/путь/к/проекту/docs/SUMMARY.md')
_make_summary(src_dir, summary_file, lang='en')
```

### `prepare_summary_path`

**Назначение**: Формирует путь к файлу `SUMMARY.md`, заменяя часть пути `src` на `docs`.

**Параметры**:

-   `src_dir` (Path): Исходный путь с `src`.
-   `file_name` (str): Имя файла, который нужно создать. По умолчанию `SUMMARY.md`.

**Возвращает**:

-   `Path`: Новый путь к файлу `SUMMARY.md`.

**Как работает функция**:

1.  Формирует новый путь, заменяя `src` на `docs` в исходном пути.
2.  Добавляет имя файла к новому пути.
3.  Возвращает новый путь к файлу.

**Примеры**:

```python
from pathlib import Path
src_dir = Path('/путь/к/проекту/src')
summary_file = prepare_summary_path(src_dir)
print(summary_file)  # Вывод: /путь/к/проекту/docs/SUMMARY.md
```

## Запуск из командной строки

Модуль можно запустить из командной строки, передав путь к исходной директории `src` и язык фильтрации файлов (`ru` или `en`).

Пример запуска:

```bash
python make_summary.py -lang ru src
```

## Параметры командной строки:

-   `-lang`: Язык фильтрации файлов (`ru` или `en`). По умолчанию `en`.
-   `src_dir`: Путь к исходной директории `src`.