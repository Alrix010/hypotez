# Модуль для отправки сообщений в WhatsApp
## Обзор

Модуль предназначен для автоматической отправки сообщений в WhatsApp с использованием библиотеки `pywhatkit` и `pyautogui`. Позволяет отправлять заданное количество сообщений на указанный номер телефона в случайное время в заданном диапазоне часов.

## Подробнее

Модуль предоставляет функцию `send_whatsapp_message` для отправки сообщений и использует список предопределенных сообщений с эмодзи. Пользователь вводит номер телефона, количество сообщений, начальный и конечный час для отправки.

## Функции

### `send_whatsapp_message`

```python
def send_whatsapp_message(phone_number, message, hour, minutes):
    """Sends a WhatsApp message using pywhatkit and pyautogui."""
```

**Назначение**: Отправляет сообщение WhatsApp с использованием библиотек `pywhatkit` и `pyautogui`.

**Параметры**:
- `phone_number` (str): Номер телефона получателя с кодом страны.
- `message` (str): Текст сообщения для отправки.
- `hour` (int): Час отправки сообщения (0-23).
- `minutes` (int): Минуты отправки сообщения (0-59).

**Возвращает**:
- `None`: Функция ничего не возвращает.

**Вызывает исключения**:
- `Exception` as `ex`: Выводит сообщение об ошибке, если произошла ошибка при отправке сообщения.

**Как работает функция**:
1. Использует `pywhatkit.sendwhatmsg` для отправки сообщения через WhatsApp Web. Устанавливает время ожидания загрузки страницы в 25 секунд и автоматически закрывает вкладку после отправки.
2. Ждет 20 секунд, чтобы страница WhatsApp Web успела загрузиться.
3. Создает экземпляр класса `Controller` из библиотеки `pynput.keyboard`.
4. Эмулирует нажатие клавиши `Enter` для отправки сообщения.
5. Выводит сообщение об успешной отправке или сообщение об ошибке в случае неудачи.

**Примеры**:
```python
send_whatsapp_message("+1234567890", "Hello! How are you?", 10, 30)
```

## Переменные

### `messages`

```python
messages = [
    "Hello! How are you? :slightly_smiling_face:",
    "Thinking of you! :heart:",
    "Just wanted to say hi! :waving_hand:",
    "I love you :heart_exclamation:",
    emoji.emojize("Have a wonderful day! :sun:")
]
```

**Описание**: Список предопределенных сообщений для отправки, содержащих эмодзи. Функция `emoji.emojize` используется для преобразования текстовых представлений эмодзи в Unicode.

### Основной цикл отправки сообщений

Цикл `while` организует отправку заданного количества сообщений в WhatsApp.

**Как работает цикл**:
1. Запрашивает у пользователя номер телефона, количество сообщений, начальный и конечный час отправки.
2. Инициализирует счетчик сообщений `message_count` значением 0.
3. Генерирует случайный час и минуту для отправки сообщения в заданном диапазоне.
4. Выбирает случайное сообщение из списка `messages`.
5. Вызывает функцию `send_whatsapp_message` для отправки сообщения.
6. Увеличивает счетчик сообщений `message_count` на 1.
7. Повторяет шаги 3-6, пока не будет отправлено заданное количество сообщений.