# Документация для модуля автоматизированной отправки сообщений WhatsApp

## Обзор

Данный модуль предназначен для автоматической отправки сообщений в WhatsApp. Он позволяет пользователю настроить количество отправляемых сообщений и временной диапазон. Для работы скрипта требуются установленные библиотеки Python, такие как `pywhatkit`, `pyautogui`, `pynput`, `emoji`, `random` и `time`.

## Подробней

Модуль автоматизирует отправку сообщений WhatsApp, используя библиотеки Python для взаимодействия с веб-версией WhatsApp, автоматизации действий мыши и клавиатуры, а также для генерации случайных сообщений и времени отправки. Разработка скрипта включает в себя функцию отправки сообщений, создание банка сообщений, получение пользовательского ввода и основной цикл отправки.

## Функции

### `send_whatsapp_message`

**Назначение**: Отправляет сообщение WhatsApp на указанный номер телефона в заданное время.

**Параметры**:
- `phone_number` (str): Номер телефона получателя (с кодом страны).
- `message` (str): Текст сообщения.
- `hour` (int): Час отправки сообщения (0-23).
- `minutes` (int): Минуты отправки сообщения (0-59).

**Как работает функция**:
1. Инициализирует отправку сообщения с использованием `pywhatkit.sendwhatmsg`.
2. Использует `time.sleep` для задержки загрузки веб-версии WhatsApp.
3. Применяет `pyautogui` и `pynput` для имитации нажатия клавиши "Enter" для отправки сообщения.
4. Обрабатывает исключения с помощью блока `try...except` для вывода ошибок.

**Примеры**:
```python
phone_number = "+79991234567"
message = "Привет! Это автоматическое сообщение."
hour = 10
minutes = 30
# send_whatsapp_message(phone_number, message, hour, minutes)
```

## Дополнительные компоненты

- **Банк сообщений**:
    - Создается список строк (`messages`) для хранения сообщений.
    - Используется `emoji.emojize` для добавления эмодзи.
    - Применяется `random.choice` для случайного выбора сообщения.
- **Пользовательский ввод**:
    - Получение количества сообщений (`num_messages`) с помощью функции `input`.
    - Получение начального часа (`start_hour`) и конечного часа (`end_hour`) диапазона отправки с помощью `input`.
- **Основной цикл отправки**:
    - Цикл `while` выполняется, пока счетчик сообщений (`message_count`) не достигнет заданного количества (`num_messages`).
    - Генерация случайного часа и минут с помощью `random.randint`.
    - Вызов функции `send_whatsapp_message` с полученными данными.
    - Увеличение счетчика сообщений.

## Возможные проблемы и решения

- **Проблемы с `pywhatkit`**: В случае неудачной автоматической отправки сообщения, использовать `pyautogui` и `pynput` для эмуляции нажатия клавиш и отправки сообщения.
- **Подключение к WhatsApp Web**: При первом использовании необходимо подключение к веб-версии WhatsApp через веб-браузер.
- **Динамическая задержка**: Скорость загрузки веб-версии WhatsApp может меняться, поэтому для стабильности увеличьте время задержки.
- **Зависимость от браузера и версии WhatsApp**: Изменения в браузере или веб-версии WhatsApp могут потребовать корректировки скрипта.

## Выполнение скрипта

1. Сохраните скрипт в файл с расширением `.py`.
2. Выполните скрипт в терминале с помощью команды: `python имя_файла.py`
3. Следуйте инструкциям на экране для ввода необходимых данных.