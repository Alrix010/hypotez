# Модуль для управления веб-сайтом

## Обзор

Модуль `website.py` предназначен для настройки маршрутов веб-приложения Flask и обработки запросов к различным страницам и ресурсам веб-сайта. Он включает в себя настройку маршрутов для главной страницы, страницы чата и статических ресурсов, таких как файлы CSS и JavaScript.

## Подробней

Этот модуль является частью веб-сервера `juliana` и отвечает за обработку HTTP-запросов и отображение соответствующих HTML-шаблонов. Он использует Flask для определения маршрутов и обработки запросов. Класс `Website` содержит методы для отображения главной страницы, страницы чата и обслуживания статических ресурсов.

## Классы

### `Website`

**Описание**:
Класс `Website` отвечает за настройку маршрутов веб-приложения и обработку запросов.

**Принцип работы**:
Класс инициализируется с экземпляром приложения Flask. В конструкторе определяются маршруты веб-приложения, связывая URL-адреса с соответствующими функциями-обработчиками.

**Аттрибуты**:
- `app`: Экземпляр приложения Flask.
- `routes` (dict): Словарь, содержащий маршруты веб-приложения и связанные с ними функции и методы HTTP.

**Методы**:
- `__init__(self, app)`: Конструктор класса, инициализирует приложение Flask и настраивает маршруты.
- `_chat(self, conversation_id)`: Обрабатывает запросы к странице чата с определенным `conversation_id`.
- `_index(self)`: Обрабатывает запросы к главной странице, генерируя уникальный идентификатор чата и отображая шаблон `index.html`.
- `_assets(self, folder: str, file: str)`: Обрабатывает запросы к статическим ресурсам, таким как файлы CSS и JavaScript.

## Функции

### `__init__`

**Назначение**:
Инициализирует экземпляр класса `Website`, сохраняет ссылку на приложение Flask и определяет маршруты веб-приложения.

**Параметры**:
- `app`: Экземпляр приложения Flask.

**Возвращает**:
- `None`

**Как работает функция**:

1. Сохраняет ссылку на приложение Flask в атрибуте `app`.
2. Определяет словарь `routes`, который связывает URL-адреса с функциями-обработчиками.

```
App_Flask --> Сохранить_ссылку_на_Flask
|
--> Создать_словарь_маршрутов
|
--> Связать_URL_с_функциями
```

**Примеры**:

```python
from flask import Flask
app = Flask(__name__)
website = Website(app)
```

### `_chat`

**Назначение**:
Обрабатывает запросы к странице чата с определенным `conversation_id`.

**Параметры**:
- `conversation_id` (str): Идентификатор чата.

**Возвращает**:
- `Response`: Ответ Flask, содержащий отображенный HTML-шаблон `index.html` или перенаправление на главную страницу.

**Как работает функция**:

1. Проверяет, содержит ли `conversation_id` символ `-`. Если нет, перенаправляет на главную страницу.
2. Отображает HTML-шаблон `index.html` с переданным `conversation_id`.

```
conversation_id --> Проверка_наличия_дефиса
|
Да --> Отобразить_шаблон_index_html
Нет --> Перенаправить_на_главную
```

**Примеры**:

```python
from flask import Flask
app = Flask(__name__)
website = Website(app)
# ... определение маршрутов и запуск приложения
with app.test_request_context('/chat/1234-5678-90ab-cdef'):
    response = website._chat('1234-5678-90ab-cdef')
    assert response.status_code == 200
```

### `_index`

**Назначение**:
Обрабатывает запросы к главной странице, генерируя уникальный идентификатор чата и отображая шаблон `index.html`.

**Параметры**:
- `None`

**Возвращает**:
- `Response`: Ответ Flask, содержащий отображенный HTML-шаблон `index.html` с сгенерированным идентификатором чата.

**Как работает функция**:

1. Генерирует уникальный идентификатор чата, используя `urandom` и `time`.
2. Отображает HTML-шаблон `index.html` с сгенерированным идентификатором чата.

```
Начало --> Сгенерировать_уникальный_id
|
--> Отобразить_шаблон_index_html
```

**Примеры**:

```python
from flask import Flask
from src.endpoints.juliana.server.website import Website
app = Flask(__name__)
website = Website(app)
# ... определение маршрутов и запуск приложения
with app.test_request_context('/chat/'):
    response = website._index()
    assert response.status_code == 200
```

### `_assets`

**Назначение**:
Обрабатывает запросы к статическим ресурсам, таким как файлы CSS и JavaScript.

**Параметры**:
- `folder` (str): Имя папки, содержащей файл.
- `file` (str): Имя файла.

**Возвращает**:
- `Response`: Ответ Flask, содержащий запрошенный файл, или сообщение об ошибке 404, если файл не найден.

**Как работает функция**:

1. Пытается отправить запрошенный файл из папки `client`.
2. Если файл не найден, возвращает сообщение об ошибке 404.

```
Запрос_файла --> Попытка_отправить_файл
|
Успех --> Отправить_файл
|
Неудача --> Вернуть_ошибку_404
```

**Примеры**:

```python
from flask import Flask
app = Flask(__name__)
website = Website(app)
# ... определение маршрутов и запуск приложения
with app.test_request_context('/assets/css/style.css'):
    response = website._assets('css', 'style.css')
    assert response.status_code == 200