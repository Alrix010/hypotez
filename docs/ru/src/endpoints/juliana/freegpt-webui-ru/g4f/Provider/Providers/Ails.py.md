# Модуль `Ails.py`

## Обзор

Модуль предоставляет реализацию провайдера `Ails` для взаимодействия с API `ai.ls`. Он включает функции для создания запросов к API и обработки ответов, а также вспомогательные утилиты для форматирования данных и генерации хешей.

## Подробнее

Модуль предназначен для интеграции с системой `g4f` и обеспечивает возможность использования моделей, предоставляемых сервисом `ai.ls`, таких как `gpt-3.5-turbo`. Он использует библиотеку `requests` для отправки HTTP-запросов и обрабатывает ответы в режиме потоковой передачи.
## Функции

### `_create_completion`

```python
def _create_completion(model: str, messages: list, temperature: float = 0.6, stream: bool = False, **kwargs):
    """Функция создает запрос к API caipacity.com для получения завершения текста.

    Args:
        model (str): Название модели, используемой для генерации текста.
        messages (list): Список сообщений, представляющих историю разговора.
        temperature (float, optional): Параметр, определяющий случайность генерации текста. По умолчанию 0.6.
        stream (bool, optional): Определяет, использовать ли потоковый режим передачи данных. По умолчанию False.
        **kwargs: Дополнительные параметры.

    Yields:
        str: Части сгенерированного текста в потоковом режиме.

    Raises:
        requests.exceptions.RequestException: В случае ошибки при выполнении HTTP-запроса.

    Как работает функция:
    - Формирует заголовки запроса, включая авторизацию, идентификатор клиента и версию клиента.
    - Устанавливает параметры запроса, такие как использование полной версии ответа.
    - Генерирует timestamp и hash для подписи запроса.
    - Формирует JSON-данные для отправки в теле запроса, включающие модель, температуру, флаг потоковой передачи, сообщения и подпись.
    - Отправляет POST-запрос к API caipacity.com/v1/chat/completions с использованием библиотеки requests.
    - Итерирует по строкам ответа, извлекая контент из каждой строки, если она содержит "content".
    - Декодирует полученные данные из JSON и извлекает текст из поля 'content', если он присутствует.
    - Возвращает текст в виде генератора.

    Внутренние функции:
        Отсутствуют.

    Примеры:
        Примеры использования функции отсутствуют, так как она является внутренней и используется другими частями модуля.
    """
```

## Классы

### `Utils`

**Описание**: Класс, содержащий утилитарные методы для работы с данными и генерации хешей.

**Методы**:

#### `hash`

```python
    def hash(json_data: Dict[str, str]) -> sha256:
        """Функция вычисляет SHA256 хеш на основе входных данных и секретного ключа.

        Args:
            json_data (Dict[str, str]): Словарь с данными для хеширования, содержащий ключи 't' и 'm'.

        Returns:
            sha256: SHA256 хеш в виде шестнадцатеричной строки.

        Как работает функция:
        - Определяет секретный ключ в виде массива байтов.
        - Формирует базовую строку для хеширования, используя значения 't' (timestamp), 'm' (message) из json_data, фиксированную строку и длину сообщения.
        - Вычисляет SHA256 хеш от базовой строки, закодированной в UTF-8.
        - Возвращает хеш в виде шестнадцатеричной строки.

        Внутренние функции:
            Отсутствуют.

        Примеры:
            Примеры использования функции отсутствуют, так как она является внутренней и используется другими частями модуля.
        """
```

#### `format_timestamp`

```python
    def format_timestamp(timestamp: int) -> str:
        """Функция форматирует timestamp, изменяя его последнюю цифру.

        Args:
            timestamp (int): Timestamp для форматирования.

        Returns:
            str: Отформатированный timestamp в виде строки.

        Как работает функция:
        - Вычисляет последнюю цифру timestamp.
        - Если последняя цифра четная, добавляет 1. Если нечетная, оставляет как есть.
        - Вычитает из исходного timestamp последнюю цифру и прибавляет измененную.
        - Преобразует результат в строку и возвращает.

        Внутренние функции:
            Отсутствуют.

        Примеры:
            Примеры использования функции отсутствуют, так как она является внутренней и используется другими частями модуля.
        """
```

## Переменные

-   `url` (str): URL-адрес API `ai.ls`.
-   `model` (str): Название используемой модели (`gpt-3.5-turbo`).
-   `supports_stream` (bool): Флаг, указывающий на поддержку потоковой передачи данных (True).
-   `needs_auth` (bool): Флаг, указывающий на необходимость аутентификации (False).
-    `params` (str): Строка, содержащая информацию о поддержке параметров для функции `_create_completion`.