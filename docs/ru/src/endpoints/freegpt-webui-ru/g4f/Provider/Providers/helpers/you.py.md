# Модуль для взаимодействия с you.com через API

## Обзор

Модуль предназначен для отправки запросов к API you.com и получения ответов в режиме реального времени. Он использует библиотеку `curl_cffi` для выполнения HTTP-запросов и преобразует структуру сообщений для соответствия требованиям API.

## Подробнее

Модуль получает конфигурацию и сообщения через аргументы командной строки, преобразует структуру сообщений в формат, ожидаемый API you.com, и отправляет запрос на потоковую передачу данных. Полученные данные обрабатываются и выводятся в консоль. В случае ошибки, модуль пытается повторить запрос.

## Содержание

- [Функции](#Функции)
  - [`transform`](#transform)
  - [`output`](#output)

## Функции

### `transform`

```python
def transform(messages: list) -> list:
    """Преобразует список сообщений в формат, требуемый API you.com.

    Args:
        messages (list): Список сообщений, где каждое сообщение представляет собой словарь с ключами 'role' и 'content'.

    Returns:
        list: Список словарей, где каждый словарь содержит ключи 'question' и 'answer'.

    Как работает функция:
    ----------------------
    Функция итерируется по списку сообщений и преобразует их в формат, подходящий для API you.com.
    Если роль сообщения 'user', то его содержимое становится вопросом. Если следующее сообщение имеет роль 'assistant',
    то его содержимое становится ответом. Если роль сообщения 'assistant', но предыдущего сообщения с ролью 'user' не было,
    то создается запись с пустым вопросом и ответом из содержимого сообщения 'assistant'.
    Сообщения с ролью 'system' также преобразуются в формат вопрос-ответ, где вопрос - содержимое сообщения, а ответ - пустая строка.
    """
```

### `output`

```python
def output(chunk):
    """Обрабатывает полученный чанк данных и выводит токен youChatToken в консоль.

    Args:
        chunk: Полученный фрагмент данных из потока ответов от API.

    Как работает функция:
    ----------------------
    Функция проверяет, содержит ли полученный фрагмент данных строку `"youChatToken"`.
    Если да, то фрагмент декодируется, разделяется по строке `'data: '`, преобразуется из JSON в словарь,
    и извлекается значение ключа `'youChatToken'`, которое выводится в консоль.

    """