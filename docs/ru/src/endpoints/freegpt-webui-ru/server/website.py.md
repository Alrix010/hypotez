# Модуль для управления веб-сайтом

## Обзор

Модуль `website.py` отвечает за маршрутизацию и отображение страниц веб-интерфейса. Он использует Flask для обработки HTTP-запросов и отображения HTML-шаблонов.

## Подробней

Этот модуль является центральным элементом для управления веб-интерфейсом, предоставляя пользователям доступ к различным страницам и ресурсам. Он определяет маршруты для чата, статических ресурсов и главной страницы, обеспечивая навигацию и взаимодействие с веб-приложением.

## Классы

### `Website`

**Описание**: Класс `Website` управляет маршрутами и отображением веб-страниц.

**Принцип работы**:
Класс инициализируется с Flask-приложением и определяет маршруты для различных URL-адресов. Каждый маршрут связан с определенной функцией, которая обрабатывает запрос и возвращает ответ.

**Атрибуты**:
- `app`: Flask-приложение, связанное с веб-сайтом.
- `routes`: Словарь, определяющий маршруты и связанные с ними функции и методы.

**Методы**:
- `__init__(self, app)`: Инициализирует экземпляр класса `Website` с Flask-приложением.
- `_chat(self, conversation_id)`: Отображает страницу чата для указанного `conversation_id`.
- `_index(self)`: Отображает главную страницу с новым `chat_id`.
- `_assets(self, folder: str, file: str)`: Отправляет статические ресурсы (например, файлы CSS, JavaScript) из указанной папки.

## Функции

### `__init__`

```python
def __init__(self, app) -> None:
    """
    Инициализирует экземпляр класса Website.

    Args:
        app: Flask-приложение.

    Returns:
        None
    """
```

**Назначение**: Инициализация экземпляра класса `Website` с Flask-приложением и определение маршрутов.

**Параметры**:
- `app`: Flask-приложение, которое будет связано с веб-сайтом.

**Возвращает**:
- `None`

**Как работает функция**:
1. Присваивает переданное Flask-приложение атрибуту `app` экземпляра класса.
2. Определяет словарь `routes`, который связывает URL-пути с функциями, обрабатывающими запросы к этим путям.

**Примеры**:
```python
from flask import Flask
app = Flask(__name__)
website = Website(app)
```

### `_chat`

```python
def _chat(self, conversation_id):
    """
    Отображает страницу чата для указанного conversation_id.

    Args:
        conversation_id: Идентификатор беседы.

    Returns:
        render_template('index.html', chat_id=conversation_id): HTML-страница чата.
    """
```

**Назначение**: Отображение страницы чата для указанного идентификатора беседы.

**Параметры**:
- `conversation_id`: Идентификатор беседы, используемый для отображения соответствующей страницы чата.

**Возвращает**:
- `render_template('index.html', chat_id=conversation_id)`: HTML-страница чата.
    - Если `conversation_id` не содержит дефис (`-`), происходит перенаправление на главную страницу чата (`/chat`).

**Как работает функция**:
1. Проверяет, содержит ли `conversation_id` символ `-`. Если нет, перенаправляет пользователя на главную страницу чата.
2. Если `conversation_id` содержит символ `-`, функция отображает HTML-шаблон `index.html`, передавая `conversation_id` в качестве параметра `chat_id`.

**Примеры**:
```python
# Пример вызова функции _chat с допустимым conversation_id
_chat("1234-5678-90ab-cdef")
```

### `_index`

```python
def _index(self):
    """
    Отображает главную страницу с новым chat_id.

    Returns:
        render_template('index.html', chat_id=f'{urandom(4).hex()}-{urandom(2).hex()}-{urandom(2).hex()}-{urandom(2).hex()}-{hex(int(time() * 1000))[2:]}'): HTML-страница с новым chat_id.
    """
```

**Назначение**: Отображение главной страницы с новым уникальным идентификатором чата.

**Возвращает**:
- `render_template('index.html', chat_id=f'{urandom(4).hex()}-{urandom(2).hex()}-{urandom(2).hex()}-{urandom(2).hex()}-{hex(int(time() * 1000))[2:]}')`: HTML-страница с новым `chat_id`.

**Как работает функция**:
1. Генерирует новый уникальный `chat_id`, используя `urandom` для создания случайных шестнадцатеричных чисел и `time` для получения текущего времени в миллисекундах.
2. Отображает HTML-шаблон `index.html`, передавая сгенерированный `chat_id` в качестве параметра.

**Примеры**:
```python
# Пример вызова функции _index
_index()
```

### `_assets`

```python
def _assets(self, folder: str, file: str):
    """
    Отправляет статические ресурсы (например, файлы CSS, JavaScript) из указанной папки.

    Args:
        folder (str): Папка, содержащая статические ресурсы.
        file (str): Имя файла ресурса.

    Returns:
        send_file(f"./../client/{folder}/{file}", as_attachment=False): Статический ресурс, если найден.
        "File not found", 404: Сообщение об ошибке и код состояния 404, если файл не найден.
    """
```

**Назначение**: Отправка статических ресурсов, таких как файлы CSS и JavaScript, из указанной папки.

**Параметры**:
- `folder` (str): Имя папки, содержащей статические ресурсы.
- `file` (str): Имя запрашиваемого файла.

**Возвращает**:
- `send_file(f"./../client/{folder}/{file}", as_attachment=False)`: Статический ресурс, если он найден.
- `"File not found", 404`: Сообщение об ошибке и код состояния 404, если файл не найден.

**Как работает функция**:
1. Пытается отправить запрошенный статический ресурс, используя `send_file` из Flask. Путь к файлу формируется как `./../client/{folder}/{file}`.
2. Если файл не найден, функция перехватывает исключение и возвращает сообщение об ошибке "File not found" с кодом состояния 404.

**Примеры**:
```python
# Пример вызова функции _assets для получения файла CSS
_assets("css", "style.css")

# Пример вызова функции _assets для получения файла JavaScript
_assets("js", "script.js")
```