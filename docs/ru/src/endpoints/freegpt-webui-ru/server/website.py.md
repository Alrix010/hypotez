# Модуль для управления веб-сайтом

## Обзор

Модуль `website.py` отвечает за настройку маршрутов и обработку запросов для веб-сайта. Он использует Flask для маршрутизации и рендеринга шаблонов.

## Подробнее

Этот модуль определяет класс `Website`, который управляет маршрутами и отображением веб-страниц, включая главную страницу, страницу чата и статические ресурсы (assets). Он интегрирован с Flask для обработки HTTP-запросов и рендеринга HTML-шаблонов.

## Классы

### `Website`

**Описание**: Класс `Website` управляет маршрутами и отображением веб-страниц.

**Атрибуты**:
- `app`: Объект Flask-приложения.
- `routes` (dict): Словарь, содержащий маршруты веб-сайта и соответствующие им функции и методы.

**Методы**:
- `__init__(self, app)`: Инициализирует экземпляр класса `Website`, принимает объект Flask-приложения в качестве аргумента.
- `_chat(self, conversation_id)`: Обрабатывает запросы к странице чата с определенным `conversation_id`.
- `_index(self)`: Обрабатывает запросы к главной странице, генерируя уникальный `chat_id`.
- `_assets(self, folder: str, file: str)`: Обрабатывает запросы к статическим ресурсам, таким как файлы CSS и JavaScript.

#### `__init__`

```python
def __init__(self, app) -> None:
    """Инициализирует класс Website.

    Args:
        app: Объект Flask-приложения.
    """
```

- **Назначение**: Инициализирует класс `Website` и устанавливает Flask-приложение, а также определяет маршруты веб-сайта.
- **Параметры**:
    - `app`: Объект Flask-приложения, который будет использоваться для маршрутизации.
- **Как работает функция**:
    - Присваивает переданное Flask-приложение атрибуту `self.app`.
    - Инициализирует атрибут `self.routes` словарем, содержащим маршруты веб-сайта, функции для обработки этих маршрутов и разрешенные HTTP-методы.
#### `_chat`

```python
def _chat(self, conversation_id):
    """Обрабатывает запросы к странице чата с определенным `conversation_id`.

    Args:
        conversation_id: Идентификатор чата.

    Returns:
        Response: Возвращает результат рендеринга шаблона 'index.html' с переданным `chat_id` или перенаправление на главную страницу, если `conversation_id` не соответствует формату.
    """
```

- **Назначение**: Обрабатывает запросы к странице чата с определенным `conversation_id`.
- **Параметры**:
    - `conversation_id`: Идентификатор чата, который должен содержать символ "-".
- **Возвращает**:
    - `render_template`: Если `conversation_id` содержит "-", функция возвращает отрендеренный HTML-шаблон "index.html" с переменной `chat_id`, установленной в `conversation_id`.
    - `redirect`: Если `conversation_id` не содержит "-", функция перенаправляет пользователя на страницу "/chat".
- **Как работает функция**:
    - Проверяет, содержит ли `conversation_id` символ "-".
    - Если символ отсутствует, перенаправляет пользователя на главную страницу ("/chat").
    - Если символ присутствует, рендерит шаблон "index.html" с переданным `conversation_id`.

#### `_index`

```python
def _index(self):
    """Обрабатывает запросы к главной странице, генерируя уникальный `chat_id`.

    Returns:
        Response: Возвращает результат рендеринга шаблона 'index.html' с автоматически сгенерированным `chat_id`.
    """
```

- **Назначение**: Обрабатывает запросы к главной странице, генерируя уникальный `chat_id`.
- **Возвращает**:
    - `render_template`: Возвращает отрендеренный HTML-шаблон "index.html" с автоматически сгенерированным `chat_id`.
- **Как работает функция**:
    - Генерирует случайный `chat_id` путем объединения нескольких случайных шестнадцатеричных чисел и текущего времени в миллисекундах.
    - Рендерит шаблон "index.html" с переданным сгенерированным `chat_id`.

#### `_assets`

```python
def _assets(self, folder: str, file: str):
    """Обрабатывает запросы к статическим ресурсам (assets).

    Args:
        folder (str): Имя папки, содержащей запрошенный файл.
        file (str): Имя запрошенного файла.

    Returns:
        Response: Отправляет запрошенный файл или возвращает сообщение об ошибке, если файл не найден.

    Raises:
        FileNotFoundError: Если файл не найден.
    """
```

- **Назначение**: Обрабатывает запросы к статическим ресурсам, таким как файлы CSS и JavaScript.
- **Параметры**:
    - `folder` (str): Имя папки, содержащей запрошенный файл.
    - `file` (str): Имя запрошенного файла.
- **Возвращает**:
    - `send_file`: Если файл найден, функция отправляет запрошенный файл.
    - Сообщение об ошибке: Если файл не найден, функция возвращает сообщение "File not found" и код состояния 404.
- **Как работает функция**:
    - Пытается отправить запрошенный файл из папки "./../client/{folder}/{file}".
    - Если файл найден, он отправляется с помощью функции `send_file`.
    - Если файл не найден, возвращается сообщение об ошибке "File not found" и код состояния 404.

## Примеры

```python
# Пример инициализации класса Website
from flask import Flask

app = Flask(__name__)
website = Website(app)
```
```python
# Пример обработки запроса к главной странице
def index_view():
    return website._index()
```
```python
# Пример обработки запроса к странице чата
def chat_view(conversation_id):
    return website._chat(conversation_id)
```
```python
# Пример обработки запроса к статическому ресурсу
def assets_view(folder, file):
    return website._assets(folder, file)