# Документация для модуля `src.logger`

## Обзор

Модуль `src.logger` предоставляет гибкую систему логирования, поддерживающую логирование в консоль, файлы и в формате JSON. Он использует шаблон проектирования Singleton, чтобы обеспечить использование единственного экземпляра логгера во всем приложении. Логгер поддерживает различные уровни логирования (например, `INFO`, `ERROR`, `DEBUG`) и включает цветное отображение для вывода в консоль. Также доступны настройки форматов вывода и управление логированием в различные файлы.

## Подробнее

Модуль предназначен для централизованного и удобного логирования событий в приложении. Он позволяет записывать сообщения разного уровня важности в различные источники, такие как консоль и файлы, с возможностью настройки форматов и цветов. Использование шаблона Singleton гарантирует, что все части приложения будут использовать один и тот же экземпляр логгера, что упрощает управление и конфигурирование логирования.

## Классы

### `SingletonMeta`

**Описание**: Метакласс, реализующий шаблон Singleton для логгера.

**Принцип работы**:
Метакласс `SingletonMeta` гарантирует, что у класса будет только один экземпляр. При попытке создать новый экземпляр возвращается существующий.

### `JsonFormatter`

**Описание**: Кастомный форматтер для вывода логов в формате JSON.

**Принцип работы**:
Форматирует логи в JSON формат.

### `Logger`

**Описание**: Основной класс логгера, поддерживающий логирование в консоль, файлы и в формате JSON.

**Атрибуты**:

- `console_logger`: Логгер для вывода в консоль.
- `info_file_logger`: Логгер для записи информационных сообщений в файл.
- `debug_file_logger`: Логгер для записи отладочных сообщений в файл.
- `errors_file_logger`: Логгер для записи сообщений об ошибках в файл.
- `json_file_logger`: Логгер для записи сообщений в формате JSON в файл.

**Методы**:

- `__init__`: Инициализирует экземпляр класса Logger с плейсхолдерами для различных типов логгеров (консоль, файлы и JSON).
- `_configure_logger`: Настраивает и возвращает экземпляр логгера.
- `initialize_loggers`: Инициализирует логгеры для логирования в консоль и файлы (информация, отладка, ошибки и JSON).
- `log`: Логирует сообщение на указанном уровне (например, `INFO`, `DEBUG`, `ERROR`) с возможным исключением и цветовым форматированием.
- `info`: Логирует информационное сообщение.
- `success`: Логирует сообщение об успешной операции.
- `warning`: Логирует предупреждение.
- `debug`: Логирует сообщение для отладки.
- `error`: Логирует сообщение об ошибке.
- `critical`: Логирует критическое сообщение.

## Функции

### `_configure_logger`

```python
def _configure_logger(name: str, log_path: str, level: Optional[int] = logging.DEBUG, formatter: Optional[logging.Formatter] = None, mode: Optional[str] = 'a') -> logging.Logger:
    """
    Настраивает и возвращает экземпляр логгера.

    Args:
        name (str): Имя логгера.
        log_path (str): Путь к файлу логов.
        level (Optional[int], optional): Уровень логирования, например, `logging.DEBUG`. По умолчанию `logging.DEBUG`.
        formatter (Optional[logging.Formatter], optional): Кастомный форматтер (опционально). По умолчанию `None`.
        mode (Optional[str], optional): Режим работы с файлом, например, `'a'` для добавления. По умолчанию `'a'`.

    Returns:
        logging.Logger: Настроенный экземпляр `logging.Logger`.

    """
    ...
```

**Назначение**: Настраивает и возвращает экземпляр логгера с заданными параметрами.

**Параметры**:

- `name` (str): Имя логгера.
- `log_path` (str): Путь к файлу логов.
- `level` (Optional[int], optional): Уровень логирования, например, `logging.DEBUG`. По умолчанию `logging.DEBUG`.
- `formatter` (Optional[logging.Formatter], optional): Кастомный форматтер (опционально). По умолчанию `None`.
- `mode` (Optional[str], optional): Режим работы с файлом, например, `'a'` для добавления. По умолчанию `'a'`.

**Возвращает**:

- `logging.Logger`: Настроенный экземпляр `logging.Logger`.

**Как работает функция**:

- Функция создает новый экземпляр логгера с указанным именем.
- Устанавливает уровень логирования.
- Создает обработчик файла, который записывает логи в указанный файл в заданном режиме (например, добавление).
- Если предоставлен форматтер, устанавливает его для обработчика.
- Добавляет обработчик к логгеру.
- Возвращает настроенный экземпляр логгера.

**Примеры**:

```python
import logging
from src.logger.logger import Logger

# Пример настройки логгера для записи в файл debug.log
logger_instance = Logger()
debug_logger = logger_instance._configure_logger(name='debug_logger', log_path='debug.log', level=logging.DEBUG)

# Пример настройки логгера с кастомным форматтером
formatter = logging.Formatter('%(asctime)s - %(levelname)s - %(message)s')
error_logger = logger_instance._configure_logger(name='error_logger', log_path='error.log', level=logging.ERROR, formatter=formatter)
```

### `initialize_loggers`

```python
def initialize_loggers(info_log_path: Optional[str] = '', debug_log_path: Optional[str] = '', errors_log_path: Optional[str] = '', json_log_path: Optional[str] = '') -> None:
    """
    Инициализирует логгеры для логирования в консоль и файлы (информация, отладка, ошибки и JSON).

    Args:
        info_log_path (Optional[str], optional): Путь к файлу логов информации (опционально). По умолчанию ''.
        debug_log_path (Optional[str], optional): Путь к файлу логов отладки (опционально). По умолчанию ''.
        errors_log_path (Optional[str], optional): Путь к файлу логов ошибок (опционально). По умолчанию ''.
        json_log_path (Optional[str], optional): Путь к файлу логов в формате JSON (опционально). По умолчанию ''.

    """
    ...
```

**Назначение**: Инициализирует логгеры для логирования в консоль и файлы (информация, отладка, ошибки и JSON).

**Параметры**:

- `info_log_path` (Optional[str], optional): Путь к файлу логов информации (опционально). По умолчанию ''.
- `debug_log_path` (Optional[str], optional): Путь к файлу логов отладки (опционально). По умолчанию ''.
- `errors_log_path` (Optional[str], optional): Путь к файлу логов ошибок (опционально). По умолчанию ''.
- `json_log_path` (Optional[str], optional): Путь к файлу логов в формате JSON (опционально). По умолчанию ''.

**Как работает функция**:

- Функция инициализирует логгер для вывода в консоль, устанавливая уровень логирования `DEBUG`.
- Если указаны пути к файлам, настраивает и инициализирует файловые логгеры для записи информации, отладочных сообщений, ошибок и JSON.
- JSON-логгер использует кастомный форматтер `JsonFormatter` для записи сообщений в формате JSON.

**Примеры**:

```python
from src.logger.logger import Logger

# Пример инициализации логгеров с указанием путей к файлам
logger = Logger()
config = {
    'info_log_path': 'logs/info.log',
    'debug_log_path': 'logs/debug.log',
    'errors_log_path': 'logs/errors.log',
    'json_log_path': 'logs/log.json'
}
logger.initialize_loggers(**config)

# Пример инициализации логгеров без записи в файлы (только консоль)
logger = Logger()
logger.initialize_loggers()
```

### `log`

```python
def log(level, message, ex=None, exc_info=False, color=None):
    """
    Логирует сообщение на указанном уровне (например, `INFO`, `DEBUG`, `ERROR`) с возможным исключением и цветовым форматированием.

    Args:
        level: Уровень логирования (например, `logging.INFO`, `logging.DEBUG`).
        message: Логируемое сообщение.
        ex: Исключение для логирования (опционально).
        exc_info: Включать информацию об исключении (значение по умолчанию — `False`).
        color: Кортеж цветов текста и фона для консольного вывода (опционально).

    """
    ...
```

**Назначение**: Логирует сообщение на указанном уровне с возможным исключением и цветовым форматированием.

**Параметры**:

- `level`: Уровень логирования (например, `logging.INFO`, `logging.DEBUG`).
- `message`: Логируемое сообщение.
- `ex`: Исключение для логирования (опционально).
- `exc_info`: Включать информацию об исключении (значение по умолчанию — `False`).
- `color`: Кортеж цветов текста и фона для консольного вывода (опционально).

**Как работает функция**:

- Функция логирует сообщение на указанном уровне, используя соответствующие логгеры (консольный и файловые).
- Если предоставлено исключение, добавляет его к сообщению.
- Если `exc_info` установлен в `True`, включает информацию об исключении в лог.
- Если указаны цвета, применяет их к консольному выводу.

**Примеры**:

```python
import logging
import colorama
from src.logger.logger import Logger

# Пример логирования информационного сообщения
logger = Logger()
logger.initialize_loggers()
logger.log(logging.INFO, 'Это информационное сообщение')

# Пример логирования сообщения об ошибке с исключением
try:
    raise ValueError('Неверное значение')
except ValueError as ex:
    logger.log(logging.ERROR, 'Произошла ошибка', ex=ex, exc_info=True)

# Пример логирования сообщения с указанием цветов
logger.log(logging.INFO, 'Это сообщение будет зеленым', color=(colorama.Fore.GREEN, colorama.Back.BLACK))
```

## Методы класса `Logger`

### `info`

```python
def info(message, color=None):
    """
    Логирует информационное сообщение.

    Args:
        message: Логируемое сообщение.
        color: Кортеж цветов текста и фона для консольного вывода (опционально).
    """
    ...
```

**Назначение**: Логирует информационное сообщение.

**Параметры**:

- `message`: Логируемое сообщение.
- `color`: Кортеж цветов текста и фона для консольного вывода (опционально).

**Как работает функция**:

- Функция вызывает метод `log` с уровнем `logging.INFO` и переданным сообщением и цветом.

### `success`

```python
def success(message, color=None):
    """
    Логирует сообщение об успешной операции.

    Args:
        message: Логируемое сообщение.
        color: Кортеж цветов текста и фона для консольного вывода (опционально).
    """
    ...
```

**Назначение**: Логирует сообщение об успешной операции.

**Параметры**:

- `message`: Логируемое сообщение.
- `color`: Кортеж цветов текста и фона для консольного вывода (опционально).

**Как работает функция**:

- Функция вызывает метод `log` с уровнем `logging.INFO` и переданным сообщением и цветом.

### `warning`

```python
def warning(message, color=None):
    """
    Логирует предупреждение.

    Args:
        message: Логируемое сообщение.
        color: Кортеж цветов текста и фона для консольного вывода (опционально).
    """
    ...
```

**Назначение**: Логирует предупреждение.

**Параметры**:

- `message`: Логируемое сообщение.
- `color`: Кортеж цветов текста и фона для консольного вывода (опционально).

**Как работает функция**:

- Функция вызывает метод `log` с уровнем `logging.WARNING` и переданным сообщением и цветом.

### `debug`

```python
def debug(message, color=None):
    """
    Логирует сообщение для отладки.

    Args:
        message: Логируемое сообщение.
        color: Кортеж цветов текста и фона для консольного вывода (опционально).
    """
    ...
```

**Назначение**: Логирует сообщение для отладки.

**Параметры**:

- `message`: Логируемое сообщение.
- `color`: Кортеж цветов текста и фона для консольного вывода (опционально).

**Как работает функция**:

- Функция вызывает метод `log` с уровнем `logging.DEBUG` и переданным сообщением и цветом.

### `error`

```python
def error(message, ex=None, exc_info=False, color=None):
    """
    Логирует сообщение об ошибке.

    Args:
        message: Логируемое сообщение.
        ex: Исключение для логирования (опционально).
        exc_info: Включать информацию об исключении (значение по умолчанию — `False`).
        color: Кортеж цветов текста и фона для консольного вывода (опционально).
    """
    ...
```

**Назначение**: Логирует сообщение об ошибке.

**Параметры**:

- `message`: Логируемое сообщение.
- `ex`: Исключение для логирования (опционально).
- `exc_info`: Включать информацию об исключении (значение по умолчанию — `False`).
- `color`: Кортеж цветов текста и фона для консольного вывода (опционально).

**Как работает функция**:

- Функция вызывает метод `log` с уровнем `logging.ERROR` и переданным сообщением, исключением, информацией об исключении и цветом.

### `critical`

```python
def critical(message, color=None):
    """
    Логирует критическое сообщение.

    Args:
        message: Логируемое сообщение.
        color: Кортеж цветов текста и фона для консольного вывода (опционально).
    """
    ...
```

**Назначение**: Логирует критическое сообщение.

**Параметры**:

- `message`: Логируемое сообщение.
- `color`: Кортеж цветов текста и фона для консольного вывода (опционально).

**Как работает функция**:

- Функция вызывает метод `log` с уровнем `logging.CRITICAL` и переданным сообщением и цветом.

## Параметры логгера

Класс `Logger` принимает несколько опциональных параметров для настройки поведения логирования.

- **Уровень**: Контролирует, какие сообщения будут записаны. Основные уровни:
  - `logging.DEBUG`: Подробная информация для диагностики.
  - `logging.INFO`: Общая информация, например, успешные операции.
  - `logging.WARNING`: Предупреждения, не требующие немедленного действия.
  - `logging.ERROR`: Сообщения об ошибках.
  - `logging.CRITICAL`: Критические ошибки, требующие немедленного внимания.

- **Форматтер**: Определяет формат сообщений. По умолчанию используется `'%(asctime)s - %(levelname)s - %(message)s'`. Можно задать кастомный форматтер, например для JSON.

- **Цвета**: Задают цвет текста и фона в консоли. Цвета указываются кортежем:
  - **Цвет текста**: Например, `colorama.Fore.RED`.
  - **Цвет фона**: Например, `colorama.Back.WHITE`.

## Конфигурация для логирования в файл (`config`)

Для записи сообщений в файл можно указать пути в конфигурации.

```python
config = {
    'info_log_path': 'logs/info.log',
    'debug_log_path': 'logs/debug.log',
    'errors_log_path': 'logs/errors.log',
    'json_log_path': 'logs/log.json'
}
```

## Примеры использования

#### 1. Инициализация логгера:

```python
logger = Logger()
config = {
    'info_log_path': 'logs/info.log',
    'debug_log_path': 'logs/debug.log',
    'errors_log_path': 'logs/errors.log',
    'json_log_path': 'logs/log.json'
}
logger.initialize_loggers(**config)
```

#### 2. Логирование сообщений:

```python
logger.info('Это информационное сообщение')
logger.success('Это сообщение об успешной операции')
logger.warning('Это предупреждение')
logger.debug('Это сообщение для отладки')
logger.error('Это сообщение об ошибке')
logger.critical('Это критическое сообщение')
```

#### 3. Настройка цветов:

```python
import colorama
from src.logger.logger import Logger
logger: Logger = Logger()
config = {
    'info_log_path': 'logs/info.log',
    'debug_log_path': 'logs/debug.log',
    'errors_log_path': 'logs/errors.log',
    'json_log_path': 'logs/log.json'
}
logger.initialize_loggers(**config)
logger.info('Это сообщение будет зеленым', color=(colorama.Fore.GREEN, colorama.Back.BLACK))
logger.error('Это сообщение с красным фоном', color=(colorama.Fore.WHITE, colorama.Back.RED))
```