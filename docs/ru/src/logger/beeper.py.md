# Модуль src.logger.beeper

## Обзор

Модуль `src.logger.beeper` предназначен для генерации звуковых сигналов различных уровней, чтобы визуально уведомлять пользователя о событиях, происходящих в системе. Он использует библиотеку `winsound` для воспроизведения звуков на платформе Windows и предоставляет функциональность для настройки частоты и длительности звуковых сигналов, а также возможность включения "тихого режима", в котором звуковые уведомления отключаются.

## Подробнее

Модуль определяет перечисление `BeepLevel`, которое представляет различные типы событий (например, `SUCCESS`, `INFO`, `WARNING`, `ERROR`) и соответствующие им мелодии. Класс `Beeper` предоставляет статический метод `beep` для воспроизведения звуковых сигналов, а также декоратор `silent_mode` для управления режимом "беззвучия".

## Классы

### `BeepLevel`

**Описание**: Перечисление, представляющее различные уровни событий, которым соответствуют разные мелодии.

**Атрибуты**:

-   `SUCCESS`: Мелодия для успешных событий.
-   `INFO`: Мелодия для информационных сообщений.
-   `INFO_LONG`: Длинная мелодия для информационных сообщений.
-   `ATTENTION`: Мелодия для привлечения внимания.
-   `WARNING`: Мелодия для предупреждений.
-   `DEBUG`: Мелодия для отладочных сообщений.
-   `ERROR`: Мелодия для ошибок.
-   `LONG_ERROR`: Длинная мелодия для ошибок.
-   `CRITICAL`: Мелодия для критических ошибок.
-   `BELL`: Мелодия звонка.

### `BeepHandler`

**Описание**: Класс обработчика звуковых сигналов.

**Методы**:

-   `emit(self, record)`: Воспроизводит звук в зависимости от уровня записи лога.
-   `beep(self, level: BeepLevel | str = BeepLevel.INFO, frequency: int = 400, duration: int = 1000)`: Вызывает статический метод `Beeper.beep` для воспроизведения звукового сигнала.

### `Beeper`

**Описание**: Класс для управления звуковыми сигналами.

**Атрибуты**:

-   `silent` (bool): Флаг, указывающий, включен ли "тихий режим".

**Методы**:

#### `beep`

```python
@staticmethod
@silent_mode
async def beep(level: BeepLevel | str = BeepLevel.INFO, frequency: int = 400, duration: int = 1000) -> None:
    """
    Звуковой сигнал оповещения.

    Args:
        level (BeepLevel | str): Тип события: `info`, `attention`, `warning`, `debug`, `error`, `long_error`, `critical`, `bell` или `Beep.SUCCESS`, `Beep.INFO`, `Beep.ATTENTION`, `Beep.WARNING`, `Beep.DEBUG`, `Beep.ERROR`, `Beep.LONG_ERROR`, `Beep.CRITICAL`, `Beep.BELL`.
        frequency (int): Частота сигнала в значениях от 37 до 32000.
        duration (int): Длительность сигнала.

    Raises:
        Exception: Если происходит ошибка при воспроизведении звука.
    """
```

**Назначение**: Воспроизводит звуковой сигнал оповещения.

**Как работает функция**:

1.  Функция принимает уровень сигнала (`level`), частоту (`frequency`) и длительность (`duration`) в качестве параметров.
2.  Если `level` является строкой, функция преобразует ее в соответствующий элемент перечисления `BeepLevel`.
3.  Функция извлекает мелодию, соответствующую заданному уровню, из перечисления `BeepLevel`.
4.  Функция итерируется по нотам в мелодии и воспроизводит каждую ноту с заданной частотой и длительностью с помощью функции `winsound.Beep`.
5.  Если в процессе воспроизведения возникает ошибка, функция выводит сообщение об ошибке.

**Примеры**:

```python
# Воспроизведение звукового сигнала уровня INFO
await Beeper.beep(level=BeepLevel.INFO)

# Воспроизведение звукового сигнала уровня WARNING с заданной частотой и длительностью
await Beeper.beep(level=BeepLevel.WARNING, frequency=800, duration=500)

# Воспроизведение звукового сигнала уровня ERROR
await Beeper.beep(level="error")
```

## Функции

### `silent_mode`

```python
def silent_mode(func):
    """
    Функция-декоратор для управления режимом "беззвучия".

    Args:
        func: Функция для декорирования.

    Returns:
        Обернутая функция, добавляющая проверку режима "беззвучия".
    """
    def wrapper(*args, **kwargs):
        """
        Внутренняя функция-обертка для проверки режима "беззвучия" перед выполнением функции.

        Args:
            args: Позиционные аргументы, переданные в оборачиваемую функцию.
            kwargs: Именованные аргументы, переданные в оборачиваемую функцию.

        Returns:
            Результат выполнения оборачиваемой функции или None, если режим "беззвучия" включен.
        """
        if Beeper.silent:
            print("Silent mode is enabled. Skipping beep.")
            return
        return func(*args, **kwargs)
    return wrapper
```

**Назначение**: Функция-декоратор для управления режимом "беззвучия".

**Как работает функция**:

1.  Функция `silent_mode` принимает функцию `func` в качестве аргумента и возвращает новую функцию `wrapper`.
2.  Функция `wrapper` проверяет, включен ли "тихий режим", обращаясь к атрибуту `silent` класса `Beeper`.
3.  Если "тихий режим" включен, функция `wrapper` выводит сообщение о том, что воспроизведение звука пропущено, и возвращает `None`.
4.  Если "тихий режим" выключен, функция `wrapper` вызывает функцию `func` с переданными аргументами и возвращает результат ее выполнения.

**Примеры**:

```python
@silent_mode
async def beep(level: BeepLevel | str = BeepLevel.INFO, frequency: int = 400, duration: int = 1000) -> None:
    # ... код функции beep ...

# Включение "тихого режима"
Beeper.silent = True

# Вызов функции beep не приведет к воспроизведению звука
await beep(level=BeepLevel.INFO)

# Выключение "тихого режима"
Beeper.silent = False

# Вызов функции beep приведет к воспроизведению звука
await beep(level=BeepLevel.INFO)