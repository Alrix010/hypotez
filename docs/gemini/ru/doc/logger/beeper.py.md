# Модуль для воспроизведения звуковых сигналов (Beeper)

## Обзор

Этот модуль предоставляет функциональность для воспроизведения звуковых сигналов различных типов, соответствующих определенным событиям в системе. Он использует библиотеку `winsound` для воспроизведения звуков на Windows и позволяет настраивать частоту и длительность сигнала. Модуль также поддерживает режим "беззвучия", в котором воспроизведение звуков отключается.

## Подробней

Модуль предназначен для визуального и звукового оповещения о различных событиях, происходящих в системе, таких как успешное выполнение операции, предупреждение об ошибке или критическая ситуация. Это может быть полезно для мониторинга работы системы и быстрого реагирования на возникающие проблемы.

## Классы

### `BeepLevel`

**Описание**: Класс-перечислитель типов событий, которым соответствуют разные мелодии.

```python
class BeepLevel(Enum):
    """   Класс перечислитель типов событий
    @details разным событиям соответствуют разные мелодии
    Уровни событий
    - SUCCESS
    - INFO
    - ATTENTION
    - WARNING
    - DEBUG
    - ERROR
    - LONG_ERROR
    - CRITICAL
    - BELL
    """
    ...
```

**Атрибуты**:

-   `SUCCESS` (list): Мелодия для успешного выполнения операции.
-   `INFO` (list): Мелодия для информационного сообщения.
-   `INFO_LONG` (list): Длинная мелодия для информационного сообщения.
-   `ATTENTION` (list): Мелодия для привлечения внимания.
-   `WARNING` (list): Мелодия для предупреждения.
-   `DEBUG` (list): Мелодия для отладочного сообщения.
-   `ERROR` (list): Мелодия для ошибки.
-   `LONG_ERROR` (list): Длинная мелодия для ошибки.
-   `CRITICAL` (list): Мелодия для критической ошибки.
-   `BELL` (list): Мелодия звонка.

### `BeepHandler`

**Описание**: Обработчик для воспроизведения звуковых сигналов на основе уровня логирования.

**Методы**:

-   `emit(self, record)`: Воспроизводит звуковой сигнал в зависимости от уровня логирования.
-   `beep(self, level: BeepLevel | str = BeepLevel.INFO, frequency: int = 400, duration: int = 1000)`: Воспроизводит звуковой сигнал с указанной частотой и длительностью.

#### `emit`

**Назначение**: Воспроизводит звуковой сигнал в зависимости от уровня логирования.

```python
def emit(self, record):
    ...
```

**Параметры**:

-   `record` (dict): Запись лога, содержащая информацию об уровне события.

**Как работает функция**:

1.  Извлекает уровень события из записи лога (`record["level"].name`).
2.  В зависимости от уровня события воспроизводит соответствующий звуковой сигнал с использованием метода `play_sound`.
3.  Если возникает ошибка при воспроизведении звука, выводит сообщение об ошибке.

#### `beep`

**Назначение**: Воспроизводит звуковой сигнал с указанной частотой и длительностью.

```python
def beep(self, level: BeepLevel | str = BeepLevel.INFO, frequency: int = 400, duration: int = 1000):
    ...
```

**Параметры**:

-   `level` (BeepLevel | str): Уровень события или название мелодии. По умолчанию `BeepLevel.INFO`.
-   `frequency` (int): Частота сигнала в Гц. По умолчанию 400.
-   `duration` (int): Длительность сигнала в миллисекундах. По умолчанию 1000.

**Как работает функция**:

1.  Вызывает статический метод `Beeper.beep` для воспроизведения звукового сигнала.

### `Beeper`

**Описание**: Класс для управления звуковыми сигналами.

**Атрибуты**:

-   `silent` (bool): Флаг, указывающий, включен ли режим "беззвучия". По умолчанию `False`.

**Методы**:

-   `beep(level: BeepLevel | str = BeepLevel.INFO, frequency: int = 400, duration: int = 1000)`: Воспроизводит звуковой сигнал оповещения.

#### `beep`

**Назначение**: Воспроизводит звуковой сигнал оповещения.

```python
@staticmethod
@silent_mode
async def beep(level: BeepLevel | str = BeepLevel.INFO, frequency: int = 400, duration: int = 1000) -> None:
    ...
```

**Параметры**:

-   `level` (BeepLevel | str): Уровень события или название мелодии. По умолчанию `BeepLevel.INFO`.
-   `frequency` (int): Частота сигнала в Гц. По умолчанию 400.
-   `duration` (int): Длительность сигнала в миллисекундах. По умолчанию 1000.

**Как работает функция**:

1.  Применяет декоратор `@silent_mode`, который проверяет, включен ли режим "беззвучия". Если режим включен, функция не выполняется.
2.  В зависимости от значения параметра `level` выбирает соответствующую мелодию из перечисления `BeepLevel`.
3.  Перебирает ноты в мелодии и воспроизводит каждую ноту с указанной частотой и длительностью с использованием функции `winsound.Beep`.
4.  В случае возникновения ошибки при воспроизведении звука, выводит сообщение об ошибке.

## Функции

### `silent_mode`

**Назначение**: Декоратор для управления режимом "беззвучия".

```python
def silent_mode(func):
    ...
```

**Параметры**:

-   `func` (function): Функция, которую нужно декорировать.

**Возвращает**:

-   `wrapper` (function): Обернутая функция, добавляющая проверку режима "беззвучия".

**Как работает функция**:

1.  Принимает функцию в качестве аргумента.
2.  Создает внутреннюю функцию `wrapper`, которая вызывается вместо исходной функции.
3.  Внутри `wrapper` проверяет, включен ли режим "беззвучия" (`Beeper.silent`).
4.  Если режим "беззвучия" включен, выводит сообщение о пропуске воспроизведения звука и завершает выполнение функции.
5.  Если режим "беззвучия" выключен, вызывает исходную функцию с переданными аргументами.
6.  Возвращает обернутую функцию `wrapper`.

## Переменные модуля

-   `note_freq` (dict): Словарь, содержащий соответствия между названиями нот и их частотами.

## Пример использования

Чтобы воспроизвести звуковой сигнал, необходимо создать экземпляр класса `BeepHandler` и вызвать метод `beep` с указанием уровня события:

```python
from src.logger.beeper import BeepHandler, BeepLevel

beeper = BeepHandler()
beeper.beep(BeepLevel.ERROR)
```

Чтобы включить режим "беззвучия", необходимо установить атрибут `silent` класса `Beeper` в значение `True`:

```python
from src.logger.beeper import Beeper

Beeper.silent = True
```