# Модуль логирования (src.logger)

## Обзор

Модуль `src.logger` предоставляет гибкую систему логирования, поддерживающую вывод в консоль, файлы и JSON формат. Он использует паттерн Singleton для обеспечения единственного экземпляра логгера в приложении. Поддерживаются различные уровни логирования (например, `INFO`, `ERROR`, `DEBUG`), а также вывод с цветовым оформлением для консольных логов. Можно настроить форматы вывода и управлять логированием в разные файлы.

## Подробней

Модуль `src.logger` предоставляет централизованную систему логирования для всего проекта, упрощая процесс отладки, мониторинга и анализа работы приложения. Он предлагает удобный интерфейс для записи сообщений разного уровня важности в различные источники, обеспечивая гибкость и настраиваемость.

## Классы

### `SingletonMeta`

**Описание**: Метакласс, реализующий паттерн Singleton для класса `Logger`.

**Атрибуты**:

-   `_instances` (dict): Приватный словарь для хранения экземпляров классов, использующих этот метакласс.
-   `_lock` (threading.Lock): Используется для обеспечения потокобезопасности при создании экземпляров.

**Методы**:

-   `__call__(cls, *args, **kwargs)`: Метод, вызываемый при создании экземпляра класса. Обеспечивает, что будет создан только один экземпляр класса.

### `JsonFormatter`

**Описание**: Пользовательский форматтер для логирования в формате JSON.

**Наследует**:

-   `logging.Formatter`: Базовый класс для форматтеров логов в Python.

**Методы**:

-   `format(self, record)`: Форматирует запись лога в JSON.

### `Logger`

**Описание**: Класс логгера, реализующий паттерн Singleton и поддерживающий логирование в консоль, файлы и в формате JSON.

**Наследует**:

-   `SingletonMeta`: Для реализации паттерна Singleton.

**Атрибуты**:

-   `log_files_path` (Path): Путь к директории, где хранятся файлы логов.
-   `info_log_path` (Path): Путь к файлу для информационных логов.
-   `debug_log_path` (Path): Путь к файлу для отладочных логов.
-   `errors_log_path` (Path): Путь к файлу для логов ошибок.
-   `json_log_path` (Path): Путь к файлу для логов в формате JSON.
-   `logger_console` (logging.Logger): Объект логгера для вывода в консоль.
-   `logger_file_info` (logging.Logger): Объект логгера для записи информационных сообщений в файл.
-   `logger_file_debug` (logging.Logger): Объект логгера для записи отладочных сообщений в файл.
-   `logger_file_errors` (logging.Logger): Объект логгера для записи сообщений об ошибках в файл.
-   `logger_file_json` (logging.Logger): Объект логгера для записи логов в формате JSON в файл.

**Методы**:

-   `__init__(self, info_log_path: Optional[str] = None, debug_log_path: Optional[str] = None, errors_log_path: Optional[str] = None, json_log_path: Optional[str] = None)`: Инициализирует объект `Logger` и настраивает обработчики для логирования в консоль и файлы.
-   `_format_message(self, message, ex=None, color: Optional[Tuple[str, str]] = None, level=None)`: Форматирует сообщение лога, добавляя информацию об исключении и цвет (если указаны).
-   `_ex_full_info(self, ex)`: Извлекает полную информацию об исключении (имя файла, функции, номер строки).
-   `log(self, level, message, ex=None, exc_info=False, color: Optional[Tuple[str, str]] = None)`: Общий метод для логирования сообщений на указанном уровне.
-   `info(self, message, ex=None, exc_info=False, text_color: str = "green", bg_color: str = "")`: Логирует информационное сообщение.
-   `success(self, message, ex=None, exc_info=False, text_color: str = "yellow", bg_color: str = "")`: Логирует сообщение об успешном выполнении операции.
-   `warning(self, message, ex=None, exc_info=False, text_color: str = "light_red", bg_color: str = "")`: Логирует сообщение-предупреждение.
-   `debug(self, message, ex=None, exc_info=True, text_color: str = "cyan", bg_color: str = "")`: Логирует отладочное сообщение.
-   `exception(self, message, ex=None, exc_info=True, text_color: str = "cyan", bg_color: str = "light_gray")`: Логирует сообщение об исключении.
-   `error(self, message, ex=None, exc_info=True, text_color: str = "red", bg_color: str = "")`: Логирует сообщение об ошибке.
-   `critical(self, message, ex=None, exc_info=True, text_color: str = "red", bg_color: str = "white")`: Логирует критическое сообщение.

## Переменные модуля

-   `TEXT_COLORS` (dict): Словарь, сопоставляющий названия цветов текста со значениями из `colorama.Fore`.
-   `BG_COLORS` (dict): Словарь, сопоставляющий названия цветов фона со значениями из `colorama.Back`.
-   `LOG_SYMBOLS` (dict): Словарь, сопоставляющий уровни логирования с символами Unicode.
-   `logger: Logger = Logger()`: Инициализированный экземпляр класса `Logger`, используемый для логирования в приложении.

## Конфигурация

Пути к файлам логов настраиваются через файл `src/config.json` в разделе `"path"` -> `"log"`. Пример:

```json
{
  "path": {
    "log": "logs"
  }
}
```

## Пример использования

```python
from src.logger.logger import logger

logger.info("Сообщение информации")
logger.warning("Сообщение предупреждения", text_color="yellow")
logger.error("Сообщение об ошибке", ex=Exception("Описание ошибки"), exc_info=True)
```

## Взаимосвязи с другими частями проекта

-   Модуль `src.logger.logger` предоставляет централизованный сервис логирования, который используется во всех частях проекта `hypotez`.
-   Он зависит от модуля `header` для определения корневого пути проекта.
-   Для вывода цветных логов в консоль используется библиотека `colorama`.
-   Настройки путей к файлам логов считываются из файла `src/config.json`.
-   Пользовательские исключения в других модулях должны логироваться с использованием `logger.error`.
-   Рекомендуется использовать этот модуль во всех частях проекта для обеспечения единообразного и управляемого логирования.