# Модуль для работы с XML (xml.py)

## Обзор

Этот модуль предоставляет функции для работы с XML, включая очистку от пустых элементов CDATA и сохранение XML в файл с отступами.

## Подробней

Модуль `src.utils.xml` предназначен для упрощения задач, связанных с обработкой XML-данных. Он предоставляет функции для очистки XML от пустых элементов и ненужных пробелов, а также для сохранения отформатированного XML в файл с отступами, что улучшает читаемость и упрощает отладку.

## Функции

### `clean_empty_cdata`

**Назначение**: Очищает пустые секции CDATA и лишние пробелы в XML-строке.

```python
def clean_empty_cdata(xml_string: str) -> str:
    """! Cleans empty CDATA sections and unnecessary whitespace in XML string.

    Args:
        xml_string (str): Raw XML content.

    Returns:
        str: Cleaned and formatted XML content.
    """
    ...
```

**Параметры**:

-   `xml_string` (str): Необработанное содержимое XML.

**Возвращает**:

-   `str`: Очищенное и отформатированное содержимое XML.

**Как работает функция**:

1.  Преобразует XML-строку в объект `ElementTree`.
2.  Определяет рекурсивную функцию `remove_empty_elements` для удаления пустых элементов из дерева XML.
3.  Удаляет пустые элементы, используя рекурсивный обход дерева.
4.  Преобразует очищенное дерево XML обратно в строку, используя кодировку UTF-8.
5.  Удаляет ненужные пробелы между тегами, используя регулярное выражение.
6.  Возвращает очищенную XML-строку.

### `save_xml`

**Назначение**: Сохраняет очищенные XML-данные из строки в файл с отступами.

```python
def save_xml(xml_string: str, file_path: str) -> None:
    """! Saves cleaned XML data from a string to a file with indentation.

    Args:
        xml_string (str): XML content as a string.
        file_path (str): Path to the output file.

    Returns:
        None
    """
    ...
```

**Параметры**:

-   `xml_string` (str): XML-контент в виде строки.
-   `file_path` (str): Путь к выходному файлу.

**Возвращает**:

-   `None`

**Как работает функция**:

1.  Очищает XML от пустых элементов, используя функцию `clean_empty_cdata`.
2.  Преобразует очищенную XML-строку в объект `ElementTree`.
3.  Преобразует дерево XML в строку с отступами, используя `minidom.parseString` и `toprettyxml`.
4.  Открывает файл для записи и записывает отформатированную XML-строку в файл.

## Переменные модуля

В данном модуле отсутствуют переменные, за исключением констант, определенных внутри функций (если бы они были).

## Пример использования

```python
from src.utils.xml import save_xml

xml_data = "<root><item>Value</item><item attr=\"test\">Another</item></root>"
save_xml(xml_data, "output.xml")
```

## Взаимосвязь с другими частями проекта

Этот модуль может использоваться другими модулями проекта `hypotez` для обработки XML-данных, например, для очистки и форматирования XML перед сохранением в файл или передачей по сети.