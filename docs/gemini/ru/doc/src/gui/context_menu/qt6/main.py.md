# Модуль для добавления/удаления элемента контекстного меню в Windows

## Обзор

Этот модуль предоставляет функции для добавления или удаления элемента контекстного меню под названием "hypo AI assistant" в контекстное меню для фона рабочего стола и папок в Windows Explorer. Он использует реестр Windows для достижения этой цели, с путями и логикой, реализованными для нацеливания на контекстное меню при щелчке правой кнопкой мыши на пустом пространстве (не на файлах или папках).

## Подробней

Модуль использует библиотеку `winreg` для взаимодействия с реестром Windows. Он создает новое значение в разделе `HKEY_CLASSES_ROOT\\Directory\\Background\\shell` для добавления пункта меню "hypo AI assistant" в контекстное меню.

**Как работает модуль:**

1. **Добавление элемента контекстного меню:**
   - Создает новый ключ реестра `hypo_AI_assistant` в разделе `HKEY_CLASSES_ROOT\\Directory\\Background\\shell`.
   - В этом ключе устанавливает значение по умолчанию как "hypo AI assistant".
   - Создает под-ключ `command` для указания действия, которое должно выполняться при выборе пункта меню.
   - В под-ключе `command` устанавливает значение как команду Python для запуска сценария `gui/context_menu/main.py`.
2. **Удаление элемента контекстного меню:**
   - Удаляет ключ реестра `hypo_AI_assistant` из раздела `HKEY_CLASSES_ROOT\\Directory\\Background\\shell`, что удаляет пункт меню из контекстного меню.

**Использование:**

- **Добавить пункт меню:** Вызовите функцию `add_context_menu_item()`.
- **Удалить пункт меню:** Вызовите функцию `remove_context_menu_item()`.

**Пример использования:**

```python
# Импорт функций для добавления и удаления пункта меню
from src.gui.context_menu.qt6.main import add_context_menu_item, remove_context_menu_item

# Добавить пункт меню
add_context_menu_item()

# Удалить пункт меню
remove_context_menu_item()
```

## Классы

### `ContextMenuManager`

**Описание**: Основное окно приложения для управления пунктом контекстного меню.

**Наследует**: `QtWidgets.QWidget`

**Атрибуты**: 
- `self`: Ссылка на текущий экземпляр класса.

**Методы**:

- `__init__(self)`: Конструктор класса, инициализирует объект.
- `initUI(self)`: Инициализирует интерфейс пользователя с кнопками для добавления, удаления или выхода.

## Функции

### `add_context_menu_item()`

**Назначение**: Добавляет элемент контекстного меню на рабочий стол и фон папки.

**Параметры**: 
- `None`

**Возвращает**: 
- `None`

**Вызывает исключения**:
- `Exception`: Если сценарий не найден, отображает сообщение об ошибке.

**Как работает функция**:

- Создает ключ реестра в `HKEY_CLASSES_ROOT\\Directory\\Background\\shell\\hypo_AI_assistant` для добавления пункта меню.
- В ключе устанавливает значение по умолчанию как "hypo AI assistant".
- Создает под-ключ `command` для задания команды, выполняемой при выборе пункта меню.
- В под-ключе `command` устанавливает значение как команду Python для запуска сценария `src/gui/context_menu/main.py`.

**Примеры**: 
- Вызов функции без параметров: `add_context_menu_item()`


### `remove_context_menu_item()`

**Назначение**: Удаляет пункт контекстного меню "hypo AI assistant".

**Параметры**:
- `None`

**Возвращает**:
- `None`

**Вызывает исключения**:
- `FileNotFoundError`: Отображает предупреждение, если пункт меню не найден.
- `Exception`: Отображает сообщение об ошибке, если операция не удалась.

**Как работает функция**:

- Удаляет ключ реестра `hypo_AI_assistant` из раздела `HKEY_CLASSES_ROOT\\Directory\\Background\\shell`, что удаляет пункт меню из контекстного меню.

**Примеры**: 
- Вызов функции без параметров: `remove_context_menu_item()`


## Параметры класса

- `key_path` (str): Путь к разделу реестра, где находится пункт меню.
- `command_path` (Path): Путь к Python-сценарию, который будет запущен при выборе пункта меню.

## Примеры

- **Пример 1: Добавление и удаление пункта меню:**

```python
from src.gui.context_menu.qt6.main import add_context_menu_item, remove_context_menu_item

# Добавить пункт меню
add_context_menu_item()

# Удалить пункт меню
remove_context_menu_item()
```

- **Пример 2: Создание и показ окна приложения:**

```python
from src.gui.context_menu.qt6.main import ContextMenuManager
from PyQt6 import QtWidgets

# Создание и показ окна приложения
app = QtWidgets.QApplication([])
window = ContextMenuManager()
window.show()
app.exec()