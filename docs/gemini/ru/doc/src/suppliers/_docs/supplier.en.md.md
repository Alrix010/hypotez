# Модуль `Supplier`

## Обзор

Модуль `Supplier` предоставляет базовый класс для управления поставщиками данных в приложении `hypotez`. Он обеспечивает основу для взаимодействия с различными источниками данных, такими как Amazon, AliExpress, Walmart и другие. Этот класс управляет инициализацией специфичных для поставщика настроек, управляет сценариями сбора данных и предоставляет методы для входа в систему и выполнения сценариев.

## Подробнее

Класс `Supplier` служит основой для управления сбором данных от различных поставщиков. Он определяет общие методы и атрибуты, которые могут использоваться или расширяться конкретными реализациями для разных поставщиков. Класс централизует управление поставщиками, включая конфигурацию, вход в систему и выполнение сценариев.

## Классы

### `Supplier`

**Описание**: Базовый класс для управления поставщиками данных. Предоставляет структуру для взаимодействия с различными источниками данных.

**Атрибуты**:

- `supplier_id` (str): Уникальный идентификатор поставщика.
- `supplier_prefix` (str): Префикс поставщика, например, `aliexpress` или `amazon`.
- `supplier_settings` (dict): Настройки для поставщика, загруженные из файла конфигурации.
- `locale` (str): Код локализации (например, `en` для английского, `ru` для русского).
- `price_rule` (str): Правило для расчета цен (например, добавление НДС или применение скидок).
- `related_modules` (module): Модуль, содержащий специфичные для поставщика функции.
- `scenario_files` (list): Список файлов сценариев для выполнения.
- `current_scenario` (dict): Текущий выполняемый сценарий.
- `login_data` (dict): Учетные данные для входа на сайт поставщика (если требуется).
- `locators` (dict): Локаторы для веб-элементов на сайте поставщика.
- `driver` (Driver): Веб-драйвер для взаимодействия с сайтом поставщика.
- `parsing_method` (str): Метод для парсинга данных (например, `webdriver`, `api`, `xls`, `csv`).

**Методы**:

- `__init__`: Конструктор, который инициализирует атрибуты на основе префикса поставщика и других параметров.
- `_payload`: Загружает специфичные для поставщика конфигурации, локаторы и инициализирует веб-драйвер.
- `login`: Обрабатывает процесс входа в систему для сайта поставщика, если требуется аутентификация.
- `run_scenario_files`: Выполняет один или несколько файлов сценариев.
- `run_scenarios`: Выполняет один или несколько сценариев.

#### `__init__`

```python
def __init__(self, supplier_prefix: str, locale: str = 'en', webdriver: str | Driver | bool = 'default', *attrs, **kwargs) -> None:
```

**Назначение**: Инициализирует экземпляр класса `Supplier`.

**Параметры**:

- `supplier_prefix` (str): Префикс поставщика (например, 'aliexpress').
- `locale` (str, optional): Локаль, используемая для поставщика. По умолчанию 'en'.
- `webdriver` (str | Driver | bool, optional): Тип веб-драйвера или инстанс веб-драйвера. По умолчанию 'default'.
- `*attrs`: Дополнительные атрибуты.
- `**kwargs`: Дополнительные именованные аргументы.

**Как работает функция**:

- Инициализирует атрибуты `supplier_prefix` и `locale`.
- Загружает настройки поставщика на основе префикса и локали.
- Инициализирует веб-драйвер с использованием метода `_payload`.

**Примеры**:

```python
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')
```

#### `_payload`

```python
def _payload(self, webdriver: str | Driver | bool, *attrs, **kwargs) -> bool:
```

**Назначение**: Загружает конфигурации и инициализирует веб-драйвер для поставщика.

**Параметры**:

- `webdriver` (str | Driver | bool): Тип веб-драйвера или инстанс веб-драйвера.
- `*attrs`: Дополнительные атрибуты.
- `**kwargs`: Дополнительные именованные аргументы.

**Возвращает**:

- `bool`: `True`, если инициализация прошла успешно, иначе `False`.

**Как работает функция**:

- Определяет, какой веб-драйвер использовать (Chrome, Firefox, Playwright или другой).
- Загружает конфигурационные файлы для поставщика, включая общие настройки, локаторы и данные для входа.
- Инициализирует веб-драйвер.

**Примеры**:

```python
supplier._payload(webdriver='chrome')
```

#### `login`

```python
def login(self) -> bool:
```

**Назначение**: Выполняет вход на сайт поставщика, если это необходимо.

**Возвращает**:

- `bool`: `True`, если вход выполнен успешно, иначе `False`.

**Как работает функция**:

- Проверяет, требуется ли вход на сайт поставщика.
- Если требуется, выполняет вход, используя данные для входа и локаторы.
- Если вход не требуется, возвращает `True`.

**Примеры**:

```python
supplier.login()
```

#### `run_scenario_files`

```python
def run_scenario_files(self, scenario_files: str | List[str] = None) -> bool:
```

**Назначение**: Выполняет сценарии из указанных файлов.

**Параметры**:

- `scenario_files` (str | List[str], optional): Список файлов сценариев для выполнения. По умолчанию `None`.

**Возвращает**:

- `bool`: `True`, если все сценарии выполнены успешно, иначе `False`.

**Как работает функция**:

- Проходит по списку файлов сценариев.
- Загружает и выполняет каждый сценарий.
- Возвращает `True`, если все сценарии выполнены успешно, иначе `False`.

**Примеры**:

```python
supplier.run_scenario_files(['example_scenario.json'])
```

#### `run_scenarios`

```python
def run_scenarios(self, scenarios: dict | list[dict]) -> bool:
```

**Назначение**: Выполняет переданные сценарии.

**Параметры**:

- `scenarios` (dict | list[dict]): Список или словарь сценариев для выполнения.

**Возвращает**:

- `bool`: `True`, если все сценарии выполнены успешно, иначе `False`.

**Как работает функция**:

- Проходит по списку сценариев.
- Выполняет каждый сценарий.
- Возвращает `True`, если все сценарии выполнены успешно, иначе `False`.

**Примеры**:

```python
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```

## Пример использования

```python
# Создание объекта Supplier для 'aliexpress'
supplier = Supplier(supplier_prefix='aliexpress', locale='en', webdriver='chrome')

# Выполнение входа на сайт поставщика
supplier.login()

# Выполнение файлов сценариев
supplier.run_scenario_files(['example_scenario.json'])

# Или выполнение конкретных сценариев
supplier.run_scenarios([{'action': 'scrape', 'target': 'product_list'}])
```