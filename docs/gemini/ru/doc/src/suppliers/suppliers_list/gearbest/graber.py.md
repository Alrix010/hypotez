# Модуль для сбора данных о товарах с Gearbest
=========================================================================================

Модуль содержит класс :class:`Graber`, который используется для сбора данных о товарах с веб-сайта `gearbest.com`. 
Он наследуется от базового класса :class:`src.suppliers.graber.Graber`.

Класс `Graber` предоставляет методы для обработки различных полей товара на странице. 
В случае необходимости нестандартной обработки поля, метод может быть переопределен.

Для каждого поля страницы товара сделана функция обработки поля в родительском `Graber`.
Если нужна нестандартная обработка, можно перегрузить метод здесь, в этом классе.

------------------
Перед отправкой запроса к вебдрайверу можно совершить предварительные действия через декоратор. 
Декоратор по умолчанию находится в родительском классе. Для того, чтобы декоратор сработал надо передать значение 
в `Context.locator`, Если надо реализовать свой декоратор - раскоментируйте строки с декоратором и переопределите его поведение.
Вы также можете реализовать свой собственный декоратор, раскомментировав соответствующие строки кода

```rst
.. module:: src.suppliers.suppliers_list.gearbest
```

## Оглавление
- :ref:`Классы`
  - :ref:`Graber`
  - :ref:`close_pop_up`
  - :ref:`decorator`

## Классы

### `Graber`

**Описание**: Класс для операций захвата Morlevi.

**Наследует**:
    - :class:`src.suppliers.graber.Graber`: Базовый класс для сбора данных о товарах.

**Атрибуты**:
    - `supplier_prefix` (str): Префикс поставщика.

**Методы**:
    - `__init__`: Инициализация класса сбора полей товара.

**Примеры**:

```python
# Создание инстанса драйвера (пример с Chrome)
driver = Driver(Chrome)

# Создание инстанса класса Graber
graber = Graber(driver=driver)
```

#### `__init__`

```python
    def __init__(self, driver: Optional['Driver'] = None, lang_index:Optional[int] = None):
        """Инициализация класса сбора полей товара."""
        self.supplier_prefix = 'etzmaleh'
        super().__init__(supplier_prefix=self.supplier_prefix, driver=driver, lang_index=lang_index)
        # Устанавливаем глобальные настройки через Context
        
        Config.locator_for_decorator = None # <- если будет уастановлено значение - то оно выполнится в декораторе `@close_pop_up`
```

**Описание**: Инициализирует класс сбора полей товара.

**Параметры**:
    - `driver` (Optional['Driver'], optional): Драйвер браузера. По умолчанию `None`.
    - `lang_index` (Optional[int], optional): Индекс языка. По умолчанию `None`.

**Возвращает**:
    - `None`: Не возвращает значения.


### `close_pop_up`

```python
# def close_pop_up(value: Any = None) -> Callable:
#     """Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.
# 
#     Args:
#         value (Any): Дополнительное значение для декоратора.
# 
#     Returns:
#         Callable: Декоратор, оборачивающий функцию.
#     """
#     def decorator(func: Callable) -> Callable:
#         @wraps(func)
#         async def wrapper(*args, **kwargs):
#             try:
#                 # await Context.driver.execute_locator(Context.locator.close_pop_up)  # Await async pop-up close  
#                 ... 
#             except ExecuteLocatorException as e:
#                 logger.debug(f'Ошибка выполнения локатора: {e}')
#             return await func(*args, **kwargs)  # Await the main function
#         return wrapper
#     return decorator
```

**Описание**: Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

**Параметры**:
    - `value` (Any): Дополнительное значение для декоратора.

**Возвращает**:
    - `Callable`: Декоратор, оборачивающий функцию.

**Как работает**:

- Декоратор `close_pop_up` предназначен для автоматического закрытия всплывающих окон перед выполнением основной логики функции.
- Он принимает в качестве параметра `value` - дополнительное значение для декоратора. 
- Декоратор оборачивает функцию, выполняя определенные действия перед ее вызовом.
- Внутри декоратора выполняется попытка закрыть всплывающее окно с помощью `Context.driver.execute_locator(Context.locator.close_pop_up)`.
- Если возникнет ошибка, она обрабатывается и логируется с помощью `logger.debug`.
- После закрытия всплывающего окна (или если оно не было найдено), декоратор вызывает основную функцию `func`.

**Примеры**:

```python
@close_pop_up()
def my_function():
    # Основная логика функции
    ...
```

### `decorator`

```python
# def close_pop_up(value: Any = None) -> Callable:
#     """Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.
# 
#     Args:
#         value (Any): Дополнительное значение для декоратора.
# 
#     Returns:
#         Callable: Декоратор, оборачивающий функцию.
#     """
#     def decorator(func: Callable) -> Callable:
#         @wraps(func)
#         async def wrapper(*args, **kwargs):
#             try:
#                 # await Context.driver.execute_locator(Context.locator.close_pop_up)  # Await async pop-up close  
#                 ... 
#             except ExecuteLocatorException as e:
#                 logger.debug(f'Ошибка выполнения локатора: {e}')
#             return await func(*args, **kwargs)  # Await the main function
#         return wrapper
#     return decorator
```

**Описание**: Шаблон декоратора.

**Параметры**:
    - `value` (Any): Дополнительное значение для декоратора.

**Возвращает**:
    - `Callable`: Декоратор, оборачивающий функцию.

**Как работает**:

- Декоратор `close_pop_up` предназначен для автоматического закрытия всплывающих окон перед выполнением основной логики функции.
- Он принимает в качестве параметра `value` - дополнительное значение для декоратора. 
- Декоратор оборачивает функцию, выполняя определенные действия перед ее вызовом.
- Внутри декоратора выполняется попытка закрыть всплывающее окно с помощью `Context.driver.execute_locator(Context.locator.close_pop_up)`.
- Если возникнет ошибка, она обрабатывается и логируется с помощью `logger.debug`.
- После закрытия всплывающего окна (или если оно не было найдено), декоратор вызывает основную функцию `func`.

**Примеры**:

```python
@close_pop_up()
def my_function():
    # Основная логика функции
    ...