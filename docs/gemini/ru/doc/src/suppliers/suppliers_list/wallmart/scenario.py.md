# Модуль сбора товаров со страницы категорий поставщика wallmart через вебдрайвер

## Обзор

Модуль предназначен для сбора информации о товарах с сайта поставщика wallmart. Он включает в себя функции для получения списка категорий товаров и списка товаров в каждой категории, а также для обработки страниц товаров.

## Подробней

Модуль предназначен для сбора информации о товарах с сайта поставщика kualastyle. Он включает в себя функции для получения списка категорий товаров и списка товаров в каждой категории, а также для обработки страниц товаров.

## Функции

### `get_list_products_in_category`

```python
def get_list_products_in_category (s: Supplier) -> list[str, str, None]:
    """ Returns list of products urls from category page
    Если надо пролистстать - страницы категорий - листаю ??????

    Attrs:
        s - Supplier
    @returns
        list or one of products urls or None
    """
    ...
```

**Назначение**: Возвращает список URL товаров со страницы категории.

**Параметры**:
- `s` (Supplier): Объект поставщика, содержащий информацию о текущем поставщике, включая драйвер веб-браузера и локаторы элементов на странице.

**Возвращает**:
- `list[str, str, None]`: Список URL товаров или `None`, если товары не найдены.

**Как работает функция**:

1.  **Инициализация**:
    *   Извлекает драйвер веб-браузера и локаторы элементов из объекта поставщика `s`.
    *   `d: Driver = s.driver` - Извлекает драйвер веб-браузера из объекта поставщика.
    *   `l: dict = s.locators['category']` - Извлекает локаторы элементов для категории из объекта поставщика.
2.  **Ожидание и закрытие баннера**:
    *   `d.wait(1)` - Ожидает 1 секунду.
    *   `d.execute_locator(s.locators['product']['close_banner'])` - Выполняет локатор для закрытия баннера (если он есть) на странице категории.

    *   `s.locators['product']['close_banner']` -  Локатор кнопки закрытия баннера на странице. Если баннера нет, то ничего не произойдет
    *   `d.scroll()` - Прокручивает страницу вниз.

3.  **Получение ссылок на товары**:
    *   `list_products_in_category: List = d.execute_locator(l['product_links'])` - Извлекает список ссылок на товары на текущей странице категории.

        *   `l['product_links']` - Локатор ссылок на товары.
        *   `d.execute_locator` -  Ищет элементы, соответствующие локатору.
        *   `list_products_in_category` -  Cписок веб-элементов, представляющих ссылки на товары.
4.  **Проверка наличия ссылок**:
    *   Если список ссылок пуст, функция логирует предупреждение и возвращает `None`.
5.  **Пагинация**:

    *   Организован обход страниц пагинации, если такие имеются
    *   Функция `paginator(d, l, list_products_in_category)` вызывается для перехода на следующую страницу.
        *   `d` - Драйвер веб-браузера.
        *   `l` - Локаторы элементов.
        *   `list_products_in_category` - Список ссылок на товары.
    *   Цикл `while d.current_url != d.previous_url:` проверяет, изменился ли URL страницы после перехода.
        *   Если URL не изменился, цикл завершается.

6.  **Формирование списка товаров**:
    *   `list_products_in_category = [list_products_in_category] if isinstance(list_products_in_category, str) else list_products_in_category` - Преобразует одиночную строку в список, если `list_products_in_category` является строкой.
7.  **Логирование**:
    *   `logger.debug(f"Found {len(list_products_in_category)} items in category {s.current_scenario['name']}")` - Логирует количество найденных товаров в категории.

**Примеры**:

Пример вызова функции:

```python
supplier = Supplier(...)  # Предполагается, что объект Supplier уже инициализирован
product_list = get_list_products_in_category(supplier)
if product_list:
    print(f"Найдено {len(product_list)} товаров в категории")
else:
    print("Товары в категории не найдены")
```

### `paginator`

```python
def paginator(d:Driver, locator: dict, list_products_in_category: list):
    """ Листалка """
    response = d.execute_locator(locator['pagination']['<-'])
    if not response or (isinstance(response, list) and len(response) == 0):
        ...
        return
    return True
```

**Назначение**: Осуществляет переход на следующую страницу пагинации.

**Параметры**:
- `d` (Driver): Объект драйвера веб-браузера.
- `locator` (dict): Словарь с локаторами элементов на странице.
- `list_products_in_category` (list): Список товаров в текущей категории.

**Возвращает**:
- `True`: Если переход на следующую страницу успешен.
- `None`: Если переход на следующую страницу невозможен.

**Как работает функция**:

1.  **Переход на следующую страницу**:
    *   `response = d.execute_locator(locator['pagination']['<-'])` -  Выполняет нажатие на кнопку "следующая страница" пагинации.

        *   `locator['pagination']['<-']` -  Локатор кнопки "следующая страница".
        *   `d.execute_locator` -  Ищет элемент, соответствующий локатору, и кликает по нему.
2.  **Проверка результата**:
    *   Если `response` отсутствует или является пустым списком, функция возвращает `None`.
3.  **Возврат значения**:
    *   Если переход успешен, функция возвращает `True`.

**Примеры**:

Пример вызова функции:

```python
driver = Driver(...)  # Предполагается, что объект Driver уже инициализирован
locator = {...}  # Предполагается, что словарь locator уже определен
product_list = [...]  # Предполагается, что список product_list уже определен

if paginator(driver, locator, product_list):
    print("Переход на следующую страницу выполнен")
else:
    print("Переход на следующую страницу невозможен")
```

### `get_list_categories_from_site`

```python
def get_list_categories_from_site(s):
    """ сборщик актуальных категорий с сайта """
    ...
```

**Назначение**: Собирает актуальные категории с сайта.

**Параметры**:
- `s`: Параметр не указан.

**Возвращает**:
- Нет информации о возвращаемом значении.

**Как работает функция**:

- Нет информации о работе функции.

**Примеры**:

- Нет примеров использования функции.