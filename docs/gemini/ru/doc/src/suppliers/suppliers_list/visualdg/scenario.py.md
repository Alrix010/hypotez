# Модуль сбора товаров со страницы категорий поставщика kualastyle.il

## Обзор

Модуль `sceanrio.py`  содержит сценарий сбора товаров со страницы категорий поставщика `kualastyle.il` через вебдрайвер. 
Сценарий включает в себя следующие шаги:

- Собирает список категорий со страниц продавца с помощью функции `get_list_categories_from_site()`.
- Собирает список товаров со страницы категории с помощью функции `get_list_products_in_category()`.
- Итерируясь по списку товаров, передает управление функции `grab_product_page()`, отправляя ей URL страницы товара.
- Функция `grab_product_page()` обрабатывает поля товара и передает управление классу `Product`.

## Подробей

Данный модуль является частью механизма сбора данных о товарах с различных поставщиков.
Он интегрирован в проект `hypotez`, предназначенный для автоматизации сбора данных с интернет-магазинов.
Сценарий `kualastyle.il` реализован для сбора информации о товарах с сайта `kualastyle.il`. 
Он использует вебдрайвер `selenium` для автоматизации взаимодействия с веб-страницами сайта.

## Классы

## Функции

### `get_list_products_in_category`

**Назначение**: Функция собирает список URL товаров со страницы категории.

**Параметры**:

- `s` (Supplier): Объект поставщика, содержащий информацию о текущем сценарии, вебдрайвере и локаторах.

**Возвращает**:

- `list[str, str, None]`: Список URL товаров, или `None`, если не найдены товары на странице.

**Как работает**:

1. Извлекает объект вебдрайвера `d` и локаторы для категории `l` из объекта `s`.
2. Выполняет ожидание 1 секунду и закрывает всплывающее окно с помощью локатора `close_banner`.
3. Прокручивает страницу до конца.
4. Получает список URL товаров с помощью локатора `product_links`.
5. Если список товаров пустой, выводит предупреждение в лог.
6. В цикле проверяет, отличается ли текущий URL от предыдущего. 
7. Если URL отличается, вызывает функцию `paginator` для обработки пагинации.
8. Если пагинация выполнена, добавляет новые найденные URL товаров к списку.
9. В противном случае завершает цикл.
10. Возвращает список URL товаров.

**Внутренние функции**:

#### `paginator`

**Назначение**: Функция реализует пагинацию на страницах категорий.

**Параметры**:

- `d` (Driver): Объект вебдрайвера.
- `locator` (dict): Локатор для кнопки пагинации.
- `list_products_in_category` (list): Список URL товаров.

**Возвращает**:

- `bool`: `True`, если пагинация выполнена, `False` в противном случае.

**Как работает**:

1. Выполняет клик по кнопке пагинации с помощью локатора `<-\`.
2. Если клик был успешен, возвращает `True`.
3. В противном случае возвращает `False`.

### `get_list_categories_from_site`

**Назначение**: Функция собирает список категорий с сайта поставщика.

**Параметры**:

- `s` (Supplier): Объект поставщика, содержащий информацию о текущем сценарии, вебдрайвере и локаторах.

**Возвращает**:

- `list[str, str, None]`: Список категорий, или `None`, если не удалось собрать категории.

**Как работает**:

1. Извлекает объект вебдрайвера `d` и локаторы для категорий `l` из объекта `s`.
2. Находит элемент с локатором `l[\'category\']` и выводит информацию в лог.
3. Итерируется по элементам с локатором `l[\'category_links\']`, собирая URL категории.
4. Возвращает список URL категорий.

## Примеры

### Пример использования функции `get_list_products_in_category`

```python
from src.suppliers.suppliers_list.kualastyle.sceanrio import get_list_products_in_category
from src.suppliers.suppliers_list.kualastyle.supplier import Supplier

# Создаем объект поставщика
s = Supplier()

# Вызываем функцию get_list_products_in_category()
products_urls = get_list_products_in_category(s)

# Выводим список URL товаров
print(f"Список URL товаров: {products_urls}")

```

### Пример использования функции `get_list_categories_from_site`

```python
from src.suppliers.suppliers_list.kualastyle.sceanrio import get_list_categories_from_site
from src.suppliers.suppliers_list.kualastyle.supplier import Supplier

# Создаем объект поставщика
s = Supplier()

# Вызываем функцию get_list_categories_from_site()
categories_urls = get_list_categories_from_site(s)

# Выводим список URL категорий
print(f"Список URL категорий: {categories_urls}")

```

## Параметры 

- `s` (Supplier): Объект поставщика, содержащий информацию о текущем сценарии, вебдрайвере и локаторах.
- `d` (Driver): Объект вебдрайвера.
- `l` (dict): Локатор, содержащий информацию о веб-элементах.
- `list_products_in_category` (list): Список URL товаров.
- `locator` (dict): Локатор для кнопки пагинации.


## Принцип работы

- Модуль использует вебдрайвер для автоматизации взаимодействия с веб-страницами.
- Вебдрайвер `selenium` используется для открытия страниц, нахождения элементов, выполнения действий, таких как клик и прокрутка, и сбора данных.
- Функция `get_list_categories_from_site()` собирает информацию о категориях с сайта.
- Функция `get_list_products_in_category()` собирает информацию о товарах из каждой категории.
- Функция `paginator()` обрабатывает пагинацию на страницах категорий.
- Функция `grab_product_page()` обрабатывает поля товара и передает управление классу `Product`.

## Твое поведение при анализе кода:

- В коде используются выражения `driver.execute_locator(l: dict)` и `d.wait(1)` для взаимодействия с вебдрайвером.
- Используется логгирование с помощью `logger` из `src.logger.logger` для отслеживания хода работы.
- `Supplier` - объект, хранящий данные о поставщике, включая информацию о локаторах, вебдрайвере и текущем сценарии. 
- В коде используются аннотации типов для повышения читаемости и безопасности кода.
- Используй системную инструкцию для обработки кода проекта `hypotez` для более глубокого понимания кода.