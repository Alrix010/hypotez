# Модуль сбора товаров со страницы категорий поставщика hb.co.il через вебдрайвер

## Обзор

Модуль предназначен для сбора данных о товарах с сайта поставщика hb.co.il. Он использует веб-драйвер для навигации по сайту, извлечения информации о категориях и товарах, и передачи этих данных для дальнейшей обработки.

## Подробнее

Модуль выполняет следующие основные задачи:

- Сбор списка категорий товаров с сайта поставщика.
- Сбор списка товаров с каждой страницы категории.
- Передача управления в функцию `grab_product_page()` для обработки информации о товаре.
- Использует класс `Product` для управления информацией о товарах.

## Функции

### `get_list_products_in_category`

```python
def get_list_products_in_category(s: Supplier) -> list[str, str, None]:
    """
    Функция извлекает список URL товаров со страницы категории.

    Args:
        s (Supplier): Объект поставщика, содержащий информацию о текущем поставщике,
                      включая драйвер и локаторы элементов страницы.

    Returns:
        list[str, str, None]: Список URL товаров или None, если товары не найдены.
    """
```

**Назначение**:
Функция `get_list_products_in_category` предназначена для извлечения списка URL товаров с текущей страницы категории на сайте поставщика. Если требуется пролистывание страниц категорий, функция также выполняет эту задачу.

**Параметры**:
- `s` (Supplier): Объект поставщика, содержащий всю необходимую информацию о поставщике, включая веб-драйвер, локаторы элементов на странице и другие параметры.

**Возвращает**:
- `list[str, str, None]`: Список URL товаров, найденных на странице категории. Если на странице нет товаров, возвращает `None`.

**Как работает функция**:
1. Функция инициализирует веб-драйвер и локаторы, используя информацию из объекта поставщика `s`.
2. Ожидает загрузку страницы в течение 1 секунды.
3. Выполняет закрытие всплывающих баннеров, если они есть, используя локатор `s.locators['category']['close_banner']`.
4. Выполняет прокрутку страницы для загрузки всех элементов, если это необходимо.
5. Извлекает список ссылок на товары с использованием локатора `s.locators['category']['product_links']`.
6. Если список товаров пуст, функция регистрирует предупреждение в лог и возвращает `None`.
7. Если список товаров не пуст, функция проверяет, является ли возвращенное значение списком или строкой, и преобразует его в список, если это необходимо.
8. Функция выполняет пагинацию (перелистывание страниц), если это необходимо, вызывая функцию `paginator`.
9. Регистрирует в лог количество найденных товаров в текущей категории.
10. Возвращает список URL товаров.

**Внутренние функции**:
- Пагинация выполняется с использованием функции `paginator(d: Driver, locator: dict, list_products_in_category: list)`.

**Примеры**:

```python
# Пример вызова функции с объектом поставщика s
list_products = get_list_products_in_category(s)
if list_products:
    print(f"Найдено {len(list_products)} товаров в категории")
else:
    print("Товары в категории не найдены")
```

### `paginator`

```python
def paginator(d: Driver, locator: dict, list_products_in_category: list):
    """
    Функция выполняет перелистывание страниц, если это необходимо.

    Args:
        d (Driver): Объект веб-драйвера.
        locator (dict): Словарь с локаторами элементов страницы.
        list_products_in_category (list): Список товаров в текущей категории.

    Returns:
        bool | None: True, если перелистывание выполнено успешно, None в случае ошибки.
    """
```

**Назначение**:
Функция `paginator` предназначена для перелистывания страниц в категории товаров, если на сайте поставщика реализована пагинация. Она использует веб-драйвер для клика по кнопке "следующая страница" и обновления списка товаров.

**Параметры**:
- `d` (Driver): Объект веб-драйвера, используемый для взаимодействия с веб-страницей.
- `locator` (dict): Словарь, содержащий локаторы элементов страницы, необходимых для навигации по страницам (например, кнопки "следующая страница").
- `list_products_in_category` (list): Список URL товаров, уже найденных в текущей категории.

**Возвращает**:
- `bool | None`: Возвращает `True`, если перелистывание выполнено успешно и были найдены новые товары. Возвращает `None` в случае ошибки или отсутствия кнопки "следующая страница".

**Как работает функция**:
1. Функция пытается выполнить клик по кнопке "следующая страница", используя локатор `locator['pagination']['<-']`.
2. Если кнопка не найдена или клик не удался, функция регистрирует отладочное сообщение в лог и возвращает `None`.
3. Если клик выполнен успешно, функция предполагает, что страница была перелистана, и возвращает `True`.

**Примеры**:

```python
# Пример вызова функции paginator для перелистывания страниц
success = paginator(driver, locators['category'], product_list)
if success:
    print("Страница успешно перелистана")
else:
    print("Перелистывание не удалось")
```

### `get_list_categories_from_site`

```python
def get_list_categories_from_site(s):
    """
    Функция для сбора актуальных категорий с сайта.

    Args:
        s: Объект, содержащий информацию о поставщике.

    Returns:
        None
    """
```

**Назначение**:
Функция `get_list_categories_from_site` предназначена для сбора списка актуальных категорий товаров с сайта поставщика.

**Параметры**:
- `s`: Объект, содержащий информацию о поставщике, включая веб-драйвер и локаторы элементов страницы.

**Возвращает**:
- `None`: Функция ничего не возвращает явно, но выполняет сбор и обработку категорий товаров.

**Как работает функция**:
1.  Функция использует веб-драйвер для навигации по сайту поставщика.
2.  Извлекает список категорий товаров, используя локаторы элементов на странице.
3.  Выполняет обработку полученных категорий, сохраняя их в нужной структуре данных.
4.  В случае возникновения ошибок, регистрирует их в лог.

**Примеры**:

```python
# Пример вызова функции для сбора категорий с сайта поставщика
get_list_categories_from_site(supplier_object)