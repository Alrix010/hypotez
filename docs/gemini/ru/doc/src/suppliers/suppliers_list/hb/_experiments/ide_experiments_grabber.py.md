# Модуль ide_experiments_grabber

## Обзор

Модуль `ide_experiments_grabber` предназначен для проведения экспериментов по проверке сценариев, связанных с поставщиком HB. Он включает в себя получение заполненного словаря `product_fields` и отправку его на сервер.

## Подробней

Этот модуль используется для автоматизированного тестирования и проверки корректности работы парсера и отправки данных о товарах от поставщика HB. В процессе работы модуль выполняет следующие шаги:

1.  Инициализация основных объектов и параметров.
2.  Загрузка URL, указанного в сценарии, с использованием веб-драйвера.
3.  Запуск сценариев для обработки данных на странице товара.
4.  Извлечение данных о товаре и формирование словаря `product_fields`.

## Классы

### `Supplier`

**Описание**: Класс для представления поставщика.

**Атрибуты**:

*   `supplier_prefix` (str): Префикс поставщика (например, 'hb').

### `Product`

**Описание**: Класс для представления товара.

**Атрибуты**:

*   `supplier` (Supplier): Объект поставщика, которому принадлежит товар.

### `ProductFields`

**Описание**: Класс для представления полей товара.

**Атрибуты**:

*   `supplier` (Supplier): Объект поставщика, для которого определены поля товара.

### `Driver`

**Описание**: Класс для управления веб-драйвером.

**Атрибуты**:

*   Различные атрибуты для настройки и управления веб-драйвером (например, тип браузера, опции запуска).

## Переменные

*   `dir_root` (Path): Корневая директория проекта `hypotez`.
*   `dir_src` (Path): Директория `src` внутри корневой директории.
*   `s` (Supplier): Объект поставщика с префиксом 'hb'.
*   `p` (Product): Объект товара, связанный с поставщиком `s`.
*   `l` (Dict): Словарь локаторов для товара, полученный из `s.locators["product"]`.
*   `d` (Driver): Объект драйвера, связанный с поставщиком `s`.
*   `f` (ProductFields): Объект полей товара, связанный с поставщиком `s`.
*   `s.current_scenario` (Dict): Словарь, представляющий текущий сценарий, содержащий URL, название, условие и категории PrestaShop.

## Методы

### `run_scenarios(s, s.current_scenario)`

**Описание**: Функция выполняет сценарии для заданного поставщика и текущего сценария.
Функция выполняет серию действий, определенных в сценарии, для сбора данных о товарах.

**Параметры**:

*   `s` (Supplier): Объект поставщика.
*   `s.current_scenario` (Dict): Словарь с описанием текущего сценария.

**Возвращает**:

*   `ret` (Any): Результат выполнения сценариев.

**Примеры**:

```python
from src.suppliers import Supplier
from src.product import Product
from src.scenario import run_scenarios
from src.webdriver.driver import Driver
from src.product import ProductFields

s = Supplier(supplier_prefix='hb')
p = Product(s)
d = Driver('chrome')
f = ProductFields(s)

s.current_scenario = {
    "url": "https://hbdeadsea.co.il/product-category/bodyspa/feet-hand-treatment/",
    "name": "טיפוח כפות ידיים ורגליים",
    "condition": "new",
    "presta_categories": {
        "default_category": 11259,
        "additional_categories": []
    }
}
d.get_url(s.current_scenario['url'])
ret = run_scenarios(s, s.current_scenario)
print(ret)
```

### `s.related_modules.grab_product_page(s)`

**Описание**: Функция для извлечения информации со страницы товара.

**Параметры**:

*   `s` (Supplier): Объект поставщика.

**Возвращает**:

*   None

**Примеры**:

```python
from src.suppliers import Supplier
s = Supplier(supplier_prefix='hb')
s.related_modules.grab_product_page(s)
```

## Как работает код:

1.  **Инициализация путей**:
    *   Определяется корневая директория проекта (`dir_root`) и добавляется в `sys.path`, что позволяет импортировать модули из проекта, независимо от текущей рабочей директории.
    *   Определяется директория с исходным кодом (`dir_src`) и также добавляется в `sys.path`.
2.  **Инициализация объектов**:
    *   Создается объект поставщика (`s`) с префиксом `'hb'`.
    *   Создается объект товара (`p`), связанный с поставщиком `s`.
    *   Извлекаются локаторы для товара из `s.locators["product"]` и сохраняются в переменной `l`.
    *   Создается объект драйвера (`d`), связанный с поставщиком `s`.
    *   Создается объект полей товара (`f`), связанный с поставщиком `s`.
3.  **Определение текущего сценария**:
    *   Определяется словарь `s.current_scenario`, содержащий информацию о текущем сценарии, такую как URL страницы товара, название, условие и категории PrestaShop.
4.  **Запуск сценария и извлечение данных**:
    *   Выполняется переход по URL, указанному в `s.current_scenario['url']`, с использованием драйвера `d.get_url()`.
    *   Запускаются сценарии для обработки данных на странице товара с использованием функции `run_scenarios(s, s.current_scenario)`, и результат сохраняется в переменной `ret`.
    *   Вызывается функция `s.related_modules.grab_product_page(s)` для извлечения данных о товаре со страницы.