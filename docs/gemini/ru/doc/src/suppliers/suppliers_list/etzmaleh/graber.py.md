# Модуль для сбора данных о товарах с Etzmaleh.

## Обзор

Модуль содержит класс `Graber`, предназначенный для сбора информации о товарах с веб-сайта [etzmaleh.com](etzmaleh.com). Он наследуется от базового класса `src.suppliers.graber.Graber` и предоставляет методы для обработки полей товаров на странице. При необходимости нестандартной обработки поля, метод может быть переопределен.

## Подробнее

Этот модуль является частью системы для автоматизированного сбора данных о товарах от различных поставщиков. Он специализируется на сборе данных с сайта Etzmaleh. Для каждого поля страницы товара существует функция обработки поля в родительском классе `Graber`. Если требуется нестандартная обработка, можно перегрузить метод в этом классе.

Перед отправкой запроса к веб-драйверу можно выполнить предварительные действия через декоратор. Декоратор по умолчанию находится в родительском классе. Чтобы декоратор сработал, необходимо передать значение в `Context.locator`. Также можно реализовать свой собственный декоратор, раскомментировав соответствующие строки кода.

## Классы

### `Graber`

**Описание**: Класс `Graber` предназначен для сбора и обработки данных о товарах с сайта Etzmaleh.

**Наследует**: `Graber` наследует от класса `src.suppliers.graber.Graber`, который предоставляет базовую функциональность для сбора данных с веб-сайтов поставщиков.

**Атрибуты**:
- `supplier_prefix` (str): Префикс поставщика, который используется для идентификации Etzmaleh.

**Методы**:
- `__init__`: Инициализирует экземпляр класса `Graber`, устанавливает префикс поставщика и вызывает конструктор родительского класса.
- Если нужно реализовать свой декоратор - раскоментируйте строки с декоратором и переопределите его поведение

#### `__init__`

```python
def __init__(self, driver: Driver, lang_index):
    """Инициализация класса сбора полей товара.

    Args:
        driver (Driver): Экземпляр веб-драйвера для взаимодействия с сайтом.
        lang_index (int): Индекс языка, используемого на сайте.

    Returns:
        None

    Raises:
        None
    """
    ...
```

**Назначение**: Инициализирует экземпляр класса `Graber` для сбора данных о товарах.

**Параметры**:
- `driver` (Driver): Экземпляр веб-драйвера, используемый для взаимодействия с веб-страницами.
- `lang_index` (int): Индекс языка, используемого на сайте поставщика.

**Возвращает**:
- `None`

**Как работает функция**:
- Устанавливает `supplier_prefix` в значение 'etzmaleh'.
- Вызывает конструктор родительского класса `Grbr` с указанием префикса поставщика, драйвера и индекса языка.
- Устанавливает `Context.locator_for_decorator` в `None`. Если установить значение, оно будет выполнено в декораторе `@close_pop_up`.

**Примеры**:

```python
from src.webdriver.driver import Driver, Chrome
from src.suppliers.suppliers_list.etzmaleh.graber import Graber

# Пример инициализации класса Graber
driver = Driver(Chrome)
graber = Graber(driver=driver, lang_index=0)
```

### Декораторы
В коде представлен закоментированный декоратор `close_pop_up`, который предназначен для закрытия всплывающих окон перед выполнением основной логики функции.

#### `close_pop_up`

```python
def close_pop_up(value: Any = None):
    """Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

    Args:
        value (Any): Дополнительное значение для декоратора.

    Returns:
        Callable: Декоратор, оборачивающий функцию.
    """
    def decorator(func: Callable):
        """Обертка декоратора"""
        def wrapper(*args, **kwargs):
            """Обертка для вызова декорируемой функции"""
            try:
                # await Context.driver.execute_locator(Context.locator.close_pop_up)  # Await async pop-up close  
                ...
            except ExecuteLocatorException as ex:
                logger.debug(f'Ошибка выполнения локатора: {ex}')
            return await func(*args, **kwargs)  # Await the main function
        return wrapper
    return decorator
```

**Назначение**: Создает декоратор для закрытия всплывающих окон перед выполнением основной логики функции.

**Параметры**:
- `value` (Any): Дополнительное значение для декоратора.

**Возвращает**:
- `Callable`: Декоратор, оборачивающий функцию.

**Как работает функция**:
- Возвращает функцию `decorator`, которая принимает функцию `func` в качестве аргумента.
- Внутри `decorator` определена функция `wrapper`, которая выполняет следующие действия:
    - Пытается закрыть всплывающее окно, используя `Context.driver.execute_locator(Context.locator.close_pop_up)`.
    - Перехватывает исключение `ExecuteLocatorException` и логирует его.
    - Вызывает функцию `func` и возвращает ее результат.

**Примеры**:
Пример использования данного декоратора предполагает его раскомментирование и адаптацию под конкретные нужды проекта.
```python
from typing import Callable, Any
from functools import wraps

from src.suppliers.graber import Graber as Grbr, Context, close_pop_up

# Пример использования декоратора (раскомментировать для использования)
# @close_pop_up()
# async def some_function():
#     pass
```
В этом примере `some_function` будет выполняться после попытки закрытия всплывающего окна.