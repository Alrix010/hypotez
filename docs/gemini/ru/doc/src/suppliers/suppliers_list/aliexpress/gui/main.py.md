# Модуль `main.py`

## Обзор

Модуль предоставляет основной интерфейс графического приложения для управления рекламными кампаниями на AliExpress. Он включает в себя редакторы JSON, кампаний, категорий и товаров.

## Подробнее

Этот модуль является точкой входа в графическое приложение, которое позволяет пользователям управлять различными аспектами рекламных кампаний на AliExpress. Он использует библиотеку PyQt6 для создания графического интерфейса и включает в себя несколько редакторов для работы с JSON-файлами, кампаниями, категориями и товарами.

## Классы

### `MainApp`

**Описание**: Главное окно приложения, содержащее вкладки для различных редакторов.

**Наследует**: `QtWidgets.QMainWindow`

**Атрибуты**:
- `tab_widget` (QtWidgets.QTabWidget): Виджет для управления вкладками.
- `tab1` (QtWidgets.QWidget): Вкладка для редактора JSON.
- `promotion_app` (CampaignEditor): Экземпляр редактора кампаний для вкладки `tab1`.
- `tab2` (QtWidgets.QWidget): Вкладка для редактора категорий.
- `campaign_editor_app` (CategoryEditor): Экземпляр редактора категорий для вкладки `tab2`.
- `tab3` (QtWidgets.QWidget): Вкладка для редактора товаров.
- `product_editor_app` (ProductEditor): Экземпляр редактора товаров для вкладки `tab3`.

**Методы**:
- `__init__()`: Инициализирует главное окно приложения, создает вкладки и добавляет их в виджет вкладок.
- `create_menubar()`: Создает меню с опциями для операций с файлами и командами редактирования.
- `open_file()`: Открывает диалоговое окно для выбора и загрузки JSON-файла.
- `save_file()`: Сохраняет текущий файл.
- `exit_application()`: Закрывает приложение.
- `copy()`: Копирует выделенный текст в буфер обмена.
- `paste()`: Вставляет текст из буфера обмена.
- `load_file()`: Загружает JSON-файл.

#### `__init__`

```python
def __init__(self):
    """ Initialize the main application with tabs """
```

**Назначение**: Инициализирует главное окно приложения, создает вкладки и добавляет их в виджет вкладок.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Вызывает конструктор родительского класса `QtWidgets.QMainWindow`.
- Устанавливает заголовок окна.
- Устанавливает геометрию окна.
- Создает виджет вкладок `QTabWidget`.
- Создает три вкладки (`tab1`, `tab2`, `tab3`) с соответствующими редакторами (`CampaignEditor`, `CategoryEditor`, `ProductEditor`).
- Добавляет вкладки в виджет вкладок.
- Устанавливает виджет вкладок в качестве центрального виджета окна.
- Вызывает метод `create_menubar()` для создания меню.

#### `create_menubar`

```python
def create_menubar(self):
    """ Create a menu bar with options for file operations and edit commands """
```

**Назначение**: Создает меню с опциями для операций с файлами и командами редактирования.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Получает строку меню (`menubar`) главного окна.
- Создает меню "File" и добавляет в него действия "Open", "Save", "Exit".
- Создает меню "Edit" и добавляет в него действия "Copy", "Paste".
- Связывает действия с соответствующими методами (`open_file`, `save_file`, `exit_application`, `copy`, `paste`).
- Добавляет действие "Open Product File", связанное с методом `product_editor_app.open_file`.

#### `open_file`

```python
def open_file(self):
    """ Open a file dialog to select and load a JSON file """
```

**Назначение**: Открывает диалоговое окно для выбора и загрузки JSON-файла.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Создает экземпляр `QFileDialog`.
- Открывает диалоговое окно для выбора файла с фильтром "JSON files (*.json)".
- Если файл выбран, проверяет, какая вкладка активна.
- Если активна вкладка "JSON Editor" (индекс 0), вызывает метод `load_file` для загрузки файла.

#### `save_file`

```python
def save_file(self):
    """ Save the current file """
```

**Назначение**: Сохраняет текущий файл.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Определяет индекс текущей активной вкладки.
- Если активна вкладка "JSON Editor" (индекс 0), вызывает метод `promotion_app.save_changes()`.
- Если активна вкладка "Product Editor" (индекс 2), вызывает метод `product_editor_app.save_product()`.

#### `exit_application`

```python
def exit_application(self):
    """ Exit the application """
```

**Назначение**: Закрывает приложение.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Вызывает метод `close()` для закрытия главного окна приложения.

#### `copy`

```python
def copy(self):
    """ Copy selected text to the clipboard """
```

**Назначение**: Копирует выделенный текст в буфер обмена.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Определяет виджет, находящийся в фокусе.
- Проверяет, является ли виджет текстовым полем (`QLineEdit`, `QTextEdit`, `QPlainTextEdit`).
- Если является, вызывает метод `copy()` для копирования выделенного текста.
- Если не является, выводит предупреждающее сообщение.

#### `paste`

```python
def paste(self):
    """ Paste text from the clipboard """
```

**Назначение**: Вставляет текст из буфера обмена.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Определяет виджет, находящийся в фокусе.
- Проверяет, является ли виджет текстовым полем (`QLineEdit`, `QTextEdit`, `QPlainTextEdit`).
- Если является, вызывает метод `paste()` для вставки текста.
- Если не является, выводит предупреждающее сообщение.

#### `load_file`

```python
def load_file(self, campaign_file):
    """ Load the JSON file """
```

**Назначение**: Загружает JSON-файл.

**Параметры**:
- `campaign_file` (str): Путь к JSON-файлу.

**Возвращает**:
- Нет

**Как работает функция**:
- Пытается вызвать метод `promotion_app.load_file()` для загрузки файла.
- Если происходит исключение, выводит сообщение об ошибке.

## Функции

### `main`

```python
def main():
    """ Initialize and run the application """
```

**Назначение**: Инициализирует и запускает приложение.

**Параметры**:
- Нет

**Возвращает**:
- Нет

**Как работает функция**:
- Создает экземпляр `QApplication`.
- Создает цикл событий для асинхронных операций.
- Создает экземпляр `MainApp`.
- Отображает главное окно приложения.
- Запускает цикл событий.