# Модуль для отправки сообщений в WhatsApp

## Обзор

Модуль `whatsapp_sender.py` предназначен для автоматической отправки сообщений в WhatsApp с использованием библиотеки `pywhatkit` и `pyautogui`. Он позволяет отправлять заданное количество сообщений на указанный номер телефона в случайное время в пределах заданного временного интервала.

## Подробнее

Модуль использует библиотеку `pywhatkit` для автоматизации отправки сообщений через веб-интерфейс WhatsApp. Библиотека `pyautogui` используется для эмуляции нажатия клавиши Enter для отправки сообщения. Модуль также содержит банк сообщений с использованием эмодзи.

## Функции

### `send_whatsapp_message`

```python
def send_whatsapp_message(phone_number, message, hour, minutes):
    """Sends a WhatsApp message using pywhatkit and pyautogui."""
```

**Назначение**: Отправляет сообщение в WhatsApp с использованием библиотеки `pywhatkit` и `pyautogui`.

**Параметры**:

-   `phone_number` (str): Номер телефона получателя в международном формате.
-   `message` (str): Текст сообщения для отправки.
-   `hour` (int): Час отправки сообщения (0-23).
-   `minutes` (int): Минута отправки сообщения (0-59).

**Возвращает**:

-   `None`: Функция ничего не возвращает.

**Вызывает исключения**:

-   `Exception`: Если происходит ошибка во время отправки сообщения.

**Как работает функция**:

1.  Функция вызывает `pywhatkit.sendwhatmsg` для отправки сообщения через веб-интерфейс WhatsApp. Функция `pywhatkit.sendwhatmsg` автоматически открывает веб-браузер, переходит на WhatsApp Web, находит указанный контакт и отправляет сообщение. Параметр `wait_time` указывает время ожидания загрузки веб-страницы, а `tab_close` указывает, следует ли закрывать вкладку после отправки сообщения.
2.  После отправки сообщения функция ждет 20 секунд, чтобы дать время WhatsApp Web загрузиться.
3.  Функция создает экземпляр класса `Controller` из библиотеки `pynput.keyboard` для управления клавиатурой.
4.  Функция эмулирует нажатие клавиши Enter для отправки сообщения, используя методы `press` и `release` класса `Controller`.
5.  В случае успеха отправки сообщения функция выводит сообщение "Message sent successfully!" в консоль.
6.  Если во время отправки сообщения происходит ошибка, функция перехватывает исключение и выводит сообщение об ошибке в консоль.

**Примеры**:

```python
send_whatsapp_message("+1234567890", "Hello, how are you?", 10, 30)
send_whatsapp_message("+1234567890", "Thinking of you!", 15, 45)
```

## Переменные

-   `messages` (List[str]): Список сообщений для отправки.
-   `phone_number` (str): Номер телефона получателя, запрошенный у пользователя.
-   `num_messages` (int): Количество сообщений для отправки, запрошенное у пользователя.
-   `start_hour` (int): Начальный час временного интервала для отправки сообщений, запрошенный у пользователя.
-   `end_hour` (int): Конечный час временного интервала для отправки сообщений, запрошенный у пользователя.
-    `message_count` (int): Счетчик отправленных сообщений.
-   `random_hour` (int): Случайный час для отправки сообщения, выбранный в пределах заданного временного интервала.
-   `random_minutes` (int): Случайная минута для отправки сообщения, выбранная в пределах заданного временного интервала.
-   `random_message` (str): Случайное сообщение, выбранное из списка `messages`.

## Цикл отправки сообщений

Модуль содержит цикл `while`, который выполняется до тех пор, пока количество отправленных сообщений не достигнет заданного значения `num_messages`. В каждой итерации цикла выполняются следующие действия:

1.  Генерируется случайный час и минута в пределах заданного временного интервала.
2.  Выбирается случайное сообщение из списка `messages`.
3.  Вызывается функция `send_whatsapp_message` для отправки сообщения на указанный номер телефона в указанное время.
4.  Увеличивается счетчик отправленных сообщений.