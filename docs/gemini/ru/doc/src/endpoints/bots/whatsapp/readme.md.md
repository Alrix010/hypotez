# Документация для автоматизированной отправки сообщений WhatsApp

## Обзор

Этот документ предоставляет руководство по созданию скрипта Python для автоматической отправки сообщений WhatsApp. Пользователь может настроить количество отправляемых сообщений и временной диапазон.

## Подробнее

Этот скрипт автоматизирует отправку сообщений WhatsApp, позволяя отправлять случайные сообщения в течение определенного периода времени. В документе описывается процесс разработки скрипта на языке Python, необходимое программное обеспечение и библиотеки, а также возможные проблемы и решения.

## Содержание

- [Необходимые компоненты](#необходимые-компоненты)
- [Процесс разработки](#процесс-разработки)
  - [Функция отправки сообщений (`send_whatsapp_message`)](#функция-отправки-сообщений-send_whatsapp_message)
  - [Банк сообщений](#банк-сообщений)
  - [Пользовательский ввод](#пользовательский-ввод)
  - [Основной цикл отправки](#основной-цикл-отправки)
- [Возможные проблемы и решения](#возможные-проблемы-и-решения)
- [Выполнение скрипта](#выполнение-скрипта)

## Необходимые компоненты

### 2.1. Библиотеки Python:
- `pywhatkit`: Для взаимодействия с веб-версией WhatsApp и отправки сообщений.
- `pyautogui`: Для автоматизации действий мыши и клавиатуры.
- `pynput`: Для контроля клавиатурного ввода.
- `emoji`: Для добавления эмодзи в сообщения.
- `random`: Для генерации случайных сообщений и времени.
- `time`: Для управления задержками и временем выполнения.
### 2.2. Зависимости
Установка указанных библиотек выполняется посредством pip:
```bash
pip install pywhatkit pyautogui pynput emoji
```
### 2.3. Требования к системе:
Операционная система с установленным веб-браузером (например, Chrome или Firefox) и возможностью подключения к WhatsApp Web.

## Процесс разработки

### 3.1. Функция отправки сообщений (`send_whatsapp_message`)

**Назначение**: Функция отвечает за отправку сообщений WhatsApp с использованием библиотеки `pywhatkit`.

**Параметры**:
- `phone_number` (str): Номер телефона получателя (с кодом страны).
- `message` (str): Текст сообщения.
- `hour` (int): Час отправки сообщения (0-23).
- `minutes` (int): Минуты отправки сообщения (0-59).

**Как работает функция**:
1. Функция инициализирует отправку сообщения с использованием `pywhatkit.sendwhatmsg`.
2.  Применяет `time.sleep` для задержки загрузки веб-версии WhatsApp.
3. Применяет `pyautogui` и `pynput` для имитации нажатия клавиши "Enter" для отправки сообщения.
4.  Обрабатывает исключения с помощью блока `try...except` для вывода ошибок.

**Примеры**:
```python
phone_number = "+79991234567"
message = "Привет! Это автоматическое сообщение."
hour = 10
minutes = 30

# Вызов функции send_whatsapp_message с параметрами
# send_whatsapp_message(phone_number, message, hour, minutes)
```

### 3.2. Банк сообщений

**Назначение**: Создание списка строк (`messages`) для хранения сообщений, использование `emoji.emojize` для добавления эмодзи, применение `random.choice` для случайного выбора сообщения.

**Как работает**:
1. Создается список (`messages`), содержащий различные текстовые сообщения.
2.  Для добавления эмодзи в сообщения используется функция `emoji.emojize`.
3. Для случайного выбора сообщения из списка применяется функция `random.choice`.

**Примеры**:
```python
import emoji
import random

messages = [
    emoji.emojize("Привет! Как дела? :waving_hand:"),
    emoji.emojize("Удачного дня! :sun:"),
    emoji.emojize("Спасибо за внимание! :thumbs_up:")
]

# Выбор случайного сообщения из списка
random_message = random.choice(messages)
# print(random_message)
```

### 3.3. Пользовательский ввод

**Назначение**: Получение количества сообщений (`num_messages`) с помощью функции `input`, получение начального часа (`start_hour`) и конечного часа (`end_hour`) диапазона отправки с помощью `input`.

**Как работает**:
1. Запрашивается количество сообщений, которое необходимо отправить, с использованием функции `input`.
2. Запрашивается начальный и конечный час для диапазона отправки сообщений, также с использованием функции `input`.

**Примеры**:
```python
# Получение количества сообщений от пользователя
num_messages = input("Введите количество сообщений для отправки: ")

# Получение начального часа для отправки сообщений
start_hour = input("Введите начальный час для отправки сообщений: ")

# Получение конечного часа для отправки сообщений
end_hour = input("Введите конечный час для отправки сообщений: ")
```

### 3.4. Основной цикл отправки

**Назначение**: Выполнение цикла `while`, пока счетчик сообщений (`message_count`) не достигнет заданного количества (`num_messages`), генерация случайного часа и минут с помощью `random.randint`, вызов функции `send_whatsapp_message` с полученными данными, увеличение счетчика сообщений.

**Как работает**:
1. Инициализируется цикл `while`, который выполняется до тех пор, пока счетчик отправленных сообщений (`message_count`) не достигнет заданного количества (`num_messages`).
2. Внутри цикла генерируются случайные значения часа и минут с помощью функции `random.randint`.
3.  Вызывается функция `send_whatsapp_message` с передачей номера телефона, текста сообщения, сгенерированного часа и минут.
4. После каждого вызова функции `send_whatsapp_message` увеличивается счетчик отправленных сообщений (`message_count`).

**Примеры**:
```python
import random

# Заданное количество сообщений для отправки
num_messages = 5
message_count = 0

while message_count < num_messages:
    # Генерация случайного часа и минут
    hour = random.randint(0, 23)
    minutes = random.randint(0, 59)

    # Вызов функции send_whatsapp_message
    # send_whatsapp_message(phone_number, message, hour, minutes)

    # Увеличение счетчика сообщений
    message_count += 1
```

## Возможные проблемы и решения

*   **4.1. Проблемы с `pywhatkit`:** В случае неудачной автоматической отправки сообщения, использовать `pyautogui` и `pynput` для эмуляции нажатия клавиш и отправки сообщения.
*   **4.2. Подключение к WhatsApp Web:** При первом использовании необходимо подключение к веб-версии WhatsApp через веб-браузер.
*   **4.3. Динамическая задержка:** Скорость загрузки веб-версии WhatsApp может меняться, поэтому для стабильности увеличьте время задержки.
*   **4.4. Зависимость от браузера и версии WhatsApp:** Изменения в браузере или веб-версии WhatsApp могут потребовать корректировки скрипта.

## Выполнение скрипта

*   Сохраните скрипт в файл с расширением `.py`.
*   Выполните скрипт в терминале с помощью команды: `python имя_файла.py`
*   Следуйте инструкциям на экране для ввода необходимых данных.