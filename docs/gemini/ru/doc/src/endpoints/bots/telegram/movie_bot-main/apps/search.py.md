# Модуль для поиска фильмов и сериалов на Kinopoisk через Google Search
=====================================================================

Модуль содержит функцию `search_query`, которая выполняет поиск фильмов или сериалов на сайте Kinopoisk через поисковую систему Google и возвращает информацию о найденном результате.

## Обзор

Этот модуль предназначен для поиска информации о фильмах и сериалах на сайте Kinopoisk с использованием поисковой системы Google. Он использует библиотеку `requests` для выполнения HTTP-запросов, `bs4` (Beautiful Soup) для парсинга HTML-ответа, и `dotenv` для загрузки переменных окружения.

## Подробней

Модуль предоставляет функцию `search_query`, которая принимает поисковый запрос и тип контента (фильм или сериал) в качестве аргументов. Функция формирует поисковый запрос для Google, отправляет HTTP-запрос, анализирует HTML-ответ и извлекает информацию о первом найденном результате, включая ссылку, заголовок и описание.

## Функции

### `search_query`

```python
def search_query(query, type_movie='series'):
    """ Функция выполняет поиск фильмов или сериалов на сайте Kinopoisk через поисковую систему Google.

    Args:
        query (str): Поисковый запрос.
        type_movie (str, optional): Тип искомого контента ('series' для сериалов, 'films' для фильмов). По умолчанию 'series'.

    Returns:
        dict | None: Словарь с информацией о найденном результате (ссылка, заголовок, описание) или None, если ничего не найдено.

    Raises:
        requests.exceptions.RequestException: Если возникает ошибка при выполнении HTTP-запроса.
        bs4.FeatureNotFound: Если не удается найти указанный парсер.
    """
```

#### Как работает функция `search_query`

1.  Формирует поисковый запрос для Google, используя переданный запрос и тип контента.
2.  Отправляет HTTP-запрос к Google с использованием библиотеки `requests`. Указывает User-Agent для имитации запроса от браузера.
3.  Анализирует HTML-ответ с использованием библиотеки `BeautifulSoup`.
4.  Находит все блоки результатов поиска (div с классом "g").
5.  Перебирает блоки результатов поиска и извлекает ссылку, заголовок и описание из каждого блока.
6.  Проверяет, является ли ссылка ссылкой на Kinopoisk (проверяет, является ли предпоследний элемент URL числом).
7.  Если ссылка соответствует Kinopoisk, возвращает словарь с информацией о результате.
8.  Если ничего не найдено, возвращает `None`.

#### Параметры функции `search_query`

*   `query` (str): Поисковый запрос.
*   `type_movie` (str, optional): Тип искомого контента ('series' для сериалов, 'films' для фильмов). По умолчанию 'series'.

#### Возвращаемое значение функции `search_query`

*   `dict | None`: Словарь с информацией о найденном результате (ссылка, заголовок, описание) или `None`, если ничего не найдено.

#### Примеры вызова функции `search_query`

```python
from apps.search import search_query

# Поиск сериала "теория большого взрыва"
result = search_query('теория большого взрыва')
print(result)
# {'link': 'https://w2.kpfr.wiki/series/123456/', 'title': 'Теория большого взрыва - Кинопоиск', 'description': 'Описание сериала...'}

# Поиск фильма "Назад в будущее"
result = search_query('Назад в будущее', type_movie='films')
print(result)
# {'link': 'https://w2.kpfr.wiki/films/654321/', 'title': 'Назад в будущее - Кинопоиск', 'description': 'Описание фильма...'}