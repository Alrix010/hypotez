# Модуль `crypto`

## Обзор

Модуль `crypto` предоставляет функции для шифрования и дешифрования данных с использованием алгоритма AES в режиме CBC. 

## Подробнее

Этот модуль используется в проекте `hypotez` для шифрования и дешифрования различных типов данных, таких как атрибуты файлов, ключи и т.д. 

## Функции

### `aes_cbc_encrypt`

**Назначение**: Шифрует данные с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `data` (bytes): Данные для шифрования.
- `key` (bytes): Ключ для шифрования.

**Возвращает**:

- `bytes`: Зашифрованные данные.

**Примеры**:

```python
>>> key = b'my_secret_key'
>>> data = b'Hello, world!'
>>> encrypted_data = aes_cbc_encrypt(data, key)
>>> encrypted_data
b'\x0f\x00\x00\x00\x1b\x80\x05\x00\x10\x00\x00\x00\x02\x00\x00\x00\x05\x00\x00\x00\x1a\x80\x10\x00\x0f\x00\x00\x00\x1e\x80\x05\x00'
```


### `aes_cbc_decrypt`

**Назначение**: Дешифрует данные, зашифрованные с помощью `aes_cbc_encrypt`.

**Параметры**:

- `data` (bytes): Зашифрованные данные.
- `key` (bytes): Ключ для дешифрования.

**Возвращает**:

- `bytes`: Дешифрованные данные.

**Примеры**:

```python
>>> key = b'my_secret_key'
>>> data = b'Hello, world!'
>>> encrypted_data = aes_cbc_encrypt(data, key)
>>> decrypted_data = aes_cbc_decrypt(encrypted_data, key)
>>> decrypted_data
b'Hello, world!'
```

### `aes_cbc_encrypt_a32`

**Назначение**: Шифрует данные, представленные в виде списка 32-битных целых чисел, с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `data` (list): Данные для шифрования, представленные в виде списка 32-битных целых чисел.
- `key` (list): Ключ для шифрования, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `list`: Зашифрованные данные, представленные в виде списка 32-битных целых чисел.

**Примеры**:

```python
>>> key = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> data = [0x01020304, 0x05060708, 0x090A0B0C, 0x0D0E0F10]
>>> encrypted_data = aes_cbc_encrypt_a32(data, key)
>>> encrypted_data
[3910223554, 1739319740, 1739229594, 4199586486]
```

### `aes_cbc_decrypt_a32`

**Назначение**: Дешифрует данные, зашифрованные с помощью `aes_cbc_encrypt_a32`.

**Параметры**:

- `data` (list): Зашифрованные данные, представленные в виде списка 32-битных целых чисел.
- `key` (list): Ключ для дешифрования, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `list`: Дешифрованные данные, представленные в виде списка 32-битных целых чисел.

**Примеры**:

```python
>>> key = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> data = [0x01020304, 0x05060708, 0x090A0B0C, 0x0D0E0F10]
>>> encrypted_data = aes_cbc_encrypt_a32(data, key)
>>> decrypted_data = aes_cbc_decrypt_a32(encrypted_data, key)
>>> decrypted_data
[16909060, 134217728, 234881028, 355544320]
```

### `stringhash`

**Назначение**: Вычисляет хеш-сумму строки с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `s` (str): Строка для хеширования.
- `aeskey` (list): Ключ для хеширования, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `str`: Хеш-сумма строки в формате Base64.

**Примеры**:

```python
>>> aeskey = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> stringhash('Hello, world!', aeskey)
'6m8lV78rX63T4r+Q/kQ=='
```

### `prepare_key`

**Назначение**: Подготавливает ключ для шифрования, выполняя 0x10000 итераций шифрования с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `a` (list): Ключ для подготовки, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `list`: Подготовленный ключ, представленный в виде списка 32-битных целых чисел.

**Примеры**:

```python
>>> a = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> prepare_key(a)
[1833845955, 3250241540, 2129758657, 168258036]
```

### `encrypt_key`

**Назначение**: Шифрует ключ, представленный в виде списка 32-битных целых чисел, с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `a` (list): Ключ для шифрования, представленный в виде списка 32-битных целых чисел.
- `key` (list): Ключ для шифрования, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `tuple`: Зашифрованный ключ, представленный в виде кортежа 32-битных целых чисел.

**Примеры**:

```python
>>> key = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> a = [0x01020304, 0x05060708, 0x090A0B0C, 0x0D0E0F10]
>>> encrypt_key(a, key)
(3910223554, 1739319740, 1739229594, 4199586486, 2639363147, 3760512581, 1596793642, 3720852376, 1763386922, 2438309905, 1628496541, 3098994262, 4063081875, 3875670565, 3644018667, 1941088692)
```

### `decrypt_key`

**Назначение**: Дешифрует ключ, зашифрованный с помощью `encrypt_key`.

**Параметры**:

- `a` (list): Зашифрованный ключ, представленный в виде списка 32-битных целых чисел.
- `key` (list): Ключ для дешифрования, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `tuple`: Дешифрованный ключ, представленный в виде кортежа 32-битных целых чисел.

**Примеры**:

```python
>>> key = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> a = [0x01020304, 0x05060708, 0x090A0B0C, 0x0D0E0F10]
>>> encrypted_key = encrypt_key(a, key)
>>> decrypted_key = decrypt_key(encrypted_key, key)
>>> decrypted_key
(16909060, 134217728, 234881028, 355544320, 252645136, 201326592, 276824064, 362905600, 298086912, 394168448, 244849760, 340931296, 388412160, 341693440, 312014336, 197095616)
```

### `enc_attr`

**Назначение**: Шифрует атрибуты файла с использованием алгоритма AES в режиме CBC.

**Параметры**:

- `attr` (dict): Словарь с атрибутами файла.
- `key` (list): Ключ для шифрования, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `bytes`: Зашифрованные атрибуты файла.

**Примеры**:

```python
>>> key = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> attr = {'name': 'test.txt', 'size': 1024}
>>> enc_attr(attr, key)
b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x15\x80\x08\x00\x15\x80\x02\x00\x12\x80\x15\x00\x05\x80\x12\x00\x0a\x80\x08\x00\x0e\x80\x08\x00\x0b\x80\x15\x00\x10\x80\x02\x00\x03\x80\x08\x00\x19\x80\x1a\x00\x09\x80\x11\x00\x11\x80\x11\x00\x0b\x80\x0b\x00\x06\x80\x1b\x00\x05\x80\x1b\x00\x0b\x80\x11\x00\x10\x80\x06\x00\x04\x80\x0f\x00\x0f\x80\x0e\x00\x05\x80\x0e\x00\x12\x80\x10\x00\x17\x80\x11\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
```

### `dec_attr`

**Назначение**: Дешифрует атрибуты файла, зашифрованные с помощью `enc_attr`.

**Параметры**:

- `attr` (bytes): Зашифрованные атрибуты файла.
- `key` (list): Ключ для дешифрования, представленный в виде списка 32-битных целых чисел.

**Возвращает**:

- `dict`: Дешифрованные атрибуты файла.

**Примеры**:

```python
>>> key = [0x12345678, 0x9ABCDEF0, 0x01234567, 0x89ABCDEF]
>>> attr = {'name': 'test.txt', 'size': 1024}
>>> encrypted_attr = enc_attr(attr, key)
>>> decrypted_attr = dec_attr(encrypted_attr, key)
>>> decrypted_attr
{'name': 'test.txt', 'size': 1024}