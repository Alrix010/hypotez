# Модуль `GetGpt.py`

## Обзор

Модуль `GetGpt.py` обеспечивает взаимодействие с API `chat.getgpt.world` для получения ответов от модели GPT-3.5-turbo. 

## Подробности

Данный модуль предоставляет набор функций и настроек для работы с API `chat.getgpt.world`. 

## Классы

### `None`

В этом модуле нет классов.

## Функции

### `_create_completion`

**Назначение**: Функция `_create_completion` отправляет запрос к API `chat.getgpt.world` с заданным набором сообщений и параметрами, а затем возвращает ответ в виде потока текста.

**Параметры**:
- `model` (str): Имя используемой модели (например, "gpt-3.5-turbo"). 
- `messages` (list): Список сообщений для отправки в API.
- `stream` (bool): Флаг, указывающий, нужно ли получать ответ в виде потока текста.

**Возвращает**:
- `Generator[str, None, None]`: Генератор, который поэтапно выдает части текста ответа.

**Вызывает исключения**:
- `requests.exceptions.RequestException`: Если возникает ошибка при отправке запроса к API.
- `json.JSONDecodeError`: Если полученный ответ от API не является корректным JSON.

**Как работает функция**:
- Функция создает заголовок запроса, включающий `Content-Type`, `Referer` и `user-agent`.
- Функция формирует данные для отправки в API, включая список сообщений, параметры модели и идентификатор запроса (UUID).
- Используя `requests.post`, функция отправляет запрос к API `https://chat.getgpt.world/api/chat/stream` с зашифрованными данными.
- Функция считывает ответ от API построчно и использует генератор, чтобы выдать части текста ответа по мере их получения.

**Внутренние функции**:

**`encrypt`**: 

**Назначение**: Функция `encrypt` шифрует данные с помощью алгоритма AES в режиме CBC. 

**Параметры**:
- `e` (str): Данные для шифрования.

**Возвращает**:
- `str`: Зашифрованные данные.

**Как работает функция**:
- Генерация случайных ключей и вектора инициализации (IV).
- Преобразование данных в байты.
- Использование `AES.new` для создания объекта шифрования AES.
- Шифрование данных с помощью `cipher.encrypt`.
- Преобразование зашифрованных данных в шестнадцатеричный формат.

**`pad_data`**: 

**Назначение**: Функция `pad_data` дополняет данные до размера, кратного блоку шифрования AES.

**Параметры**:
- `data` (bytes): Данные для дополнения.

**Возвращает**:
- `bytes`: Дополненные данные.

**Как работает функция**:
- Вычисление размера дополнения.
- Создание заполнителя нужной длины.
- Добавление заполнителя к исходным данным.


**Пример**:
```python
# Пример вызова функции _create_completion
messages = [
    {'role': 'user', 'content': 'Привет! Как дела?'},
]

response = _create_completion(model='gpt-3.5-turbo', messages=messages, stream=True)

# Вывод текста по мере его получения
for chunk in response:
    print(chunk)
```

## Параметры

- `url` (str): URL API `chat.getgpt.world`.
- `model` (list): Список поддерживаемых моделей (в данном случае, только `gpt-3.5-turbo`).
- `supports_stream` (bool): Флаг, указывающий, поддерживает ли провайдер потоковый вывод текста.
- `needs_auth` (bool): Флаг, указывающий, требуется ли аутентификация для использования API.

## Примеры

```python
from ...typing import Dict, get_type_hints
import os

params = f'g4f.Providers.{os.path.basename(__file__)[:-3]} supports: ' + \\\
    '(%s)' % ', '.join(\
        [f'{name}: {get_type_hints(_create_completion)[name].__name__}' for name in _create_completion.__code__.co_varnames[:_create_completion.__code__.co_argcount]])