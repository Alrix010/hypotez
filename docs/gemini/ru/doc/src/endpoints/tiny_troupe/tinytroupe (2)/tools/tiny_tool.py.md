# Модуль TinyTool

## Обзор

Этот модуль предоставляет класс `TinyTool`, который представляет собой базовый класс для инструментов в TinyTroupe. 

## Подробней

Класс `TinyTool` служит для создания и управления инструментами, которые могут быть использованы агентами в среде TinyTroupe. Инструменты реализуют определенные действия (например, отправка сообщения, запуск процесса) и могут иметь владельца,  указание на наличие реальных последствий в реальном мире (например, изменение состояния внешней системы) и возможность экспорта результатов. 

## Классы

### `class TinyTool`

**Описание**: Базовый класс для инструментов в TinyTroupe. 

**Наследует**: `JsonSerializableRegistry`

**Атрибуты**:

- `name` (str): Имя инструмента.
- `description` (str): Краткое описание инструмента.
- `owner` (str): Агент, который владеет инструментом. Если значение `None`, инструмент может быть использован любым агентом.
- `real_world_side_effects` (bool): Флаг, указывающий, имеет ли инструмент реальные последствия в реальном мире. 
- `exporter` (ArtifactExporter): Экспортер, который можно использовать для экспорта результатов действий инструмента. Если значение `None`, инструмент не сможет экспортировать результаты.
- `enricher` (Enricher): Обогатитель, который можно использовать для обогащения результатов действий инструмента. Если значение `None`, инструмент не сможет обогащать результаты.


**Методы**:

- `_process_action(self, agent, action: dict) -> bool`: Абстрактный метод, который должен быть реализован в подклассах. Этот метод обрабатывает действие, которое выполняется инструментом.
- `_protect_real_world(self)`: Метод, который выводит предупреждение, если инструмент имеет реальные последствия в реальном мире.
- `_enforce_ownership(self, agent)`: Метод, который проверяет, владеет ли агент инструментом.
- `set_owner(self, owner)`: Метод, который устанавливает владельца инструмента.
- `actions_definitions_prompt(self) -> str`: Абстрактный метод, который должен быть реализован в подклассах. Этот метод возвращает подсказку для определения действий, которые может выполнять инструмент.
- `actions_constraints_prompt(self) -> str`: Абстрактный метод, который должен быть реализован в подклассах. Этот метод возвращает подсказку для определения ограничений на действия инструмента.
- `process_action(self, agent, action: dict) -> bool`: Метод, который обрабатывает действие, которое выполняется инструментом. Он выводит предупреждение, если инструмент имеет реальные последствия в реальном мире, проверяет владение инструментом и вызывает метод `_process_action`.


**Примеры**:

```python
from tinytroupe.tools import TinyTool, logger

# Создание инструмента
tool = TinyTool(name='MyTool', description='Tool for doing something', real_world_side_effects=False)

# Задание владельца
tool.set_owner('Agent1')

# Выполнение действия
action = {'action': 'do_something'}
tool.process_action(agent='Agent1', action=action)

# Вывод предупреждения, если инструмент имеет реальные последствия в реальном мире
tool.real_world_side_effects = True
tool.process_action(agent='Agent1', action=action)
```

## Внутренние функции

### `_process_action(self, agent, action: dict) -> bool`

**Назначение**: Метод, который должен быть реализован в подклассах для обработки действия, выполняемого инструментом.

**Параметры**:

- `agent` (Agent): Агент, который выполняет действие.
- `action` (dict): Словарь, содержащий информацию о действии.


**Возвращает**:

- `bool`: Флаг, указывающий на успешное выполнение действия.


**Пример**:

```python
class MyTool(TinyTool):

    def _process_action(self, agent, action: dict) -> bool:
        # Обработка действия
        # ...
        return True 
```

### `_protect_real_world(self)`

**Назначение**: Метод, который выводит предупреждение, если инструмент имеет реальные последствия в реальном мире.

**Параметры**:

-  Нет


**Возвращает**:

-  Нет

**Пример**:

```python
class MyTool(TinyTool):

    def _protect_real_world(self):
        # ...
        logger.warning("!!!!!! Tool has REAL-WORLD SIDE EFFECTS. !!!!!!!!!!")
        # ...
```

### `_enforce_ownership(self, agent)`

**Назначение**: Метод, который проверяет, владеет ли агент инструментом.

**Параметры**:

- `agent` (Agent): Агент, который пытается использовать инструмент.


**Возвращает**:

-  Нет

**Пример**:

```python
class MyTool(TinyTool):

    def _enforce_ownership(self, agent):
        # ...
        if self.owner is not None and agent.name != self.owner.name:
            raise ValueError("Agent does not own tool")
        # ...
```

### `actions_definitions_prompt(self) -> str`

**Назначение**: Абстрактный метод, который должен быть реализован в подклассах. Этот метод возвращает подсказку для определения действий, которые может выполнять инструмент.


**Параметры**:

-  Нет


**Возвращает**:

- `str`: Подсказка для определения действий.


**Пример**:

```python
class MyTool(TinyTool):

    def actions_definitions_prompt(self) -> str:
        # ...
        return "This tool can perform the following actions: ..."
        # ...
```

### `actions_constraints_prompt(self) -> str`

**Назначение**: Абстрактный метод, который должен быть реализован в подклассах. Этот метод возвращает подсказку для определения ограничений на действия инструмента.


**Параметры**:

-  Нет


**Возвращает**:

- `str`: Подсказка для определения ограничений.


**Пример**:

```python
class MyTool(TinyTool):

    def actions_constraints_prompt(self) -> str:
        # ...
        return "The tool is subject to the following constraints: ..."
        # ...
```

### `process_action(self, agent, action: dict) -> bool`

**Назначение**: Метод, который обрабатывает действие, выполняемое инструментом. Он выводит предупреждение, если инструмент имеет реальные последствия в реальном мире, проверяет владение инструментом и вызывает метод `_process_action`.


**Параметры**:

- `agent` (Agent): Агент, который выполняет действие.
- `action` (dict): Словарь, содержащий информацию о действии.


**Возвращает**:

- `bool`: Флаг, указывающий на успешное выполнение действия.

**Пример**:

```python
class MyTool(TinyTool):

    def process_action(self, agent, action: dict) -> bool:
        # ...
        self._protect_real_world()
        self._enforce_ownership(agent)
        return self._process_action(agent, action)
        # ...