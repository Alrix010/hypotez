# Модуль TinyWordProcessor

## Обзор

Модуль `TinyWordProcessor` предоставляет функциональность для работы с текстовыми документами. 

## Подробнее

Модуль `TinyWordProcessor` реализует класс `TinyWordProcessor`, который позволяет агентам создавать и сохранять текстовые документы. 

## Классы

### `TinyWordProcessor`

**Описание**: Класс, реализующий функциональность текстового процессора для агентов.

**Наследует**: `TinyTool`

**Атрибуты**:

- `owner`: Владелец инструмента (агент).
- `exporter`: Экспортер данных.
- `enricher`: Модуль для обогащения текста.

**Методы**:

- `write_document(title, content, author=None)`: Создает документ с заданным заголовком, текстом и автором.
- `_process_action(agent, action)`: Обрабатывает действия агента для создания документа.
- `actions_definitions_prompt()`: Возвращает подсказку с описанием допустимых действий.
- `actions_constraints_prompt()`: Возвращает подсказку с ограничениями на действия.

**Пример**:

```python
# Создание объекта TinyWordProcessor
processor = TinyWordProcessor()

# Создание документа
processor.write_document(title="Мой документ", content="Это текст документа.", author="Иван Иванов")
```

### `write_document`

**Назначение**: Создает документ с заданным заголовком, текстом и автором. 

**Параметры**:

- `title` (str): Заголовок документа.
- `content` (str): Текст документа.
- `author` (str, optional): Автор документа. По умолчанию `None`.

**Возвращает**: 
- `None`

**Вызывает исключения**: 
- `Exception`: При возникновении ошибки.

**Пример**:

```python
processor.write_document(title="Мой документ", content="Это текст документа.", author="Иван Иванов")
```

**Как работает функция**:

- Функция сначала проверяет, доступен ли модуль `enricher`. Если доступен, функция использует его для обогащения текста документа.
- Затем функция проверяет, доступен ли модуль `exporter`. Если доступен, функция экспортирует текст документа в различные форматы, такие как Markdown, DOCX и JSON.

### `_process_action`

**Назначение**: Обрабатывает действия агента для создания документа.

**Параметры**:

- `agent`: Агент, который выполняет действие.
- `action`: Словарь, описывающий действие.

**Возвращает**: 
- `bool`: True, если действие успешно обработано, False - в противном случае.

**Вызывает исключения**: 
- `json.JSONDecodeError`: Если возникла ошибка при разборе JSON-данных.
- `Exception`: При возникновении ошибки.

**Пример**:

```python
processor._process_action(agent, {"type": "WRITE_DOCUMENT", "content": {"title": "Мой документ", "content": "Это текст документа.", "author": "Иван Иванов"}})
```

**Как работает функция**:

- Функция сначала проверяет тип действия. Если тип действия - `WRITE_DOCUMENT` и `content` не равен `None`, функция продолжает обработку.
- Функция проверяет, является ли `content` строкой. Если да, то функция извлекает JSON-данные из строки.
- Функция проверяет, есть ли в JSON-данных невалидные ключи.
- Функция вызывает функцию `write_document` для создания документа.
- Функция возвращает True, если действие успешно обработано.

### `actions_definitions_prompt`

**Назначение**: Возвращает подсказку с описанием допустимых действий.

**Параметры**: 
- Нет

**Возвращает**: 
- `str`: Подсказка с описанием допустимых действий.

**Вызывает исключения**: 
- Нет

**Пример**:

```python
processor.actions_definitions_prompt()
```

**Как работает функция**:

- Функция просто возвращает строку, содержащую описание допустимых действий.

### `actions_constraints_prompt`

**Назначение**: Возвращает подсказку с ограничениями на действия.

**Параметры**: 
- Нет

**Возвращает**: 
- `str`: Подсказка с ограничениями на действия.

**Вызывает исключения**: 
- Нет

**Пример**:

```python
processor.actions_constraints_prompt()
```

**Как работает функция**:

- Функция просто возвращает строку, содержащую ограничения на действия.

## Внутренние функции

### `extract_json`

**Назначение**: Извлекает JSON-данные из строки.

**Параметры**:

- `content` (str): Строка, содержащая JSON-данные.

**Возвращает**: 
- `dict`: Словарь, содержащий JSON-данные.

**Вызывает исключения**: 
- `json.JSONDecodeError`: Если возникла ошибка при разборе JSON-данных.

**Пример**:

```python
data = utils.extract_json('{"title": "Мой документ", "content": "Это текст документа.", "author": "Иван Иванов"}')
```

**Как работает функция**:

- Функция использует модуль `json` для разбора JSON-данных из строки.

### `check_valid_fields`

**Назначение**: Проверяет, есть ли в словаре невалидные ключи.

**Параметры**:

- `data` (dict): Словарь, который нужно проверить.
- `valid_keys` (list): Список допустимых ключей.

**Возвращает**: 
- `None`

**Вызывает исключения**: 
- `ValueError`: Если в словаре найдены невалидные ключи.

**Пример**:

```python
utils.check_valid_fields({"title": "Мой документ", "content": "Это текст документа.", "author": "Иван Иванов"}, ["title", "content", "author"])
```

**Как работает функция**:

- Функция проверяет, есть ли в словаре ключи, которые не входят в список `valid_keys`.
- Если найдены невалидные ключи, функция выводит исключение `ValueError`.