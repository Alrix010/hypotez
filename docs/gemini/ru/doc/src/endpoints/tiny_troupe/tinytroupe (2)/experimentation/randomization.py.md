# Модуль рандомизации

## Обзор

Этот модуль предоставляет класс `ABRandomizer`, который используется для рандомизации двух вариантов и последующей дерандомизации.  Он предоставляет функции для выполнения рандомизации, дерандомизации и преобразования зашифрованного варианта, представленного пользователю, обратно в исходный.

## Классы

### `ABRandomizer`

**Описание**: Класс, который рандомизирует два варианта, и дерандомизирует их позже.
**Наследует**: Класс не наследует другие классы.

**Атрибуты**:
- `choices` (dict): Словарь, который хранит информацию о рандомизации. Ключ - это индекс элемента, значение - кортеж из двух чисел, которые указывают, были ли варианты переключены для данного элемента.
- `real_name_1` (str): Название первого варианта, как оно представлено в данных.
- `real_name_2` (str): Название второго варианта, как оно представлено в данных.
- `blind_name_a` (str): Название первого варианта, как оно представлено пользователю.
- `blind_name_b` (str): Название второго варианта, как оно представлено пользователю.
- `passtrough_name` (list): Список названий, которые не рандомизируются и всегда возвращаются как есть.
- `random_seed` (int): Случайное число, используемое для рандомизации.

**Методы**:
- `randomize(self, i, a, b)`: Выполняет рандомизацию между двумя вариантами `a` и `b` для элемента с индексом `i`. Сохраняет информацию о переключении вариантов для последующей дерандомизации.
- `derandomize(self, i, a, b)`: Дерандомизирует варианты для элемента с индексом `i`, возвращая исходные варианты `a` и `b`.
- `derandomize_name(self, i, blind_name)`: Декодирует зашифрованное имя варианта, представленное пользователю, в исходное имя варианта.

## Функции

### `randomize(self, i, a, b)`

**Назначение**: Рандомизация вариантов для элемента с индексом `i`.

**Параметры**:
- `i` (int): Индекс элемента, для которого выполняется рандомизация.
- `a` (str): Первый вариант.
- `b` (str): Второй вариант.

**Возвращает**:
- `tuple`: Кортеж из двух вариантов: `a` и `b`, которые могут быть переключены.

**Как работает функция**:

1.  Функция использует случайное число для определения того, нужно ли переключать варианты. 
2.  Если случайное число меньше 0.5, функция сохраняет информацию о том, что варианты были переключены, и возвращает переключенные варианты `b` и `a`.
3.  Если случайное число больше 0.5, функция сохраняет информацию о том, что варианты не были переключены, и возвращает исходные варианты `a` и `b`.

**Примеры**:

```python
randomizer = ABRandomizer()
a, b = randomizer.randomize(0, "control", "treatment")
print(a, b)  # Вывод: treatment control (или control treatment)
```

### `derandomize(self, i, a, b)`

**Назначение**: Дерандомизация вариантов для элемента с индексом `i`.

**Параметры**:
- `i` (int): Индекс элемента, для которого выполняется дерандомизация.
- `a` (str): Первый вариант.
- `b` (str): Второй вариант.

**Возвращает**:
- `tuple`: Кортеж из двух вариантов `a` и `b`, которые могут быть дерандомизированы.

**Как работает функция**:

1.  Функция проверяет, были ли варианты переключены для элемента с индексом `i` в словаре `self.choices`.
2.  Если варианты были переключены, функция возвращает исходные варианты `a` и `b`.
3.  Если варианты не были переключены, функция возвращает переключенные варианты `b` и `a`.

**Примеры**:

```python
randomizer = ABRandomizer()
a, b = randomizer.randomize(0, "control", "treatment")
a_derandomized, b_derandomized = randomizer.derandomize(0, a, b)
print(a_derandomized, b_derandomized)  # Вывод: control treatment (или treatment control)
```

### `derandomize_name(self, i, blind_name)`

**Назначение**: Декодирует зашифрованное имя варианта, представленное пользователю, в исходное имя варианта.

**Параметры**:
- `i` (int): Индекс элемента.
- `blind_name` (str): Зашифрованное имя варианта, как оно представлено пользователю.

**Возвращает**:
- `str`: Исходное имя варианта.

**Как работает функция**:

1.  Функция проверяет, было ли имя `blind_name` рандомизировано для элемента с индексом `i`.
2.  Если оно было рандомизировано, функция возвращает противоположный вариант.
3.  Если оно не было рандомизировано, функция возвращает `blind_name` как есть.

**Примеры**:

```python
randomizer = ABRandomizer(blind_name_a="A", blind_name_b="B", real_name_1="control", real_name_2="treatment")
randomizer.randomize(0, "control", "treatment")
print(randomizer.derandomize_name(0, "A"))  # Вывод: treatment (или control)
```