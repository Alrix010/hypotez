# Документация для модуля `make_summary.py`

## Описание

Модуль `make_summary.py` предназначен для автоматического создания файла `SUMMARY.md`, используемого для компиляции документации с помощью инструментов, таких как `mdbook`. Модуль рекурсивно обходит указанную директорию с исходными файлами `.md` и генерирует оглавление, включая или исключая файлы в зависимости от указанного языка.

## Обзор

Модуль предназначен для автоматизации процесса создания файла `SUMMARY.md`, который необходим для компиляции документации с использованием `mdbook`. Он предоставляет гибкую настройку для фильтрации файлов по языку и позволяет легко управлять структурой документации.

## Подробней

Модуль обходит указанную директорию (обычно `src`) в поисках файлов с расширением `.md`. В зависимости от указанного языка (русский или английский), он включает или исключает файлы с суффиксом `.ru.md`. Результатом работы является файл `SUMMARY.md`, который содержит оглавление для всех найденных `.md` файлов, отформатированное для использования с `mdbook`. Это упрощает процесс создания и обновления документации для проекта.

## Файлы модуля

### `make_summary.py`

**Описание**: Основной файл модуля, содержащий логику для обхода директорий, фильтрации файлов и создания файла `SUMMARY.md`.

## Функции

### `main`

**Назначение**: Главная функция модуля, которая выполняет обход директорий, фильтрацию файлов и создание файла `SUMMARY.md`.

```python
def main(arg: list | None = None) -> None:
    """
    Главная функция для создания файла SUMMARY.md.

    Args:
        arg (list | None): Список аргументов командной строки. По умолчанию None.

    Returns:
        None

    Raises:
        FileNotFoundError: Если указанная директория не существует.
        Exception: При возникновении других ошибок в процессе выполнения.

    """
    ...
```

**Параметры**:
- `arg` (list | None): Список аргументов командной строки. Если не указан, используются аргументы из `sys.argv`.

**Возвращает**:
- `None`

**Вызывает исключения**:
- `FileNotFoundError`: Если указанная директория не существует.
- `Exception`: При возникновении других ошибок в процессе выполнения.

**Как работает функция**:

1. Функция `main` анализирует аргументы командной строки, используя `argparse`, чтобы получить директорию исходных файлов и язык фильтрации.
2. Если аргументы не переданы, используются значения по умолчанию.
3. Проверяется существование указанной директории.
4. В зависимости от языка фильтрации, функция обходит указанную директорию и создает файл `SUMMARY.md` с оглавлением для `.md` файлов. Файлы `.ru.md` включаются или исключаются в зависимости от значения параметра `-lang`.

**Примеры**:

```python
# Пример запуска функции с указанием языка и директории
main(['-lang', 'ru', 'src'])

# Пример запуска функции с использованием аргументов по умолчанию
main()
```

### `create_summary`

**Назначение**: Функция для создания файла `SUMMARY.md` на основе списка файлов.

```python
def create_summary(files: list[str]) -> None:
    """
    Создает файл SUMMARY.md на основе списка файлов.

    Args:
        files (list[str]): Список файлов, которые нужно включить в SUMMARY.md.

    Returns:
        None

    Raises:
        OSError: Если не удается открыть или записать файл SUMMARY.md.

    """
    ...
```

**Параметры**:
- `files` (list[str]): Список файлов, которые нужно включить в `SUMMARY.md`.

**Возвращает**:
- `None`

**Вызывает исключения**:
- `OSError`: Если не удается открыть или записать файл `SUMMARY.md`.

**Как работает функция**:

1. Функция `create_summary` получает список файлов, которые нужно включить в `SUMMARY.md`.
2. Открывает файл `SUMMARY.md` для записи в кодировке UTF-8.
3. Записывает заголовок "# Summary" в файл.
4. Для каждого файла в списке формирует строку оглавления в формате "- [{filename}]({filename})" и записывает её в файл.
5. Закрывает файл после записи всех строк.

**Примеры**:

```python
# Пример создания SUMMARY.md из списка файлов
create_summary(['file1.md', 'file2.ru.md', 'file3.en.md'])
```

### `walk_dir`

**Назначение**: Функция для рекурсивного обхода директории и сбора `.md` файлов.

```python
def walk_dir(path: str, lang: str = None) -> list[str]:
    """
    Рекурсивно обходит директорию и возвращает список .md файлов, отфильтрованных по языку.

    Args:
        path (str): Путь к директории для обхода.
        lang (str, optional): Язык для фильтрации файлов ('ru' или 'en'). По умолчанию None.

    Returns:
        list[str]: Список отфильтрованных .md файлов.

    Raises:
        FileNotFoundError: Если указанный путь не является директорией.
        OSError: Если возникают проблемы с доступом к файлам или директориям.

    """
    ...
```

**Параметры**:
- `path` (str): Путь к директории для обхода.
- `lang` (str, optional): Язык для фильтрации файлов (`'ru'` или `'en'`). По умолчанию `None`.

**Возвращает**:
- `list[str]`: Список отфильтрованных `.md` файлов.

**Вызывает исключения**:
- `FileNotFoundError`: Если указанный путь не является директорией.
- `OSError`: Если возникают проблемы с доступом к файлам или директориям.

**Как работает функция**:

1. Функция `walk_dir` рекурсивно обходит указанную директорию `path`.
2. Для каждого найденного файла проверяет, является ли он `.md` файлом.
3. В зависимости от значения параметра `lang`, файлы с суффиксом `.ru.md` включаются или исключаются.
4. Функция возвращает список всех найденных и отфильтрованных `.md` файлов.

**Примеры**:

```python
# Пример обхода директории без фильтрации по языку
files = walk_dir('src')

# Пример обхода директории с фильтрацией по русскому языку
files = walk_dir('src', lang='ru')

# Пример обхода директории с фильтрацией по английскому языку
files = walk_dir('src', lang='en')