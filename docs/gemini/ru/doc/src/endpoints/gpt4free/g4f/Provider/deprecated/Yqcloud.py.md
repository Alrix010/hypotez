# Модуль `Yqcloud`

## Обзор

Модуль `Yqcloud` предоставляет асинхронный генератор для взаимодействия с сервисом `chat9.yqcloud.top`. Он используется для генерации текстовых ответов на основе предоставленных сообщений, имитируя работу GPT-3.5 Turbo. Модуль поддерживает работу через прокси и обработку ошибок, связанных с блокировкой IP-адреса.

## Подробней

Модуль предназначен для интеграции с другими частями проекта `hypotez`, где требуется асинхронная генерация текста с использованием внешнего сервиса. Он предоставляет удобный интерфейс для отправки запросов и получения ответов в виде асинхронного генератора.

## Классы

### `Yqcloud`

**Описание**: Класс `Yqcloud` является провайдером асинхронной генерации текста.

**Наследует**: `AsyncGeneratorProvider`

**Атрибуты**:
- `url` (str): URL-адрес сервиса `chat9.yqcloud.top`.
- `working` (bool): Указывает, работает ли провайдер в данный момент.
- `supports_gpt_35_turbo` (bool): Указывает, поддерживает ли провайдер модель GPT-3.5 Turbo.

**Методы**:
- `create_async_generator()`: Создает асинхронный генератор для получения ответов от сервиса.

## Методы класса

### `create_async_generator`

```python
@staticmethod
async def create_async_generator(
    model: str,
    messages: Messages,
    proxy: str = None,
    timeout: int = 120,
    **kwargs,
) -> AsyncResult:
    """
    Создает асинхронный генератор для получения ответов от сервиса `chat9.yqcloud.top`.

    Args:
        model (str): Модель, используемая для генерации (фактически не используется).
        messages (Messages): Список сообщений для отправки в сервис.
        proxy (str, optional): Адрес прокси-сервера. По умолчанию `None`.
        timeout (int, optional): Время ожидания ответа от сервиса в секундах. По умолчанию `120`.
        **kwargs: Дополнительные аргументы, передаваемые в функцию `_create_payload`.

    Returns:
        AsyncResult: Асинхронный генератор, выдающий текстовые фрагменты ответа.

    Raises:
        RuntimeError: Если IP-адрес заблокирован из-за обнаружения злоупотреблений.

    Как работает функция:
    - Создает асинхронную сессию с заданными заголовками и прокси.
    - Формирует полезную нагрузку (payload) с использованием функции `_create_payload`.
    - Отправляет POST-запрос к API сервиса `chat9.yqcloud.top`.
    - Итерируется по содержимому ответа, декодирует его и передает фрагменты текста через генератор.
    - Проверяет наличие сообщения о блокировке IP-адреса и вызывает исключение `RuntimeError` в случае обнаружения.

    Внутренние функции:
        Отсутствуют.

    Примеры:
        # Пример использования асинхронного генератора
        messages = [{"role": "user", "content": "Hello, how are you?"}]
        async for chunk in Yqcloud.create_async_generator(model="gpt-3.5-turbo", messages=messages):
            print(chunk, end="")
    """
    ...
```

## Функции

### `_create_header`

```python
def _create_header():
    """
    Создает словарь с HTTP-заголовками для запроса к сервису `chat9.yqcloud.top`.

    Args:
        Нет

    Returns:
        dict: Словарь с HTTP-заголовками.

    Как работает функция:
        Функция создает и возвращает словарь, содержащий HTTP-заголовки, необходимые для взаимодействия с API `chat9.yqcloud.top`.
        Эти заголовки включают `accept`, `content-type`, `origin` и `referer`.

    Внутренние функции:
        Отсутствуют.

    Примеры:
        # Пример использования функции _create_header
        headers = _create_header()
        print(headers)
    """
    ...
```

### `_create_payload`

```python
def _create_payload(
    messages: Messages,
    system_message: str = "",
    user_id: int = None,
    **kwargs
):
    """
    Создает словарь с полезной нагрузкой (payload) для запроса к сервису `chat9.yqcloud.top`.

    Args:
        messages (Messages): Список сообщений для отправки в сервис.
        system_message (str, optional): Системное сообщение для установки контекста. По умолчанию "".
        user_id (int, optional): Идентификатор пользователя. Если не указан, генерируется случайный. По умолчанию `None`.
        **kwargs: Дополнительные аргументы.

    Returns:
        dict: Словарь с полезной нагрузкой.

    Как работает функция:
        Функция формирует словарь, содержащий данные для отправки в API `chat9.yqcloud.top`.
        Она принимает список сообщений, системное сообщение и идентификатор пользователя (если предоставлен).
        Если идентификатор пользователя не указан, он генерируется случайным образом.
        В полезную нагрузку включаются отформатированные сообщения, флаги для сетевого взаимодействия, системное сообщение,
        флаг отключения контекста, флаг потоковой передачи и идентификатор пользователя.

    Внутренние функции:
        Отсутствуют.

    Примеры:
        # Пример использования функции _create_payload
        messages = [{"role": "user", "content": "Hello, how are you?"}]
        payload = _create_payload(messages=messages)
        print(payload)
    """
    ...