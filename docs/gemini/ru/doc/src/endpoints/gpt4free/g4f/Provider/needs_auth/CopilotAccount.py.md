# Модуль `CopilotAccount`

## Обзор

Модуль `CopilotAccount` предоставляет класс `CopilotAccount`, который реализует аутентификацию для использования модели `Copilot` от GitHub. 

## Классы

### `class CopilotAccount`

**Описание**: Класс `CopilotAccount` наследует от `AsyncAuthedProvider` и `Copilot` и предоставляет функциональность для аутентификации и использования модели `Copilot`.

**Наследует**:
- `AsyncAuthedProvider` - для асинхронной обработки аутентификации.
- `Copilot` - для использования модели `Copilot`.

**Атрибуты**:

- `needs_auth` (bool): Определяет, требуется ли аутентификация для использования модели. 
- `use_nodriver` (bool): Определяет, нужно ли использовать веб-драйвер для аутентификации.
- `parent` (str): Родительский провайдер.
- `default_model` (str): Модель по умолчанию.
- `default_vision_model` (str): Модель для обработки изображений по умолчанию.

**Методы**:

- `on_auth_async(proxy: str = None, **kwargs) -> AsyncIterator`: Асинхронно выполняет аутентификацию.
- `create_authed(model: str, messages: Messages, auth_result: AuthResult, **kwargs) -> AsyncResult`:  Создает асинхронный результат для модели `Copilot` с использованием аутентификационных данных.

#### `on_auth_async(proxy: str = None, **kwargs) -> AsyncIterator`

**Назначение**: Асинхронно выполняет аутентификацию для модели `Copilot`. 

**Параметры**:

- `proxy` (str, optional): Прокси-сервер для использования. По умолчанию `None`.
- `**kwargs`: Дополнительные аргументы для аутентификации.

**Возвращает**:

- `AsyncIterator`: Итератор с аутентификационными данными.

**Как работает метод**:

- Метод пытается прочитать данные аутентификации (токен доступа, cookies) из файла HAR.
- Если файл HAR не найден или не содержит валидных данных, выполняется аутентификация с использованием веб-драйвера или вызывается исключение.
- Если аутентификация выполнена успешно, возвращается итератор с аутентификационными данными (токен доступа, cookies).

#### `create_authed(model: str, messages: Messages, auth_result: AuthResult, **kwargs) -> AsyncResult`

**Назначение**: Создает асинхронный результат для модели `Copilot` с использованием аутентификационных данных. 

**Параметры**:

- `model` (str): Имя модели `Copilot`.
- `messages` (Messages): Сообщения для отправки в модель.
- `auth_result` (AuthResult): Результат аутентификации, содержащий токен доступа и cookies.
- `**kwargs`: Дополнительные аргументы для модели.

**Возвращает**:

- `AsyncResult`: Асинхронный результат для модели `Copilot`.

**Как работает метод**:

- Устанавливает токен доступа и cookies, полученные из `auth_result`.
- Выполняет запрос к модели `Copilot` с использованием полученных данных.
- Возвращает итератор, который содержит результаты выполнения модели.

## Внутренние функции

### `cookies_to_dict()`

**Назначение**: Преобразует объект cookies в словарь. 

**Параметры**: Нет

**Возвращает**:

- `dict`: Словарь с cookies.

**Как работает функция**:

- Если объект cookies уже является словарем, возвращает его.
- Иначе, создает словарь с именем и значением каждого cookie.