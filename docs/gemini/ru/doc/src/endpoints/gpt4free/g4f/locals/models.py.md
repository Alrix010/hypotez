# Модуль `models`

## Обзор

Модуль `models` содержит функции для работы с моделями GPT4Free. 

## Подробней

Модуль обеспечивает функциональность для загрузки, сохранения, обработки и получения информации о доступных моделях. 

## Функции

### `load_models`

**Назначение**: Загрузка списка моделей GPT4Free из онлайн-источника.

**Параметры**:

- Нет параметров

**Возвращает**:

- `dict`: Словарь, содержащий информацию о моделях GPT4Free.

**Как работает функция**:

- Функция выполняет HTTP-запрос к `https://gpt4all.io/models/models3.json`.
- Использует функцию `raise_for_status()` для проверки статуса ответа.
- Вызывает функцию `format_models` для обработки полученных данных.

**Примеры**:

```python
>>> load_models()
{
    "7B": {
        "path": "7B-v1_5-pruned.ggml",
        "ram": 4096,
        "prompt": None,
        "system": None
    },
    "13B": {
        "path": "13B-v1_5-pruned.ggml",
        "ram": 8192,
        "prompt": None,
        "system": None
    },
    ...
}
```

### `get_model_name`

**Назначение**: Извлечение имени модели из имени файла.

**Параметры**:

- `filename` (str): Имя файла, содержащее имя модели.

**Возвращает**:

- `str`: Имя модели.

**Как работает функция**:

- Разделяет имя файла по точке (`.`) и возвращает первую часть.
- Удаляет стандартные суффиксы из имени модели.

**Примеры**:

```python
>>> get_model_name("7B-v1_5-pruned.ggml")
'7B'
>>> get_model_name("13B-v1-q4_0.ggml")
'13B'
```

### `format_models`

**Назначение**: Форматирование информации о моделях в словарь.

**Параметры**:

- `models` (list): Список моделей GPT4Free в формате JSON.

**Возвращает**:

- `dict`: Словарь, где ключи - имена моделей, а значения - информация о моделях.

**Как работает функция**:

- Проходит по списку моделей.
- Извлекает имя модели с помощью функции `get_model_name`.
- Создает словарь, где:
    - Ключ - имя модели.
    - Значение - словарь с информацией о модели (путь к файлу, необходимый объем ОЗУ, подсказка и системные инструкции).

**Примеры**:

```python
>>> models = [
    {"filename": "7B-v1_5-pruned.ggml", "ramrequired": 4096},
    {"filename": "13B-v1-q4_0.ggml", "ramrequired": 8192},
    ...
]
>>> format_models(models)
{
    "7B": {
        "path": "7B-v1_5-pruned.ggml",
        "ram": 4096,
        "prompt": None,
        "system": None
    },
    "13B": {
        "path": "13B-v1-q4_0.ggml",
        "ram": 8192,
        "prompt": None,
        "system": None
    },
    ...
}
```

### `read_models`

**Назначение**: Чтение информации о моделях из JSON-файла.

**Параметры**:

- `file_path` (str): Путь к JSON-файлу с информацией о моделях.

**Возвращает**:

- `dict`: Словарь с информацией о моделях.

**Как работает функция**:

- Открывает файл по указанному пути в режиме чтения.
- Десериализует JSON-данные из файла.

**Примеры**:

```python
>>> read_models("models.json")
{
    "7B": {
        "path": "7B-v1_5-pruned.ggml",
        "ram": 4096,
        "prompt": None,
        "system": None
    },
    "13B": {
        "path": "13B-v1-q4_0.ggml",
        "ram": 8192,
        "prompt": None,
        "system": None
    },
    ...
}
```

### `save_models`

**Назначение**: Сохранение информации о моделях в JSON-файл.

**Параметры**:

- `file_path` (str): Путь к JSON-файлу для сохранения информации.
- `data` (dict): Словарь с информацией о моделях.

**Возвращает**:

- Нет возвращаемого значения.

**Как работает функция**:

- Открывает файл по указанному пути в режиме записи.
- Сериализует словарь `data` в JSON-формат.
- Сохраняет JSON-данные в файл.

**Примеры**:

```python
>>> models = {
    "7B": {
        "path": "7B-v1_5-pruned.ggml",
        "ram": 4096,
        "prompt": None,
        "system": None
    },
    "13B": {
        "path": "13B-v1-q4_0.ggml",
        "ram": 8192,
        "prompt": None,
        "system": None
    },
    ...
}
>>> save_models("models.json", models)
```

### `get_model_dir`

**Назначение**: Получение пути к директории, где хранятся модели GPT4Free.

**Параметры**:

- Нет параметров

**Возвращает**:

- `str`: Путь к директории, где хранятся модели GPT4Free.

**Как работает функция**:

- Определяет путь к текущему файлу.
- Определяет путь к родительской директории (проекту).
- Определяет путь к директории `models`.
- Создает директорию `models`, если она не существует.

**Примеры**:

```python
>>> get_model_dir()
'/path/to/hypotez/models'
```

### `get_models`

**Назначение**: Получение списка моделей GPT4Free.

**Параметры**:

- Нет параметров

**Возвращает**:

- `dict`: Словарь с информацией о моделях GPT4Free.

**Как работает функция**:

- Получает путь к директории, где хранятся модели.
- Проверяет наличие файла `models.json`.
- Если файл существует, читает данные из файла с помощью функции `read_models`.
- Если файл не существует, загружает список моделей с помощью функции `load_models`, сохраняет данные в файл `models.json` и возвращает полученный список.

**Примеры**:

```python
>>> get_models()
{
    "7B": {
        "path": "7B-v1_5-pruned.ggml",
        "ram": 4096,
        "prompt": None,
        "system": None
    },
    "13B": {
        "path": "13B-v1-q4_0.ggml",
        "ram": 8192,
        "prompt": None,
        "system": None
    },
    ...
}