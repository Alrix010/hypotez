# Модуль Goabror для взаимодействия с GPT-4 API
## Обзор
Модуль `Goabror` предоставляет  интерфейс для взаимодействия с API GPT-4 через сервис `goabror.uz`. 
Он реализует асинхронный генератор, который позволяет получать ответы от модели по частям, что 
позволяет сократить время ожидания и память, необходимую для обработки больших ответов. 
## Подробности
Этот модуль использует асинхронный генератор для  обработки ответов от модели, 
позволяя получать текст по частям. Это значительно повышает 
производительность и оптимизирует использование ресурсов. 
Он также включает в себя реализацию  `ProviderModelMixin`, который 
предоставляет стандартные функции для управления моделями и  протоколов 
взаимодействия. 
## Классы
### `class Goabror`
**Описание**: Класс `Goabror` реализует асинхронный генератор для получения ответов от модели GPT-4 через API `goabror.uz`. 
**Наследует**: 
    - `AsyncGeneratorProvider`: Базовый класс для асинхронных генераторов. 
    - `ProviderModelMixin`: Миксин, который предоставляет функциональность для работы с моделями и протоколами.
**Атрибуты**: 
    - `url` (str): URL-адрес основного сайта `goabror.uz`.
    - `api_endpoint` (str): URL-адрес API-интерфейса `goabror.uz`.
    - `working` (bool): Флаг, указывающий на доступность сервиса. 
    - `default_model` (str):  Имя модели по умолчанию (`gpt-4`).
    - `models` (list): Список поддерживаемых моделей.
**Методы**:
    - `create_async_generator(model: str, messages: Messages, proxy: str = None, **kwargs) -> AsyncResult`:
        **Описание**: Асинхронный генератор для получения ответов от модели.
        **Параметры**: 
            - `model` (str): Имя модели.
            - `messages` (Messages): Список сообщений, включая системные и пользовательские.
            - `proxy` (str, optional): Прокси-сервер.
            - `**kwargs`:  Дополнительные аргументы. 
        **Возвращает**: 
            - `AsyncResult`: Асинхронный результат, который представляет собой генератор, 
            возвращающий текст ответа от модели по частям.
        **Как работает**: 
            - Метод формирует URL-адрес API-запроса, используя `api_endpoint`.
            - Он формирует запрос с параметрами `user` (текст запроса пользователя) 
            и `system` (системные инструкции для модели) с использованием функций 
            `format_prompt` и `get_system_prompt`.
            - Он выполняет HTTP-запрос GET к API-интерфейсу и проверяет статус ответа.
            - Он пытается декодировать ответ в JSON и получить данные, если они 
            доступны. В противном случае он возвращает текст ответа как строку. 
            - Он возвращает асинхронный генератор, который поставляет текст ответа по частям.
        **Примеры**: 
            ```python
            async def get_response(messages: Messages):
                generator = await Goabror.create_async_generator(model='gpt-4', messages=messages)
                async for response in generator:
                    print(response)
            ```

## Параметры класса
- `url` (str): URL-адрес основного сайта `goabror.uz`.
- `api_endpoint` (str): URL-адрес API-интерфейса `goabror.uz`.
- `working` (bool): Флаг, указывающий на доступность сервиса. 
- `default_model` (str):  Имя модели по умолчанию (`gpt-4`).
- `models` (list): Список поддерживаемых моделей.

## Внутренние функции
### `format_prompt(messages: Messages, include_system: bool = True) -> str`:
    **Описание**: Форматирует текст запроса пользователя для отправки в API. 
    **Параметры**: 
        - `messages` (Messages): Список сообщений, включая системные и пользовательские. 
        - `include_system` (bool, optional):  Включить ли системные инструкции 
        в текст запроса. По умолчанию `True`.
    **Возвращает**: 
        - `str`: Форматированный текст запроса. 
    **Как работает**: 
        - Функция извлекает пользовательские сообщения из списка `messages` 
        и формирует строку с текстом запроса.  
        - Она опционально включает системные инструкции в текст, 
        используя  `include_system` флаг.
    **Примеры**:
        ```python
        messages = [
            {"role": "system", "content": "Ты - искусственный интеллект."},
            {"role": "user", "content": "Что такое AI?"}
        ]
        formatted_prompt = format_prompt(messages)
        print(formatted_prompt)
        ```
### `get_system_prompt(messages: Messages) -> str`:
    **Описание**: Получает системные инструкции из списка сообщений.
    **Параметры**: 
        - `messages` (Messages): Список сообщений, включая системные и пользовательские.
    **Возвращает**: 
        - `str`: Системные инструкции для модели.
    **Как работает**: 
        - Функция извлекает системные сообщения из списка `messages` и 
        объединяет их в строку.
    **Примеры**:
        ```python
        messages = [
            {"role": "system", "content": "Ты - искусственный интеллект."},
            {"role": "user", "content": "Что такое AI?"}
        ]
        system_prompt = get_system_prompt(messages)
        print(system_prompt)
        ```