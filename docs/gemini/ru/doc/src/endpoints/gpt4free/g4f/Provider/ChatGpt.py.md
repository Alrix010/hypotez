# Модуль ChatGpt

## Обзор

Модуль предоставляет класс `ChatGpt`, который реализует функциональность взаимодействия с ChatGPT через API. 

##  Функции

### `format_conversation`

**Назначение**: Функция преобразует список сообщений в формат, который можно использовать для отправки в API ChatGPT.

**Параметры**:

- `messages` (list): Список сообщений в формате, определенном в проекте `hypotez`.

**Возвращает**:

- list: Список сообщений в формате, совместимом с API ChatGPT.


**Как работает функция**:

- Функция итерирует по списку `messages`.
- Для каждого сообщения создает словарь, который включает:
    - `id`: Уникальный идентификатор сообщения.
    - `author`: Словарь с ролью отправителя (пользователь или ассистент).
    - `content`: Словарь, содержащий текст сообщения.
    - `metadata`: Дополнительные метаданные сообщения.
- Функция возвращает список созданных словарей.


### `init_session`

**Назначение**: Функция создает сессию `Session` с настроенными заголовками и куки для взаимодействия с API ChatGPT.

**Параметры**:

- `user_agent` (str): Строка, представляющая User-Agent.

**Возвращает**:

- requests.Session: Сессия `Session` с необходимыми настройками.

**Как работает функция**:

- Функция создает объект `Session`.
- Настраивает заголовки HTTP-запросов, включая User-Agent и другие необходимые параметры.
- Задает начальные значения куки.
- Выполняет GET-запрос на сайт ChatGPT.
- Возвращает объект `Session`.


## Классы

### `ChatGpt`

**Описание**: Класс `ChatGpt` реализует взаимодействие с API ChatGPT. 

**Наследует**: 
- `AbstractProvider`:  Класс, предоставляющий базовые методы для работы с разными провайдерами.
- `ProviderModelMixin`:  Класс, предоставляющий функции для обработки моделей.

**Атрибуты**:

- `label`:  Строка, содержащая название провайдера. 
- `url`:  Строка, содержащая URL-адрес API ChatGPT.
- `working`:  Логическое значение, которое указывает, работает ли провайдер.
- `supports_message_history`:  Логическое значение, которое указывает, поддерживает ли провайдер историю сообщений.
- `supports_system_message`:  Логическое значение, которое указывает, поддерживает ли провайдер системные сообщения.
- `supports_stream`:  Логическое значение, которое указывает, поддерживает ли провайдер потоковую передачу данных.
- `default_model`:  Строка, содержащая название модели по умолчанию.
- `models`:  Список доступных моделей ChatGPT.
- `model_aliases`:  Словарь, который сопоставляет псевдонимы моделей с их фактическими названиями.


**Методы**:

#### `get_model`

**Назначение**:  Метод возвращает название модели, соответствующее переданному значению.

**Параметры**:

- `model` (str):  Название модели.

**Возвращает**:

- str:  Название модели, которая соответствует переданному значению.


**Как работает функция**:

- Проверяет, содержится ли `model` в списке `models`.
- Если `model` находится в списке, метод возвращает его.
- Если `model` находится в словаре `model_aliases`, метод возвращает значение, сопоставленное с ним.
- Если `model` не найден, метод возвращает значение `default_model`.

#### `create_completion`

**Назначение**:  Метод отправляет запрос в API ChatGPT и возвращает ответ.

**Параметры**:

- `model` (str):  Название модели.
- `messages` (Messages):  Список сообщений для отправки в API.
- `stream` (bool):  Логическое значение, указывающее, следует ли использовать потоковую передачу.
- `**kwargs`:  Дополнительные аргументы, передаваемые в API.

**Возвращает**:

- CreateResult:  Результат запроса.


**Как работает функция**:

- Получает название модели, соответствующее переданному значению.
- Проверяет, доступна ли модель.
- Создает объект `Session`.
- Получает конфигурацию API.
- Получает токены `requirements` и `answer`.
- Обрабатывает проверку `turnstile`.
- Формирует заголовки HTTP-запроса.
- Отправляет POST-запрос в API ChatGPT.
- Обрабатывает ответ API.
- Возвращает результат.


## Примеры

```python
from hypotez.src.endpoints.gpt4free.g4f.Provider import ChatGpt

# Создание объекта ChatGpt
chatgpt = ChatGpt()

# Список сообщений для отправки в API
messages = [
    {'role': 'user', 'content': 'Привет!'},
    {'role': 'assistant', 'content': 'Привет! Как дела?'},
]

# Отправка запроса в API
response = chatgpt.create_completion(model='gpt-3.5-turbo', messages=messages, stream=False)

# Вывод результата
print(response)
```
```markdown