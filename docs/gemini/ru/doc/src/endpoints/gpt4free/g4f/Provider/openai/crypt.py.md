# Модуль crypt.py

## Обзор

Модуль `crypt.py` предоставляет функции для шифрования и дешифрования данных с использованием алгоритма AES (Advanced Encryption Standard). Он включает методы для заполнения (padding) данных, шифрования, удаления заполнения и дешифрования. Этот модуль обеспечивает безопасное преобразование данных, используя криптографические методы.

## Подробней

Этот модуль предназначен для защиты конфиденциальных данных путем их шифрования. Он использует комбинацию `AES` шифрования и `MD5` хеширования для создания безопасного канала передачи или хранения информации.

## Функции

### `pad`

```python
def pad(data: str) -> bytes:
    """
    Дополняет входные данные до размера, кратного 16 байтам, в соответствии со стандартом PKCS#7.

    Args:
        data (str): Строка, которую необходимо дополнить.

    Returns:
        bytes: Дополненные данные в виде байтовой строки.

    Как работает функция:
    - Преобразует входную строку в байты.
    - Вычисляет необходимое количество байтов для дополнения, чтобы длина данных стала кратна 16.
    - Добавляет байты дополнения, значение каждого байта соответствует количеству добавленных байтов.

    Примеры:
    >>> pad("example")
    b'example\\t\\t\\t\\t\\t\\t\\t\\t\\t'
    """
```

### `encrypt`

```python
def encrypt(data, key):
    """
    Шифрует входные данные с использованием алгоритма AES в режиме CBC.

    Args:
        data (str): Строка, которую необходимо зашифровать.
        key (str): Ключ шифрования.

    Returns:
        str: JSON-представление зашифрованных данных, включающее зашифрованный текст, вектор инициализации (IV) и соль.

    Как работает функция:
    - Генерирует случайную соль.
    - Хеширует ключ и соль несколько раз с использованием MD5 для получения ключа шифрования и вектора инициализации.
    - Дополняет данные с помощью функции pad.
    - Шифрует дополненные данные с использованием AES в режиме CBC.
    - Кодирует зашифрованный текст в base64 и формирует JSON-ответ, содержащий зашифрованный текст, IV и соль.

    Примеры:
    >>> encrypt("example", "secret_key")
    '{"ct": "EjR2Vq... (truncated)", "iv": "...", "s": "..."}'
    """
```

### `unpad`

```python
def unpad(data: bytes) -> bytes:
    """
    Удаляет дополнение, добавленное функцией pad, из входных данных.

    Args:
        data (bytes): Байтовая строка, из которой необходимо удалить дополнение.

    Returns:
        bytes: Данные без дополнения.

    Как работает функция:
    - Извлекает значение байта дополнения из последнего байта данных.
    - Удаляет байты дополнения на основе полученного значения.

    Примеры:
    >>> unpad(b'example\\t\\t\\t\\t\\t\\t\\t\\t\\t')
    b'example'
    """
```

### `decrypt`

```python
def decrypt(data: str, key: str):
    """
    Дешифрует входные данные, зашифрованные с использованием алгоритма AES в режиме CBC.

    Args:
        data (str): JSON-представление зашифрованных данных, содержащее зашифрованный текст, вектор инициализации (IV) и соль.
        key (str): Ключ дешифрования.

    Returns:
        str: Дешифрованные данные в виде строки.

    Как работает функция:
    - Декодирует JSON-представление данных.
    - Извлекает зашифрованный текст, IV и соль.
    - Хеширует ключ и соль несколько раз с использованием MD5 для получения ключа дешифрования.
    - Дешифрует зашифрованный текст с использованием AES в режиме CBC.
    - Удаляет дополнение с помощью функции unpad и декодирует результат в строку.

    Примеры:
    >>> decrypt('{"ct": "EjR2Vq... (truncated)", "iv": "...", "s": "..."}', "secret_key")
    'example'
    """