# Модуль для асинхронного тестирования GPT4Free

## Обзор

Модуль содержит функции для тестирования API GPT4Free в асинхронном режиме. Он использует библиотеку `asyncio` для запуска множественных задач одновременно.

## Подробней

Модуль `testing/test_async.py`  содержит две ключевые функции:
- `create_async`: создает асинхронное подключение к API GPT4Free.
- `run_async`: запускает асинхронные задачи для тестирования API.

## Классы

## Функции

### `create_async`

**Назначение**: Эта функция создает асинхронную сессию для взаимодействия с API GPT4Free.

**Параметры**:

- `provider`:  Экземпляр провайдера API GPT4Free.

**Возвращает**:

- `None`: Возвращает `None`, если сессия успешно создана.

**Вызывает исключения**:

- `Exception`:  Возникает в случае ошибки во время создания сессии.

**Как работает функция**:

- Функция `create_async` используется для создания асинхронной сессии для взаимодействия с API GPT4Free. 
- Она принимает провайдера API в качестве аргумента и создает сессию, используя асинхронные методы провайдера.
- В случае успешного создания сессии, функция возвращает `None`. 
- Если происходит ошибка, функция вызывает исключение `Exception`. 

**Примеры**:

```python
async def create_async(provider):
    try:
        response = await log_time_async(
            provider.create_async,
            model=g4f.models.default.name,
            messages=[{"role": "user", "content": "Hello, are you GPT 3.5?"}]
        )
        print(f"{provider.__name__}:", response)
    except Exception as e:
        print(f"{provider.__name__}: {e.__class__.__name__}: {e}")
```

### `run_async`

**Назначение**: Эта функция запускает асинхронные задачи для тестирования API GPT4Free.

**Параметры**:

-  `None`.

**Возвращает**:

- `None`: Возвращает `None`.

**Вызывает исключения**:

- `None`: Не вызывает исключения.

**Как работает функция**:

-  Функция `run_async` создает список асинхронных задач для каждого доступного провайдера API GPT4Free.
-  Она запускает задачи с помощью `asyncio.gather`, позволяя выполнять их одновременно.
-  После завершения всех задач, функция возвращает `None`.

**Примеры**:

```python
async def run_async():
  responses: list = [
      create_async(provider)
      for provider in get_providers()
      if provider.working
  ]
  await asyncio.gather(*responses)
```

## Параметры класса

## Примеры

```python
print("Total:", asyncio.run(log_time_async(run_async)))
```

##  Внутренние функции

### `log_time_async`

**Назначение**:  Эта функция используется для измерения времени выполнения асинхронных задач.

**Параметры**:

- `func`: Асинхронная функция, время выполнения которой нужно измерить.
- `*args`: Дополнительные аргументы, передаваемые в `func`.
- `**kwargs`: Дополнительные ключевые аргументы, передаваемые в `func`.

**Возвращает**:

- `None`: Возвращает `None`, если время выполнения функции успешно измерено.

**Вызывает исключения**:

- `Exception`: Возникает в случае ошибки во время измерения времени выполнения функции.

**Как работает функция**:

-  `log_time_async`  запускает асинхронную функцию `func`  и измеряет время ее выполнения.
-  Результат измерения времени записывается в лог файл.

**Примеры**:
```python
print("Total:", asyncio.run(log_time_async(run_async)))