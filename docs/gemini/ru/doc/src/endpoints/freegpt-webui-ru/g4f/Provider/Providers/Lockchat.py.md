# Модуль Lockchat

## Обзор

Модуль `Lockchat.py` предназначен для взаимодействия с сервисом Lockchat через API. Он предоставляет функцию для создания запросов к модели и получения ответов в потоковом режиме. Модуль поддерживает модели `gpt-4` и `gpt-3.5-turbo`.

## Подробней

Модуль содержит функции для отправки запросов к API Lockchat и обработки потоковых ответов. Он использует библиотеку `requests` для выполнения HTTP-запросов и модуль `json` для обработки JSON-данных.

## Функции

### `_create_completion`

```python
def _create_completion(model: str, messages: list, stream: bool, temperature: float = 0.7, **kwargs):
    """ Функция отправляет запрос к API Lockchat и возвращает ответ в потоковом режиме.

    Args:
        model (str): Имя модели для использования.
        messages (list): Список сообщений для отправки.
        stream (bool): Флаг, указывающий, нужно ли возвращать ответ в потоковом режиме.
        temperature (float, optional): Температура для генерации текста. По умолчанию 0.7.
        **kwargs: Дополнительные параметры.

    Returns:
        Generator[str, None, None]: Генератор токенов ответа.

    Raises:
        Exception: Если возникает ошибка при отправке запроса или обработке ответа.

    Как работает функция:
        1. Формирует полезную нагрузку (payload) с параметрами запроса, включая температуру, сообщения, модель и флаг потоковой передачи.
        2. Устанавливает заголовки запроса, включая User-Agent.
        3. Отправляет POST-запрос к API Lockchat с полезной нагрузкой и заголовками, используя потоковую передачу.
        4. Итерируется по строкам ответа.
        5. Проверяет наличие ошибки, связанной с отсутствием модели `gpt-4`, и в случае обнаружения повторно вызывает функцию с теми же параметрами.
        6. Извлекает содержимое из JSON-ответа и преобразует его в строку.
        7. Возвращает токен содержимого, если он присутствует.

    """
    ...
```

## Параметры модуля

- `url` (str): URL-адрес API Lockchat (`http://super.lockchat.app`).
- `model` (list): Список поддерживаемых моделей (`['gpt-4', 'gpt-3.5-turbo']`).
- `supports_stream` (bool): Флаг, указывающий, поддерживает ли провайдер потоковый режим (True).
- `needs_auth` (bool): Флаг, указывающий, требуется ли аутентификация (False).
- `params` (str): Строка, содержащая информацию о поддерживаемых параметрах функции `_create_completion`.

```python
params = f\'g4f.Providers.{os.path.basename(__file__)[:-3]} supports: \' + \
    \'(%s)\' % \', \'.join([f"{name}: {get_type_hints(_create_completion)[name].__name__}" for name in _create_completion.__code__.co_varnames[:_create_completion.__code__.co_argcount]])