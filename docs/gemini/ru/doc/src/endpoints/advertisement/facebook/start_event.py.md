# Модуль для отправки мероприятий в группы Facebook

## Обзор

Модуль `src.endpoints.advertisement.facebook.start_event` предназначен для автоматической отправки рекламных мероприятий в различные группы Facebook. Он использует веб-драйвер для взаимодействия с Facebook и выполняет запланированные рекламные кампании.

## Подробнее

Этот модуль является частью системы автоматизации рекламы в проекте `hypotez`. Он отвечает за запуск и управление рекламными мероприятиями в Facebook, используя данные о группах и мероприятиях, хранящиеся в JSON-файлах. Модуль включает в себя функциональность для выбора групп, публикации контента и обработки ошибок.

## Классы

### `FacebookPromoter`

**Описание**: Класс `FacebookPromoter` управляет процессом продвижения мероприятий в Facebook.

**Наследует**:

- Наследует от класса `FacebookPromoter` из модуля `src.endpoints.advertisement.facebook`.

**Атрибуты**:

- `d` (Driver): Экземпляр веб-драйвера для взаимодействия с Facebook.
- `group_file_paths` (list[str]): Список путей к JSON-файлам, содержащим информацию о группах Facebook.
- `no_video` (bool): Флаг, указывающий на отсутствие видео в рекламных материалах.

**Методы**:

- `run_events`: Запускает процесс продвижения мероприятий.

**Принцип работы**:

Класс инициализируется с драйвером веб-браузера и путями к файлам групп. Метод `run_events` выполняет основные шаги по продвижению мероприятий, такие как выбор групп, публикация контента и обработка результатов.

## Функции

### `run_events`

```python
def run_events(events_names:list = events_names, group_file_paths:list[str] = filenames)
```

**Назначение**: Запускает процесс продвижения мероприятий в Facebook.

**Параметры**:

- `events_names` (list[str]): Список названий мероприятий для запуска. По умолчанию `events_names = ["choice_day_01_10"]`.
- `group_file_paths` (list[str]): Список путей к JSON-файлам с информацией о группах Facebook. По умолчанию `filenames`.

**Возвращает**:

- None

**Вызывает исключения**:

- Отсутствуют явные исключения, но могут возникать исключения, связанные с веб-драйвером или API Facebook.

**Как работает функция**:

Функция выполняет итерацию по списку названий событий и путей к файлам групп. Для каждого события и группы вызываются соответствующие методы для публикации рекламных материалов.

**Примеры**:

```python
promoter.run_events(events_names=["event1", "event2"], group_file_paths=["groups1.json", "groups2.json"])
```

## Переменные

- `d` (Driver): Инстанс класса `Driver` с драйвером Chrome, используемый для управления браузером.
- `filenames` (list[str]): Список имен файлов, содержащих информацию о группах Facebook. Используется для определения целевых групп для рекламных мероприятий.
- `excluded_filenames` (list[str]): Список исключенных имен файлов, которые не будут использоваться в рекламной кампании.
- `events_names` (list): Список имен событий, которые будут продвигаться в Facebook группах.
- `promoter` (FacebookPromoter): Инстанс класса `FacebookPromoter`, используемый для запуска рекламных мероприятий.

## Основной цикл

```python
try:
    while True:
        logger.debug(f"waikig up {time.strftime('%H:%M:%S')}",None,False)
        promoter.run_events(events_names = events_names, group_file_paths = filenames)
        logger.debug(f"going to sleep at {time.strftime('%H:%M:%S')}",None,False)
        time.sleep(7200)
        
except KeyboardInterrupt:
    logger.info("Campaign promotion interrupted.")
```

**Описание**: Основной цикл программы, который запускает рекламные мероприятия и управляет временем работы.

**Как работает**:

1.  **Бесконечный цикл**: `while True` обеспечивает непрерывную работу программы до тех пор, пока она не будет прервана вручную.
2.  **Логирование**: `logger.debug` записывает время начала работы (`waikig up`).
3.  **Запуск мероприятий**: `promoter.run_events` запускает рекламные мероприятия, используя заданные имена событий и пути к файлам групп.
4.  **Логирование**: `logger.debug` записывает время перехода в режим ожидания (`going to sleep`).
5.  **Ожидание**: `time.sleep(7200)` приостанавливает выполнение программы на 7200 секунд (2 часа).
6.  **Обработка прерывания**: `except KeyboardInterrupt` перехватывает прерывание с клавиатуры (например, Ctrl+C) и завершает программу, записывая сообщение в лог.

**Пример**:

```python
try:
    while True:
        logger.debug(f"waikig up {time.strftime('%H:%M:%S')}",None,False)
        promoter.run_events(events_names = events_names, group_file_paths = filenames)
        logger.debug(f"going to sleep at {time.strftime('%H:%M:%S')}",None,False)
        time.sleep(7200)
        
except KeyboardInterrupt as ex:
    logger.info("Campaign promotion interrupted.")
```

В этом примере показано, как основной цикл запускает рекламные мероприятия каждые два часа, пока не будет прерван пользователем.