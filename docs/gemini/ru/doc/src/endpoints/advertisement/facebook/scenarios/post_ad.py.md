# Модуль: Публикация рекламного сообщения в группах Facebook

## Обзор

Модуль `src.endpoints.advertisement.facebook.scenarios.post_ad` предназначен для автоматизации процесса публикации рекламных сообщений в группах Facebook. Он включает в себя функции для отправки заголовка сообщения, загрузки медиафайлов (изображений) и публикации самого сообщения.

## Подробнее

Этот модуль является частью системы автоматизации рекламных кампаний в Facebook. Он использует Selenium WebDriver для взаимодействия с веб-интерфейсом Facebook, выполняя такие действия, как ввод текста, загрузка изображений и нажатие кнопок. Модуль обрабатывает возможные ошибки и повторно пытается выполнить действия при сбоях.

## Функции

### `post_ad`

```python
def post_ad(d: Driver, message: SimpleNamespace) -> bool:
    """
    Отправляет рекламное сообщение в Facebook.

    Args:
        d (Driver): Инстанс драйвера, используемый для взаимодействия с веб-страницей.
        message (SimpleNamespace): Объект, содержащий данные для публикации, включая описание и путь к изображению.

    Returns:
        bool: `True`, если сообщение успешно опубликовано, в противном случае `None`.

    Raises:
        Exception: Если возникает ошибка при публикации сообщения.

    Примеры:
        >>> from types import SimpleNamespace
        >>> from src.webdriver.driver import Driver, Firefox
        >>> # Создание экземпляра драйвера Firefox
        >>> driver = Driver(Firefox) 
        >>> # Создание объекта с данными сообщения
        >>> message = SimpleNamespace(description="Текст рекламного сообщения", image_path="path/to/image.jpg")
        >>> # Публикация сообщения
        >>> post_ad(driver, message)
        True
    """
```

**Назначение**:
Функция `post_ad` автоматизирует процесс публикации рекламного сообщения в Facebook. Она принимает инстанс драйвера Selenium и объект `SimpleNamespace`, содержащий необходимые данные для публикации, такие как описание и путь к изображению.

**Параметры**:
- `d` (Driver): Инстанс драйвера, используемый для взаимодействия с веб-страницей Facebook.
- `message` (SimpleNamespace): Объект, содержащий данные для публикации:
  - `description` (str): Текст рекламного сообщения.
  - `image_path` (str, optional): Путь к изображению, которое нужно загрузить в сообщение.

**Возвращает**:
- `bool`: `True`, если сообщение успешно опубликовано, в противном случае `None`.

**Как работает функция**:

1.  **Отправка заголовка сообщения**:
    -   Вызывает функцию `post_message_title` для отправки описания сообщения.
    -   Если отправка не удалась, регистрирует ошибку и увеличивает счетчик `fails`.
    -   Если количество неудачных попыток превышает 15, функция завершает работу.

2.  **Загрузка медиафайла**:
    -   Проверяет, есть ли атрибут `image_path` в объекте `message` и не является ли он пустым.
    -   Если `image_path` указан, вызывает функцию `upload_post_media` для загрузки изображения.
    -   Если загрузка не удалась, функция завершает работу.

3.  **Публикация сообщения**:
    -   Вызывает функцию `message_publish` для публикации сообщения.
    -   Если публикация не удалась, функция завершает работу.

4.  **Сброс счетчика ошибок**:
    -   Если все этапы выполнены успешно, счетчик ошибок `fails` сбрасывается.

**Внутренние функции**:
В данной функции вызываются другие функции: `post_message_title`, `upload_post_media` и `message_publish`.

**Примеры**:
```python
from types import SimpleNamespace
from src.webdriver.driver import Driver, Firefox
# Создание экземпляра драйвера Firefox
driver = Driver(Firefox) 
# Создание объекта с данными сообщения
message = SimpleNamespace(description="Текст рекламного сообщения", image_path="path/to/image.jpg")
# Публикация сообщения
post_ad(driver, message)
True
```
```python
from types import SimpleNamespace
from src.webdriver.driver import Driver, Firefox
# Создание экземпляра драйвера Firefox
driver = Driver(Firefox) 
# Создание объекта с данными сообщения (без изображения)
message = SimpleNamespace(description="Текст рекламного сообщения")
# Публикация сообщения
post_ad(driver, message)
True
```

## Переменные модуля

- `locator` (SimpleNamespace): Локаторы элементов веб-страницы, загруженные из JSON-файла.
- `fails` (int): Счетчик неудачных попыток выполнения операций.