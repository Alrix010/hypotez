# Документация для разработчика: Описание структуры данных товара для PrestaShop API

## Обзор

Этот документ содержит подробное описание структуры JSON, используемой для создания или обновления товаров через PrestaShop API. Он предоставляет информацию о каждом поле, его назначении и возможных значениях. Данная документация поможет разработчикам правильно формировать запросы к API для управления товарами в PrestaShop.

## Подробней

В этом документе подробно рассматриваются поля, необходимые для создания и обновления товаров в PrestaShop через API. Он объясняет, как использовать различные параметры, включая обязательные и необязательные поля, многоязычные значения и ассоциации с другими сущностями, такими как категории и изображения. Документ также предоставляет примеры использования Python для отправки данных в PrestaShop API.

## Структура JSON для данных товара PrestaShop

### `product`

Корневой элемент JSON, содержащий все данные о товаре.

#### Общие поля

*   `id_default_combination`: ID комбинации по умолчанию (если есть). Значение `null`, если у товара нет комбинаций.
*   `id_tax_rules_group`: ID группы налогов. **Важно:** Группа налогов должна существовать в PrestaShop.
*   `id_manufacturer`: ID производителя.
*   `id_supplier`: ID поставщика.
*   `reference`: Артикул товара.
*   `ean13`: EAN-13 штрихкод товара.
*   `upc`: UPC штрихкод товара.
*   `ecotax`: Экологический налог.
*   `quantity`: Количество товара на складе.
*   `minimal_quantity`: Минимальное количество товара для заказа.
*   `price`: Цена товара (без налога). Обратите внимание на формат (дробное число).
*   `wholesale_price`: Оптовая цена товара.
*   `on_sale`: Флаг, определяющий, отображать ли значок "Распродажа" (0 или 1).
*   `online_only`: Флаг, определяющий, доступен ли товар только для онлайн-заказа (0 или 1).
*   `unity`: Единица измерения товара (например, "шт").
*   `unit_price`: Цена за единицу измерения.
*   `reduction_price`: Скидка в валюте.
*   `reduction_percent`: Скидка в процентах.
*   `reduction_from`: Дата начала скидки.
*   `reduction_to`: Дата окончания скидки.
*   `cache_is_pack`: Флаг, определяющий, является ли товар комплектом (0 или 1).
*   `cache_has_attachments`: Флаг, определяющий, есть ли у товара прикрепленные файлы (0 или 1).
*   `cache_default_attribute`: ID атрибута по умолчанию (для комбинаций).
*   `advanced_stock_management`: Флаг, определяющий, использовать ли расширенное управление складом (0 или 1).
*   `pack_stock_type`: Тип управления складом для комплектов (1-3).
*   `state`: Флаг, определяющий, активен ли товар (0 или 1).
*   `available_for_order`: Флаг, определяющий, доступен ли товар для заказа (0 или 1).
*   `show_price`: Флаг, определяющий, отображать ли цену товара (0 или 1).
*   `visibility`: Видимость товара (`both`, `catalog`, `search`, `none`).
*   `id_category_default`: ID категории по умолчанию. **Важно:** Категория должна существовать в PrestaShop.

#### `associations`

Раздел, содержащий ассоциации товара с другими сущностями.

*   `categories`: Массив категорий, к которым принадлежит товар. `id` категорий должны существовать в PrestaShop.
*   `images`: Массив ID изображений, связанных с товаром. `id` изображений должны существовать в PrestaShop (обычно изображения сначала загружаются, а затем привязываются к товару).

#### Многоязычные поля

Следующие поля поддерживают многоязычные значения. Для каждого языка, поддерживаемого вашим магазином, необходимо предоставить значение.

*   `name`: Название товара.
*   `description`: Полное описание товара.
*   `description_short`: Краткое описание товара.
*   `meta_title`: Мета-заголовок товара.
*   `meta_description`: Мета-описание товара.
*   `meta_keywords`: Мета-ключевые слова товара.
*   `link_rewrite`: URL-адрес товара. Генерируется автоматически на основе названия, но может быть указан вручную. Важно, чтобы он был уникальным.
*   `available_now`: Текст, отображаемый, когда товар в наличии.
*   `available_later`: Текст, отображаемый, когда товара нет в наличии.

## Пример использования (Python)

Пример кода на Python, демонстрирующий отправку данных о товаре в PrestaShop API.

```python
import requests
import json

API_URL = "http://your-prestashop-domain/api/products"  # Замените <URL API>
API_KEY = "YOUR_API_KEY"  # Замените <ключ API>

headers = {
    "Content-Type": "application/json",
    "Authorization": f"Basic {API_KEY}"
}

data = {
    "product": {
        "id_default_combination": None,
        "id_tax_rules_group": "1",
        "reference": "REF-001",
        "quantity": "100",
        "price": "10.000000",
        "state": "1",
        "available_for_order": "1",
        "show_price": "1",
        "visibility": "both",
        "id_category_default": "2",
        "name": [
            {
                "language": {
                    "id": "1"
                },
                "value": "Новый продукт"
            }
        ],
        "description_short": [
            {
                "language": {
                    "id": "1"
                },
                "value": "<p>Краткое описание нового продукта.</p>"
            }
        ],
        "link_rewrite": [
            {
                "language": {
                    "id": "1"
                },
                "value": "novyj-produkt"
            }
        ]
    }
}

try:
    response = requests.post(API_URL, headers=headers, data=json.dumps(data))
    response.raise_for_status()  # Проверка на HTTP ошибки
    print("Товар успешно создан")
except requests.exceptions.RequestException as ex:
    print(f"Ошибка при создании товара: {ex}")
```

### Важные моменты:

*   **`id` значений:** Все ID (категорий, изображений, налоговых групп, производителей, поставщиков) должны существовать в вашей PrestaShop. Сначала нужно создать эти сущности через API или вручную через административную панель.
*   **Языки:** Необходимо указать значения для каждого языка, поддерживаемого вашим магазином. В примере только один язык (id=1).
*   **Формат данных:** Строго соблюдайте формат данных (числа, строки, булевы значения).
*   **Кодировка:** Используйте кодировку UTF-8 для JSON.
*   **Ошибки:** API PrestaShop возвращает подробные сообщения об ошибках. Внимательно их читайте и исправляйте проблемы в вашем JSON.
*   **Версия PrestaShop:** API может немного отличаться в разных версиях PrestaShop. Проверяйте документацию для вашей версии.
*   **Комбинации:** Если вы работаете с комбинациями, вам понадобится гораздо более сложный JSON. Посмотрите примеры в документации PrestaShop API для работы с комбинациями.