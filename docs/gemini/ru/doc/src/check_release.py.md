# Модуль `src.check_release`

## Обзор

Модуль `src.check_release` предназначен для проверки актуальной версии релизов указанного репозитория на платформе GitHub.

## Подробнее

Данный модуль содержит функцию `check_latest_release`, которая выполняет HTTP-запрос к API GitHub для получения информации о последнем опубликованном релизе конкретного репозитория. Это полезно для автоматизированных систем проверки обновлений или интеграции с CI/CD пайплайнами для мониторинга версий. Функция обрабатывает успешные и неуспешные ответы от API и логирует ошибки.

## Содержание

*   [Функции](#функции)
    *   [`check_latest_release`](#check_latest_release)

## Функции

### `check_latest_release`

```python
def check_latest_release(repo: str, owner: str) -> str | None:
    """ Check the latest release version of a GitHub repository.

    Args:
        owner (str): Владелец репозитория.
        repo (str): Название репозитория.

    Returns:
        str | None: Последняя версия релиза, если доступна, иначе `None`.

    Raises:
        Неявные исключения могут возникнуть в процессе выполнения HTTP-запроса
        или при парсинге JSON, которые перехватываются и логируются.

    Example:
        >>> latest_version = check_latest_release(owner='<владелец_репозитория>', repo='<название_репозитория>')
        >>> if latest_version:
        ...     print(f'Последний релиз: {latest_version}')
        ... else:
        ...     print('Не удалось получить информацию о релизе.')
    """
```

**Назначение**: Функция проверяет и возвращает номер последней версии опубликованного релиза для заданного репозитория на GitHub.

**Параметры**:

-   `repo` (str): Строка, представляющая название репозитория на GitHub.
-   `owner` (str): Строка, представляющая имя пользователя или организации - владельца репозитория на GitHub.

**Возвращает**:

-   `str | None`: Возвращает строку, содержащую тег (номер версии) последнего релиза, если запрос к API GitHub был успешным и релиз найден. Возвращает `None` в случае ошибки при выполнении запроса, получении ответа или парсинге данных.

**Вызывает исключения**:

-   `Exception`: Перехватывает общие исключения, которые могут возникнуть при обработке JSON-ответа, логирует их и возвращает `None`.

**Как работает функция**:

1.  Функция формирует URL для запроса к API GitHub, используя предоставленные имя владельца (`owner`) и название репозитория (`repo`). URL ведет к конечной точке получения последнего релиза.
2.  Выполняется GET-запрос к сформированному URL с использованием библиотеки `requests`.
3.  Проверяется статус-код ответа:
    *   Если статус-код равен `200` (OK), это означает успешное получение данных. Функция пытается распарсить JSON-ответ. В случае успешного парсинга, из словаря данных извлекается значение по ключу `'tag_name'`, которое и представляет номер версии релиза. Это значение возвращается. Если при парсинге JSON или извлечении ключа происходит ошибка, она перехватывается, логируется с использованием `logger.error`, и функция возвращает `None`.
    *   Если статус-код не равен `200`, это указывает на ошибку при запросе к API GitHub. Функция логирует предупреждение с использованием `logger.warning`, указывая URL и статус-код ответа, а затем возвращает `None`.

**Примеры**:

```python
# Пример успешного вызова (замените <owner> и <repo> на реальные значения)
latest_version = check_latest_release(owner='octocat', repo='Spoon-Knife')
if latest_version:
    print(f'Последний релиз для octocat/Spoon-Knife: {latest_version}')
else:
    print('Не удалось получить информацию о релизе для octocat/Spoon-Knife.')

# Пример вызова для несуществующего репозитория
latest_version_nonexistent = check_latest_release(owner='nonexistent_user', repo='nonexistent_repo')
if latest_version_nonexistent:
     print(f'Последний релиз для nonexistent_user/nonexistent_repo: {latest_version_nonexistent}')
else:
     print('Не удалось получить информацию о релизе для nonexistent_user/nonexistent_repo.')
```
```