# Модуль для преобразования словарей

## Обзор

Модуль `src.utils.convertors.dict` содержит набор функций для конвертации словарей в различные форматы, такие как SimpleNamespace, XML, CSV, JSON, XLS, HTML и PDF.

## Подробнее

Этот модуль предоставляет набор функций для конвертации словарей в различные форматы. Он позволяет выполнять следующие операции:

- **Преобразование словарей в объекты `SimpleNamespace`**: 
    - Функция `dict2ns` рекурсивно преобразует словари в объекты `SimpleNamespace`, что упрощает доступ к данным.
- **Генерация XML-строки из словаря**: 
    - Функция `dict2xml` преобразует словарь в XML-строку.
- **Сохранение данных в файл CSV**:
    - Функция `dict2csv` сохраняет словарь или данные `SimpleNamespace` в файл CSV.
- **Сохранение данных в файл JSON**:
    - Функция `dict2json` сохраняет словарь или данные `SimpleNamespace` в файл JSON.
- **Сохранение данных в файл XLS**:
    - Функция `dict2xls` сохраняет словарь или данные `SimpleNamespace` в файл XLS.
- **Генерация HTML-таблицы из словаря**:
    - Функция `dict2html` генерирует HTML-таблицу из словаря или объекта `SimpleNamespace`.
- **Сохранение данных в файл PDF**:
    - Функция `dict2pdf` сохраняет данные словаря в файл PDF.

## Функции

### `replace_key_in_dict`

**Назначение**: 
  - Функция рекурсивно заменяет ключ в словаре или списке.

**Параметры**:
 - `data` (dict | list): Словарь или список, где происходит замена ключа.
 - `old_key` (str): Ключ, который нужно заменить.
 - `new_key` (str): Новый ключ.

**Возвращает**:
 - `dict`: Обновленный словарь с замененными ключами.

**Примеры**:

```python
# Пример 1: простой словарь
data = {"old_key": "value"}
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится {"new_key": "value"}

# Пример 2: вложенный словарь
data = {"outer": {"old_key": "value"}}
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится {"outer": {"new_key": "value"}}

# Пример 3: список словарей
data = [{"old_key": "value1"}, {"old_key": "value2"}]
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится [{"new_key": "value1"}, {"new_key": "value2"}]

# Пример 4: смешанная вложенная структура со списками и словарями
data = {"outer": [{"inner": {"old_key": "value"}}]}
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится {"outer": [{"inner": {"new_key": "value"}}]}
```


### `dict2ns`

**Назначение**:
  - Функция рекурсивно преобразует словари в `SimpleNamespace`.

**Параметры**:
 - `data` (Dict[str, Any] | List[Any]): Данные для преобразования.

**Возвращает**:
 - `Any`: Преобразованные данные в виде `SimpleNamespace` или списка `SimpleNamespace`.

**Как работает функция**:
  - Функция iteratively проходит через словарь и рекурсивно применяет себя к вложенным словарям и спискам.
  - Для каждого ключа-значения словаря:
    - Если значение является словарем, функция рекурсивно вызывает себя для этого словаря.
    - Если значение является списком, функция рекурсивно вызывает себя для каждого элемента списка.
  - В результате создается объект `SimpleNamespace` с атрибутами, соответствующими ключам и значениям исходного словаря.

**Пример**:

```python
data = {"name": "John", "age": 30, "address": {"street": "Main Street", "city": "New York"}}
ns = dict2ns(data)
print(ns.name)  # Выведет "John"
print(ns.address.street) # Выведет "Main Street"
```

### `dict2xml`

**Назначение**:
  - Функция генерирует XML-строку из словаря.

**Параметры**:
 - `data` (Dict[str, Any]): Данные для преобразования в XML.
 - `encoding` (str, optional): Кодировка данных. По умолчанию - `UTF-8`.

**Возвращает**:
 - `str`: XML-строка, представляющая входной словарь.

**Вызывает исключения**:
 - `Exception`: Если предоставлено более одного корневого узла.

**Как работает функция**:
  - Функция использует `xml.etree.ElementTree` для генерации XML-структуры из словаря.
  - Для каждого ключа-значения словаря:
    - Если значение является простым типом (например, `int`, `str`), функция создает простой XML-узел.
    - Если значение является списком или словарем, функция рекурсивно обрабатывает эти значения для создания соответствующих XML-узлов.
  - В результате создается XML-дерево, которое затем преобразуется в строку.

**Пример**:

```python
data = {"product": {"name": "Test Product", "price": "10.00", "id_tax_rules_group": "13", "id_category_default": "2"}}
xml_output = dict2xml(data)
print(xml_output)
```

### `dict2csv`

**Назначение**:
  - Функция сохраняет словарь или данные `SimpleNamespace` в файл CSV.

**Параметры**:
 - `data` (dict | SimpleNamespace): Данные для сохранения в файл CSV.
 - `file_path` (str | Path): Путь к файлу CSV.

**Возвращает**:
 - `bool`: `True`, если файл был успешно сохранен, `False` в противном случае.

**Как работает функция**:
  - Функция использует модуль `csv` для сохранения данных в файл CSV.
  - Если данные представлены в виде объекта `SimpleNamespace`, функция преобразует их в словарь.
  - Затем функция записывает ключи словаря как заголовок CSV-файла, а соответствующие значения - как данные в строках файла.

**Пример**:

```python
data = {"name": "John", "age": 30, "city": "New York"}
dict2csv(data, "data.csv")
```

### `dict2xls`

**Назначение**:
  - Функция сохраняет словарь или данные `SimpleNamespace` в файл XLS.

**Параметры**:
 - `data` (dict | SimpleNamespace): Данные для сохранения в файл XLS.
 - `file_path` (str | Path): Путь к файлу XLS.

**Возвращает**:
 - `bool`: `True`, если файл был успешно сохранен, `False` в противном случае.

**Как работает функция**:
  - Функция использует модуль `xlsxwriter` для сохранения данных в файл XLS.
  - Если данные представлены в виде объекта `SimpleNamespace`, функция преобразует их в словарь.
  - Затем функция записывает ключи словаря как заголовок XLS-файла, а соответствующие значения - как данные в строках файла.

**Пример**:

```python
data = {"name": "John", "age": 30, "city": "New York"}
dict2xls(data, "data.xls")
```

### `dict2html`

**Назначение**:
  - Функция генерирует HTML-таблицу из словаря или объекта `SimpleNamespace`.

**Параметры**:
 - `data` (dict | SimpleNamespace): Данные для преобразования в HTML.
 - `encoding` (str, optional): Кодировка данных. По умолчанию - `UTF-8`.

**Возвращает**:
 - `str`: HTML-строка, представляющая входной словарь.

**Как работает функция**:
  - Функция рекурсивно проходит через словарь и строит HTML-таблицу.
  - Для каждого ключа-значения словаря:
    - Ключ отображается в качестве заголовка столбца таблицы.
    - Значение отображается как ячейка таблицы.
    - Если значение является списком или словарем, функция рекурсивно вызывается для этого значения, создавая вложенные таблицы.

**Пример**:

```python
data = {"product": {"name": "Test Product", "price": "10.00", "id_tax_rules_group": "13", "id_category_default": "2"}}
html_output = dict2html(data)
print(html_output)
```

### `dict2pdf`

**Назначение**:
  - Функция сохраняет данные словаря в файл PDF.

**Параметры**:
 - `data` (dict | SimpleNamespace): Словарь для преобразования в PDF.
 - `file_path` (str | Path): Путь к выходному PDF-файлу.

**Как работает функция**:
  - Функция использует модуль `reportlab` для генерации PDF-файла из словаря.
  - Если данные представлены в виде объекта `SimpleNamespace`, функция преобразует их в словарь.
  - Затем функция iteratively проходит через словарь и записывает каждый ключ-значение в PDF-файл.
  - Если места на странице недостаточно, функция создает новую страницу.

**Пример**:

```python
data = {"name": "John", "age": 30, "city": "New York"}
dict2pdf(data, "data.pdf")
```

## Параметры

### `encoding`

- `encoding` (str, optional): Кодировка данных для функций `dict2xml` и `dict2html`. 
  - По умолчанию используется `UTF-8`.
  - Эта кодировка используется для правильного представления символов в генерируемых XML- и HTML-файлах.


## Примеры

```python
# Пример использования функции dict2ns
data = {"name": "John", "age": 30, "address": {"street": "Main Street", "city": "New York"}}
ns = dict2ns(data)
print(ns.name)  # Выведет "John"
print(ns.address.street) # Выведет "Main Street"

# Пример использования функции dict2xml
data = {"product": {"name": "Test Product", "price": "10.00", "id_tax_rules_group": "13", "id_category_default": "2"}}
xml_output = dict2xml(data)
print(xml_output)

# Пример использования функции dict2csv
data = {"name": "John", "age": 30, "city": "New York"}
dict2csv(data, "data.csv")

# Пример использования функции dict2xls
data = {"name": "John", "age": 30, "city": "New York"}
dict2xls(data, "data.xls")

# Пример использования функции dict2html
data = {"product": {"name": "Test Product", "price": "10.00", "id_tax_rules_group": "13", "id_category_default": "2"}}
html_output = dict2html(data)
print(html_output)

# Пример использования функции dict2pdf
data = {"name": "John", "age": 30, "city": "New York"}
dict2pdf(data, "data.pdf")
```

```python
                ```