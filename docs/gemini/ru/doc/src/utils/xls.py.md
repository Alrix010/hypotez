# Модуль для работы с Excel (`xls`)

## Обзор

Модуль `src.utils.xls` предоставляет функции для конвертации файлов Excel (`xls`) в формат JSON и обратно. Он позволяет читать данные из Excel-файлов, преобразовывать их в JSON, а также сохранять JSON-данные в Excel-файлы. Модуль поддерживает работу с несколькими листами в Excel-файле и обеспечивает обработку ошибок.

## Подробнее

Этот модуль предназначен для обеспечения функциональности преобразования данных между форматами Excel и JSON. Он упрощает чтение данных из Excel-файлов для использования в приложениях, работающих с JSON, а также позволяет сохранять данные из JSON-формата обратно в Excel-файлы.

## Функции

### `read_xls_as_dict`

```python
def read_xls_as_dict(
    xls_file: str,
    json_file: str = None,
    sheet_name: Union[str, int] = None
) -> Union[Dict, List[Dict], bool]:
    """
    Читает Excel-файл и конвертирует его в JSON. Опционально, конвертирует указанный лист и сохраняет результат в JSON-файл.
    Обрабатывает ошибки.

    Args:
        xls_file (str): Путь к Excel-файлу.
        json_file (str, optional): Путь для сохранения JSON-файла. По умолчанию `None`.
        sheet_name (Union[str, int], optional): Имя или индекс листа для конвертации. По умолчанию `None`.

    Returns:
        Union[Dict, List[Dict], bool]: Словарь с данными из Excel-файла, список словарей, если указан конкретный лист, или `False` в случае ошибки.

    Raises:
        FileNotFoundError: Если Excel-файл не найден.
        Exception: Если произошла ошибка при обработке файла или листа.

    Как работает функция:
    - Функция принимает путь к Excel-файлу, опциональный путь для сохранения JSON-файла и опциональное имя листа.
    - Сначала проверяется существование Excel-файла по указанному пути.
    - Если имя листа не указано, функция читает все листы Excel-файла и сохраняет их в словарь, где ключи - имена листов, а значения - списки словарей, представляющие строки данных.
    - Если имя листа указано, функция читает только этот лист и преобразует его в список словарей.
    - Если указан путь для сохранения JSON-файла, функция сохраняет данные в JSON-файл с отступом 4 для удобочитаемости.
    - В случае возникновения ошибок, функция записывает информацию об ошибке в лог и возвращает `False`.

    Примеры:
        >>> data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')
        >>> if data:
        ...     print(data)

        >>> data = read_xls_as_dict('input.xlsx')
        >>> if data:
        ...     print(data.keys())
    """
    ...
```

### `save_xls_file`

```python
def save_xls_file(data: Dict[str, List[Dict]], file_path: str) -> bool:
    """
    Сохраняет JSON-данные в Excel-файл. Обрабатывает ошибки.

    Args:
        data (Dict[str, List[Dict]]): Словарь, где ключи - имена листов, а значения - списки словарей, представляющие строки данных.
        file_path (str): Путь для сохранения Excel-файла.

    Returns:
        bool: `True`, если данные успешно сохранены в Excel-файл, `False` в случае ошибки.

    Raises:
        Exception: Если произошла ошибка при сохранении файла.

    Как работает функция:
    - Функция принимает словарь с данными и путь для сохранения Excel-файла.
    - Используется `pd.ExcelWriter` для записи данных в Excel-файл.
    - Для каждого листа в словаре создается DataFrame и записывается в соответствующий лист Excel-файла.
    - В случае возникновения ошибок, функция записывает информацию об ошибке в лог и возвращает `False`.

    Примеры:
        >>> data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
        >>> success = save_xls_file(data_to_save, 'output.xlsx')
        >>> if success:
        ...     print("Successfully saved to output.xlsx")
    """
    ...