# Модуль для экспериментов с OpenAI Chat

## Обзор

Модуль `kazarinov.py` предназначен для экспериментов с моделью чата OpenAI. Он предоставляет класс `OpenAIChat` для взаимодействия с API OpenAI и функцию `chat` для организации интерактивного чата с пользователем. Модуль использует системные инструкции для настройки поведения модели и логирует ошибки с использованием модуля `src.logger`.

## Подробнее

Модуль включает следующие компоненты:

1.  **Импорт библиотек**: Импортируются необходимые библиотеки, такие как `header`, `openai`, `src.gs`, `src.utils.file`, `src.logger.logger` и `pathlib`.
2.  **Загрузка системной инструкции**: Системная инструкция загружается из файла `system_instruction.txt` для настройки поведения модели OpenAI.
3.  **Класс `OpenAIChat`**: Класс для взаимодействия с моделью OpenAI, который инициализируется с API-ключом и системной инструкцией.
4.  **Функция `chat`**: Функция для организации интерактивного чата с пользователем через консоль.

## Классы

### `OpenAIChat`

**Описание**: Класс для взаимодействия с моделью OpenAI.

**Атрибуты**:

*   `api_key` (str): API-ключ OpenAI.
*   `system_instruction` (str): Системная инструкция для модели.
*   `messages` (list): Список сообщений для поддержания контекста чата.

**Методы**:

*   `__init__`: Инициализирует объект `OpenAIChat` с API-ключом и системной инструкцией.
*   `ask`: Отправляет вопрос в модель OpenAI и возвращает ответ.

#### `__init__`

```python
def __init__(self, api_key: str, system_instruction: str = None):
    """Инициализирует объект OpenAIChat.

    Args:
        api_key (str): API-ключ OpenAI.
        system_instruction (str, optional): Системная инструкция для модели. По умолчанию `None`.

    Returns:
        None

    Принцип работы:
        1. Устанавливает API-ключ OpenAI.
        2. Инициализирует системную инструкцию.
        3. Инициализирует список сообщений, добавляя системную инструкцию, если она предоставлена.
    """
    ...
```

#### `ask`

```python
def ask(self, prompt: str) -> str:
    """Отправляет вопрос в модель OpenAI и получает ответ.

    Args:
        prompt (str): Вопрос пользователя.

    Returns:
        str: Ответ от модели OpenAI или сообщение об ошибке.

    Raises:
        Exception: Если возникает ошибка при обращении к API OpenAI.

    Принцип работы:
        1. Добавляет вопрос пользователя в список сообщений.
        2. Отправляет запрос в OpenAI ChatCompletion API.
        3. Получает и обрабатывает ответ от модели.
        4. Добавляет ответ модели в список сообщений.
        5. В случае ошибки логирует её и возвращает сообщение об ошибке.

    """
    ...
```

## Функции

### `chat`

```python
def chat():
    """Организует интерактивный чат с пользователем через консоль.

    Args:
        None

    Returns:
        None

    Принцип работы:
        1. Выводит приветственное сообщение и инструкции для пользователя.
        2. Запрашивает у пользователя API-ключ OpenAI.
        3. Инициализирует объект `OpenAIChat` с API-ключом и системной инструкцией.
        4. В цикле запрашивает вопросы у пользователя, отправляет их модели и выводит ответы, пока пользователь не введет 'exit'.

    """
    ...
```

## Параметры

### `OpenAIChat`

*   `api_key` (str): API-ключ OpenAI. Используется для аутентификации при обращении к API OpenAI.
*   `system_instruction` (str): Системная инструкция для модели. Определяет поведение и роль модели при генерации ответов.
*   `prompt` (str): Запрос пользователя. Содержит вопрос или инструкцию, которую пользователь отправляет модели.
*   `response` (str): Ответ от модели OpenAI. Содержит сгенерированный моделью текст в ответ на запрос пользователя.

## Примеры

### Использование класса `OpenAIChat`

```python
from src.ai.openai.model._experiments.kazarinov import OpenAIChat
from src.utils.file import read_text_file
from pathlib import Path

# Укажите путь к файлу с системной инструкцией
system_instruction_path = Path('../src/ai/openai/model/_experiments/system_instruction.txt')

# Прочитайте системную инструкцию из файла
system_instruction = read_text_file(system_instruction_path)

# Замените 'YOUR_API_KEY' на ваш фактический API-ключ OpenAI
ai = OpenAIChat(api_key='YOUR_API_KEY', system_instruction=system_instruction)

# Задайте вопрос модели
question = "Как создать программу на Python, которая выводит 'Hello, world!'?"

# Получите ответ от модели
answer = ai.ask(prompt=question)

# Выведите ответ модели
print(answer)
```

### Интерактивный чат

```python
from src.ai.openai.model._experiments.kazarinov import chat

# Запустите интерактивный чат
chat()