# Модуль `file_counter`

## Обзор

Модуль `file_counter` предназначен для подсчета количества строк кода, классов и функций в текстовых файлах, расположенных в указанной директории и её поддиректориях.

## Подробней

Модуль предоставляет функциональность для рекурсивного анализа структуры файлов проекта, исключая бинарные файлы, файлы Jupyter Notebook и директории `__pycache__`. Он используется для получения общей статистики о кодовой базе проекта.

## Функции

### `count_lines_in_files`

**Назначение**: Рекурсивно подсчитывает количество строк в текстовых файлах, а также количество классов и функций в указанной директории и ее поддиректориях.

```python
def count_lines_in_files(directory):
    """
    Recursively counts the number of lines in text files in the specified directory and its subdirectories,
    as well as the number of classes and functions.

    @param directory: Path to the directory
    @return: Total number of lines in text files, number of classes, and number of functions
    """
    ...
```

**Параметры**:
- `directory` (str): Путь к директории, в которой необходимо выполнить подсчет.

**Возвращает**:
- `total_lines` (int): Общее количество строк в текстовых файлах.
- `total_classes` (int): Общее количество классов.
- `total_functions` (int): Общее количество функций.

**Как работает функция**:
1. Инициализирует счетчики `total_lines`, `total_classes` и `total_functions` нулем.
2. Перебирает все файлы и директории в указанной директории.
3. Если текущий элемент является файлом:
   - Проверяет, является ли файл текстовым (не бинарным), не является ли он файлом Jupyter Notebook (`.ipynb`) и файлом `__init__.py`.
   - Если файл соответствует условиям, открывает его, подсчитывает количество строк, классов и функций с помощью функции `count_lines_classes_functions`.
   - Увеличивает общие счетчики на значения, возвращенные функцией `count_lines_classes_functions`.
4. Если текущий элемент является директорией:
   - Исключает директории, начинающиеся с `__pycache__` или `.`.
   - Рекурсивно вызывает функцию `count_lines_in_files` для подсчета строк, классов и функций в поддиректории.
   - Увеличивает общие счетчики на значения, возвращенные рекурсивным вызовом.
5. Возвращает общее количество строк, классов и функций.

**Примеры**:

```python
dir_path = 'путь/к/директории'
total_lines, total_classes, total_functions = count_lines_in_files(dir_path)
print(f"Всего строк: {total_lines}, классов: {total_classes}, функций: {total_functions}")
```

### `is_binary`

**Назначение**: Проверяет, является ли файл бинарным.

```python
def is_binary(filepath):
    """
    Checks if the file is binary.

    @param filepath: Path to the file
    @return: True if the file is binary, otherwise False
    """
    ...
```

**Параметры**:
- `filepath` (str): Путь к файлу.

**Возвращает**:
- `bool`: `True`, если файл является бинарным, и `False` в противном случае.

**Как работает функция**:
1. Пытается открыть файл в бинарном режиме (`'rb'`).
2. Читает первые 512 байт файла.
3. Проверяет наличие нулевых байтов (`b'\\0'`) в прочитанном куске. Если нулевые байты найдены, файл считается бинарным.
4. В случае возникновения исключения при чтении файла, считает файл бинарным.
5. Возвращает `True`, если файл бинарный, и `False` в противном случае.

**Примеры**:

```python
file_path = 'путь/к/файлу.txt'
if is_binary(file_path):
    print("Файл является бинарным")
else:
    print("Файл не является бинарным")
```

### `count_lines_classes_functions`

**Назначение**: Подсчитывает количество строк, классов и функций в файле.

```python
def count_lines_classes_functions(file):
    """
    Counts the number of lines, classes, and functions in the file.

    @param file: File object
    @return: Number of lines, number of classes, and number of functions
    """
    ...
```

**Параметры**:
- `file` (file object): Объект файла, открытый для чтения.

**Возвращает**:
- `lines` (int): Количество строк в файле.
- `classes_count` (int): Количество классов в файле.
- `functions_count` (int): Количество функций в файле.

**Как работает функция**:
1. Инициализирует счетчики `lines`, `classes_count` и `functions_count` нулем.
2. Перебирает все строки в файле.
3. Удаляет начальные и конечные пробелы из каждой строки.
4. Проверяет, не является ли строка пустой.
5. Если строка не пустая, увеличивает счетчик строк (`lines`).
6. Проверяет, начинается ли строка с `'class'`. Если да, увеличивает счетчик классов (`classes_count`).
7. Проверяет, начинается ли строка с `'def'`. Если да, увеличивает счетчик функций (`functions_count`).
8. Возвращает количество строк, классов и функций.

**Примеры**:

```python
with open('путь/к/файлу.txt', 'r', encoding='utf-8') as file:
    lines, classes_count, functions_count = count_lines_classes_functions(file)
    print(f"Строк: {lines}, Классов: {classes_count}, Функций: {functions_count}")
```

## Запуск из командной строки

Если скрипт запущен напрямую (как главный модуль), он выполняет следующие действия:

1. Определяет корневую директорию проекта (`hypotez`).
2. Определяет директорию `src` внутри корневой директории.
3. Выводит сообщение о начале подсчета строк, классов и функций в файлах в директории `src`.
4. Вызывает функцию `count_lines_in_files` для подсчета строк, классов и функций в директории `src`.
5. Выводит общее количество строк, классов и функций.

**Пример запуска**:

```shell
python dev_utils/file_counter.py
```

## Параметры среды

- `MODE`: Определяет режим работы приложения. В данном случае установлено значение `'development'`.