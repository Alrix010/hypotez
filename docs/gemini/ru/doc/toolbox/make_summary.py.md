# Модуль для создания SUMMARY.md

## Обзор

Этот модуль предназначен для автоматической генерации файла `SUMMARY.md`, который используется для компиляции документации с помощью таких инструментов, как `mdbook`. Модуль рекурсивно обходит указанный каталог, содержащий исходные `.md` файлы, и генерирует оглавление, включая или исключая файлы на основе указанного языка.

## Подробней

Этот модуль автоматизирует процесс создания файла `SUMMARY.md`, необходимого для `mdbook` и других инструментов для генерации документации. Он фильтрует файлы по языку (русский или английский), чтобы в оглавление включались только релевантные файлы. Все пути указываются относительно корня проекта, что обеспечивает устойчивость модуля к изменениям структуры каталогов.

## Функции

### `make_summary`

**Назначение**: Создает файл SUMMARY.md, рекурсивно обходя папку.

```python
def make_summary(docs_dir: Path, lang: str = 'en') -> None:
    """
    Создает файл SUMMARY.md, рекурсивно обходя папку.

    Args:
        docs_dir (Path): Путь к исходной директории 'src'.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Параметры**:

-   `docs_dir` (Path): Путь к исходной директории `'src'`.
-   `lang` (str): Язык фильтрации файлов. Возможные значения: `'ru'` или `'en'`. По умолчанию `'en'`.

**Возвращает**:

-   `None`

**Как работает функция**:

1.  Принимает путь к исходной директории и язык фильтрации файлов.
2.  Формирует путь к файлу `SUMMARY.md`, используя функцию `prepare_summary_path`.
3.  Создает родительские директории для файла `SUMMARY.md`, если они не существуют.
4.  Вызывает функцию `_make_summary` для рекурсивного обхода директории и создания содержимого файла `SUMMARY.md`.

### `_make_summary`

**Назначение**: Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

```python
def _make_summary(src_dir: Path, summary_file: Path, lang: str = 'en') -> bool:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Параметры**:

-   `src_dir` (Path): Путь к папке с исходниками `.md`.
-   `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`.
-   `lang` (str): Язык фильтрации файлов. Возможные значения: `'ru'` или `'en'`. По умолчанию `'en'`.

**Возвращает**:

-   `bool`: `True`, если файл создан успешно, `False` в случае ошибки.

**Как работает функция**:

1.  Принимает путь к исходной директории, путь к файлу `SUMMARY.md` и язык фильтрации файлов.
2.  Проверяет, существует ли файл `SUMMARY.md`, и выводит сообщение, если он будет перезаписан.
3.  Открывает файл `SUMMARY.md` для записи.
4.  Записывает заголовок `# Summary` в файл.
5.  Рекурсивно перебирает все файлы с расширением `.md` в исходной директории.
6.  Фильтрует файлы по языку:
    -   Если указан русский язык (`lang == 'ru'`), то включаются только файлы с суффиксом `.ru.md`.
    -   Если указан английский язык (`lang == 'en'`), то файлы с суффиксом `.ru.md` исключаются.
7.  Формирует относительный путь к файлу относительно родительской директории исходной директории.
8.  Записывает строку в формате Markdown для каждого файла в файл `SUMMARY.md`.
9.  Обрабатывает исключения, которые могут возникнуть в процессе создания файла.
10. Возвращает `True` в случае успешного создания файла и `False` в случае ошибки.

### `prepare_summary_path`

**Назначение**: Формирует путь к файлу, заменяя часть пути `'src'` на `'docs'` и добавляя имя файла.

```python
def prepare_summary_path(src_dir: Path, file_name: str = 'SUMMARY.md') -> Path:
    """
    Формирует путь к файлу, заменяя часть пути 'src' на 'docs' и добавляя имя файла.

    Args:
        src_dir (Path): Исходный путь с 'src'.
        file_name (str): Имя файла, который нужно создать. По умолчанию 'SUMMARY.md'.

    Returns:
        Path: Новый путь к файлу.
    """
    ...
```

**Параметры**:

-   `src_dir` (Path): Исходный путь с `'src'`.
-   `file_name` (str): Имя файла, который нужно создать. По умолчанию `'SUMMARY.md'`.

**Возвращает**:

-   `Path`: Новый путь к файлу.

**Как работает функция**:

1.  Принимает исходный путь и имя файла.
2.  Формирует новый путь, заменяя часть пути `'src'` на `'docs'`.
3.  Добавляет имя файла к новому пути.
4.  Возвращает новый путь.

## Запуск модуля

В блоке `if __name__ == '__main__':` происходит разбор аргументов командной строки, преобразование пути к исходной директории в объект `Path` и вызов функции `make_summary` с переданными аргументами.

```python
if __name__ == '__main__':
    # Парсинг аргументов командной строки
    parser = argparse.ArgumentParser(description="Создание файла SUMMARY.md с фильтрацией по языку.")
    parser.add_argument('-lang', type=str, choices=['ru', 'en'], default='en', help="Язык фильтрации файлов (ru или en). По умолчанию 'en'.")
    parser.add_argument('src_dir', type=str, help="Путь к исходной директории 'src'.")
    args = parser.parse_args()

    # Преобразование пути в объект Path
    src_dir = PROJECT_ROOT / args.src_dir

    # Вызов функции make_summary с переданными аргументами
    make_summary(src_dir, args.lang)
```

Это позволяет запускать скрипт из командной строки с указанием языка и исходной директории:

```bash
python src/endpoints/hypo69/code_assistant/make_summary.py -lang ru src