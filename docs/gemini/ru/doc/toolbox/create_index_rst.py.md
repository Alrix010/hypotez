# Модуль для создания index.rst

## Обзор

Этот модуль предназначен для автоматического создания файла `index.rst`, необходимого для генерации документации Sphinx. Он рекурсивно обходит поддиректории, начиная с указанной, находит все файлы с расширением `.py` (имена которых не содержат скобок), и добавляет их в файл `index.rst` в формате `toctree`.

## Подробней

Модуль автоматизирует процесс создания основного файла `index.rst`, который служит отправной точкой для документации Sphinx. Он сканирует структуру проекта, определяет Python-файлы, которые должны быть включены в документацию, и генерирует соответствующую структуру `toctree`.

## Функции

### `create_index_rst`

**Назначение**: Рекурсивно обходит поддиректории, начиная с указанной, находит все файлы с расширением `.py` (имена которых не содержат скобок), и добавляет их в файл `index.rst` в формате `toctree`.

```python
def create_index_rst(start_dir: str) -> None:
    """ Recursively traverses all subdirectories from the start directory, reads all *.py files,
    and creates an index.rst file in the `docs` directory that lists all these files in a toctree format. Logs the process throughout.

    Args:
        start_dir (str): The root directory to start the traversal from.

    Returns:
        None

    Example:
        >>> create_index_rst(os.getcwd())
    """
    ...
```

**Параметры**:

-   `start_dir` (str): Корневая директория, с которой начинается обход.

**Возвращает**:

-   `None`

**Как работает функция**:

1.  Принимает путь к корневой директории в качестве аргумента.
2.  Определяет пути к директории `docs` и файлу `index.rst` внутри этой директории.
3.  Создает директорию `docs`, если она не существует.
4.  Открывает файл `index.rst` для записи.
5.  Записывает в файл заголовок `toctree` с настройками `maxdepth` и `caption`.
6.  Рекурсивно обходит все поддиректории, начиная с указанной корневой.
7.  Для каждой поддиректории определяет все Python-файлы, имена которых не содержат скобок.
8.  Для каждого найденного Python-файла формирует относительный путь к модулю и добавляет его в файл `index.rst` в формате, требуемом для директивы `toctree`.
9.  Если в указанной директории не найдено ни одного Python-файла, выводит соответствующее сообщение в лог.
10. Логгирует информацию о процессе создания файла `index.rst`.
11. Обрабатывает исключения, которые могут возникнуть в процессе создания файла.

## Запуск модуля

В блоке `if __name__ == "__main__":` вызывается функция `create_index_rst` с указанием директории `src` относительно корня проекта в качестве аргумента.

```python
if __name__ == "__main__":
    create_index_rst(Path(header.__root__, 'src'))
```

Это приведет к созданию или обновлению файла `index.rst` в директории `docs`, который будет содержать список всех Python-файлов в директории `src` и ее поддиректориях.