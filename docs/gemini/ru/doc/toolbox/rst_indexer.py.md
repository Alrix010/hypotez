# Модуль для создания index.rst в формате Sphinx

## Обзор

Этот модуль предназначен для автоматического создания файла `index.rst`, необходимого для генерации документации Sphinx. Он рекурсивно обходит поддиректории, начиная с указанной, находит все файлы с расширением `.py` (имена которых не содержат скобок) и добавляет их в файл `index.rst` в формате `toctree`, соответствующем конвенциям Sphinx.

## Подробней

Модуль автоматизирует процесс создания основного файла `index.rst` для документации Sphinx. Он сканирует структуру проекта, определяет Python-файлы, которые должны быть включены в документацию, и генерирует соответствующую структуру `toctree` с заголовком и настройками.  Также, модуль использует логгирование для отслеживания процесса создания файла.

## Функции

### `create_index_rst`

**Назначение**: Рекурсивно обходит поддиректории, начиная с указанной, находит все файлы с расширением `.py` и создает файл `index.rst` в директории `docs` в формате Sphinx.

```python
def create_index_rst(start_dir: str) -> None:
    """
    Recursively traverses all subdirectories from the start directory, reads all *.py files,
    and creates an index.rst file in the `docs` directory that lists all these files
    using the Sphinx `toctree` structure. Logs the process throughout.

    Args:
        start_dir (str): The root directory to start the traversal from.

    Returns:
        None

    Example:
        >>> create_index_rst(os.getcwd())
    """
    ...
```

**Параметры**:

-   `start_dir` (str): Корневая директория, с которой начинается обход.

**Возвращает**:

-   `None`

**Как работает функция**:

1.  Принимает путь к корневой директории (`start_dir`) в качестве аргумента.
2.  Формирует пути к директории `docs` и файлу `index.rst` внутри этой директории.
3.  Проверяет существование директории `docs` и создает ее, если она не существует.
4.  Открывает файл `index.rst` для записи.
5.  Записывает в файл заголовок и директиву `toctree` с настройками `maxdepth` и `caption`, необходимые для Sphinx.
6.  Рекурсивно обходит все поддиректории, начиная с указанной корневой, используя `os.walk`.
7.  Для каждой поддиректории определяет все Python-файлы, имена которых не содержат скобок.
8.  Для каждого найденного Python-файла:
    -   Вычисляет относительный путь к файлу от корневой директории.
    -   Преобразует путь к модулю в формат, используемый Sphinx (заменяет разделители директорий на точки).
    -   Добавляет имя модуля в файл `index.rst` в формате, требуемом для директивы `toctree`.
9.  Если в указанной директории не найдено ни одного Python-файла, выводит соответствующее сообщение в файл `index.rst`.
10. Использует модуль `src.logger` для логирования информации о процессе создания файла `index.rst`.
11. Обрабатывает исключения, которые могут возникнуть в процессе создания файла.

## Переменные модуля

-   `MODE` (str): Определяет режим работы модуля (в данном случае, 'development').

## Запуск модуля

В блоке `if __name__ == "__main__":` вызывается функция `create_index_rst` с указанием директории `src/utils` относительно корня проекта в качестве аргумента.

```python
if __name__ == "__main__":
    create_index_rst(Path(header.__root__, 'src', 'utils'))
```

Это приведет к созданию или обновлению файла `index.rst` в директории `docs`, который будет содержать список всех Python-файлов в директории `src/utils` и ее поддиректориях в формате, совместимом со Sphinx.