# Модуль для создания SUMMARY.md для mdbook

## Обзор

Этот модуль предназначен для автоматического создания файла `SUMMARY.md`, который используется инструментом `mdbook` для генерации документации. Модуль рекурсивно обходит указанную директорию и создает файл `SUMMARY.md` с главами на основе найденных `.md` файлов.

## Подробней

Модуль автоматизирует процесс создания оглавления для документации, написанной в формате Markdown. Он сканирует указанную директорию, находит все файлы с расширением `.md`, исключает сам файл `SUMMARY.md` и генерирует список ссылок на эти файлы в формате, необходимом для `mdbook`.  Модуль предполагает наличие правильно настроенного модуля `gs` для получения пути к корневой директории проекта.

## Функции

### `make_summary`

**Назначение**: Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов. Если файл SUMMARY.md уже существует, он будет перезаписан.

```python
def make_summary(src_dir: Path = src_path , summary_file: Path = summary_path) -> None:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.
    Если файл SUMMARY.md уже существует, он будет перезаписан.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
    
    How to use:
    -----------------------
    1. Убедитесь, что у вас есть папка с .md файлами (например, 'docs/gemini/consultant/ru/src').
    2. Убедитесь, что модуль `gs` правильно настроен для получения пути корневой директории.
    3. Запустите скрипт. Он автоматически создаст файл `SUMMARY.md` в указанной папке.
    4. Файл `SUMMARY.md` будет содержать список всех `.md` файлов в директории, структурированный в виде глав с вложениями.
    """
    ...
```

**Параметры**:

-   `src_dir` (Path): Путь к папке с исходниками `.md`. По умолчанию `src_path`, определенный в модуле.
-   `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`. По умолчанию `summary_path`, определенный в модуле.

**Возвращает**:

-   `None`

**Как работает функция**:

1.  Принимает путь к исходной директории и путь к файлу `SUMMARY.md`.
2.  Проверяет, существует ли файл `SUMMARY.md`, и выводит соответствующее сообщение.
3.  Открывает файл `SUMMARY.md` для записи.
4.  Записывает заголовок `# Summary` в файл.
5.  Рекурсивно перебирает все файлы с расширением `.md` в исходной директории.
6.  Исключает из обработки сам файл `SUMMARY.md`.
7.  Формирует относительный путь к файлу и преобразует название файла в удобочитаемый формат.
8.  Определяет уровень вложенности для правильного форматирования отступов.
9.  Записывает строку в формате Markdown для каждого файла в файл `SUMMARY.md`.
10. Выводит сообщение об успешном создании или перезаписи файла `SUMMARY.md`.

## Переменные модуля

-   `src_path` (Path): Путь к директории с файлами `.md`. Определяется как `gs.path.root / 'docs' / 'gemini' / 'consultant' / 'ru' / 'src'`, где `gs.path.root` - корневой путь проекта, полученный из модуля `src`.
-   `summary_path` (Path): Путь для сохранения файла `SUMMARY.md`. Определяется как `src_path / 'SUMMARY.md'`.
-   `PROJECT_ROOT` (Path):  Корневой путь проекта, полученный из модуля `header.__root__`.
## Пример использования

### Локальный запуск
```bash
python путь/к/скрипту/mdbook_create_summary.py
```

В этом случае будут использованы пути по умолчанию, сконфигурированные в самом файле. Если их необходимо изменить, отредактируйте переменные `src_path` и `summary_path` непосредственно в коде.
```python
# Путь к директории с файлами .md
src_path = Path(gs.path.root / 'docs' / 'gemini' / 'consultant' / 'ru' / 'src')

# Путь для сохранения SUMMARY.md
summary_path = src_path / 'SUMMARY.md'
```

## Зависимости

* `pathlib`: для работы с путями.
* `header`: для определения корневого пути проекта.
* `src`: для получения доступа к `gs.path.root`, содержащему базовые пути.

## Описание переменных

* `PROJECT_ROOT`:  Корневой путь проекта, полученный из модуля `header.__root__`.
* `src_path`:  Путь к директории с исходными `.md` файлами, используемый по умолчанию.
* `summary_path`:  Путь к файлу `SUMMARY.md`, который будет создан или перезаписан.
* `rel_path`: Относительный путь к `.md` файлу, используемый для создания ссылок в `SUMMARY.md`.
* `chapter_name`:  Название главы, полученное из имени `.md` файла (без расширения).
* `indent`: Отступ для форматирования, соответствующий глубине вложенности файлов.

## Потенциальные проблемы и области для улучшения

* Отсутствует обработка исключений при работе с файловой системой.
* Не реализована возможность настройки путей через аргументы командной строки.
* Жестко заданы пути в коде (стоит сделать их более гибкими).
* Зависимость от модуля `src` и его внутренней структуры (`gs.path.root`). Это создает сильную связь между модулями и ограничивает возможность повторного использования кода.
* Не хватает подробных комментариев в коде, особенно внутри цикла обработки файлов.
* В функции  `make_summary` отсутствует явная обработка ошибок, связанных с созданием и записью в файл. Рекомендуется использовать блоки `try-except` для более надежной обработки исключений.

## Связь с другими модулями проекта

Модуль `mdbook_create_summary.py` зависит от `header` для определения корневого пути проекта и от модуля `src` для доступа к `gs.path.root`. Это создает связь с другими частями проекта и может потребовать рефакторинга для повышения независимости модуля.