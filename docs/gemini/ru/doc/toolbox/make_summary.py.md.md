# Модуль для создания SUMMARY.md

## Обзор

Модуль предназначен для автоматического создания файла `SUMMARY.md`, который используется для навигации по документации, написанной в формате Markdown. Он рекурсивно обходит указанную директорию с исходными файлами, формирует ссылки на найденные `.md` файлы и записывает их в файл `SUMMARY.md`. Файлы могут быть отфильтрованы по языку (русский или английский).

## Подробней

Этот модуль играет важную роль в проекте `hypotez`, так как позволяет автоматизировать процесс создания оглавления для документации. Это упрощает навигацию по документации и делает ее более удобной для использования. Модуль использует аргументы командной строки для настройки языка и директории с исходными файлами, что позволяет гибко адаптировать его к различным проектам и структурам документации.

## Классы

В данном модуле классы отсутствуют.

## Функции

### `make_summary`

```python
def make_summary(docs_dir: Path, lang: str = 'en') -> None:
    """
    Создает файл SUMMARY.md в директории docs, рекурсивно обходя директорию src
    и добавляя в SUMMARY.md ссылки на найденные .md файлы, отфильтрованные по языку.

    Args:
        docs_dir (Path): Путь к исходной директории `src`.
        lang (str): Язык фильтрации файлов (`'ru'` или `'en'`). По умолчанию `'en'`.

    Returns:
        None

    """
```

**Назначение**: Создает файл `SUMMARY.md` в директории `docs`, рекурсивно обходя директорию `src` и добавляя в `SUMMARY.md` ссылки на найденные `.md` файлы, отфильтрованные по языку.

**Параметры**:

-   `docs_dir` (Path): Путь к исходной директории `src`.
-   `lang` (str): Язык фильтрации файлов (`'ru'` или `'en'`). По умолчанию `'en'`.

**Возвращает**:

-   `None`

**Как работает функция**:

1.  Функция принимает путь к исходной директории (`docs_dir`) и язык фильтрации (`lang`).
2.  Преобразует путь к исходной директории в объект `Path`.
3.  Вызывает функцию `prepare_summary_path` для формирования пути к файлу `SUMMARY.md` в директории `docs`.
4.  Вызывает функцию `_make_summary` для рекурсивного обхода директории `src` и добавления ссылок на `.md` файлы в `SUMMARY.md`.

**Примеры**:

```python
make_summary(Path('src/module1'), 'ru')
```

Эта функция создаст `SUMMARY.md` в директории `docs/module1`, содержащий ссылки на все `.ru.md` файлы в директории `src/module1` и ее поддиректориях.

### `_make_summary`

```python
def _make_summary(src_dir: Path, summary_file: Path, lang: str = 'en') -> bool:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

    Args:
        src_dir (Path): Путь к папке с исходниками `.md`.
        summary_file (Path): Путь для сохранения файла `SUMMARY.md`.
        lang (str): Язык фильтрации файлов (`'ru'` или `'en'`). По умолчанию `'en'`.

    Returns:
        bool: True в случае успеха, False в случае ошибки.

    """
```

**Назначение**: Рекурсивно обходит указанную директорию и создает файл `SUMMARY.md` с главами на основе найденных `.md` файлов.

**Параметры**:

-   `src_dir` (Path): Путь к папке с исходными файлами `.md`.
-   `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`.
-   `lang` (str): Язык фильтрации файлов (`'ru'` или `'en'`). По умолчанию `'en'`.

**Возвращает**:

-   `bool`: `True` в случае успеха, `False` в случае ошибки.

**Как работает функция**:

1.  Функция принимает путь к исходной директории (`src_dir`), путь к файлу `SUMMARY.md` (`summary_file`) и язык фильтрации (`lang`).
2.  Проверяет, существует ли файл `SUMMARY.md`. Если существует, выводит предупреждение о перезаписи файла.
3.  Открывает файл `SUMMARY.md` для записи.
4.  Записывает заголовок `# Summary` в файл.
5.  Рекурсивно обходит директорию `src_dir` в поиске файлов `.md`.
6.  Для каждого найденного файла проверяет, является ли он файлом `SUMMARY.md`. Если да, то пропускает его.
7.  В зависимости от языка фильтрации (`lang`) проверяет, соответствует ли имя файла языку.
    -   Если `lang == 'ru'`, то выбираются только файлы, заканчивающиеся на `.ru.md`.
    -   Если `lang == 'en'`, то выбираются только файлы, не заканчивающиеся на `.ru.md`.
8.  Формирует относительный путь к файлу от родительской директории `src_dir`.
9.  Записывает строку в файл `SUMMARY.md` в формате `- [path.stem](relative_path.as_posix())`.
10. Закрывает файл `SUMMARY.md`.

**Примеры**:

```python
_make_summary(Path('src/module1'), Path('docs/module1/SUMMARY.md'), 'en')
```

Эта функция создаст или перезапишет файл `docs/module1/SUMMARY.md`, содержащий ссылки на все `.md` файлы (кроме `.ru.md`, если `lang='en'`) в директории `src/module1` и ее поддиректориях.

### `prepare_summary_path`

```python
def prepare_summary_path(src_dir: Path, file_name: str = 'SUMMARY.md') -> Path:
    """
    Формирует путь к файлу, заменяя часть пути src на docs и добавляя имя файла.

    Args:
        src_dir (Path): Исходный путь с `src`.
        file_name (str): Имя файла, который нужно создать. По умолчанию `'SUMMARY.md'`.

    Returns:
        Path: Новый путь к файлу.

    """
```

**Назначение**: Формирует путь к файлу `SUMMARY.md` в директории `docs`, заменяя часть пути `src` на `docs`.

**Параметры**:

-   `src_dir` (Path): Исходный путь к директории `src`.
-   `file_name` (str): Имя файла, который нужно создать. По умолчанию `'SUMMARY.md'`.

**Возвращает**:

-   `Path`: Новый путь к файлу.

**Как работает функция**:

1.  Функция принимает путь к исходной директории (`src_dir`) и имя файла (`file_name`).
2.  Определяет корневую директорию проекта (`PROJECT_ROOT`).
3.  Формирует новый путь, заменяя `src` на `docs` в пути `src_dir` и добавляя имя файла.
4.  Создает директорию `docs`, если она не существует.
5.  Возвращает новый путь к файлу.

**Примеры**:

```python
prepare_summary_path(Path('src/module1'), 'SUMMARY.md')
```

Эта функция вернет объект `Path` с путем `docs/module1/SUMMARY.md`.

## Переменные

-   `PROJECT_ROOT`: Путь к корневой директории проекта. Определяется модулем `header`.
-   `args`: Объект, возвращаемый `parser.parse_args()`, содержащий значения аргументов командной строки.
    Атрибуты: `lang` (язык фильтрации), `src_dir` (путь к исходной директории).
-   `summary_file`: Объект `Path`, представляющий путь к файлу `SUMMARY.md`.
-   `relative_path`: Объект `Path`, представляющий относительный путь от `src_dir.parent` до текущего файла `.md`.