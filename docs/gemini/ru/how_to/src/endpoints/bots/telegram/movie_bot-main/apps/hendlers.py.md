### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Данный блок кода содержит набор обработчиков для Telegram-бота, который позволяет пользователям искать фильмы и сериалы. Он использует библиотеку `aiogram` для обработки команд и взаимодействий с пользователем через callback-запросы и сообщения. Блок кода определяет роутер (`router`) для обработки различных типов запросов, а также использует FSM (Finite State Machine) для управления состоянием диалога с пользователем.

Шаги выполнения
-------------------------
1. **Импорт необходимых модулей**:
   - Импортируются классы и функции из `aiogram` для работы с ботом, роутером, фильтрами, состояниями и сообщениями.
   - Импортируются модули `keyboard` (как `kb`) и `search` (как `search_query`) из локальных директорий `apps`.

2. **Определение роутера**:
   - Создается экземпляр `Router` для организации обработчиков.

3. **Определение словаря `type_movies`**:
   - Определяется словарь, который сопоставляет строковые идентификаторы (`'film'`, `'series'`) с их отображаемыми названиями на русском языке (`'Фильм'`, `'Сериал'`).

4. **Определение класса `Params`**:
   - Создается класс `Params`, который наследуется от `StatesGroup` и определяет состояния для FSM: `type_movie` (тип фильма) и `name` (название фильма).

5. **Обработчик команды `/start`**:
   - Функция `command_start_handler` обрабатывает команду `/start`.
   - Отправляет приветственное сообщение пользователю с его именем.
   - Отправляет сообщение с предложением найти фильм и прикрепляет клавиатуру `find_movie` для выбора действия.

6. **Обработчик callback-запроса `new_movies`**:
   - Функция `movie_handler` обрабатывает callback-запрос с данными `'new_movies'`.
   - Устанавливает состояние `Params.type_movie` для FSM.
   - Редактирует сообщение, предлагая пользователю указать, что он ищет: фильм или сериал, используя клавиатуру `choice`.

7. **Обработчики callback-запросов `series` и `film`**:
   - Функции `series_handler` и `film_handler` обрабатывают callback-запросы с данными `'series'` и `'film'` соответственно.
   - Удаляют предыдущее сообщение с клавиатурой.
   - Обновляют данные состояния, сохраняя тип фильма (`'series'` или `'film'`).
   - Устанавливают состояние `Params.name` для FSM.
   - Отправляют сообщение с запросом названия фильма/сериала.

8. **Обработчик сообщений в состоянии `Params.name`**:
   - Функция `name_handler` обрабатывает сообщения, когда FSM находится в состоянии `Params.name`.
   - Обновляет данные состояния, сохраняя название фильма/сериала из сообщения пользователя.
   - Извлекает данные из состояния.
   - Вызывает функцию `search_query` для поиска фильма/сериала по названию и типу.
   - Отправляет сообщение с информацией о запросе (название и тип).
   - Если фильм/сериал найден, отправляет информацию о нем (название, описание, ссылка).
   - Если фильм/сериал не найден, отправляет сообщение об этом.
   - Предлагает пользователю найти новый фильм, используя клавиатуру `find_movie`.
   - Очищает состояние FSM.

Пример использования
-------------------------

```python
from aiogram import Bot, Dispatcher
import asyncio
import logging

# from hendlers import router  # Исправлено
from apps.hendlers import router  # Исправлено
from config import Config
# from src.logger.logger import logger
from logger.logger import logger
# from src.webdirver import Driver  # Fix убрал лишние импорты
from webdirver import Driver  # Fix убрал лишние импорты


async def main():
    # Настройка логирования
    logging.basicConfig(level=logging.INFO)
    logger.info("Starting bot")

    # Инициализация бота и диспетчера
    config = Config()
    bot = Bot(token=config.BOT_TOKEN, parse_mode="html")
    dp = Dispatcher()

    # Регистрация роутера
    dp.include_router(router)

    # Запуск polling
    try:
        await dp.start_polling(bot)
    finally:
        await bot.session.close()


if __name__ == '__main__':
    asyncio.run(main())