### Как запустить Telegram-бота для поиска фильмов
=========================================================================================

Описание
-------------------------
Этот блок кода запускает Telegram-бота, используя библиотеку aiogram, для обработки сообщений и выполнения задач, связанных с поиском фильмов. Код инициализирует бота, регистрирует обработчики сообщений, подключает middleware для управления скоростью обработки запросов и запускает процесс получения обновлений от Telegram.

Шаги выполнения
-------------------------
1. **Импорт необходимых библиотек**:
   - Импортируются библиотеки `asyncio`, `betterlogging`, `os`, `aiogram`, `dotenv` и пользовательские модули `router` и `ThrottlingMiddleware`.
   - `asyncio` используется для асинхронного выполнения кода.
   - `betterlogging` используется для настройки логирования.
   - `os` используется для доступа к переменным окружения.
   - `aiogram` используется для создания и управления Telegram-ботом.
   - `dotenv` используется для загрузки переменных окружения из файла `.env`.
   - `router` содержит обработчики сообщений для бота.
   - `ThrottlingMiddleware` используется для ограничения частоты обработки запросов.

2. **Загрузка переменных окружения**:
   - Функция `load_dotenv()` загружает переменные окружения из файла `.env`, что позволяет получить доступ к токену бота и другим настройкам.

3. **Инициализация Dispatcher**:
   - Создается экземпляр класса `Dispatcher` и присваивается переменной `dp`. `Dispatcher` используется для регистрации обработчиков и управления потоком обработки сообщений.

4. **Определение асинхронной функции `main`**:
   - Определяется асинхронная функция `main`, которая будет содержать основную логику запуска бота.

5. **Инициализация бота**:
   - Создается экземпляр класса `Bot` с использованием токена, полученного из переменной окружения `TOKEN`.

6. **Регистрация middleware**:
   - `ThrottlingMiddleware` регистрируется как middleware для обработки сообщений. Это позволяет ограничить частоту обработки запросов от одного пользователя, предотвращая перегрузку бота.

7. **Регистрация обработчиков**:
   - `router` (который содержит обработчики сообщений) включается в `Dispatcher`. Это позволяет `Dispatcher` находить и вызывать соответствующие обработчики для каждого типа входящего сообщения.

8. **Запуск процесса получения обновлений**:
   - `dp.start_polling(bot)` запускает процесс получения обновлений от Telegram. Бот начинает прослушивать входящие сообщения и передавать их на обработку в `Dispatcher`.

9. **Настройка логирования**:
   - В блоке `if __name__ == "__main__":` настраивается логирование с использованием библиотеки `betterlogging`.
   - Устанавливается уровень логирования `INFO`.
   - Определяется формат сообщений лога, включающий время, уровень, имя модуля, имя файла, имя функции и номер строки.
   - Устанавливается формат даты.

10. **Запуск асинхронной функции `main`**:
    - `asyncio.run(main())` запускает асинхронную функцию `main`, которая инициализирует и запускает Telegram-бота.

Пример использования
-------------------------

```python
import asyncio
import betterlogging as logging
import os

from aiogram import Bot, Dispatcher
from dotenv import load_dotenv

from apps.hendlers import router
from middlewares.throttling import ThrottlingMiddleware

load_dotenv()

dp = Dispatcher()


async def main() -> None:
    bot = Bot(os.getenv('TOKEN'),)
    dp.message.middleware(ThrottlingMiddleware())
    dp.include_router(router)
    await dp.start_polling(bot)


if __name__ == "__main__":
    logging.basic_colorized_config(
        level=logging.INFO,
        format='%(asctime)s - [%(levelname)s] - %(name)s - '
               '(%(filename)s).%(funcName)s(%(lineno)d) - %(message)s',
        datefmt='%H:%M:%S'
    )
    asyncio.run(main())