## Как использовать функцию `successful_payment_logic`
=========================================================================================

Описание
-------------------------
Функция `successful_payment_logic` обрабатывает успешную оплату товара в боте, выполняя следующие действия:

1. **Записывает данные о покупке в базу данных.**
2. **Отправляет уведомление администраторам о совершённой покупке.**
3. **Отправляет пользователю информацию о купленном товаре.**
4. **Возвращает пользователю звёзды, если оплата была проведена звёздами.**

Шаги выполнения
-------------------------
1. **Извлекает данные о покупке из `payment_data`**: 
    - ID товара (`product_id`)
    - Цена товара (`price`)
    - Тип оплаты (`payment_type`)
    - ID оплаты (`payment_id`)
    - ID пользователя (`user_id`)
2. **Записывает данные о покупке в базу данных**:
    - Использует объект `PurchaseDao` для добавления записи о покупке в таблицу `purchases`.
3. **Извлекает данные о товаре из базы данных**:
    - Использует объект `ProductDao` для получения данных о товаре по его ID (`product_id`).
4. **Отправляет уведомление администраторам**:
    - Проходит по списку ID администраторов (`settings.ADMIN_IDS`).
    - Отправляет сообщение в чат каждого администратора с информацией о покупке:
        - ID пользователя, совершившего покупку.
        - Название купленного товара.
        - Цена товара.
        - Валюта товара.
    - Обрабатывает исключения, если возникли проблемы с отправкой сообщения.
5. **Отправляет информацию о товаре пользователю**:
    - Формирует текст сообщения с информацией о товаре:
        - Название товара.
        - Описание товара.
        - Цена товара.
        - Закрытое описание товара (если оно есть).
        - Информацию о наличии файла (если файл есть).
    - Если у товара есть файл, отправляет пользователю файл с текстом сообщения.
    - Иначе отправляет пользователю только текстовое сообщение.
6. **Возвращает пользователю звёзды, если оплата была проведена звёздами**:
    - Проверяет, был ли тип оплаты `stars`.
    - Если да, то использует метод `bot.refund_star_payment` для возврата пользователю звёзд.

Пример использования
-------------------------
```python
from bot.endpoints.bots.telegram.digital_market.bot.user.utils import successful_payment_logic
from bot.endpoints.bots.telegram.digital_market.bot.dao.dao import PurchaseDao, ProductDao
from bot.endpoints.bots.telegram.digital_market.bot.config import settings
from bot.endpoints.bots.telegram.digital_market.bot.user.schemas import PaymentData

# Предположим, что мы уже получили данные о покупке от Telegram 
payment_data = {
    "product_id": 123,
    "price": 10.00,
    "payment_type": "stars",
    "payment_id": "45678901234567890123456789012345",
    "user_id": 1234567890
}

# Создаем объект сессии базы данных
async with AsyncSession(settings.engine) as session:
    # Вызываем функцию successful_payment_logic 
    await successful_payment_logic(session, payment_data, 'RUB', 1234567890, bot)
```