## Как использовать этот блок кода
=========================================================================================

### Описание
-------------------------
Этот фрагмент кода реализует набор обработчиков HTTP-запросов для различных эндпоинтов API. Включает в себя обработку вебхуков Telegram, ответов от платежной системы Робокасса, а также выводит простую HTML-страницу с информацией о сервисе.

### Шаги выполнения
-------------------------
1. **Обработка вебхука Telegram:**
    - Функция `handle_webhook` принимает объект `web.Request` как входной параметр.
    - Извлекает данные из тела запроса в формате JSON и создает объект `Update`.
    - Передает объект `Update` в диспетчер событий `dp` для дальнейшей обработки Telegram ботом.
    - Возвращает HTTP-ответ с кодом 200 (успешно).
    - В случае возникновения ошибки возвращает HTTP-ответ с кодом 500 (ошибка сервера).
2. **Обработка запроса на домашнюю страницу:**
    - Функция `home_page` генерирует HTML-код с приветственным сообщением, описанием сервиса и текущим временем сервера.
    - Возвращает HTTP-ответ с HTML-кодом и типом контента "text/html".
3. **Обработка ответа от Робокассы на ResultURL:**
    - Функция `robokassa_result` принимает объект `web.Request` как входной параметр.
    - Извлекает данные из запроса, включая `SignatureValue`, `OutSum`, `InvId`, `Shp_user_id`, `Shp_user_telegram_id` и `Shp_product_id`.
    - Проверяет подпись запроса, используя функцию `check_signature_result`.
    - Если подпись верна:
        - Записывает информацию о платеже в базу данных, используя функцию `successful_payment_logic`.
        - Возвращает HTTP-ответ с кодом "OK" и идентификатором платежа.
    - Если подпись неверна:
        - Возвращает HTTP-ответ с кодом "bad sign".
4. **Обработка ответа от Робокассы на FailURL:**
    - Функция `robokassa_fail` принимает объект `web.Request` как входной параметр.
    - Извлекает данные о неудачном платеже, включая `InvId` и `OutSum`.
    - Выводит сообщение о неудачном платеже в консоль.
    - Возвращает HTTP-ответ с сообщением "Платеж не удался".

### Пример использования
-------------------------
```python
from aiohttp import web

app = web.Application()
app.add_routes([
    web.post('/webhook', handle_webhook),
    web.get('/', home_page),
    web.post('/robokassa/result', robokassa_result),
    web.get('/robokassa/fail', robokassa_fail),
])

if __name__ == '__main__':
    web.run_app(app, host='127.0.0.1', port=8080)
```

### Заметки
- В коде используются асинхронные функции для обработки HTTP-запросов.
- Функция `check_signature_result` проверяет подпись запроса от Робокассы, используя секретный ключ, хранящийся в файле настроек.
- Функция `successful_payment_logic` обрабатывает успешный платеж, сохраняя информацию в базу данных и уведомляя пользователя в Telegram.
- Для работы этого кода необходимо настроить вебхук Telegram бота, а также иметь подключенную платежную систему Робокасса.