## Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Данный блок кода представляет собой миграцию базы данных, которая добавляет новый столбец `payment_type` в таблицу `purchases` и создает уникальный ключ для столбца `payment_id`.

Шаги выполнения
-------------------------
1. **Добавление столбца `payment_type`:** Функция `upgrade()` добавляет столбец `payment_type` в таблицу `purchases` с типом `sa.String()`, делая его обязательным для заполнения. 
2. **Создание уникального ключа:** Функция `upgrade()` создает уникальный ключ `None` для столбца `payment_id` в таблице `purchases`. 
3. **Удаление изменений (downgrade):** Функция `downgrade()` отменяет изменения, внесенные в `upgrade()`. Сначала она удаляет уникальный ключ `None` для столбца `payment_id` в таблице `purchases`. Затем удаляет столбец `payment_type` из таблицы `purchases`. 


Пример использования
-------------------------

```python
from alembic import op
import sqlalchemy as sa

# ... остальной код ...

def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('purchases', sa.Column('payment_type', sa.String(), nullable=False))
    op.create_unique_constraint(None, 'purchases', ['payment_id'])
    # ### end Alembic commands ###

def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'purchases', type_='unique')
    op.drop_column('purchases', 'payment_type')
    # ### end Alembic commands ###
```

**Важно:** Данный код является частью миграции базы данных и используется для изменения схемы таблицы `purchases`. Не рекомендуется вызывать функции `upgrade()` и `downgrade()` напрямую, за исключением случаев ручного управления миграциями.