### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода представляет собой набор обработчиков для Telegram-бота, предназначенного для цифрового магазина. Он обрабатывает команды `/start`, колбэки для навигации по главному меню, странице "О магазине", просмотру профиля пользователя и истории покупок.

Шаги выполнения
-------------------------
1. **Обработка команды `/start`**:
   - Функция `cmd_start` вызывается, когда пользователь отправляет команду `/start`.
   - Функция извлекает `user_id` из объекта `message`.
   - Функция проверяет, зарегистрирован ли пользователь в базе данных, используя `UserDAO.find_one_or_none`.
   - Если пользователь зарегистрирован, бот приветствует пользователя и отображает главное меню с помощью `main_user_kb`.
   - Если пользователь не зарегистрирован, создается новый пользователь с использованием `UserModel` и добавляется в базу данных через `UserDAO.add`. После этого бот отправляет приветственное сообщение и отображает главное меню.

2. **Обработка колбэка "home"**:
   - Функция `page_home` вызывается, когда пользователь нажимает на кнопку "Домой".
   - Функция отправляет уведомление "Главная страница" и отображает главное меню с помощью `main_user_kb`.

3. **Обработка колбэка "about"**:
   - Функция `page_about` вызывается, когда пользователь нажимает на кнопку "О магазине".
   - Функция отправляет уведомление "О магазине" и отображает информацию о магазине, включая описание, автора и данные для тестовой оплаты.

4. **Обработка колбэка "my_profile"**:
   - Функция `page_about` (обратите внимание на дублирование имени, возможно, это ошибка) вызывается, когда пользователь нажимает на кнопку "Профиль".
   - Функция отправляет уведомление "Профиль".
   - Функция извлекает статистику покупок пользователя из базы данных с помощью `UserDAO.get_purchase_statistics`.
   - Если у пользователя нет покупок, бот отправляет сообщение об отсутствии покупок и предлагает перейти в каталог.
   - Если у пользователя есть покупки, бот отображает информацию о количестве покупок и общей сумме, а также предлагает просмотреть детали покупок.

5. **Обработка колбэка "purchases"**:
   - Функция `page_user_purchases` вызывается, когда пользователь нажимает на кнопку "Мои покупки".
   - Функция отправляет уведомление "Мои покупки".
   - Функция удаляет предыдущее сообщение пользователя.
   - Функция извлекает список покупок пользователя из базы данных с помощью `UserDAO.get_purchased_products`.
   - Если у пользователя нет покупок, бот отправляет сообщение об отсутствии покупок и предлагает перейти в каталог.
   - Если у пользователя есть покупки, бот отправляет информацию о каждой покупке, включая название товара, описание, цену и закрытое описание. Если товар включает файл, бот отправляет файл с описанием.
   - В конце бот отправляет благодарственное сообщение.

Пример использования
-------------------------

```python
from aiogram import Bot, Dispatcher
from aiogram.enums import ParseMode
import asyncio
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker
from user.user_router import user_router  # Подключаем роутер пользователя
from config import Config, load_config
from logger.logger import logger


async def main():
    #  Загрузка конфигурации
    config: Config = load_config()

    # Инициализация базы данных
    engine = create_async_engine(config.db.construct_url(), echo=True)
    async_session_maker = sessionmaker(engine, class_=AsyncSession, expire_on_commit=False)

    # Инициализация бота и диспетчера
    bot = Bot(config.tg_bot.token, parse_mode=ParseMode.HTML)
    dp = Dispatcher()

    # Регистрация роутеров
    dp.include_router(user_router)  # Регистрируем роутер пользователя

    # Запуск процесса опроса (polling)
    try:
        await dp.start_polling(bot, session_maker=async_session_maker)
    finally:
        await bot.session.close()

if __name__ == '__main__':
    try:
        asyncio.run(main())
    except (KeyboardInterrupt, SystemExit):
        logger.info("Bot stopped!")