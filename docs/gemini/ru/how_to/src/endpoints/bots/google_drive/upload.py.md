Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Код загружает указанный файл в Google Drive пользователя. Он проверяет аутентификацию пользователя, создает папку, если она не существует, и загружает файл в указанную папку или в корневую директорию, если папка не указана.

Шаги выполнения
-------------------------
1. **Инициализация**: Функция `upload` принимает имя файла (`filename`), флаг обновления (`update`), контекст (`context`) и имя родительской папки (`parent_folder`) в качестве аргументов.
2. **Аутентификация пользователя**:
   - Извлекает ID пользователя из объекта `update`.
   - Загружает учетные данные пользователя из файла. Если учетные данные отсутствуют или устарели, обновляет их и сохраняет.
   - Авторизуется в Google Drive с использованием полученных учетных данных.
3. **Проверка существования файла**: Проверяет, существует ли указанный файл локально. Если файл не найден, выводит сообщение об ошибке и завершает работу.
4. **Определение родительской папки**:
   - Если `TEAMDRIVE_FOLDER_ID` не указан:
     - Проверяет, указана ли родительская папка.
     - Если родительская папка указана, ищет ее в корневой директории Google Drive. Если папка найдена, использует её ID.
     - Если родительская папка не найдена, создает новую папку с указанным именем и получает её ID.
5. **Формирование параметров файла**: Создает словарь `file_params` с параметрами загружаемого файла, такими как заголовок.
6. **Загрузка файла**:
   - Если `TEAMDRIVE_FOLDER_ID` указан, добавляет информацию о Team Drive в параметры файла.
   - Если родительская папка указана, добавляет её ID в параметры файла.
   - Создает объект файла Google Drive и устанавливает содержимое файла из локального файла.
   - Загружает файл в Google Drive с поддержкой Team Drives.
7. **Установка разрешений**:
   - Если `TEAMDRIVE_FOLDER_ID` не указан, устанавливает разрешение на чтение файла для всех пользователей, имеющих ссылку.
8. **Возврат ссылки**: Возвращает ссылку на загруженный файл.

Пример использования
-------------------------

```python
from src.endpoints.bots.google_drive.upload import upload
from telegram import Update

# Пример использования функции upload
# Предположим, что у вас есть объект update и имя файла для загрузки
filename = 'path/to/your/file.txt'
update = Update(...)  # Здесь должен быть ваш объект Update от Telegram

# Вызов функции upload
try:
    file_link = upload(filename, update, context={}, parent_folder='MyFolder')
    print(f"Файл успешно загружен. Ссылка: {file_link}")
except Exception as e:
    print(f"Ошибка при загрузке файла: {e}")