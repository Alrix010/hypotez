### Как использовать этот блок кода

=========================================================================================

Описание
-------------------------
Этот код представляет собой основной файл `main.py` для веб-приложения "Desktop Assistant", созданного с использованием фреймворка FastAPI. Приложение предоставляет API для обмена сообщениями с использованием модели Google Gemini и поддерживает мультиязычность через JSON-файлы локализации.

Шаги выполнения
-------------------------
1. **Инициализация FastAPI**: Создается экземпляр класса `FastAPI`, который служит основой для веб-приложения.
2. **Настройка CORS**: Добавляется middleware `CORSMiddleware` для разрешения кросс-доменных запросов. Это необходимо для того, чтобы фронтенд мог обращаться к API, работающему на другом домене или порту.
3. **Определение модели данных**: Создается класс `ChatRequest` на основе `BaseModel` из библиотеки Pydantic для валидации входящих запросов к API.
4. **Настройка статических файлов**: Монтируется директория `templates` как статическое содержимое, доступное по пути `/templates`. Здесь хранятся HTML, CSS и JavaScript файлы.
5. **Определение корневого маршрута**: Создается GET-маршрут `/`, который возвращает содержимое файла `index.html` из директории `templates`.
6. **Определение маршрута чата**: Создается POST-маршрут `/api/chat`, который принимает сообщения от пользователя и отправляет их в модель Google Gemini для получения ответа.
7. **Реализация локализации**: Определяется функция `get_locale_file`, которая загружает JSON-файлы локализации на основе указанного языка.
8. **Определение маршрута локализации**: Создается GET-маршрут `/locales/{lang}.json`, который возвращает JSON-файл локализации для указанного языка.
9. **Запуск сервера**: Если скрипт запускается напрямую (а не импортируется как модуль), запускается Uvicorn-сервер на `127.0.0.1` и порту `8000`.

Пример использования
-------------------------

```python
import requests
import json

# URL для отправки запроса чата
chat_url = "http://127.0.0.1:8000/api/chat"

# Пример сообщения для отправки
message = "Привет! Как дела?"

# Формирование данных для отправки в формате JSON
data = {"message": message}
headers = {'Content-type': 'application/json'}

# Отправка POST-запроса
response = requests.post(chat_url, data=json.dumps(data), headers=headers)

# Проверка статуса ответа
if response.status_code == 200:
    # Вывод полученного ответа
    print("Ответ от API:", response.json())
else:
    # Вывод сообщения об ошибке
    print("Ошибка:", response.status_code, response.text)

# URL для запроса файла локализации
locale_url = "http://127.0.0.1:8000/locales/ru.json"

# Отправка GET-запроса
response = requests.get(locale_url)

# Проверка статуса ответа
if response.status_code == 200:
    # Вывод содержимого файла локализации
    print("Содержимое файла локализации:", response.json())
else:
    # Вывод сообщения об ошибке
    print("Ошибка:", response.status_code, response.text)
```