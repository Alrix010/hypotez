## Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Данный блок кода представляет собой класс `CreateImagesProvider`, который позволяет генерировать изображения на основе текстовых запросов. Он обрабатывает запросы на создание изображений, встроенные в текстовое сообщение, и интегрируется с функциями создания изображений, предоставляемыми другими сервисами. 

Шаги выполнения
-------------------------
1. **Инициализация класса:**  Создается экземпляр класса `CreateImagesProvider` с указанием:
    - `provider`: Основной провайдер, который обрабатывает текстовую часть запроса.
    - `create_images`: Функция для создания изображений синхронно.
    - `create_async`: Функция для создания изображений асинхронно.
    - `system_message` (опционально): Текст, который объясняет возможность генерации изображений. По умолчанию - стандартный текст. 
    - `include_placeholder` (опционально): Флаг, который указывает, добавлять ли в результат заполнитель для изображения. По умолчанию - `True`.
2. **Обработка запросов на создание изображений:** При обработке запросов `CreateImagesProvider`  ищет теги `<img>` в текстовом сообщении, которые содержат атрибут `data-prompt`, в котором указан текстовый запрос для генерации изображения.
3. **Создание изображений:**  
    - Если найден тег `<img>` с `data-prompt`, код извлекает запрос и  вызывает функцию `create_images` или `create_images_async` (в зависимости от того, включена ли асинхронная обработка).
    - Результат генерации изображения включается в ответ, а сам тег `<img>` заменяется на ссылку на сгенерированное изображение.
4. **Формирование ответа:** После обработки всех запросов на создание изображений формируется итоговый текст, который содержит текст сгенерированный основным провайдером и ссылки на созданные изображения.

Пример использования
-------------------------

```python
from hypotez.src.endpoints.gpt4free.g4f.providers.create_images import CreateImagesProvider
from hypotez.src.endpoints.gpt4free.g4f.providers.openai import OpenAIProvider

# Предположим, что у нас есть функция create_image, которая генерирует изображения
# синхронно.
def create_image(prompt: str) -> str:
    # Логика для генерации изображения
    return "Ссылка на сгенерированное изображение"

# Создаем экземпляр OpenAIProvider
provider = OpenAIProvider(api_key="YOUR_API_KEY", model="gpt-3.5-turbo")

# Создаем экземпляр CreateImagesProvider с использованием OpenAIProvider
image_provider = CreateImagesProvider(
    provider=provider,
    create_images=create_image,
    create_async=None,  # В данном примере асинхронная обработка не используется
    include_placeholder=False,
)

# Запрос, содержащий текстовый запрос для генерации изображения
messages = [
    {"role": "user", "content": "Нарисуй мне кота, сидящего на диване."},
    {"role": "user", "content": "<img data-prompt=\"Кошка с зелеными глазами\" />"},
    {"role": "user", "content": "Какой у кошки цвет глаз?"},
]

# Выполняем генерацию ответа с обработкой запросов на создание изображений
for chunk in image_provider.create_completion(model="gpt-3.5-turbo", messages=messages):
    print(chunk)

```

В этом примере `CreateImagesProvider` создает ответ, включающий текст от `OpenAIProvider` и ссылку на изображение, сгенерированное по запросу `<img data-prompt="Кошка с зелеными глазами" />`.