### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код представляет собой класс `MagickPen`, который является асинхронным генератором, используемым для взаимодействия с API сервиса MagickPen. Он извлекает учетные данные API, необходимые для аутентификации, и отправляет запросы для генерации текста на основе предоставленных сообщений.

Шаги выполнения
-------------------------
1. **Извлечение учетных данных API**:
   - Функция `fetch_api_credentials` отправляет запрос к JavaScript файлу на сайте `magickpen.com`, чтобы извлечь необходимые секреты и параметры для аутентификации.
   - Используются регулярные выражения (`re.search`) для поиска значений `X-API-Secret` и `secret` в тексте JavaScript файла.
   - Создаются параметры `timestamp`, `nonce` и `signature`, необходимые для запроса к API.
   - Если все необходимые данные успешно извлечены, функция возвращает их в виде кортежа. В противном случае, вызывается исключение.

2. **Создание асинхронного генератора**:
   - Функция `create_async_generator` принимает модель, список сообщений и опциональный прокси-сервер.
   - Вызывается `fetch_api_credentials` для получения учетных данных API.
   - Формируются заголовки (`headers`) для HTTP-запроса, включая полученные учетные данные.
   - Создается полезная нагрузка (`payload`) с запросом (`query`), сформированным из списка сообщений с помощью `format_prompt`.
   - Отправляется POST-запрос к API (`cls.api_endpoint`) с заголовками и полезной нагрузкой.
   - Функция возвращает асинхронный генератор, который итерируется по частям ответа (`chunk`) и возвращает их в декодированном виде.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.Provider.not_working import MagickPen
import asyncio

async def main():
    model = 'gpt-4o-mini'
    messages = [
        {"role": "user", "content": "Напиши небольшое стихотворение о природе."}
    ]

    try:
        generator = await MagickPen.create_async_generator(model=model, messages=messages)
        async for chunk in generator:
            print(chunk, end="")
    except Exception as e:
        print(f"Произошла ошибка: {e}")

if __name__ == "__main__":
    asyncio.run(main())
```