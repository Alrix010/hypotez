### **Как использовать этот блок кода**
=========================================================================================

Описание
-------------------------
Этот код определяет асинхронный провайдер `Aibn` для работы с моделью GPT-3.5 Turbo через API `aibn.cc`. Он включает в себя функции для создания асинхронного генератора ответов на основе входящих сообщений и для генерации подписи запросов.

Шаги выполнения
-------------------------
1. **Импорт необходимых модулей**:
   - `time`: для получения текущего времени в формате timestamp.
   - `hashlib`: для генерации SHA256-хеша, используемого в подписи запроса.
   - `AsyncResult`, `Messages` из `...typing`: для аннотаций типов.
   - `StreamSession` из `...requests`: для асинхронных HTTP-запросов с потоковой передачей.
   - `AsyncGeneratorProvider` из `..base_provider`: базовый класс для асинхронных провайдеров.

2. **Определение класса `Aibn`**:
   - Устанавливаются атрибуты класса:
     - `url` (str): URL API `aibn.cc`.
     - `working` (bool): Флаг, указывающий на работоспособность провайдера (по умолчанию `False`).
     - `supports_message_history` (bool): Флаг поддержки истории сообщений (установлен в `True`).
     - `supports_gpt_35_turbo` (bool): Флаг поддержки модели GPT-3.5 Turbo (установлен в `True`).

3. **Определение асинхронного метода `create_async_generator`**:
   - Этот метод создает асинхронный генератор, который отправляет сообщения в API `aibn.cc` и возвращает чанки ответов.
   - Параметры:
     - `model` (str): Идентификатор модели (не используется в коде, но может быть передан).
     - `messages` (Messages): Список сообщений для отправки.
     - `proxy` (str, optional): Прокси-сервер для использования при подключении. По умолчанию `None`.
     - `timeout` (int, optional): Время ожидания ответа от сервера в секундах. По умолчанию `120`.
     - `**kwargs`: Дополнительные параметры.

4. **Создание сессии `StreamSession`**:
   - Используется `StreamSession` для асинхронного выполнения POST-запроса к API.
   - Настраивается:
     - `impersonate="chrome107"`: имитация браузера Chrome 107.
     - `proxies={"https": proxy}`: использование прокси, если он указан.
     - `timeout=timeout`: установка времени ожидания.

5. **Подготовка данных для запроса**:
   - `timestamp` (int): Текущее время в секундах.
   - `data` (dict): Словарь с данными для отправки в API, включающий:
     - `messages`: Список сообщений.
     - `pass`: Всегда `None`.
     - `sign`: Подпись, сгенерированная функцией `generate_signature`.
     - `time`: Текущий timestamp.

6. **Отправка POST-запроса и обработка ответа**:
   - Отправляется POST-запрос к `f"{cls.url}/api/generate"` с данными в формате JSON.
   - Проверяется статус ответа (`response.raise_for_status()`).
   - Асинхронно итерируются чанки содержимого ответа (`response.iter_content()`).
   - Декодируются и возвращаются чанки как часть асинхронного генератора.

7. **Определение функции `generate_signature`**:
   - Генерирует SHA256-хеш на основе timestamp, сообщения и секрета (по умолчанию "undefined").
   - Параметры:
     - `timestamp` (int): Timestamp.
     - `message` (str): Сообщение.
     - `secret` (str, optional): Секретный ключ. По умолчанию "undefined".

Пример использования
-------------------------

```python
import asyncio
from src.endpoints.gpt4free.g4f.Provider.deprecated.Aibn import Aibn

async def main():
    messages = [{"role": "user", "content": "Привет, как дела?"}]
    
    async for chunk in Aibn.create_async_generator(model="gpt-3.5-turbo", messages=messages):
        print(chunk, end="")

if __name__ == "__main__":
    asyncio.run(main())