Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код представляет собой асинхронный генератор, используемый для взаимодействия с моделью Qwen Qwen-2.5 через API. Он отправляет запросы к API и обрабатывает ответы, чтобы извлечь сгенерированный текст. Поддерживает потоковую передачу данных, системные сообщения и имеет возможность работать через прокси.

Шаги выполнения
-------------------------
1. **Генерация уникального идентификатора сессии**: Функция `generate_session_hash` создает уникальный идентификатор сессии, который используется для отслеживания взаимодействия с API.
2. **Подготовка заголовков**: Определяются заголовки для HTTP-запросов, включая `User-Agent`, `Accept`, `Referer` и другие, необходимые для взаимодействия с API.
3. **Формирование системного промпта**: Извлекаются системные сообщения из списка сообщений и объединяются в системный промпт, который устанавливает контекст для модели. Если системные сообщения отсутствуют, используется промпт по умолчанию.
4. **Формирование запроса**: Создается полезная нагрузка (payload) для запроса, которая включает промпт пользователя, системный промпт и другие параметры, необходимые для API.
5. **Отправка запроса на соединение**: Отправляется POST-запрос к API для установления соединения и получения идентификатора события.
6. **Подготовка запроса на получение данных**: Формируются URL и заголовки для запроса на получение потоковых данных.
7. **Отправка запроса на получение данных**: Отправляется GET-запрос к API для получения потоковых данных.
8. **Обработка потоковых данных**: Полученные данные построчно декодируются и обрабатываются. Из каждой строки извлекаются JSON-данные, содержащие сгенерированный текст.
9. **Извлечение и передача фрагментов текста**: Из JSON-данных извлекаются фрагменты текста, которые передаются вызывающей стороне с помощью `yield`.
10. **Проверка завершения**: Проверяется, содержит ли сообщение информацию о завершении генерации. Если генерация завершена, извлекается и возвращается итоговый текст.
11. **Обработка ошибок JSON**: В случае ошибки при декодировании JSON-данных, она регистрируется в лог.

Пример использования
-------------------------

```python
import asyncio
from src.endpoints.gpt4free.g4f.Provider.hf_space.Qwen_Qwen_2_5 import Qwen_Qwen_2_5

async def main():
    messages = [
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "What is the capital of France?"}
    ]

    async for fragment in Qwen_Qwen_2_5.create_async_generator(
        model="qwen-2.5",
        messages=messages
    ):
        print(fragment, end="")

if __name__ == "__main__":
    asyncio.run(main())
```