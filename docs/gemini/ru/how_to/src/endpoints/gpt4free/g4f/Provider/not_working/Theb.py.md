### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `Theb`, который является провайдером для работы с языковыми моделями TheB.AI. Он использует Selenium WebDriver для взаимодействия с веб-интерфейсом TheB.AI, отправляет запросы и получает ответы от модели.

Шаги выполнения
-------------------------
1. **Инициализация**:
   - Определяются метаданные провайдера, такие как `label`, `url`, `working` и `supports_stream`.
   - Указывается, что данный провайдер поддерживает стриминг ответов.
   - Определяется словарь `models`, содержащий соответствия между короткими именами моделей и их полными именами на TheB.AI.

2. **`create_completion`**:
   - Функция `create_completion` принимает параметры: `model` (имя модели), `messages` (список сообщений для формирования запроса), `stream` (флаг стриминга) и другие параметры, такие как `proxy`, `webdriver` и `virtual_display`.
   - Если имя модели есть в словаре `models`, оно заменяется на полное имя модели.
   - Формируется промпт из списка сообщений с использованием функции `format_prompt`.
   - Создается сессия WebDriver с использованием класса `WebDriverSession`, который управляет экземпляром браузера.

3. **Взаимодействие с веб-интерфейсом**:
   - Внутри блока `with web_session as driver:` происходит взаимодействие с браузером:
     - Регистрируется JavaScript-хук для перехвата fetch-запросов к API `/api/conversation`.
     - Скрипт перехватывает ответы и извлекает из них контент, отправляемый моделью.
     - Открывается страница TheB.AI (`f"{cls.url}/home"`).
     - Выполняется ожидание загрузки элемента textarea с `ID = "textareaAutosize"`.
     - Обрабатываются возможные оверлеи (всплывающие окна), которые могут мешать взаимодействию.
     - Если указана модель, выбирается соответствующая модель в веб-интерфейсе.
     - В поле textarea вводится сформированный промпт.

4. **Чтение ответа**:
   - Используется JavaScript для чтения ответа от сервера через `window._reader`.
   - Извлекаются данные из каждого чанка ответа, которые имеют формат `data: {"args":{"content": "..."}}`.
   - Извлеченный контент возвращается как часть генератора.

5. **Генерация чанков ответа**:
   - Цикл `while True:` читает чанки ответа из JavaScript.
   - Если чанк получен, он возвращается через `yield chunk`.
   - Если чанк пустой (`""`), цикл завершается.
   - Если чанк не получен, происходит ожидание в течение 0.1 секунды.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.Provider.not_working.Theb import Theb
from src.webdirver import Driver, Chrome, Firefox, Playwright

# Пример использования провайдера Theb для получения ответа от модели GPT-3.5 Turbo
messages = [
    {"role": "user", "content": "Привет, как дела?"}
]

# Инициализация драйвера для Firefox
driver = Driver(Firefox)
# Получение ответа в режиме стриминга
for chunk in Theb.create_completion(
    model="gpt-3.5-turbo",
    messages=messages,
    stream=True,
    webdriver=driver.instance  # Передаем экземпляр драйвера
):
    print(chunk, end="")