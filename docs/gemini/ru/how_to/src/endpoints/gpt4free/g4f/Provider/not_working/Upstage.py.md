### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `Upstage`, который является асинхронным провайдером для работы с API Upstage AI для генерации текста. Он позволяет отправлять запросы к API Upstage AI и получать сгенерированный текст в асинхронном режиме. Код также включает в себя выбор модели и форматирование запроса.

Шаги выполнения
-------------------------
1. **Импорт необходимых модулей**:
   - Импортируются модули `aiohttp` для выполнения асинхронных HTTP-запросов, `json` для работы с JSON-данными.
   - Импортируются классы и типы из других модулей проекта, такие как `AsyncResult`, `Messages`, `AsyncGeneratorProvider`, `ProviderModelMixin` и `format_prompt`.

2. **Определение класса `Upstage`**:
   - Класс `Upstage` наследуется от `AsyncGeneratorProvider` и `ProviderModelMixin`, что позволяет ему использовать функциональность асинхронного генератора и миксина для моделей.
   - Определяются атрибуты класса:
     - `url`: URL главной страницы Upstage AI.
     - `api_endpoint`: URL API для отправки запросов на генерацию текста.
     - `working`: Флаг, указывающий, работает ли провайдер (в данном случае `False`).
     - `default_model`: Модель, используемая по умолчанию (`solar-pro`).
     - `models`: Список поддерживаемых моделей.
     - `model_aliases`: Словарь с псевдонимами моделей.

3. **Метод `get_model`**:
   - Этот метод выбирает модель для использования. Если указанная модель есть в списке поддерживаемых моделей или в псевдонимах, она возвращается. В противном случае возвращается модель по умолчанию.

4. **Метод `create_async_generator`**:
   - Этот асинхронный метод создает асинхронный генератор для получения текста от API Upstage AI.
   - Принимает параметры:
     - `model`: Модель для использования.
     - `messages`: Список сообщений для отправки в API.
     - `proxy`: Прокси-сервер для использования (если необходимо).
     - `kwargs`: Дополнительные параметры.
   - Выполняет следующие действия:
     - Выбирает модель с помощью метода `get_model`.
     - Формирует заголовки запроса (`headers`), включая User-Agent, Content-Type и другие необходимые параметры.
     - Создает асинхронную сессию `aiohttp` с заданными заголовками.
     - Формирует данные запроса (`data`) в формате JSON, включая сообщения и модель.
     - Отправляет POST-запрос к API Upstage AI с использованием асинхронной сессии.
     - Обрабатывает ответ от API:
       - Читает ответ построчно.
       - Если строка начинается с "data: " и не равна "data: [DONE]", пытается извлечь содержимое из JSON-данных.
       - Извлеченное содержимое передается через `yield`, что делает метод генератором.
       - Если строка равна "data: [DONE]", завершает чтение ответа.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.Provider.not_working.Upstage import Upstage
from src.endpoints.gpt4free.g4f.typing import Messages
import asyncio

async def main():
    messages: Messages = [{"role": "user", "content": "Напиши короткий рассказ о космосе."}]
    model = "solar-pro"  # Или другая поддерживаемая модель
    async for content in Upstage.create_async_generator(model=model, messages=messages):
        print(content, end="")

if __name__ == "__main__":
    asyncio.run(main())