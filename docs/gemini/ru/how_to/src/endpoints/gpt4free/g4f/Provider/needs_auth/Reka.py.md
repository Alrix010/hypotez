Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код реализует взаимодействие с API Reka для создания текстовых завершений и загрузки изображений. Он включает в себя функции для получения токена доступа, отправки запросов на завершение текста и загрузки изображений для использования в разговоре.

Шаги выполнения
-------------------------
1. **Инициализация**: Класс `Reka` наследуется от `AbstractProvider` и определяет основные параметры, такие как домен, URL, необходимость аутентификации и поддержку потоковой передачи.
2. **Создание завершения**: Функция `create_completion` отправляет запрос к API Reka для создания текстового завершения на основе предоставленных сообщений и изображения (если есть).
3. **Аутентификация**: Если `api_key` не предоставлен, функция пытается получить его из cookies. Если cookies отсутствуют или не содержат `appSession`, возникает исключение.
4. **Подготовка данных**: Формируется структура данных `conversation`, содержащая сообщения для отправки в API. Если предоставлено изображение, оно загружается, и URL изображения добавляется в структуру данных.
5. **Отправка запроса**: Отправляется POST-запрос к API Reka с использованием библиотеки `requests`. Запрос включает в себя заголовки, cookies и данные в формате JSON.
6. **Обработка ответа**: Ответ от API обрабатывается построчно, извлекаются данные о завершении текста и возвращаются как генератор токенов.
7. **Загрузка изображения**: Функция `upload_image` загружает изображение на сервер Reka и возвращает URL загруженного изображения.
8. **Получение токена доступа**: Функция `get_access_token` получает токен доступа из API Reka, используя cookies. Если получение токена не удается, возникает исключение.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.Provider.needs_auth import Reka
from src.endpoints.gpt4free.g4f.typing import Messages, ImageType

# Пример использования create_completion
messages: Messages = [{"role": "user", "content": "Напиши короткое стихотворение о весне."}]
stream = True
api_key = "YOUR_API_KEY"  # Замените на ваш реальный API ключ

try:
    completion = Reka.create_completion(
        model="reka-core",
        messages=messages,
        stream=stream,
        api_key=api_key
    )
    if completion:
        for token in completion:
            print(token, end="")
    else:
        print("Не удалось получить завершение.")
except ValueError as e:
    print(f"Ошибка: {e}")

# Пример использования upload_image
image: ImageType = b"PNG image data"  # Замените на ваши реальные данные изображения
try:
    image_url = Reka.upload_image(Reka, api_key, image)
    print(f"URL изображения: {image_url}")
except Exception as e:
    print(f"Ошибка при загрузке изображения: {e}")

# Пример использования get_access_token
try:
    access_token = Reka.get_access_token(Reka)
    print(f"Токен доступа: {access_token}")
except ValueError as e:
    print(f"Ошибка при получении токена доступа: {e}")