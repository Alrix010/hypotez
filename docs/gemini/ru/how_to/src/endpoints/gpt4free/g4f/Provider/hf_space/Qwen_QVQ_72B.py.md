### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код реализует асинхронный генератор для взаимодействия с моделью Qwen QVQ-72B, размещенной на платформе Hugging Face Space. Он позволяет отправлять текстовые запросы и изображения, а также получать ответы от модели в асинхронном режиме.

Шаги выполнения
-------------------------
1. **Импорт необходимых модулей**: Импортируются модули `json`, `aiohttp`, `FormData`, а также классы и типы из локальных модулей `typing`, `requests`, `errors`, `base_provider`, `helper` и `image`.
2. **Определение класса `Qwen_QVQ_72B`**: Класс наследуется от `AsyncGeneratorProvider` и `ProviderModelMixin` и определяет атрибуты, специфичные для модели Qwen QVQ-72B, включая URL, endpoint API, флаг рабочего состояния, имя модели по умолчанию и алиасы моделей.
3. **Метод `create_async_generator`**: Этот метод является асинхронным генератором, который принимает модель, сообщения, медиафайлы, API-ключ и прокси в качестве аргументов.
4. **Настройка заголовков**: Создаются заголовки запроса, включая `Accept: application/json` и, если предоставлен, заголовок авторизации с API-ключом.
5. **Создание асинхронной сессии**: Используется `ClientSession` из `aiohttp` для выполнения HTTP-запросов.
6. **Обработка медиафайлов (изображений)**:
    - Если предоставлены медиафайлы, они преобразуются в байты и добавляются в `FormData`.
    - Файл отправляется на endpoint `/gradio_api/upload` для загрузки.
    - После успешной загрузки из ответа извлекается путь к изображению.
7. **Формирование данных запроса**: Данные запроса формируются в виде словаря, содержащего либо путь к изображению, либо `None`, а также отформатированный промпт сообщения.
8. **Отправка запроса к модели**: Асинхронный POST-запрос отправляется на endpoint `cls.api_endpoint` с данными запроса.
9. **Обработка ответа от модели**:
    - Извлекается `event_id` из JSON-ответа.
    - Асинхронный GET-запрос отправляется на endpoint `cls.api_endpoint/{event_id}` для получения событий от модели.
    - Полученные чанки данных обрабатываются для извлечения текста ответа.
    - Если событие равно "error", выбрасывается исключение `ResponseError`.
    - Если событие равно "generating", извлекается текст из данных и возвращается с помощью `yield`.
    - Если событие равно "complete", обработка завершается.
10. **Обработка ошибок**: В случае ошибок при декодировании JSON или других ошибок времени выполнения, выбрасывается исключение `RuntimeError`.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.Provider.hf_space.Qwen_QVQ_72B import Qwen_QVQ_72B
from src.endpoints.gpt4free.g4f.typing import Messages, MediaListType
import asyncio

async def main():
    model = "qwen-qvq-72b-preview"
    messages: Messages = [{"role": "user", "content": "Translate to french: Hello, world!"}]
    media: MediaListType = None
    api_key = None
    proxy = None

    async for chunk in Qwen_QVQ_72B.create_async_generator(model, messages, media, api_key, proxy):
        print(chunk, end="")

if __name__ == "__main__":
    asyncio.run(main())