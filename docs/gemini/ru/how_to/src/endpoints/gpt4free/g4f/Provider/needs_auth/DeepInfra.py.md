### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода определяет класс `DeepInfra`, который является адаптером для взаимодействия с API DeepInfra. Он позволяет получать список доступных моделей, генерировать текст и изображения на основе этих моделей. Класс использует асинхронные запросы для обеспечения неблокирующего взаимодействия с API.

Шаги выполнения
-------------------------
1. **Инициализация класса**:
   - Класс `DeepInfra` наследуется от `OpenaiTemplate` и определяет основные атрибуты, такие как URL, базовый URL API, флаг необходимости авторизации и модели по умолчанию.

2. **Получение списка моделей**:
   - Метод `get_models` выполняет HTTP-запрос к API DeepInfra для получения списка доступных моделей.
   - Список моделей разделяется на текстовые и графические модели.
   - Результаты кэшируются в атрибутах класса `models` и `image_models`.

3. **Получение списка графических моделей**:
   - Метод `get_image_models` возвращает список графических моделей, полученных с помощью `get_models`.

4. **Создание асинхронного генератора**:
   - Метод `create_async_generator` создает асинхронный генератор для получения текстовых или графических данных.
   - Если запрошена графическая модель, вызывается метод `create_async_image`.
   - Для текстовых моделей формируются заголовки запроса и используется родительский метод `create_async_generator` для отправки запроса.

5. **Создание асинхронного изображения**:
   - Метод `create_async_image` отправляет запрос к API DeepInfra для генерации изображения на основе заданного промпта и модели.
   - Формируются заголовки запроса, включая авторизационный токен, если он предоставлен.
   - Выполняется POST-запрос к API с использованием `StreamSession`.
   - Полученный ответ преобразуется в объект `ImageResponse` и возвращается.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.Provider.needs_auth.DeepInfra import DeepInfra
from src.typing import Messages

async def main():
    # Пример использования DeepInfra для генерации текста
    messages: Messages = [{"role": "user", "content": "Напиши короткий стих о весне."}]
    model = DeepInfra.default_model
    async for chunk in DeepInfra.create_async_generator(model=model, messages=messages, stream=True):
        print(chunk, end="")

    # Пример использования DeepInfra для генерации изображения
    # Для этого потребуется передать ключ API и выбрать графическую модель
    # prompt = "A futuristic cityscape at sunset"
    # model = "stabilityai/sd3.5"  # или другая графическая модель из DeepInfra.get_image_models()
    # api_key = "YOUR_API_KEY"
    # image_response = await DeepInfra.create_async_image(prompt=prompt, model=model, api_key=api_key)
    # print(f"Image URL: {image_response.images}")

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())