Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет асинхронный провайдер `Ylokh` для взаимодействия с API `chat.ylokh.xyz`. Он позволяет отправлять запросы к модели GPT и получать ответы в режиме потоковой передачи или полным блоком.

Шаги выполнения
-------------------------
1. **Импорт необходимых модулей**:
   - Импортируются модули `json`, `StreamSession`, `AsyncGeneratorProvider` и `AsyncResult`.

2. **Определение класса `Ylokh`**:
   - Класс `Ylokh` наследуется от `AsyncGeneratorProvider` и представляет собой асинхронный провайдер для работы с API `chat.ylokh.xyz`.
   - Указываются основные атрибуты класса:
     - `url`: URL сервиса (`https://chat.ylokh.xyz`).
     - `working`: Статус работоспособности провайдера (по умолчанию `False`).
     - `supports_message_history`: Поддержка истории сообщений (установлено в `True`).
     - `supports_gpt_35_turbo`: Поддержка модели `gpt-3.5-turbo` (установлено в `True`).

3. **Метод `create_async_generator`**:
   - Это асинхронный классовый метод, который отправляет запрос к API и возвращает асинхронный генератор для потоковой передачи ответов.
   - **Аргументы**:
     - `model` (str): Название модели (`gpt-3.5-turbo` по умолчанию).
     - `messages` (Messages): Список сообщений для отправки в API.
     - `stream` (bool): Флаг потоковой передачи (по умолчанию `True`).
     - `proxy` (str): Прокси-сервер для использования (по умолчанию `None`).
     - `timeout` (int): Время ожидания запроса (по умолчанию `120`).
     - `kwargs`: Дополнительные аргументы для передачи в API.
   - **Шаги**:
     1. Определяются заголовки запроса (`headers`), включающие `Origin` и `Referer`.
     2. Формируются данные запроса (`data`) с использованием переданных аргументов и настроек.
     3. Используется `StreamSession` для отправки асинхронного POST-запроса к API (`https://chatapi.ylokh.xyz/v1/chat/completions`).
     4. Обрабатывается ответ в зависимости от режима потоковой передачи (`stream`):
        - Если `stream` равен `True`:
          - Читаются строки ответа (`response.iter_lines()`).
          - Декодируются строки.
          - Если строка начинается с `data: `, извлекается JSON-содержимое.
          - Если строка содержит `data: [DONE]`, цикл завершается.
          - Извлекается содержимое сообщения (`content`) из JSON и возвращается через `yield`.
        - Если `stream` равен `False`:
          - Получается JSON-ответ (`response.json()`).
          - Извлекается содержимое сообщения (`content`) из JSON и возвращается через `yield`.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.Provider.deprecated import Ylokh

async def main():
    messages = [
        {"role": "user", "content": "Привет, как дела?"}
    ]
    async for message in Ylokh.create_async_generator(model="gpt-3.5-turbo", messages=messages):
        print(message, end="")

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())