### Как использовать блок кода `get_streaming`
=========================================================================================

Описание
-------------------------
Функция `get_streaming` предназначена для организации процесса чтения и обработки файлов из указанной директории (bucket). Она выполняет скачивание файлов по URL, извлечение текста из различных форматов файлов, кэширование и, при необходимости, улучшение текста с использованием библиотеки `spacy`. Функция поддерживает потоковую передачу данных и отправку событий о процессе обработки.

Шаги выполнения
-------------------------
1. **Подготовка директории**:
   - Функция принимает путь к директории (`bucket_dir`) и создает ее, если она не существует. Используется `Path` для работы с путями.

2. **Запуск процесса чтения и скачивания URL**:
   - Вызывается функция `read_and_download_urls` для скачивания файлов, указанных в файле `downloads.json` в директории `bucket_dir`.
   - Если `event_stream` установлен в `True`, функция отправляет события о процессе скачивания.

3. **Запуск потоковой обработки файлов**:
   - Вызывается функция `stream_chunks` для обработки файлов, находящихся в директории `bucket_dir`.
   - В зависимости от значения `refine_chunks_with_spacy`, функция выполняет улучшение текста с использованием `spacy` или просто читает файлы и кэширует их.
   - Если `event_stream` установлен в `True`, функция отправляет события о процессе обработки.

4. **Обработка исключений**:
   - В случае возникновения исключений в процессе обработки, функция отправляет событие об ошибке, если `event_stream` установлен в `True`, и перебрасывает исключение.

Пример использования
-------------------------

```python
from src.endpoints.gpt4free.g4f.tools.files import get_streaming
from pathlib import Path
import os
import json

# Определяем директорию для bucket
bucket_dir = "test_bucket"

# Создаем файл downloads.json с URL для скачивания
downloads_data = [
    {"urls": ["https://www.example.com/example.txt"]}
]
os.makedirs(bucket_dir, exist_ok=True)
with open(os.path.join(bucket_dir, "downloads.json"), "w") as f:
    json.dump(downloads_data, f)

# Запускаем потоковую обработку с скачиванием, без улучшения и с отправкой событий
try:
    for event in get_streaming(bucket_dir, delete_files=True, refine_chunks_with_spacy=False, event_stream=True):
        print(event)  # Вывод событий о процессе обработки
except Exception as e:
    print(f"Error: {e}")
finally:
    # Удаляем тестовую директорию после завершения
    import shutil
    shutil.rmtree(bucket_dir)