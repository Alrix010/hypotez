### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код реализует асинхронное взаимодействие с API Perplexity Labs для получения ответов на основе предоставленных сообщений. Он устанавливает соединение через WebSocket, отправляет запросы и обрабатывает ответы, возвращая результаты в виде асинхронного генератора.

Шаги выполнения
-------------------------
1. **Инициализация**:
   - Определяются URL для API (`API_URL`) и WebSocket (`WS_URL`).
   - Класс `PerplexityLabs` наследуется от `AsyncGeneratorProvider` и `ProviderModelMixin`, предоставляя функциональность асинхронного генератора.
   - Указываются поддерживаемые модели (`models`) и модель по умолчанию (`default_model`).

2. **Создание асинхронного генератора (`create_async_generator`)**:
   - Формируются заголовки (`headers`) для HTTP-запросов, включая `Origin` и `Referer`.
   - Создается асинхронная сессия (`StreamSession`) с использованием указанных заголовков и прокси (если указан).
   - Получается идентификатор сессии (`sid`) путем выполнения GET-запроса к API.

3. **Установка WebSocket-соединения**:
   - Выполняется POST-запрос для аутентификации с использованием JWT.
   - Устанавливается WebSocket-соединение с использованием полученного `sid`.
   - Выполняется обмен probe-сообщениями для установки соединения.

4. **Отправка запроса и получение ответа**:
   - Формируется JSON-сообщение (`message_data`) с версией, источником, моделью и сообщениями.
   - Отправляется сообщение через WebSocket.

5. **Обработка сообщений**:
   - В цикле принимаются сообщения из WebSocket.
   - Если получено сообщение "2", отправляется сообщение "3" в ответ.
   - Извлекаются данные из JSON-сообщения и возвращаются как часть асинхронного генератора.
   - Если получен флаг `final`, возвращаются цитаты (если есть) и сигнал `FinishReason("stop")` для завершения генератора.

6. **Обработка ошибок**:
   - В случае ошибки при обработке сообщения выбрасывается исключение `ResponseError`.

Пример использования
-------------------------

```python
from typing import AsyncGenerator
from src.endpoints.gpt4free.g4f.Provider.PerplexityLabs import PerplexityLabs
from src.endpoints.gpt4free.g4f.typing import Messages

async def main():
    messages: Messages = [
        {"role": "user", "content": "Tell me a joke"}
    ]
    model = "r1-1776"
    
    generator: AsyncGenerator = PerplexityLabs.create_async_generator(
        model=model,
        messages=messages
    )
    
    async for message in generator:
        print(message)

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())
```