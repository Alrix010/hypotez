### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `Anthropic`, который предоставляет интерфейс для взаимодействия с API Anthropic для генерации текста. Класс поддерживает как потоковую, так и непотоковую генерацию текста, работу с изображениями, системными сообщениями и инструментами. Он также включает методы для получения списка доступных моделей и формирования заголовков запросов.

Шаги выполнения
-------------------------
1. **Инициализация класса**:
   - Класс `Anthropic` наследуется от класса `OpenaiAPI`.
   - Определяются основные атрибуты класса, такие как `label`, `url`, `api_base`, `needs_auth`, `supports_stream` и `default_model`.
   - Задаются поддерживаемые модели и их псевдонимы.

2. **Получение списка моделей**:
   - Метод `get_models` отправляет GET-запрос к API Anthropic для получения списка доступных моделей.
   - Извлекает идентификаторы моделей из полученных данных и сохраняет их в атрибуте `models` класса.

3. **Создание асинхронного генератора**:
   - Метод `create_async_generator` является асинхронным и создает генератор для получения текста от API Anthropic.
   - Проверяет наличие `api_key` и вызывает исключение `MissingAuthError`, если ключ отсутствует.
   - Обрабатывает медиафайлы (изображения), кодирует их в base64 и добавляет в сообщение.
   - Формирует системное сообщение, если оно присутствует, и удаляет его из списка сообщений.
   - Отправляет POST-запрос к API Anthropic с необходимыми данными, включая сообщения, модель, температуру и другие параметры.
   - Обрабатывает потоковый и непотоковый ответы от API.
   - В случае потокового ответа извлекает данные из каждого чанка и генерирует текст, `FinishReason` или `Usage`.
   - В случае непотокового ответа извлекает текст из полученных данных и генерирует его.

4. **Формирование заголовков запроса**:
   - Метод `get_headers` формирует заголовки запроса, включая `Accept`, `Content-Type`, `x-api-key` и `anthropic-version`.
   - Заголовки зависят от того, используется ли потоковый режим и передан ли `api_key`.

Пример использования
-------------------------

```python
from g4f.Provider.needs_auth import Anthropic
from g4f.typing import Messages

# Замените на ваш фактический API-ключ
api_key = "YOUR_API_KEY"

# Пример сообщений для отправки
messages: Messages = [
    {"role": "user", "content": "Расскажи мне о Python."},
]

async def main():
    # Создание асинхронного генератора
    generator = await Anthropic.create_async_generator(
        model="claude-3-opus-latest",
        messages=messages,
        api_key=api_key,
        stream=True,
    )

    # Асинхронный перебор генератора и вывод текста
    async for item in generator:
        print(item, end="", flush=True)

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())