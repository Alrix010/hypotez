### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код определяет класс `ChatGptt`, который является асинхронным провайдером для работы с API chatgptt.me. Он использует `aiohttp` для выполнения асинхронных HTTP-запросов и предназначен для генерации текста на основе предоставленных сообщений. Код выполняет аутентификацию путем извлечения токенов из HTML-страницы и отправляет запросы с этими токенами для получения потокового ответа.

Шаги выполнения
-------------------------
1. **Инициализация**: Определяется класс `ChatGptt`, наследующийся от `AsyncGeneratorProvider` и `ProviderModelMixin`. Устанавливаются основные параметры, такие как URL, API endpoint, поддержка потоковой передачи, системных сообщений и истории сообщений.
2. **Получение модели**: Метод `create_async_generator` принимает модель, сообщения и прокси (опционально). Вызывается `cls.get_model(model)` для получения нужной модели.
3. **Подготовка заголовков**: Формируются HTTP-заголовки, необходимые для запроса к API, включая `authority`, `accept`, `origin`, `referer` и `user-agent`.
4. **Создание асинхронной сессии**: Создается асинхронная сессия `ClientSession` с заданными заголовками.
5. **Получение начального содержимого страницы**: Выполняется GET-запрос к `cls.url` для получения HTML-содержимого страницы.
6. **Извлечение токенов**:
   - Из HTML-кода извлекаются значения `nonce` и `post_id` с помощью регулярных выражений.
   - Проверяется, найдены ли оба токена, и, если нет, выбрасывается исключение `RuntimeError`.
7. **Подготовка полезной нагрузки (payload)**:
   - Формируется словарь `payload` с данными, необходимыми для запроса, включая `_wpnonce`, `post_id`, `url`, `action`, `message` (сформированное из входных сообщений), `bot_id`, `chatbot_identity`, `wpaicg_chat_client_id` (случайный идентификатор) и `wpaicg_chat_history`.
8. **Отправка POST-запроса и потоковая обработка ответа**:
   - Выполняется POST-запрос к `cls.api_endpoint` с заголовками, полезной нагрузкой и прокси (если указан).
   - Проверяется статус ответа и выбрасывается исключение в случае ошибки.
   - Из JSON-ответа извлекается поле `data`, которое передается как часть потока.
9. **Генерация результата**: Результат (`result['data']`) передается через `yield`, что позволяет асинхронно генерировать данные по мере их получения.

Пример использования
-------------------------

```python
import asyncio
from src.endpoints.gpt4free.g4f.Provider.not_working.ChatGptt import ChatGptt

async def main():
    messages = [
        {"role": "user", "content": "Привет, как дела?"}
    ]
    
    try:
        async for response in ChatGptt.create_async_generator(model="gpt-4", messages=messages):
            print(response)
    except Exception as e:
        print(f"Произошла ошибка: {e}")

if __name__ == "__main__":
    asyncio.run(main())