### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот код демонстрирует асинхронное взаимодействие с моделью GPT-4 через библиотеку `g4f`. Он отправляет сообщение пользователем и получает ответ в режиме потока, отображая каждый полученный фрагмент текста и аккумулируя полный ответ.

Шаги выполнения
-------------------------
1. **Импорт необходимых модулей**: Импортируются `asyncio` для асинхронного выполнения и `AsyncClient` из библиотеки `g4f.client` для взаимодействия с GPT-4.
2. **Создание асинхронной функции `main()`**: Определяется асинхронная функция `main()`, которая будет содержать основную логику.
3. **Инициализация асинхронного клиента**: Создается экземпляр `AsyncClient()` для отправки запросов к модели GPT-4.
4. **Создание потока ответов**: Используется метод `client.chat.completions.create()` для отправки запроса к модели.
   - `model="gpt-4"`: Указывается используемая модель (GPT-4).
   - `messages=[{"role": "user", "content": "Say hello there!"}]`: Определяется сообщение пользователя, которое будет отправлено модели.
   - `stream=True`: Указывается, что ответ должен быть получен в режиме потока.
5. **Обработка потока ответов**: Асинхронно перебираются фрагменты (chunks) из потока `stream`.
   - Извлекается содержимое из каждого фрагмента `chunk.choices[0].delta.content`.
   - Содержимое добавляется к переменной `accumulated_text`.
   - Каждый фрагмент выводится в консоль.
6. **Обработка ошибок**: Блок `try...except` используется для перехвата возможных исключений. В случае ошибки выводится сообщение об ошибке.
7. **Вывод накопленного текста**: В блоке `finally` выводится полный накопленный текст, полученный от модели.
8. **Запуск асинхронной функции**: Используется `asyncio.run(main())` для запуска асинхронной функции `main()`.

Пример использования
-------------------------

```python
import asyncio
from g4f.client import AsyncClient

async def main():
    client = AsyncClient()
    
    stream = client.chat.completions.create(
        model="gpt-4",
        messages=[{"role": "user", "content": "Say hello there!"}],
        stream=True,
    )
    
    accumulated_text = ""
    try:
        async for chunk in stream:
            if chunk.choices and chunk.choices[0].delta.content:
                content = chunk.choices[0].delta.content
                accumulated_text += content
                print(content, end="", flush=True)
    except Exception as e:
        print(f"\nError occurred: {e}")
    finally:
        print("\n\nFinal accumulated text:", accumulated_text)

asyncio.run(main())