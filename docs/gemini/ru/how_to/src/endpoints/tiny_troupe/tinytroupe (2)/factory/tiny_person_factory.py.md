### Как использовать этот блок кода

Описание
-------------------------
Этот блок кода определяет класс `TinyPersonFactory`, который используется для создания экземпляров класса `TinyPerson` (виртуальных личностей) с использованием OpenAI LLM (большой языковой модели). `TinyPersonFactory` принимает контекст, на основе которого генерируются описания личностей. Фабрика также следит за тем, чтобы не создавать повторяющихся личностей.

Шаги выполнения
-------------------------
1. **Инициализация `TinyPersonFactory`**:
   - При создании экземпляра `TinyPersonFactory` передается `context_text` (текст, описывающий контекст для генерации личностей) и опционально `simulation_id` (идентификатор симуляции).
   - Устанавливается путь к шаблону промпта для генерации личностей (`person_prompt_template_path`).
   - Инициализируются списки `generated_minibios` и `generated_names` для отслеживания сгенерированных личностей, чтобы избежать повторений.

2. **Генерация нескольких фабрик `TinyPersonFactory`**:
   - Метод `generate_person_factories` генерирует список экземпляров `TinyPersonFactory` на основе заданного количества и общего контекста.
   - Считывается системный промпт из файла (`prompts/generate_person_factory.md`).
   - Формируется пользовательский промпт с использованием шаблонизатора `chevron`, который включает количество фабрик и общий контекст.
   - Отправляется запрос в OpenAI LLM для генерации описаний фабрик личностей.
   - Извлекаются JSON-описания из ответа LLM и создаются экземпляры `TinyPersonFactory` с этими описаниями.

3. **Генерация личности `TinyPerson`**:
   - Метод `generate_person` генерирует экземпляр `TinyPerson` на основе контекста фабрики и дополнительных параметров.
   - Считываются примеры спецификаций агентов из файлов (`Friedrich_Wolf.agent.json` и `Sophie_Lefevre.agent.json`).
   - Формируется промпт с использованием шаблонизатора `chevron`, который включает контекст, особенности агента, примеры и списки уже сгенерированных мини-биографий и имен.
   - Вызывается вспомогательная функция `aux_generate` для отправки запроса в OpenAI LLM и получения спецификации личности.
   - Проверяется уникальность имени сгенерированной личности.
   - Создается экземпляр `TinyPerson` с использованием полученной спецификации и добавляется в списки сгенерированных личностей.

4. **Вспомогательный метод `aux_generate`**:
   - Отправляет запрос в OpenAI LLM с сформированным промптом.
   - Извлекает JSON-описание личности из ответа LLM.
   - Проверяет, не было ли уже сгенерировано такое имя.
   - Возвращает спецификацию личности, если имя уникально.

5. **Генерация нескольких личностей `TinyPerson`**:
   - Метод `generate_people` генерирует список экземпляров `TinyPerson` на основе заданного количества и дополнительных параметров.
   - Вызывает метод `generate_person` для каждой личности и добавляет ее в список.

6. **Вспомогательный метод `_aux_model_call`**:
    -  Отправляет запросы в OpenAI LLM, используя параметры, такие как температура, штрафы за частоту и присутствие.
    -  Этот метод предназначен для кэширования ответов модели.

7. **Вспомогательный метод `_setup_agent`**:
    -  Настраивает агента с необходимой конфигурацией, включая определения персонажа.

Пример использования
-------------------------

```python
    from tinytroupe.factory.tiny_person_factory import TinyPersonFactory

    # Пример использования TinyPersonFactory
    context_text = "Действие происходит в маленьком городке, где все друг друга знают."
    factory = TinyPersonFactory(context_text)

    # Генерация одной личности
    person = factory.generate_person(agent_particularities="Любит читать книги по истории.")
    if person:
        print(f"Сгенерирована личность: {person.get('name')}, {person.minibio()}")

    # Генерация нескольких личностей
    people = factory.generate_people(number_of_people=2, agent_particularities="Один любит играть в шахматы, другой - в гольф.")
    if people:
        print("Сгенерированы следующие личности:")
        for p in people:
            print(f"- {p.get('name')}, {p.minibio()}")

    # Генерация нескольких фабрик
    factories = TinyPersonFactory.generate_person_factories(number_of_factories=2, generic_context_text="test context")
    if factories:
        print("Сгенерированы следующие фабрики:")
        for f in factories:
            print(f"- {f.context_text}")
```