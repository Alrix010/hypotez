### **Как использовать этот блок кода**

=========================================================================================

Описание
-------------------------
Этот код обеспечивает взаимодействие с Google Bard для генерации текста на основе предоставленных сообщений. Он использует cookies для аутентификации, формирует запрос к API Bard и возвращает сгенерированный текст.

Шаги выполнения
-------------------------
1. **Аутентификация**:
   - Извлекает cookie `__Secure-1PSID` из браузера Chrome для аутентификации в Google Bard.
   - Формирует заголовок `cookie` для HTTP-запросов.

2. **Форматирование сообщений**:
   - Преобразует список сообщений в строку, где каждое сообщение имеет формат `роль: содержимое`.
   - Создает запрос `prompt`, который включает в себя все сообщения и указание на ожидаемый ответ от ассистента.

3. **Настройка HTTP-клиента**:
   - Создает сессию `requests.Session()` для выполнения HTTP-запросов.
   - Если указан `proxy`, настраивает прокси-сервер для HTTP и HTTPS запросов.
   - Устанавливает необходимые заголовки, такие как `authority`, `content-type`, `origin`, `referer`, `user-agent` и `cookie`.

4. **Получение токена `SNlM0e`**:
   - Извлекает токен `SNlM0e` из HTML-кода главной страницы Google Bard. Этот токен необходим для выполнения запросов.

5. **Формирование параметров запроса**:
   - Создает параметры `params` для запроса, включая `bl`, `_reqid` (случайное число) и `rt`.

6. **Формирование данных запроса**:
   - Создает данные `data` для запроса, включающие токен `at` (SNlM0e) и отформатированный запрос `f.req`.

7. **Выполнение POST-запроса к API Bard**:
   - Отправляет POST-запрос к API Bard (`https://bard.google.com/_/BardChatUi/data/{intents}/StreamGenerate`) с использованием сформированных данных и параметров.

8. **Обработка ответа**:
   - Извлекает данные чата из ответа, разделяя его на строки и загружая JSON.
   - Извлекает сгенерированный текст из JSON и возвращает его.

9. **Обработка ошибок**:
   - Если данные чата отсутствуют, возвращает сообщение об ошибке (`'error'`).

Пример использования
-------------------------

```python
from g4f.Provider import Bard

messages = [
    {'role': 'user', 'content': 'Напиши небольшое стихотворение о весне'},
]

# Укажите ваш прокси, если необходимо
proxy = 'логин:пароль@ip:port'  # Замените на ваши учетные данные прокси

for response in Bard._create_completion(model='Palm2', messages=messages, stream=False, proxy=proxy):
    print(response)
```