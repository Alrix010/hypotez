## Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода реализует провайдер для генерации текста с помощью Bing AI. 
Он взаимодействует с API Bing Chat через WebSockets для получения ответов от модели GPT-4. 

Шаги выполнения
-------------------------
1. **Инициализация**: 
    - Загружаются необходимые библиотеки, такие как `requests`, `aiohttp` и `asyncio`.
    - Определяются классы `optionsSets` и `Defaults`, содержащие конфигурационные данные для взаимодействия с API Bing Chat. 
    - Определяется функция `_format`, которая форматирует сообщения в JSON-формат с использованием разделителя `Defaults.delimiter`.

2. **Создание диалога**:
    - Функция `create_conversation` асинхронно создает диалог с Bing AI, отправляя запрос на `https://www.bing.com/turing/conversation/create`.
    - Функция возвращает идентификатор диалога (`conversationId`), идентификатор клиента (`clientId`) и подпись диалога (`conversationSignature`).

3. **Потоковая генерация текста**:
    - Функция `stream_generate` асинхронно генерирует текст по заданному запросу.
    - Функция принимает три параметра: 
        - `prompt`:  текст запроса.
        - `mode`:  набор параметров, которые определяют поведение модели, например, `optionsSets.jailbreak` для режима, который позволяет модели отвечать свободнее.
        - `context`:  дополнительный контекст для запроса.
    - Функция подключается к WebSockets сервера Bing Chat и отправляет сообщения с запросом.
    - Функция получает ответы от модели и возвращает их в виде потока текста, используя генератор `yield`.

4. **Запуск генератора**:
    - Функция `run` запускает асинхронный генератор `stream_generate` и возвращает поток текста, используя генератор `yield`.

5. **Преобразование сообщений**:
    - Функция `convert` преобразует список сообщений в формат, пригодный для использования в качестве контекста для запроса.

6. **Создание завершения**:
    - Функция `_create_completion` создает завершение текста, используя функцию `stream_generate` и конвертирует сообщения в контекст.
    - Функция использует генератор `yield` для возврата текста по частям, обеспечивая поддержку потоковой передачи.

Пример использования
-------------------------

```python
from g4f.Provider.Providers.Bing import _create_completion

messages = [
    {'role': 'user', 'content': 'Привет! Расскажи мне о себе.'}
]

for token in _create_completion(model='gpt-4', messages=messages, stream=True):
    print(token, end='')
```