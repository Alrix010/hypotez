Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Данный блок кода отвечает за взаимодействие с API deepai.org для получения ответов на запросы в формате чата. Он включает в себя функции для создания ключа API, формирования запроса и обработки потоковых ответов.

Шаги выполнения
-------------------------
1. **Определение функции `md5(text: str) -> str`**:
   - Принимает строку `text` в качестве аргумента.
   - Кодирует строку в байты, вычисляет её MD5-хеш и преобразует его в шестнадцатеричный формат.
   - Инвертирует полученную строку и возвращает её.

2. **Определение функции `get_api_key(user_agent: str) -> str`**:
   - Принимает строку `user_agent` в качестве аргумента.
   - Генерирует случайное число `part1` в диапазоне от 0 до 10^11.
   - Вычисляет `part2` как MD5-хеш от конкатенации `user_agent` и нескольких MD5-хешей `user_agent` и `part1`.
   - Формирует и возвращает ключ API в формате `"tryit-{part1}-{part2}"`.

3. **Определение функции `_create_completion(model: str, messages: list, stream: bool, **kwargs)`**:
   - Принимает следующие аргументы:
     - `model` (str): Идентификатор используемой модели.
     - `messages` (list): Список сообщений в формате чата.
     - `stream` (bool): Флаг, указывающий на необходимость потоковой передачи данных.
     - `**kwargs`: Дополнительные параметры.
   - Определяет `user_agent` для заголовка запроса.
   - Формирует заголовки `headers`, включающие сгенерированный `api-key` и `user-agent`.
   - Формирует данные `files` для отправки в запросе, включая стиль чата и историю сообщений.
   - Выполняет POST-запрос к API `https://api.deepai.org/chat_response` с указанными заголовками и данными, с включенным режимом потоковой передачи данных.
   - Итерируется по чанкам ответа, декодирует их и передает через `yield`.

4. **Определение переменной `params`**:
   - Формирует строку с информацией о поддерживаемых типах данных для функции `_create_completion`.
   - Использует `os.path.basename(__file__)[:-3]` для получения имени текущего файла без расширения `.py`.
   - Использует `get_type_hints` для получения аннотаций типов аргументов функции `_create_completion`.

Пример использования
-------------------------

```python
import asyncio

async def main():
    messages = [
        {"role": "user", "content": "Hello, how are you?"}
    ]
    
    async for chunk in _create_completion(model="gpt-3.5-turbo", messages=messages, stream=True):
        print(chunk, end="")

if __name__ == "__main__":
    asyncio.run(main())
```