### **Инструкции по использованию кода `src/utils/file.py`**

=========================================================================================

Этот модуль предоставляет набор утилит для выполнения операций с файлами, таких как сохранение, чтение и получение списков файлов. Поддерживает обработку больших файлов с использованием генераторов для экономии памяти.

#### **1. Функция `save_text_file`**

Описание
-------------------------
Функция `save_text_file` сохраняет данные в текстовый файл. Данные могут быть строкой, списком строк или словарем.

Шаги выполнения
-------------------------
1. Функция принимает путь к файлу (`file_path`), данные (`data`) и режим записи (`mode`).
2. Создает родительские директории, если они не существуют.
3. Открывает файл в указанном режиме (`'w'` для записи, `'a'` для добавления) с кодировкой UTF-8.
4. Если данные - список строк, записывает каждую строку в файл с символом новой строки.
5. Если данные - словарь, записывает словарь в файл в формате JSON с отступами.
6. Если данные - строка, записывает строку в файл.
7. Возвращает `True`, если файл успешно сохранен, `False` в противном случае.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import save_text_file

file_path = Path('example.txt')
data = 'Пример текста'
result = save_text_file(file_path, data)
print(result)  # Вывод: True
```

#### **2. Функция `read_text_file_generator`**

Описание
-------------------------
Функция `read_text_file_generator` читает содержимое файла(ов) или директории с использованием генератора для экономии памяти.

Шаги выполнения
-------------------------
1. Функция принимает путь к файлу или директории (`file_path`), флаг `as_list`, список расширений `extensions`, размер чанка `chunk_size`, флаг рекурсивного поиска `recursive` и шаблоны `patterns`.
2. Проверяет, является ли путь файлом или директорией.
3. Если путь - файл и `as_list` is True, возвращает генератор строк.
4. Если путь - файл и `as_list` is False, возвращает строку.
5. Если путь - директория и `recursive` is True, выполняет рекурсивный поиск файлов, соответствующих шаблонам, и возвращает генератор строк или объединенную строку.
6. Если путь - директория и `recursive` is False, читает файлы в текущей директории и возвращает генератор строк или объединенную строку.
7. Возвращает `None` в случае ошибки.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import read_text_file_generator

file_path = Path('example.txt')
content = read_text_file_generator(file_path)
if content:
    print(f'File content: {next(content)[:100]}...')
```

#### **3. Функция `read_text_file`**

Описание
-------------------------
Функция `read_text_file` читает содержимое файла и возвращает его в виде строки или списка строк.

Шаги выполнения
-------------------------
1. Функция принимает путь к файлу или директории (`file_path`), флаг `as_list`, список расширений `extensions` и флаг `exc_info`.
2. Проверяет, является ли путь файлом или директорией.
3. Если путь - файл, открывает файл в режиме чтения с кодировкой UTF-8, читает содержимое, заменяет множественные пробелы на одинарные и экранирует двойные кавычки.
4. Если `as_list` is True, возвращает содержимое в виде списка строк, иначе возвращает строку.
5. Если путь - директория, рекурсивно читает файлы, соответствующие расширениям, и возвращает список строк или объединенную строку.
6. Возвращает `None` в случае ошибки.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import read_text_file

file_path = Path('example.txt')
content = read_text_file(file_path)
if content:
    print(f'File content: {content[:100]}...')
```

#### **4. Функция `yield_text_from_files`**

Описание
-------------------------
Функция `yield_text_from_files` читает содержимое файла и возвращает его в виде генератора строк или одной строки.

Шаги выполнения
-------------------------
1. Функция принимает путь к файлу (`file_path`), флаг `as_list` и размер чанка `chunk_size`.
2. Проверяет, является ли путь файлом.
3. Если путь - файл и `as_list` is True, возвращает генератор строк.
4. Если путь - файл и `as_list` is False, возвращает строку.
5. Возвращает `None` в случае ошибки.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import yield_text_from_files

file_path = Path('example.txt')
for line in yield_text_from_files(file_path, as_list=True):
    print(line)
```

#### **5. Функция `_read_file_content`**

Описание
-------------------------
Функция `_read_file_content` читает содержимое файла по чанкам и возвращает как строку.

Шаги выполнения
-------------------------
1. Функция принимает путь к файлу (`file_path`) и размер чанка (`chunk_size`).
2. Открывает файл в режиме чтения с кодировкой UTF-8.
3. Читает файл по чанкам и объединяет содержимое в строку.
4. Заменяет множественные пробелы на одинарные и экранирует двойные кавычки.
5. Возвращает содержимое файла в виде строки.

#### **6. Функция `_read_file_lines_generator`**

Описание
-------------------------
Функция `_read_file_lines_generator` читает файл по строкам с помощью генератора.

Шаги выполнения
-------------------------
1. Функция принимает путь к файлу (`file_path`) и размер чанка (`chunk_size`).
2. Открывает файл в режиме чтения с кодировкой UTF-8.
3. Читает файл по чанкам, разделяет чанк на строки и возвращает каждую строку с помощью генератора.
4. Заменяет множественные пробелы на одинарные и экранирует двойные кавычки в каждой строке.

#### **7. Функция `get_filenames_from_directory`**

Описание
-------------------------
Функция `get_filenames_from_directory` возвращает список имен файлов в директории, опционально отфильтрованных по расширению.

Шаги выполнения
-------------------------
1. Функция принимает путь к директории (`directory`) и расширение (`ext`).
2. Проверяет, является ли путь директорией.
3. Если `ext` - строка, преобразует ее в список.
4. Получает список имен файлов, соответствующих расширениям.
5. Возвращает список имен файлов.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import get_filenames_from_directory

directory = Path('.')
filenames = get_filenames_from_directory(directory, ['.txt', '.md'])
print(filenames)  # Вывод: ['example.txt', 'readme.md']
```

#### **8. Функция `recursively_yield_file_path`**

Описание
-------------------------
Функция `recursively_yield_file_path` рекурсивно возвращает пути ко всем файлам, соответствующим заданным шаблонам, в указанной директории.

Шаги выполнения
-------------------------
1. Функция принимает корневую директорию (`root_dir`) и шаблоны (`patterns`).
2. Преобразует шаблоны в список, если они представлены строкой.
3. Рекурсивно обходит директорию и возвращает пути ко всем файлам, соответствующим шаблонам, с помощью генератора.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import recursively_yield_file_path

root_dir = Path('.')
for path in recursively_yield_file_path(root_dir, ['*.txt', '*.md']):
    print(path)
```

#### **9. Функция `recursively_get_file_path`**

Описание
-------------------------
Функция `recursively_get_file_path` рекурсивно возвращает список путей ко всем файлам, соответствующим заданным шаблонам, в указанной директории.

Шаги выполнения
-------------------------
1. Функция принимает корневую директорию (`root_dir`) и шаблоны (`patterns`).
2. Преобразует шаблоны в список, если они представлены строкой.
3. Рекурсивно обходит директорию и возвращает список путей ко всем файлам, соответствующим шаблонам.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import recursively_get_file_path

root_dir = Path('.')
paths = recursively_get_file_path(root_dir, ['*.txt', '*.md'])
print(paths)  # Вывод: [Path('./example.txt'), Path('./readme.md')]
```

#### **10. Функция `recursively_read_text_files`**

Описание
-------------------------
Функция `recursively_read_text_files` рекурсивно читает текстовые файлы из указанной корневой директории, соответствующие заданным шаблонам.

Шаги выполнения
-------------------------
1. Функция принимает корневую директорию (`root_dir`), шаблоны (`patterns`) и флаг `as_list`.
2. Проверяет, является ли корневая директория директорией.
3. Преобразует шаблоны в список, если они представлены строкой.
4. Рекурсивно обходит директорию, находит файлы, соответствующие шаблонам, и читает их содержимое.
5. Если `as_list` is True, возвращает список строк, иначе возвращает список содержимого файлов.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import recursively_read_text_files

root_dir = Path('.')
contents = recursively_read_text_files(root_dir, ['*.txt', '*.md'], as_list=True)
for line in contents:
    print(line)
```

#### **11. Функция `get_directory_names`**

Описание
-------------------------
Функция `get_directory_names` возвращает список имен директорий из указанной директории.

Шаги выполнения
-------------------------
1. Функция принимает путь к директории (`directory`).
2. Получает список имен директорий в указанной директории.
3. Возвращает список имен директорий.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import get_directory_names

directory = Path('.')
directory_names = get_directory_names(directory)
print(directory_names)  # Вывод: ['dir1', 'dir2']
```

#### **12. Функция `remove_bom`**

Описание
-------------------------
Функция `remove_bom` удаляет BOM из текстового файла или из всех файлов Python в директории.

Шаги выполнения
-------------------------
1. Функция принимает путь к файлу или директории (`path`).
2. Проверяет, является ли путь файлом или директорией.
3. Если путь - файл, открывает файл в режиме чтения и записи с кодировкой UTF-8, удаляет BOM, записывает содержимое обратно в файл и обрезает файл до нового размера.
4. Если путь - директория, обходит все файлы Python в директории и удаляет BOM из каждого файла.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.file import remove_bom

file_path = Path('example.txt')
with open(file_path, 'w', encoding='utf-8') as f:
    f.write('\ufeffПример текста с BOM')
remove_bom(file_path)
with open(file_path, 'r', encoding='utf-8') as f:
    print(f.read())  # Вывод: Пример текста с BOM
```