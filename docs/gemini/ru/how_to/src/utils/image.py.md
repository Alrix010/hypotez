### Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода предоставляет набор инструментов для работы с изображениями, включая загрузку, сохранение, изменение размера, добавление водяных знаков и преобразование форматов. Он включает функции для асинхронной обработки изображений, что позволяет эффективно выполнять операции с изображениями, не блокируя основной поток выполнения.

Шаги выполнения
-------------------------
1. **Загрузка изображения из URL:**
   - Функция `save_image_from_url_async` используется для асинхронной загрузки изображения по указанному URL и сохранения его в файл.
   - Функция выполняет HTTP-запрос к указанному URL, извлекает данные изображения из ответа и сохраняет их в файл.

2. **Сохранение изображения:**
   - Функции `save_image` и `save_image_async` используются для сохранения данных изображения в файл в указанном формате.
   - Функция создает каталог, если он не существует, и записывает данные изображения в файл, используя либо синхронную, либо асинхронную запись файлов.

3. **Получение данных изображения:**
   - Функция `get_image_bytes` используется для чтения изображения из файла и возврата его байтов в формате JPEG.
   - Функция открывает изображение с помощью PIL, сохраняет его в формате JPEG в буфер BytesIO и возвращает либо объект BytesIO, либо байты.

4. **Получение необработанных данных изображения:**
   - Функция `get_raw_image_data` используется для получения необработанных двоичных данных из файла изображения.
   - Функция считывает байты из файла и возвращает их.

5. **Поиск случайного изображения:**
   - Функция `random_image` используется для рекурсивного поиска случайного изображения в указанном каталоге.
   - Функция сканирует каталог и его подкаталоги на наличие файлов изображений с указанными расширениями и возвращает путь к случайно выбранному изображению.

6. **Добавление текстового водяного знака:**
   - Функция `add_text_watermark` используется для добавления текстового водяного знака к изображению.
   - Функция открывает изображение, создает прозрачный слой для водяного знака, рисует текст на этом слое и объединяет его с исходным изображением.

7. **Добавление водяного знака изображения:**
   - Функция `add_image_watermark` используется для добавления водяного знака изображения к изображению.
   - Функция открывает исходное изображение и изображение водяного знака, изменяет размер водяного знака, определяет положение для размещения водяного знака и объединяет два изображения.

8. **Изменение размера изображения:**
   - Функция `resize_image` используется для изменения размера изображения до указанных размеров.
   - Функция открывает изображение, изменяет его размер и сохраняет измененное изображение в файл.

9. **Преобразование изображения:**
   - Функция `convert_image` используется для преобразования изображения в указанный формат.
   - Функция открывает изображение, сохраняет его в указанном формате и сохраняет преобразованное изображение в файл.

10. **Обработка изображений с водяным знаком:**
    - Функция `process_images_with_watermark` используется для обработки всех изображений в указанной папке, добавляя водяной знак и сохраняя их в папке "output".
    - Функция выполняет итерацию по каждому файлу в папке, проверяет, является ли файл изображением, и добавляет водяной знак к изображению.

Пример использования
-------------------------

```python
from pathlib import Path
from src.utils.image import (
    save_image_from_url_async,
    add_text_watermark,
    resize_image,
    convert_image,
    add_image_watermark,
    process_images_with_watermark,
    random_image
)
import asyncio


async def main():
    # Загрузка изображения из URL
    image_url = "https://www.easygifanimator.net/images/samples/video-to-gif-sample.gif"
    filename = "downloaded_image.gif"
    await save_image_from_url_async(image_url, filename)

    # Добавление текстового водяного знака
    image_path = "downloaded_image.gif"
    watermark_text = "Sample Watermark"
    output_path = "watermarked_image.gif"
    add_text_watermark(image_path, watermark_text, output_path)

    # Изменение размера изображения
    image_path = "watermarked_image.gif"
    size = (500, 500)
    output_path = "resized_image.gif"
    resize_image(image_path, size, output_path)

    # Преобразование изображения
    image_path = "resized_image.gif"
    format = "PNG"
    output_path = "converted_image.png"
    convert_image(image_path, format, output_path)

    # Добавление водяного знака изображения
    input_image_path = Path("converted_image.png")
    watermark_image_path = Path("watermark.png")  # Замените фактическим путем к изображению водяного знака
    output_image_path = Path("watermarked_with_image.png")
    add_image_watermark(input_image_path, watermark_image_path, output_image_path)

    # Обработка изображений с водяным знаком
    folder_path = Path("images")  # Замените фактическим путем к папке изображений
    watermark_path = Path("watermark.png")  # Замените фактическим путем к изображению водяного знака
    process_images_with_watermark(folder_path, watermark_path)

    # Поиск случайного изображения
    root_path = "images"  # Замените фактическим путем к папке изображений
    random_image_path = random_image(root_path)
    if random_image_path:
        print(f"Случайное изображение найдено: {random_image_path}")


if __name__ == "__main__":
    asyncio.run(main())