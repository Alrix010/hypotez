## Как использовать этот блок кода
=========================================================================================

Описание
-------------------------
Этот блок кода предоставляет две функции для работы с файлами Excel:

1. **`read_xls_as_dict`**: читает файл Excel и преобразует его в формат JSON. Функция поддерживает обработку множества листов, а также позволяет выбрать один конкретный лист для преобразования. Результат можно сохранить в файл JSON.
2. **`save_xls_file`**: сохраняет данные в формате JSON в файл Excel. Данные должны быть представлены в виде словаря, где ключи - имена листов, а значения - списки словарей, представляющих строки в листе.

Шаги выполнения
-------------------------
1. **Импорт необходимых модулей**: 
    -  `pandas` используется для работы с файлами Excel.
    -  `json` используется для преобразования данных в формат JSON.
    -  `Path` из `pathlib` позволяет работать с путями к файлам.
    -  `logging` используется для записи сообщений о работе функции.

2. **Настройка логирования**:
    -  `logging.basicConfig` настраивает базовый уровень логирования и формат вывода сообщений.

3. **Функция `read_xls_as_dict`**:
    -  Принимает путь к файлу Excel (`xls_file`), опционально путь к файлу JSON (`json_file`) и имя листа (`sheet_name`).
    -  Проверяет, существует ли файл Excel.
    -  Если файл найден, считывает его с помощью `pd.ExcelFile`.
    -  Если `sheet_name` не указан, функция обрабатывает все листы в файле Excel, создавая словарь `data_dict`, где ключи - имена листов, а значения - списки словарей, представляющих строки в каждом листе.
    -  Если `sheet_name` указан, функция считывает только указанный лист и создает словарь `data_dict` с данными из этого листа.
    -  Если `json_file` указан, функция сохраняет полученный словарь `data_dict` в файл JSON с помощью `json.dump`.
    -  Возвращает `data_dict` или `False` в случае ошибки.

4. **Функция `save_xls_file`**:
    -  Принимает словарь `data` (структура, описанная выше) и путь к файлу Excel (`file_path`).
    -  Сохраняет данные в файл Excel с помощью `pd.ExcelWriter` и `to_excel` для каждого листа в `data`.
    -  Возвращает `True` в случае успешного сохранения или `False` в случае ошибки.


Пример использования
-------------------------

```python
# Чтение файла Excel и сохранение в JSON
data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')  # Читает лист 'Sheet1'
if data:
    print(data)  # Output will be {'Sheet1': [{...}]}

# Сохранение данных в формате JSON в файл Excel
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Successfully saved to output.xlsx")
```