### **Как использовать этот блок кода**
=========================================================================================

Описание
-------------------------
Класс `GSRender` предназначен для стилизации Google таблиц. Он предоставляет методы для форматирования заголовков, объединения ячеек, установки направления текста и записи данных в таблицу. Класс использует библиотеки `gspread`, `gspread_formatting` для взаимодействия с Google Sheets API.

Шаги выполнения
-------------------------
1. **Инициализация класса `GSRender`**:
   - Создается экземпляр класса `GSRender`. В конструкторе пока не происходит никаких действий, но предполагается, что в будущем здесь может быть загрузка схем рендеринга из JSON.

2. **Метод `render_header`**:
   - Принимает объект `Worksheet`, заголовок таблицы (`world_title`), диапазон ячеек (`range`) и тип объединения (`merge_type`).
   - Задает цвет фона и текста, выравнивание и другие параметры форматирования для указанного диапазона ячеек.
   - Устанавливает высоту строки.
   - Применяет форматирование к диапазону ячеек и объединяет их.

3. **Метод `merge_range`**:
   - Принимает объект `Worksheet`, диапазон ячеек (`range`) и тип объединения (`merge_type`).
   - Объединяет ячейки в указанном диапазоне в соответствии с выбранным типом объединения.

4. **Метод `set_worksheet_direction`**:
   - Принимает объект `Spreadsheet`, объект `Worksheet` и направление текста (`direction`).
   - Устанавливает направление текста для указанного листа (справа налево или слева направо).

5. **Метод `header`**:
   - Принимает объект `Worksheet`, заголовок (`ws_header`) и номер строки (`row`).
   - Определяет номер строки для записи заголовка (если не указан, использует первую пустую строку).
   - Записывает заголовок в указанную строку и применяет к нему форматирование с помощью метода `render_header`.

6. **Метод `write_category_title`**:
   - Принимает объект `Worksheet`, заголовок категории (`ws_category_title`) и номер строки (`row`).
   - Записывает заголовок категории в указанную строку и объединяет ячейки для него.

7. **Метод `get_first_empty_row`**:
   - Принимает объект `Worksheet` и номер колонки (`by_col`).
   - Определяет первую пустую строку в указанной колонке или во всем листе.

Пример использования
-------------------------

```python
from src import gs
from src.goog.spreadsheet.bberyakov.grender import GSRender
from gspread import service_account

# Укажите путь к вашему JSON-файлу с учетными данными
gc = service_account(filename='path/to/your/credentials.json')

# Откройте таблицу по ее ID
spreadsheet_id = 'your_spreadsheet_id'
sh = gc.open_by_key(spreadsheet_id)

# Выберите лист
worksheet = sh.sheet1

# Создайте экземпляр класса GSRender
renderer = GSRender()

# Пример использования методов
renderer.set_worksheet_direction(sh, worksheet, 'rtl')
renderer.render_header(worksheet, 'Заголовок таблицы', 'A1:Z1')
renderer.merge_range(worksheet, 'A2:B2', 'MERGE_ALL')
renderer.header(worksheet, ['Заголовок 1', 'Заголовок 2', 'Заголовок 3'], row=3)
renderer.write_category_title(worksheet, 'Категория', row=4)

# Получение первой пустой строки
first_empty_row = renderer.get_first_empty_row(worksheet)
print(f"Первая пустая строка: {first_empty_row}")