# Модуль для взаимодействия с OpenAI API

## Обзор

Этот модуль предоставляет функции для взаимодействия с OpenAI API. Он позволяет использовать различные модели OpenAI, такие как GPT-3, GPT-4, и другие, для задач, связанных с обработкой текста, генерацией кода, переводом и т.д.

## Подробности

Модуль предоставляет функции для отправки запросов к OpenAI API, обработки ответов и вывода результатов. Он также включает в себя методы для настройки параметров запросов, таких как выбор модели, языка, температурности и т.д.

## Классы

### `class OpenAIInterface`

**Описание**: Класс для работы с OpenAI API, предоставляющий основные функции для отправки запросов, обработки ответов и настройки параметров запросов.
**Наследуется**:  от `object`
**Атрибуты**:
    - `api_key` (str): Ключ API для доступа к OpenAI API.
    - `model` (str): Имя используемой модели OpenAI.
    - `temperature` (float): Параметр температурности, определяющий случайность ответов модели.
    - `max_tokens` (int): Максимальное количество токенов в ответе.
    - `top_p` (float): Вероятность выбора токенов для генерации ответа.

**Методы**:
    - `send_request(self, prompt: str) -> dict`: Отправка запроса к OpenAI API с предоставленным текстом.
        **Параметры**:
            - `prompt` (str): Текст запроса.
        **Возвращает**:
            - `dict`: Словарь, содержащий ответ модели.
        **Исключения**:
            - `Exception`: Возникает при ошибке отправки запроса или получения ответа.
    - `process_response(self, response: dict) -> str`: Обработка ответа модели OpenAI.
        **Параметры**:
            - `response` (dict): Ответ модели OpenAI.
        **Возвращает**:
            - `str`: Обработанный текст ответа модели.
        **Исключения**:
            - `Exception`: Возникает при ошибке обработки ответа.

## Функции

### `function get_completion(text: str, model: str = 'text-davinci-003', temperature: float = 0.7, max_tokens: int = 1024, top_p: float = 1.0, frequency_penalty: float = 0.0, presence_penalty: float = 0.0) -> str`

**Цель**: Функция генерирует текст на основе заданного текста, используя модель OpenAI.
**Параметры**:
    - `text` (str): Текст для генерации ответа.
    - `model` (str): Имя модели OpenAI. По умолчанию `text-davinci-003`.
    - `temperature` (float): Параметр температурности, определяющий случайность ответа модели. По умолчанию `0.7`.
    - `max_tokens` (int): Максимальное количество токенов в ответе. По умолчанию `1024`.
    - `top_p` (float): Вероятность выбора токенов для генерации ответа. По умолчанию `1.0`.
    - `frequency_penalty` (float): Штраф за повторение слов в ответе. По умолчанию `0.0`.
    - `presence_penalty` (float): Штраф за включение новых слов в ответе. По умолчанию `0.0`.

**Возвращает**:
    - `str`: Сгенерированный текст.

**Исключения**:
    - `Exception`: Возникает при ошибке отправки запроса или получения ответа.

**Пример**:

```python
text = "Сегодня хорошая погода. Я люблю гулять в парке."
response = get_completion(text, model='text-davinci-003')
print(response)
```

## Примеры

```python
from src.ai.openai import OpenAIInterface, get_completion

# Создание экземпляра класса OpenAIInterface
openai = OpenAIInterface(api_key='YOUR_API_KEY', model='text-davinci-003')

# Отправка запроса к OpenAI API
prompt = "Напишите стихотворение про кошку."
response = openai.send_request(prompt)

# Обработка ответа модели OpenAI
processed_response = openai.process_response(response)

# Вывод обработанного текста
print(processed_response)

# Использование функции get_completion
response = get_completion(text='Напишите стихотворение про собаку', model='text-davinci-003')
print(response)

```

##  Работа функции

Функция `get_completion` использует класс `OpenAIInterface` для отправки запроса к OpenAI API. Она передает заданный текст в качестве запроса, а также устанавливает необходимые параметры, такие как имя модели, температурность и т.д. 

Функция `get_completion` обрабатывает ответ модели OpenAI, извлекая сгенерированный текст и возвращая его в качестве результата.

## Дополнительные сведения

###  Примеры вызова функции `get_completion` с различными параметрами

```python
#  Пример 1: Генерация текста с использованием стандартных параметров модели
response = get_completion(text='Напишите историю про маленького кота', model='text-davinci-003')

#  Пример 2: Генерация текста с увеличением температурности для большей случайности
response = get_completion(text='Напишите историю про маленького кота', model='text-davinci-003', temperature=0.9)

#  Пример 3: Генерация текста с ограничением максимального количества токенов
response = get_completion(text='Напишите историю про маленького кота', model='text-davinci-003', max_tokens=50)

#  Пример 4: Генерация текста с использованием другой модели OpenAI
response = get_completion(text='Напишите историю про маленького кота', model='text-curie-001')
```

## Параметры в деталях

- `api_key` (str): Ключ API для доступа к OpenAI API. Получить его можно на [сайте OpenAI](https://platform.openai.com/account/api-keys).
- `model` (str): Имя модели OpenAI, которую вы хотите использовать. Доступные модели можно найти на [сайте OpenAI](https://platform.openai.com/docs/models).
- `temperature` (float): Параметр температурности, который определяет случайность ответа модели. Чем выше значение температурности, тем более неожиданные и креативные ответы вы будете получать.
- `max_tokens` (int): Максимальное количество токенов, которые может содержать ответ модели.
- `top_p` (float): Вероятность выбора токенов для генерации ответа. Чем выше значение, тем больше вероятность того, что модель будет использовать самые вероятные токены.
- `frequency_penalty` (float): Штраф за повторение слов в ответе. Чем выше значение, тем меньше модель будет повторять слова в ответе.
- `presence_penalty` (float): Штраф за включение новых слов в ответе. Чем выше значение, тем меньше модель будет использовать новые слова в ответе.