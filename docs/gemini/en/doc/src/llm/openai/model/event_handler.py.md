# Module for Handling OpenAI Assistant Events

## Overview

This module defines a custom `EventHandler` class that handles events from the OpenAI Assistant API's response stream. The class inherits from `openai.AssistantEventHandler` and implements methods to process different types of events, such as text creation, text deltas, tool calls, and tool call deltas.

## Details

The `EventHandler` class is used to customize the way OpenAI Assistant responses are displayed in the console. It enables real-time streaming of responses and provides clear formatting for different types of events.

## Classes

### `EventHandler`

**Description**: This class handles events from the OpenAI Assistant API's response stream. It provides customized logic for processing text, text deltas, tool calls, and tool call deltas.

**Inherits**: `openai.AssistantEventHandler`

**Methods**:

- `on_text_created(text: Text) -> None`: This method is called when a new text message is created in the response stream. It prints the assistant's message to the console with a prefix indicating the source.

- `on_text_delta(delta: TextDelta, snapshot: Text) -> None`: This method is called when a text delta is received. It updates the displayed text with the changes specified in the delta.

- `on_tool_call_created(tool_call: ToolCall) -> None`: This method is called when a new tool call is created. It prints the type of the tool call to the console.

- `on_tool_call_delta(delta: ToolCallDelta, snapshot: ToolCall) -> None`: This method is called when a tool call delta is received. It handles the delta's data based on the tool call's type. For code interpreter tool calls, it displays the code input and outputs, including any logs generated by the code execution.

## How the Class Works

The `EventHandler` class works by overriding the default methods of the `openai.AssistantEventHandler` class. These methods are called by the OpenAI Assistant API as events occur during the response processing.

The `on_text_created` and `on_text_delta` methods manage the display of text messages. The `on_text_created` method prints the initial text, while `on_text_delta` updates the text with any changes received as deltas.

The `on_tool_call_created` and `on_tool_call_delta` methods handle tool calls. The `on_tool_call_created` method prints the type of the tool call, while `on_tool_call_delta` processes the specific delta data. For code interpreter tool calls, the delta information is used to display the code input, outputs, and any logs generated during execution.

## Examples

```python
from openai import AssistantEventHandler, OpenAI
from openai.types.beta.threads import Text, TextDelta
from openai.types.beta.threads.runs import ToolCall, ToolCallDelta

# Create a custom EventHandler class
class EventHandler(AssistantEventHandler):
    """This class handles events from the OpenAI Assistant API's response stream."""

    @override
    def on_text_created(self, text: Text) -> None:
        """This method is called when a new text message is created in the response stream."""
        print(f"\nassistant > ", end="", flush=True)

    @override
    def on_text_delta(self, delta: TextDelta, snapshot: Text) -> None:
        """This method is called when a text delta is received."""
        print(delta.value, end="", flush=True)

    @override
    def on_tool_call_created(self, tool_call: ToolCall) -> None:
        """This method is called when a new tool call is created."""
        print(f"\nassistant > {tool_call.type}\n", flush=True)

    @override
    def on_tool_call_delta(self, delta: ToolCallDelta, snapshot: ToolCall) -> None:
        """This method is called when a tool call delta is received."""
        if delta.type == "code_interpreter" and delta.code_interpreter:
            if delta.code_interpreter.input:
                print(delta.code_interpreter.input, end="", flush=True)
            if delta.code_interpreter.outputs:
                print(f"\n\noutput >", flush=True)
                for output in delta.code_interpreter.outputs:
                    if output.type == "logs":
                        print(f"\n{output.logs}", flush=True)

# Initialize the OpenAI client
openai = OpenAI()

# Create a new thread
thread = openai.beta.threads.create()

# Create a new run with the custom EventHandler
run = openai.beta.threads.runs.create(
    thread_id=thread.id,
    instructions="Hello, world!",
    tools=["code_interpreter"],
    event_handler=EventHandler(),
)

# Stream the response
for event in run.stream():
    # Handle events as they are received
    pass
```

## Parameter Details

- `text`: Represents a text message generated by the assistant.
- `delta`: Represents a delta (change) to an existing text message.
- `snapshot`: The current state of the text or tool call before the delta was applied.
- `tool_call`: Represents a tool call made by the assistant.
- `code_interpreter`: Represents the code interpreter tool call's specific data, including input code, outputs, and logs.

## Examples

- **Example 1**: Handling text creation and text deltas:
  ```python
  # ... code ...

  @override
  def on_text_created(self, text: Text) -> None:
      print(f"\nassistant > ", end="", flush=True)

  @override
  def on_text_delta(self, delta: TextDelta, snapshot: Text) -> None:
      print(delta.value, end="", flush=True)
  ```

- **Example 2**: Handling code interpreter tool calls and deltas:
  ```python
  # ... code ...

  @override
  def on_tool_call_delta(self, delta: ToolCallDelta, snapshot: ToolCall) -> None:
      if delta.type == "code_interpreter" and delta.code_interpreter:
          if delta.code_interpreter.input:
              print(delta.code_interpreter.input, end="", flush=True)
          if delta.code_interpreter.outputs:
              print(f"\n\noutput >", flush=True)
              for output in delta.code_interpreter.outputs:
                  if output.type == "logs":
                      print(f"\n{output.logs}", flush=True)