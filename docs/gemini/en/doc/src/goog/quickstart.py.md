# Модуль src.goog.quickstart

## Обзор

Модуль `quickstart.py` демонстрирует базовое использование Apps Script API. Он вызывает Apps Script API для создания нового скриптового проекта, загружает файл в проект и выводит URL скрипта для пользователя.

## Подробнее

Этот модуль предназначен для демонстрации взаимодействия с Google Apps Script API. Он создает новый скриптовый проект, загружает в него код и манифест, а затем выводит URL для редактирования скрипта. Этот код может быть использован в качестве отправной точки для автоматизации работы с Google Apps Script.

## Классы

В данном модуле классы отсутствуют.

## Функции

### `main`

```python
def main():
    """Вызывает Apps Script API."""
```

**Описание**: Функция `main` является основной точкой входа для работы с Apps Script API. Она выполняет следующие действия:
1. Аутентификация и авторизация пользователя через Google OAuth2.
2. Создание нового проекта Apps Script.
3. Загрузка файлов с кодом и манифестом в проект.
4. Вывод URL для редактирования созданного скрипта.

**Как работает функция**:

1. **Аутентификация**:
   - Функция пытается загрузить учетные данные из файла `token.json`. Если файл существует и учетные данные в нем валидны, они используются для аутентификации.
   - Если файл `token.json` не существует или учетные данные не валидны, выполняется процесс аутентификации через `InstalledAppFlow`. Пользователю будет предложено войти в свой аккаунт Google и предоставить необходимые разрешения.
   - Полученные учетные данные сохраняются в файл `token.json` для последующего использования.

2. **Создание проекта**:
   - После успешной аутентификации функция создает экземпляр сервиса Apps Script API.
   - Создается новый проект Apps Script с названием "My Script".

3. **Загрузка контента**:
   - В проект загружаются два файла: `hello` (с кодом на JavaScript) и `appsscript` (с манифестом в формате JSON).
   - Код и манифест определены в виде строковых констант `SAMPLE_CODE` и `SAMPLE_MANIFEST`.

4. **Вывод URL**:
   - После успешной загрузки контента функция выводит URL для редактирования созданного скрипта.

5. **Обработка ошибок**:
   - Если в процессе выполнения возникают ошибки, они перехватываются и информация об ошибке выводится в консоль.

**Пример структуры файлов**:
- Файл `token.json` содержит сохраненные учетные данные пользователя для доступа к Google Apps Script API.
- Файл `credentials.json` содержит учетные данные приложения, необходимые для аутентификации через Google OAuth2.

```python
SCOPES = ['https://www.googleapis.com/auth/script.projects']
```
- `SCOPES` (list): Список областей доступа, необходимых для работы с Apps Script API.

```python
SAMPLE_CODE = '''
function helloWorld() {
  console.log("Hello, world!");
}
'''.strip()
```
- `SAMPLE_CODE` (str): Пример кода на JavaScript, который будет загружен в Apps Script проект.

```python
SAMPLE_MANIFEST = '''
{
  "timeZone": "America/New_York",
  "exceptionLogging": "CLOUD"
}
'''.strip()
```
- `SAMPLE_MANIFEST` (str): Пример манифеста в формате JSON, который будет загружен в Apps Script проект.

**Параметры**:
- Функция `main` не принимает параметров.

**Возвращает**:
- Функция `main` ничего не возвращает.

**Вызывает исключения**:
- `errors.HttpError`: Возникает, если API возвращает ошибку.

**Пример вызова**:

```python
if __name__ == '__main__':
    main()
```
В данном случае, функция `main` вызывается при запуске скрипта.

```python
creds = None
```
- `creds`: переменная для хранения учетных данных пользователя.

```python
token_path = gs.path.secrets / 'e-cat-346312-137284f4419e.json'
```
- `token_path`: путь к файлу, содержащему учетные данные пользователя.

```python
service = build('script', 'v1', credentials=creds)
```
- `service`: экземпляр сервиса Apps Script API.

```python
request = {'title': 'My Script'}
```
- `request`: запрос на создание нового проекта Apps Script.

```python
response = service.projects().create(body=request).execute()
```
- `response`: ответ от API на запрос о создании проекта.

```python
request = {
    'files': [{
        'name': 'hello',
        'type': 'SERVER_JS',
        'source': SAMPLE_CODE
    }, {
        'name': 'appsscript',
        'type': 'JSON',
        'source': SAMPLE_MANIFEST
    }]
}
```
- `request`: запрос на обновление контента проекта.

```python
response = service.projects().updateContent(
    body=request,
    scriptId=response['scriptId']).execute()
```
- `response`: ответ от API на запрос об обновлении контента проекта.

## Примеры

1. Запуск скрипта для создания нового проекта Apps Script и загрузки в него файлов:

```python
if __name__ == '__main__':
    main()
```
При первом запуске скрипта потребуется аутентификация в Google аккаунте. После успешной аутентификации в консоль будет выведен URL для редактирования созданного скрипта.