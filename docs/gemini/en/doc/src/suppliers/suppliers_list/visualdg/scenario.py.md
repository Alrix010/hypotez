# Модуль сбора товаров с сайта kualastyle.il

## Обзор

Модуль `sceanrio.py` предназначен для сбора информации о товарах с сайта  `kualastyle.il` с использованием `Webdriver` для автоматизации процесса. 

## Детали

Модуль `sceanrio.py` реализует сценарий обработки категорий товаров для поставщика `kualastyle.il`. 

**Процесс обработки категорий:**

1. **Сбор категорий:** `get_list_categories_from_site()`  извлекает список доступных категорий товаров с сайта.
2. **Сбор товаров в категории:**  `get_list_products_in_category()`  извлекает список ссылок на товары с определенной категории.
3. **Обработка страниц товаров:**  `grab_product_page()`  обрабатывает  каждую страницу товара и создает объекты `Product`.

## TOC

- **Функции:**
    - `get_list_products_in_category`
    - `paginator`
    - `get_list_categories_from_site`

## Функции

### `get_list_products_in_category`

**Цель:** Извлечение списка ссылок на товары из категории.

**Параметры:**

- `s` (`Supplier`): Объект поставщика, содержащий информацию о поставщике и настройках сценария.

**Возвращает:**

- `list[str, str, None]`: Список ссылок на товары в категории. Возвращает `None`, если на странице отсутствуют ссылки.

**Как работает:**

1. Инициализация переменных `d` (объект `Driver`) и `l` (словарь с локаторами).
2. Ожидание загрузки страницы и закрытие баннера (с помощью `d.wait(1)` и  `d.execute_locator(s.locators['product']['close_banner'])`).
3. Прокрутка страницы (с помощью `d.scroll()`).
4. Извлечение списка ссылок на товары (с помощью  `d.execute_locator(l['product_links'])`).
5. Обработка отсутствия ссылок на товары (с помощью  `logger.warning(...)`).
6. Итерация по страницам категории с помощью `while d.current_url != d.previous_url`.
7. Вызов функции `paginator` для проверки наличия следующих страниц.
8. Добавление новых ссылок на товары в список `list_products_in_category` (с помощью `d.execute_locator(l['product_links'])`).
9. Возврат `list_products_in_category`.


**Примеры:**
```python
# Пример вызова:
s = Supplier(name='kualastyle', ...)
products_urls = get_list_products_in_category(s)
if products_urls is not None:
    print(f'Найдено {len(products_urls)} товаров.')
```

### `paginator`

**Цель:**  Проверка наличия следующих страниц в категории.

**Параметры:**

- `d` (`Driver`): Объект `Driver`.
- `locator` (`dict`): Словарь с локаторами.
- `list_products_in_category` (`list`): Список ссылок на товары в категории.

**Возвращает:**

- `bool`: `True`, если есть следующие страницы, `None` - если нет.

**Как работает:**

1. Выполняется  `d.execute_locator(locator['pagination']['<-\']`) для поиска кнопки "Предыдущая страница".
2. Если кнопка не найдена или список пуст, возвращается `None`.
3. Возвращает `True` в противном случае.

**Примеры:**
```python
# Пример вызова:
d = Driver(Chrome)
locator = {'pagination': {'<-' : ...}}  # Должны быть определены локаторы
list_products_in_category = [] 
has_next_page = paginator(d, locator, list_products_in_category)
if has_next_page:
    print('Есть следующая страница.')
```

### `get_list_categories_from_site`

**Цель:** Сбор актуальных категорий с сайта.

**Параметры:**

- `s` (`Supplier`): Объект `Supplier`.

**Возвращает:**

- `None`: Функция не возвращает данных, но собирает список категорий с сайта.

**Как работает:**

1. Функция должна реализовать логику извлечения списка категорий с сайта, используя `Webdriver`. 
2. После извлечения списка категорий, возможно, потребуется сохранить их в базу данных или файл.
3. Функция должна использовать `logger` для записи логов.

**Примеры:**
```python
# Пример вызова:
s = Supplier(name='kualastyle', ...)
get_list_categories_from_site(s)
```

**Описание локаторов:**

- `s.locators['category']`: Локаторы для работы с элементами на странице категории.
- `s.locators['product']`: Локаторы для работы с элементами на странице товара.
- `s.locators['product']['close_banner']`: Локатор для закрытия баннера на странице товара.
- `s.locators['product_links']`: Локатор для извлечения ссылок на товары.
- `s.locators['pagination']['<-\']`: Локатор для поиска кнопки "Предыдущая страница".

**Дополнительные замечания:**

- Добавьте описание для  `Supplier` и всех локаторов, используемых в сценарии. 
- Добавьте примеры использования всех функций.
- Добавьте описание сценария сбора товаров с сайта.
- Добавьте  `logger.error(...)`  для обработки ошибок в каждой функции.

**Важно**: 

- Опишите процесс работы функции  `get_list_categories_from_site` более подробно, включая примеры вызова.
- Опишите процесс сбора товаров с сайта  `kualastyle.il`,  включая все этапы сбора.
- Опишите локаторы, которые используются для работы с элементами на странице.
- Внесите в код изменения, используя `logger.error(...)` для обработки ошибок в каждой функции.
- Опишите, как  `get_list_categories_from_site` взаимодействует с  `PrestaShop.categories <-> aliexpress.shop.categoies`.