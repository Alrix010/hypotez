# Модуль сбора товаров со страницы категорий поставщика bangood.co.il через вебдрайвер

## Обзор

Модуль `hypotez/src/suppliers/bangood/scenario.py`  отвечает за сбор данных о товарах с  страницы категорий поставщика `bangood.co.il`  с помощью `web driver`.

## Детали

Модуль реализует следующие задачи:

-  **Сбор списка категорий с сайта `bangood.co.il`:** Функция `get_list_categories_from_site(s)`  извлекает список категорий, которые доступны на сайте.

- **Сбор списка товаров с страницы категории:** Функция `get_list_products_in_category(s)`  перебирает ссылки на товары на странице категории и формирует список, содержащий URLs страниц этих товаров.

-  **Обработка страниц товара:**  Функция `grab_product_page()`  (не представлена в коде,  но упоминается)  получает URL страницы товара и  выполняет ее обработку,  извлекая  данные о товаре  и передавая их в класс `Product`  (также не представлен в коде).

## Классы

### `Supplier`

**Описание**:  Класс `Supplier`   (не представлен в коде)   вероятно  предназначен для  представления  поставщика  и  содержит  информацию  о  нем,  включая  конкретные  сценарии  сбора  данных  о  товарах  (возможно,  с  разными  способами  обработки  страниц  и  сбора  данных).

**Атрибуты**:

-  `driver`:  Экземпляр  `Driver`   (предположительно  класс  для  работы  с  `web driver`). 

- `locators`:  Словарь,  который  содержит  локаторы  для  нахождения  необходимых  элементов  на  страницах  сайта  поставщика.

**Методы**:

-  `get_list_products_in_category(s)`:  Функция  для  сбора  списка  URL  страниц  товаров  с  страницы  категории.

-  `get_list_categories_from_site(s)`:  Функция  для  сбора  списка  категорий  с  сайта.

-  `grab_product_page()` (не представлена в коде):  Функция  для  обработки  страницы  товара.

## Функции

### `get_list_products_in_category(s)`

**Описание**:  Функция  возвращает  список  URL  страниц  товаров  со  страницы  категории.

**Параметры**:

- `s` (`Supplier`):  Экземпляр  класса  `Supplier`.

**Возвращает**:

-  `list[str, str, None]`:  Список  URL  страниц  товаров  или  `None`,  если  ссылки  не  были  найдены.

**Как работает функция**:

1.  Получает  экземпляр  `Driver`  из  атрибута  `driver`  класса  `Supplier`.

2.  Извлекает  локаторы  из  атрибута  `locators`  класса  `Supplier`.

3.  Вызывает  функцию  `execute_locator()`  `Driver`  с  локатором  `product\close_banner`,  чтобы  закрыть  баннер  с  рекламой  (если  он  есть).

4.  Проверяет  наличие  локаторов  для  страницы  категории.

5.  Пролистывает  страницу  категории  (возможно,  если  необходимо,  но  в  коде  нет  реализации  этого  функционала).

6.  Вызывает  функцию  `execute_locator()`  `Driver`  с  локатором  `product_links`,  чтобы  получить  ссылки  на  товары.

7.  Проверяет  наличие  списка  ссылок  на  товары  и  выводит  сообщение  в  лог,  если  ссылки  не  были  найдены.

8.  Преобразует  результат  в  список,  если  результат  является  строкой.

9.  Записывает  в  лог  количество  найденных  товаров  и  возвращает  список  URL  товаров.

### `get_list_categories_from_site(s)`

**Описание**:  Функция  извлекает  список  категорий  с  сайта  `bangood.co.il`.

**Параметры**:

- `s` (`Supplier`):  Экземпляр  класса  `Supplier`.

**Возвращает**:

-  `list[str, str, None]`:  Список  URL  страниц  категорий  или  `None`,  если  категории  не  были  найдены.

**Как работает функция**:  

Функция  не  представлена  в  коде,  но  она  вероятно  выполняет  следующие  действия:

1.  Использует  `Driver`  для  загрузки  страницы  сайта  `bangood.co.il`.

2.  Использует  локаторы  для  нахождения  списка  категорий  на  странице.

3.  С помощью  цикла  перебирает  категории  и  собирает  их  URL  страниц.

4.  Возвращает  список  URL  страниц  категорий.

## Примеры

### Пример вызова `get_list_products_in_category(s)`

```python
# Предположим, что у нас есть экземпляр класса Supplier
s = Supplier()  

# Вызываем функцию get_list_products_in_category
products = get_list_products_in_category(s)

# Проверяем, что функция вернула список URL
if products:
    logger.info(f"Найдено {len(products)} товаров")

    # Проходим по списку URL товаров и выполняем необходимые действия
    for product_url in products:
        # ...
```

## Parameter Details

-  `s` (`Supplier`):  Экземпляр  класса  `Supplier`,  который  представляет  поставщика  `bangood.co.il`.  

-  `l` (`dict`):  Словарь,  содержащий  локаторы  для  нахождения  элементов  на  странице  сайта  `bangood.co.il`.  Локаторы  могут  быть  разные  в  зависимости  от  того,  какой  тип  данных  необходимо  извлечь  (например,  `product\close_banner`  для  закрытия  рекламного  баннера  или  `product_links`  для  получения  списка  ссылок  на  товары).

## Как работает код

Код  модуля  `hypotez/src/suppliers/bangood/scenario.py`  предназначен  для  сбора  информации  о  товарах  с  сайта  `bangood.co.il`.  Он  использует  `web driver`  для  загрузки  и  обработки  страниц  сайта  и  локаторы  для  нахождения  необходимых  элементов  на  страницах. 

## Дополнительные замечания

-  В  коде  отсутствует  функция  `grab_product_page()`.  В  документации  описано  ее  предполагаемое  назначение  и  роль  в  процессе  сбора  данных.

-  В  коде  нет  реализации  пролистывания  страниц  категорий.  Это  может  быть  проблемой,  если  количество  товаров  на  странице  категории  превышает  число  отображаемых  товаров  на  экране.

-  В  коде  нет  проверки  на  изменение  категорий  на  страницах  поставщика.  Это  может  привести  к  неверным  данным,  если  продавец  изменит  структуру  категорий  на  своем  сайте.  

-  В  коде  используется  функция  `execute_locator()`,  которая  применяется  к  `Driver`  для  нахождения  и  обработки  элементов  на  страницах  сайта.  Эта  функция  должна  быть  реализована  в  модуле  `webdriver`.

-  В  коде  присутствуют  комментарии  с  `@todo`,  которые  указывает  на  необходимость  доработки  кода.