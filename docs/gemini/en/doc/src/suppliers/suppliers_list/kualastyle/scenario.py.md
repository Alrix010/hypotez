# Модуль сбора товаров со страницы категорий поставщика kualastyle.il через вебдрайвер
=================================================================================================

## Обзор

Модуль собирает информацию о товарах с категорийных страниц поставщика `kualastyle.il` с использованием `web driver`.

## Детали

У каждого поставщика свой сценарий обработки категорий. Этот модуль реализует сценарий для `kualastyle.il`.

**Основные шаги:**

1. **Получение списка категорий:** Функция `get_list_categories_from_site()` собирает список категорий со страниц продавца.

2. **Получение списка товаров в категории:** Функция `get_list_products_in_category()` собирает список товаров со страницы категории.

3. **Обработка страниц товара:** Функция `grab_product_page()` обрабатывает поля товара и передает управление классу `Product`.

## Функции

### `get_list_products_in_category`

**Цель:** Извлечение списка ссылок на товары с категорийной страницы.

**Параметры:**

- `s` (Supplier): Экземпляр класса `Supplier`, содержащий информацию о текущем поставщике.

**Возвращаемое значение:**

- Список URL товаров или `None`, если товары не найдены.

**Как работает:**

1. Получает экземпляр `Driver` из объекта `Supplier`.
2. Получает локаторы для элементов на странице категории из объекта `Supplier`.
3. Ждет 1 секунду для загрузки страницы.
4. Закрывает всплывающее баннерное окно.
5. Прокручивает страницу вниз.
6. Использует `driver.execute_locator()` для извлечения списка ссылок на товары.
7. Если список ссылок пуст, выводит предупреждение в лог и возвращает `None`.
8. Если на странице есть пагинация, переходит на следующую страницу и повторяет действия.
9. Возвращает список найденных ссылок на товары.

### `paginator`

**Цель:** Обработка пагинации на странице категории.

**Параметры:**

- `d` (Driver): Экземпляр класса `Driver`.
- `locator` (dict): Локатор для элемента пагинации.
- `list_products_in_category` (list): Список ссылок на товары.

**Возвращаемое значение:**

- `True`, если пагинация существует, `None` в противном случае.

**Как работает:**

1. Выполняет `driver.execute_locator()` для элемента пагинации.
2. Если элемент не найден или список пуст, возвращает `None`.
3. В противном случае возвращает `True`.

### `get_list_categories_from_site`

**Цель:** Сбор актуального списка категорий с сайта.

**Параметры:**

- `s` (Supplier): Экземпляр класса `Supplier`.

**Возвращаемое значение:**

- Не определено.

**Как работает:**

- Не определено.

## Примеры

```python
# Пример использования функции get_list_products_in_category:
from src.suppliers.suppliers_list.kualastyle.scenario import get_list_products_in_category

# Предположим, что у нас есть объект Supplier:
supplier = Supplier(
    ...
)

# Получаем список товаров в категории:
product_urls = get_list_products_in_category(supplier)

# Проверяем результат:
if product_urls:
    print(f"Найдено {len(product_urls)} товаров")
else:
    print("Товары не найдены")

```

## Дополнительная информация

- В модуле используется `logger` из `src.logger.logger`. 
- Модуль использует `Driver`, `Chrome`, `Firefox`, `Playwright` из `src.webdriver.driver`.
- В коде используются местозаполнители: `<instruction for gemini model:Loading product descriptions into PrestaShop.>, <next, if available>`. 
- Рекомендуется ознакомиться с инструкцией по обработке кода проекта `hypotez` для получения дополнительной информации.
- Пример использования `driver.execute_locator()`:

```python
close_banner = {
  "attribute": null,
  "by": "XPATH",
  "selector": "//button[@id = 'closeXButton']",
  "if_list": "first",
  "use_mouse": false,
  "mandatory": false,
  "timeout": 0,
  "timeout_for_event": "presence_of_element_located",
  "event": "click()",
  "locator_description": "Закрываю pop-up окно, если оно не появилось - не страшно (`mandatory`:`false`)"
}

result = driver.execute_locator(close_banner)

```