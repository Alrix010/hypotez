# Модуль для работы с файлами Excel (`xls`)

## Обзор

Этот модуль предоставляет функции для преобразования файлов Excel в формат JSON, обработки нескольких листов и сохранения данных JSON обратно в файлы Excel.

## Подробности

Этот модуль реализует функции, которые обеспечивают конвертацию данных из формата Excel в формат JSON и наоборот. В частности, он предоставляет две основные функции:

- `read_xls_as_dict`:  Читает файл Excel и преобразует его в JSON.  Можно указать определенный лист для преобразования и сохранить результат в файл JSON.  Обрабатывает ошибки с помощью журнала.
- `save_xls_file`: Сохраняет данные JSON в файл Excel.  Данные должны быть представлены в виде словаря, где ключи — имена листов, а значения — списки словарей, представляющие строки.  Обрабатывает ошибки с помощью журнала.

## Описание кода

### Классы

### Функции

#### `read_xls_as_dict`

**Цель**: Функция считывает файл Excel и преобразует его в JSON. Можно указать конкретный лист для преобразования и сохранить результат в JSON-файл. Обрабатывает ошибки.

**Параметры**:

- `xls_file` (str): Путь к файлу Excel.
- `json_file` (str, optional): Путь к файлу JSON для сохранения результата. По умолчанию None.
- `sheet_name` (Union[str, int], optional): Имя или номер листа для преобразования. По умолчанию None (обрабатываются все листы).

**Возвращает**:

- `Union[Dict, List[Dict], bool]`: Возвращает словарь с данными JSON, список словарей (если указан один лист) или False в случае ошибки.

**Исключения**:

- `FileNotFoundError`: Если файл Excel не найден.
- `Exception`: Если происходит другая ошибка.

**Как работает функция**:

- Сначала проверяет, существует ли файл Excel.
- Если файл найден, считывает его с помощью `pd.ExcelFile`.
- Если указано имя листа, считывает только этот лист с помощью `pd.read_excel`.
- Если имя листа не указано, считывает данные со всех листов.
- Преобразует данные DataFrame в список словарей с помощью `df.to_dict(orient='records')`.
- Если указан путь к JSON-файлу, записывает преобразованные данные в этот файл.
- Возвращает словарь с данными JSON или False в случае ошибки.

**Примеры**:

```python
# Чтение и сохранение в JSON
data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')  # Чтение листа с именем 'Sheet1'
if data:
    print(data)  # Вывод будет {'Sheet1': [{...}]}

# Сохранение из JSON-данных
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Успешно сохранено в output.xlsx")
```

#### `save_xls_file`

**Цель**:  Сохраняет данные JSON в файл Excel.  Обрабатывает ошибки с помощью журнала.

**Параметры**:

- `data` (Dict[str, List[Dict]]): Словарь, где ключи — имена листов, а значения — списки словарей, представляющие строки.
- `file_path` (str): Путь к файлу Excel.

**Возвращает**:

- `bool`: Возвращает True, если файл был успешно сохранен, иначе False.

**Исключения**:

- `Exception`: Если происходит ошибка при сохранении файла.

**Как работает функция**:

- Использует `pd.ExcelWriter` для создания файла Excel.
- Для каждого листа в словаре `data`:
    - Создает DataFrame из списка словарей.
    - Сохраняет DataFrame в файл Excel с помощью `df.to_excel`.
- Возвращает True, если файл был успешно сохранен, иначе False.

**Примеры**:

```python
# Сохранение данных в файл Excel
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Данные успешно сохранены в output.xlsx")
```

## Подробности параметров

- `xls_file` (str): Путь к файлу Excel.
- `json_file` (str, optional): Путь к файлу JSON для сохранения результата. По умолчанию None.
- `sheet_name` (Union[str, int], optional): Имя или номер листа для преобразования. По умолчанию None (обрабатываются все листы).
- `data` (Dict[str, List[Dict]]): Словарь, где ключи — имена листов, а значения — списки словарей, представляющие строки.
- `file_path` (str): Путь к файлу Excel.

## Примеры

### Пример использования `read_xls_as_dict`

```python
# Чтение и сохранение в JSON
data = read_xls_as_dict('input.xlsx', 'output.json', 'Sheet1')  # Чтение листа с именем 'Sheet1'
if data:
    print(data)  # Вывод будет {'Sheet1': [{...}]}
```

### Пример использования `save_xls_file`

```python
# Сохранение данных в файл Excel
data_to_save = {'Sheet1': [{'column1': 'value1', 'column2': 'value2'}]}
success = save_xls_file(data_to_save, 'output.xlsx')
if success:
    print("Данные успешно сохранены в output.xlsx")
```