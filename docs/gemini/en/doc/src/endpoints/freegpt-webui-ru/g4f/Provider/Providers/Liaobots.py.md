# Документация для `Liaobots.py`

## Обзор

В этом файле содержится реализация провайдера `Liaobots` для проекта `hypotez`. Он обеспечивает взаимодействие с сервисом `liaobots.com` для генерации текста на основе предоставленных сообщений с использованием моделей `gpt-3.5-turbo` и `gpt-4`.

## Подробнее

Этот код определяет параметры подключения к сервису `Liaobots`, включая URL, поддерживаемые модели и необходимость аутентификации. Он также содержит функцию `_create_completion`, которая отправляет запросы к API `Liaobots` и возвращает сгенерированный текст.

## Classes

В данном файле классы отсутствуют.

## Functions

### `_create_completion`

```python
def _create_completion(model: str, messages: list, stream: bool, **kwargs):
    """ Функция создает запрос к API Liaobots и возвращает сгенерированный текст.

    Args:
        model (str): Идентификатор используемой модели (например, 'gpt-3.5-turbo', 'gpt-4').
        messages (list): Список сообщений для отправки в API.
        stream (bool): Флаг, указывающий, использовать ли потоковую передачу данных.
        **kwargs: Дополнительные параметры, такие как ключ аутентификации (`auth`).

    Returns:
        Generator[str, None, None]: Генератор токенов сгенерированного текста.

    Raises:
        requests.exceptions.RequestException: Если возникает ошибка при отправке запроса к API.

    Пример:
        >>> for token in _create_completion(model='gpt-3.5-turbo', messages=[{'role': 'user', 'content': 'Hello'}], stream=True, auth='ключ_авторизации'):
        ...     print(token)
    """
```

**Параметры**:
- `model` (str): Идентификатор модели, используемой для генерации текста.
- `messages` (list): Список сообщений, отправляемых в API. Каждое сообщение представляет собой словарь с ключами `role` и `content`.
- `stream` (bool): Флаг, указывающий, следует ли использовать потоковую передачу для получения ответа.
- `kwargs` (dict): Дополнительные параметры, передаваемые в API, такие как ключ аутентификации.

**Как работает функция**:

1. Функция принимает параметры модели, сообщения, флаг потоковой передачи и дополнительные аргументы.
2. Формирует заголовки запроса, включая `authority`, `content-type`, `origin`, `referer`, `user-agent` и ключ аутентификации (`x-auth-code`).
3. Создает JSON-данные для отправки в API, включая `conversationId`, `model`, `messages`, `key` и `prompt`.
4. Отправляет POST-запрос к API `https://liaobots.com/api/chat` с использованием библиотеки `requests`.
5. Итерируется по содержимому ответа, декодирует каждый токен и возвращает его через генератор.

**Примеры**:

```python
# Пример использования функции _create_completion
for token in _create_completion(model='gpt-3.5-turbo', messages=[{'role': 'user', 'content': 'Hello'}], stream=True, auth='ключ_авторизации'):
    print(token)
```

## Global Variables

- `url`: URL адрес сервиса `Liaobots` (`https://liaobots.com`).
- `model`: Список поддерживаемых моделей (`gpt-3.5-turbo`, `gpt-4`).
- `supports_stream`: Флаг, указывающий на поддержку потоковой передачи (`True`).
- `needs_auth`: Флаг, указывающий на необходимость аутентификации (`True`).
- `models`: Словарь, содержащий информацию о поддерживаемых моделях, включая их идентификаторы, имена, максимальную длину и лимит токенов.
- `params`: Строка, формирующая параметры для `g4f.Providers`, включающая типы данных аргументов функции `_create_completion`.