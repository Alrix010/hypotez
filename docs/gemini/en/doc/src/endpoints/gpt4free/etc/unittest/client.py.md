# Модуль тестирования клиента `gpt4free`
## Обзор

Этот модуль содержит набор юнит-тестов для проверки функциональности клиента `gpt4free`. Тесты покрывают различные сценарии использования, включая отправку запросов, получение ответов и обработку исключений.

## Детали

Модуль использует библиотеку `unittest` для создания юнит-тестов. Тесты написаны для проверки работы как синхронных, так и асинхронных клиентов.

## Классы
### `AsyncTestPassModel`

**Описание**: Класс `AsyncTestPassModel` содержит набор асинхронных тестов для проверки функциональности асинхронного клиента `gpt4free`.

**Наследование**: `unittest.IsolatedAsyncioTestCase`

**Атрибуты**:

- `client`:  Экземпляр асинхронного клиента `gpt4free`, используемый для выполнения запросов.

**Методы**:

- `test_response()`:  Проверяет, что клиент возвращает правильный тип ответа (ChatCompletion) при отправке пустого сообщения.
- `test_pass_model()`:  Проверяет, что клиент отправляет запрос и возвращает правильный ответ.
- `test_max_tokens()`:  Проверяет, что клиент ограничивает количество токенов в ответе в соответствии с параметром `max_tokens`.
- `test_max_stream()`:  Проверяет, что клиент правильно обрабатывает потоковый режим (`stream=True`) и возвращает правильное количество частей (`chunk`) ответа.
- `test_stop()`:  Проверяет, что клиент останавливает генерацию ответа, если встречает заданные стоп-слова (`stop`).

### `TestPassModel`

**Описание**: Класс `TestPassModel` содержит набор тестов для проверки функциональности синхронного клиента `gpt4free`.

**Наследование**: `unittest.TestCase`

**Атрибуты**:

- `client`:  Экземпляр синхронного клиента `gpt4free`, используемый для выполнения запросов.

**Методы**:

- `test_response()`:  Проверяет, что клиент возвращает правильный тип ответа (ChatCompletion) при отправке пустого сообщения.
- `test_pass_model()`:  Проверяет, что клиент отправляет запрос и возвращает правильный ответ.
- `test_max_tokens()`:  Проверяет, что клиент ограничивает количество токенов в ответе в соответствии с параметром `max_tokens`.
- `test_max_stream()`:  Проверяет, что клиент правильно обрабатывает потоковый режим (`stream=True`) и возвращает правильное количество частей (`chunk`) ответа.
- `test_stop()`:  Проверяет, что клиент останавливает генерацию ответа, если встречает заданные стоп-слова (`stop`).
- `test_model_not_found()`:  Проверяет, что клиент генерирует исключение `ModelNotFoundError`, если не найдена модель.
- `test_best_provider()`:  Проверяет, что функция `get_model_and_provider` возвращает правильный поставщик (`provider`) для модели.
- `test_default_model()`:  Проверяет, что функция `get_model_and_provider` возвращает правильный поставщик (`provider`) для модели по умолчанию.
- `test_provider_as_model()`:  Проверяет, что функция `get_model_and_provider` возвращает правильный поставщик (`provider`) для модели, заданной в качестве имени поставщика.
- `test_get_model()`:  Проверяет, что функция `get_model_and_provider` возвращает правильную модель.

## Функции
### `get_model_and_provider`

**Цель**:  Функция `get_model_and_provider` определяет модель и поставщика (`provider`) для заданной модели `gpt4free`.

**Параметры**:

- `model`:  Название модели `gpt4free`, которую нужно использовать.
- `provider`:  Поставщик (`provider`) для модели.
- `default`:  Флаг, указывающий, следует ли использовать модель по умолчанию, если модель не задана.

**Возвращает**:

- `Tuple[str, Any]`: Кортеж, содержащий название модели и поставщика.

**Исключения**:

- `ModelNotFoundError`:  Генерируется, если модель не найдена.

**Пример**:
```python
from g4f.models import gpt_4o

model, provider = get_model_and_provider(gpt_4o.name, None, False)
# model == "gpt-4o"
```

**Как работает функция**:

- Функция сначала проверяет, задана ли модель. 
- Если модель задана, функция пытается найти соответствующий поставщик (`provider`) в списке доступных поставщиков (`provider`).
- Если модель не задана, функция проверяет флаг `default`. 
- Если `default=True`, функция возвращает модель и поставщик по умолчанию.
- Если `default=False`, функция генерирует исключение `ModelNotFoundError`.

**Пример**:
```python
# В этом примере модель "gpt-4o" должна быть добавлена ​​в список доступных моделей
# в модуле `g4f.Provider.Copilot`.
from g4f.models import gpt_4o

model, provider = get_model_and_provider(gpt_4o.name, None, False)
# model == "gpt-4o"
```

## Подробности о параметрах

- `model` (str):  Название модели `gpt4free`, которую нужно использовать. Доступные модели: `""` (модель по умолчанию), `gpt-4o`, `Copilot`, `gemini`, `claude`.
- `provider` (Optional[Any]):  Поставщик (`provider`) для модели.  Если не задан, функция `get_model_and_provider` попытается автоматически найти подходящий поставщик.
- `default` (bool):  Флаг, указывающий, следует ли использовать модель по умолчанию, если модель не задана.

## Примеры

```python
# Создание экземпляра асинхронного клиента с использованием модели по умолчанию
client = AsyncClient()

# Создание экземпляра асинхронного клиента с использованием модели "gpt-4o"
client = AsyncClient(model="gpt-4o")

# Создание экземпляра асинхронного клиента с использованием модели "gpt-4o" и указанного поставщика
client = AsyncClient(model="gpt-4o", provider="Copilot")

# Создание экземпляра синхронного клиента с использованием модели по умолчанию
client = Client()

# Создание экземпляра синхронного клиента с использованием модели "gpt-4o"
client = Client(model="gpt-4o")

# Создание экземпляра синхронного клиента с использованием модели "gpt-4o" и указанного поставщика
client = Client(model="gpt-4o", provider="Copilot")
```