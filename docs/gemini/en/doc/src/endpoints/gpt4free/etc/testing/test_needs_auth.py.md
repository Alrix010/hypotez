# Тестирование GPT4Free для авторизованных запросов

## Обзор

Этот файл содержит код для тестирования GPT4Free API с использованием авторизованных запросов.  
Он проверяет скорость и производительность API для различных поставщиков.  
Также демонстрирует использование потоковой передачи для получения ответов.

## Подробности

Этот модуль предназначен для тестирования работы API GPT4Free при использовании авторизованных запросов.  
Он отправляет простой запрос с приветствием и измеряет время, затраченное на получение ответа от каждого поставщика.  
Тестирование проводится в трех режимах:

* **Асинхронные запросы:** Каждый поставщик выполняет запрос асинхронно, и ответы собираются.  
* **Потоковая передача:**  Ответы от каждого поставщика передаются по мере их получения.
* **Без потоковой передачи:**  Ответы от каждого поставщика собираются только после завершения обработки запроса.  

## Классы

### `g4f.ChatCompletion`

**Описание**: Класс для работы с GPT4Free API для получения ответов на текстовые запросы.

**Атрибуты**:

* `model`:  Модель, которая будет использоваться для обработки запроса. 
* `messages`: Список сообщений в диалоге.
* `provider`:  Поставщик API GPT4Free.

**Методы**:

* `create()`: Метод для отправки запроса к API GPT4Free. 
* `create_completion()`: Метод для получения завершенного ответа.
* `create_async()`:  Асинхронный метод для отправки запроса.

## Функции

### `run_async()`

**Цель**: Асинхронное выполнение запросов к GPT4Free API для каждого поставщика. 

**Параметры**:

* `provider`: Поставщик API GPT4Free.

**Возвращает**:

* `None`. 

**Описание**:
Функция запускает асинхронные запросы для каждого поставщика GPT4Free API.  
Каждый запрос измеряет время выполнения с помощью `log_time_async` для измерения общей продолжительности.  
Результаты вывода выводятся в консоль.

### `run_stream()`

**Цель**: Выполнение запросов к GPT4Free API с использованием потоковой передачи для каждого поставщика.

**Параметры**:

* `provider`: Поставщик API GPT4Free.

**Возвращает**:

* `None`.

**Описание**:
Функция запускает запросы к GPT4Free API для каждого поставщика с использованием потоковой передачи.  
Ответы от каждого поставщика выводятся по мере их получения с помощью `log_time_yield`.  
Результаты вывода выводятся в консоль.

### `create_no_stream()`

**Цель**: Выполнение запросов к GPT4Free API без использования потоковой передачи.

**Параметры**:

* `provider`: Поставщик API GPT4Free.

**Возвращает**:

* `None`.

**Описание**:
Функция запускает запросы к GPT4Free API для каждого поставщика без использования потоковой передачи.  
Ответы от каждого поставщика собираются только после завершения обработки запроса, и результаты вывода выводятся в консоль.  

## Примеры

**Пример 1:** Асинхронное выполнение запросов:

```python
async def run_async():
    responses = [
        log_time_async(
            provider.create_async,
            model=None,
            messages=[{"role": "user", "content": _instruct}],
        )
        for provider in _providers
    ]
    responses = await asyncio.gather(*responses)
    for idx, provider in enumerate(_providers):
        print(f"{provider.__name__}:", responses[idx])
print("Async Total:", asyncio.run(log_time_async(run_async)))\nprint()
```

**Пример 2:** Выполнение запросов с использованием потоковой передачи:

```python
def run_stream():
    for provider in _providers:
        print(f"{provider.__name__}: ", end="")
        for response in log_time_yield(
            provider.create_completion,
            model=None,
            messages=[{"role": "user", "content": _instruct}],
        ):
            print(response, end="", flush=True)
        print()
print("Stream Total:", log_time(run_stream))\nprint()
```

**Пример 3:** Выполнение запросов без использования потоковой передачи:

```python
def create_no_stream():
    for provider in _providers:
        print(f"{provider.__name__}:", end=" ")\n        for response in log_time_yield(
            provider.create_completion,
            model=None,
            messages=[{"role": "user", "content": _instruct}],
            stream=False
        ):
            print(response, end="")
        print()
print("No Stream Total:", log_time(create_no_stream))\nprint()