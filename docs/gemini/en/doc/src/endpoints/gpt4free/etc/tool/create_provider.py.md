# Модуль для создания провайдеров G4F

## Обзор

Этот модуль предназначен для автоматического создания файлов провайдеров на основе команд cURL для библиотеки `g4f`. Он принимает имя провайдера, команду cURL и генерирует код провайдера, используя модель GPT-4o. Модуль также включает функциональность для чтения кода из текстовых блоков и добавления нового провайдера в файл `__init__.py`.

## Детали

Модуль автоматизирует процесс создания новых провайдеров для библиотеки `g4f`. Он запрашивает у пользователя имя провайдера и команду cURL, затем использует модель GPT-4o для генерации кода провайдера на основе предоставленной команды cURL и примера. Сгенерированный код сохраняется в файл провайдера, и провайдер добавляется в файл `__init__.py`.

## Функции

### `read_code`

```python
def read_code(text):
    """Извлекает код Python из текстового блока, заключенного в тройные обратные кавычки.

    Args:
        text (str): Текст, содержащий блок кода Python.

    Returns:
        str | None: Извлеченный код Python или None, если код не найден.

    Как работает:
        Функция использует регулярное выражение для поиска блока кода Python, заключенного в тройные обратные кавычки.
        Если блок кода найден, функция извлекает код и возвращает его.
        Если блок кода не найден, функция возвращает None.
    """
    if match := re.search(r"```(python|py|)\\n(?P<code>[\\S\\s]+?)\\n```", text):
        return match.group("code")
```

### `input_command`

```python
def input_command():
    """Получает команду cURL от пользователя через стандартный ввод.

    Returns:
        str: Объединенные строки ввода, представляющие команду cURL.

    Как работает:
        Функция предлагает пользователю ввести или вставить команду cURL.
        Она считывает ввод построчно до тех пор, пока пользователь не завершит ввод с помощью Ctrl-D или Ctrl-Z (в Windows).
        Затем она объединяет все введенные строки в одну строку и возвращает ее.
    """
    print("Enter/Paste the cURL command. Ctrl-D or Ctrl-Z ( windows ) to save it.")
    contents = []
    while True:
        try:
            line = input()
        except EOFError:
            break
        contents.append(line)
    return "\\n".join(contents)
```

## Основная часть модуля

Основная часть модуля запрашивает у пользователя имя провайдера и проверяет, существует ли файл провайдера. Если файл не существует, он запрашивает команду cURL, создает запрос для модели GPT-4o для генерации кода провайдера на основе команды cURL и примера, сохраняет сгенерированный код в файл провайдера и добавляет провайдера в файл `__init__.py`. Если файл провайдера существует, он считывает код из файла.

## Переменные

- `name` (str): Имя провайдера, введенное пользователем.
- `provider_path` (str): Путь к файлу провайдера.
- `example` (str): Пример кода провайдера, используемый в запросе.
- `command` (str): Команда cURL, введенная пользователем.
- `prompt` (str): Запрос для модели GPT-4o.
- `response` (str): Ответ от модели GPT-4o.
- `code` (str): Извлеченный код провайдера из ответа.

## Как работает модуль

1. **Запрос имени провайдера**:
   - Модуль запрашивает у пользователя имя нового провайдера.

2. **Проверка существования файла провайдера**:
   - Проверяется, существует ли файл провайдера.

3. **Запрос команды cURL (если файл не существует)**:
   - Если файл не существует, модуль запрашивает у пользователя команду cURL.

4. **Создание запроса для GPT-4o**:
   - Формируется запрос для модели GPT-4o, включающий команду cURL, пример кода провайдера и имя провайдера.

5. **Генерация кода провайдера**:
   - Модель GPT-4o генерирует код провайдера на основе запроса.

6. **Сохранение кода провайдера (если файл не существует)**:
   - Если файл не существовал, сгенерированный код сохраняется в файл провайдера.
   - Пример:
     ```python
     with open(provider_path, "w") as file:
         file.write(code)
     ```

7. **Добавление провайдера в `__init__.py` (если файл не существует)**:
   - Если файл не существовал, провайдер добавляется в файл `__init__.py`.
   - Пример:
     ```python
     with open("g4f/Provider/__init__.py", "a") as file:
         file.write(f"\\nfrom .{name} import {name}")
     ```

8. **Чтение кода провайдера (если файл существует)**:
   - Если файл существует, код считывается из файла.
   - Пример:
     ```python
     with open(provider_path, "r") as file:
         code = file.read()
     ```

## Примеры

### Пример создания файла провайдера

```python
name = input("Name: ")  # Ввод: MyProvider
provider_path = f"g4f/Provider/{name}.py"
if not path.isfile(provider_path):
    command = input_command()  # Ввод команды cURL
    # ... (генерация кода провайдера с использованием g4f.ChatCompletion.create)
    with open(provider_path, "w") as file:
        file.write(code)
    with open("g4f/Provider/__init__.py", "a") as file:
        file.write(f"\\nfrom .{name} import {name}")