# Модуль `Acytoo.py`

## Обзор

Модуль предоставляет асинхронный генератор для взаимодействия с провайдером Acytoo. Acytoo - это веб-сервис, предоставляющий доступ к языковым моделям, в частности `gpt-3.5-turbo`. Модуль предназначен для асинхронной отправки запросов к API Acytoo и получения ответов в виде потока данных.

## Подробнее

Модуль содержит класс `Acytoo`, который наследуется от `AsyncGeneratorProvider` и реализует метод `create_async_generator` для создания асинхронного генератора, отправляющего запросы к API Acytoo. Также модуль содержит две вспомогательные функции: `_create_header` для формирования заголовков запроса и `_create_payload` для создания полезной нагрузки запроса.

## Классы

### `Acytoo`

**Описание**: Класс для взаимодействия с провайдером Acytoo и получения ответов в виде асинхронного генератора.

**Наследует**:
- `AsyncGeneratorProvider`: Обеспечивает базовую функциональность для асинхронных провайдеров генераторов.

**Атрибуты**:
- `url` (str): URL-адрес API Acytoo (`https://chat.acytoo.com`).
- `working` (bool): Флаг, указывающий на работоспособность провайдера (в данном случае `False`).
- `supports_message_history` (bool): Флаг, указывающий на поддержку истории сообщений (в данном случае `True`).
- `supports_gpt_35_turbo` (bool): Флаг, указывающий на поддержку модели `gpt-3.5-turbo` (в данном случае `True`).

**Принцип работы**:
Класс `Acytoo` предоставляет интерфейс для отправки запросов к API Acytoo и получения ответов в виде асинхронного генератора. Он использует `aiohttp.ClientSession` для отправки асинхронных HTTP-запросов.

**Методы**:
- `create_async_generator`: Создает асинхронный генератор для взаимодействия с API Acytoo.

## Методы класса

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    proxy: str = None,
    **kwargs
) -> AsyncResult:
    """
    Создает асинхронный генератор для взаимодействия с API Acytoo.

    Args:
        cls (Acytoo): Ссылка на класс `Acytoo`.
        model (str): Название модели, используемой для генерации текста (в данном случае всегда `gpt-3.5-turbo`).
        messages (Messages): Список сообщений для отправки в API.
        proxy (str, optional): URL-адрес прокси-сервера. По умолчанию `None`.
        **kwargs: Дополнительные аргументы для передачи в API.

    Returns:
        AsyncResult: Асинхронный генератор, возвращающий части ответа от API Acytoo.

    Raises:
        aiohttp.ClientResponseError: Если возникает ошибка при отправке запроса или получении ответа от API.

    Как работает функция:
    - Создает асинхронную HTTP-сессию с использованием `aiohttp.ClientSession`.
    - Формирует заголовок запроса с помощью функции `_create_header`.
    - Формирует полезную нагрузку запроса с помощью функции `_create_payload`, передавая список сообщений и дополнительные аргументы.
    - Отправляет POST-запрос к API Acytoo по адресу `f'{cls.url}/api/completions'`.
    - Обрабатывает ответ от API, итерируясь по содержимому ответа в виде потока данных.
    - Декодирует каждый чанк данных и возвращает его в виде части ответа через `yield`.
    """
    ...
```

## Функции

### `_create_header`

```python
def _create_header():
    """
    Создает заголовок запроса.

    Returns:
        dict: Словарь с заголовками запроса.

    Как работает функция:
    - Возвращает словарь с заголовками `accept` и `content-type`.
    """
    ...
```

### `_create_payload`

```python
def _create_payload(messages: Messages, temperature: float = 0.5, **kwargs):
    """
    Создает полезную нагрузку запроса.

    Args:
        messages (Messages): Список сообщений для отправки в API.
        temperature (float, optional): Температура модели. По умолчанию 0.5.
        **kwargs: Дополнительные аргументы для передачи в API.

    Returns:
        dict: Словарь с полезной нагрузкой запроса.

    Как работает функция:
    - Возвращает словарь с параметрами запроса, такими как `key`, `model`, `messages`, `temperature` и `password`.
    """
    ...