# Модуль `BackendApi.py`

## Обзор

Модуль `BackendApi.py` содержит класс `BackendApi`, который используется для взаимодействия с API бэкенда для создания асинхронных генераторов. Этот класс предназначен для отправки запросов к API, получения ответов в виде потока данных и обработки этих данных. Он поддерживает отправку сообщений и медиа-файлов.

## Детали

Модуль предоставляет функциональность для асинхронного взаимодействия с API, поддерживая потоковую передачу данных. Это позволяет обрабатывать большие объемы данных без полной загрузки в память, что особенно полезно при работе с медиа-контентом. Класс `BackendApi` наследуется от `AsyncGeneratorProvider` и `ProviderModelMixin`, что позволяет ему использовать функциональность асинхронных генераторов и моделей провайдеров.

## Классы

### `BackendApi`

**Описание**: Класс `BackendApi` предназначен для взаимодействия с API бэкенда и создания асинхронных генераторов для обработки данных, получаемых в виде потока.

**Наследует**:
- `AsyncGeneratorProvider`: Предоставляет базовую функциональность для асинхронных генераторов.
- `ProviderModelMixin`: Предоставляет функциональность для работы с моделями провайдеров.

**Атрибуты**:
- `ssl` (None): Указывает, использовать ли SSL. По умолчанию `None`.
- `headers` (dict): Заголовки HTTP-запроса. По умолчанию пустой словарь `{}`.

**Методы**:
- `create_async_generator()`: Создает асинхронный генератор для получения ответов от API.

### `create_async_generator`

```python
    @classmethod
    async def create_async_generator(
        cls,
        model: str,
        messages: Messages,
        media: MediaListType = None,
        api_key: str = None,
        **kwargs
    ) -> AsyncResult:
        """Создает асинхронный генератор для получения ответов от API.

        Args:
            cls (BackendApi): Ссылка на класс `BackendApi`.
            model (str): Название модели, используемой для генерации ответов.
            messages (Messages): Список сообщений для отправки в API.
            media (MediaListType, optional): Список медиа-файлов для отправки в API. По умолчанию `None`.
            api_key (str, optional): Ключ API для аутентификации. По умолчанию `None`.
            **kwargs: Дополнительные аргументы для отправки в API.

        Returns:
            AsyncResult: Асинхронный генератор, возвращающий объекты `RawResponse`.

        Как работает функция:
        - Логирует информацию об использовании API-ключа.
        - Преобразует медиа-файлы в формат data URI.
        - Отправляет POST-запрос к API с использованием `StreamSession`.
        - Получает ответы от API в виде потока данных и возвращает объекты `RawResponse`.

        Примеры:
            >>> model = "gpt-3.5-turbo"
            >>> messages = [{"role": "user", "content": "Hello, world!"}]
            >>> async for response in BackendApi.create_async_generator(model=model, messages=messages):
            ...     print(response)
        """
```

## Параметры Класса

- `ssl`: Определяет, нужно ли использовать SSL для подключения к API.
- `headers`: HTTP-заголовки, используемые при отправке запросов.

## Параметры Метода `create_async_generator`

- `model` (str): Имя используемой модели.
- `messages` (Messages): Список сообщений, отправляемых в API.
- `media` (MediaListType, optional): Список медиа-файлов для отправки. По умолчанию `None`.
- `api_key` (str, optional): Ключ API для аутентификации. По умолчанию `None`.
- `**kwargs`: Дополнительные аргументы, передаваемые в API.