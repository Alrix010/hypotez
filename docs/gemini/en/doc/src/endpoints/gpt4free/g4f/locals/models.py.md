# Модуль для загрузки и форматирования моделей GPT4Free

## Обзор

Модуль `models.py` предназначен для загрузки, форматирования и хранения информации о моделях, используемых в проекте `hypotez`. Он обеспечивает получение списка доступных моделей, их сохранение в локальном файле и чтение из него.

## Детали

Модуль содержит функции для получения списка моделей с удаленного ресурса, форматирования этих данных и сохранения их в локальный файл `models.json`. При отсутствии файла с моделями производится его загрузка с удаленного ресурса, сохранение и последующее чтение.

## Функции

### `load_models`

```python
def load_models() -> dict:
    """
    Функция загружает список моделей с удаленного ресурса.

    Returns:
        dict: Возвращает словарь с информацией о моделях.

    Raises:
        requests.exceptions.HTTPError: Если HTTP-запрос завершается с ошибкой.

    Как работает:
    - Отправляет GET-запрос к адресу "https://gpt4all.io/models/models3.json".
    - Вызывает функцию `raise_for_status` для проверки статуса ответа.
    - Форматирует полученные данные с помощью функции `format_models`.

    Пример:
        >>> models = load_models()
        >>> print(type(models))
        <class 'dict'>
    """
```

### `get_model_name`

```python
def get_model_name(filename: str) -> str:
    """
    Функция извлекает имя модели из имени файла.

    Args:
        filename (str): Имя файла модели.

    Returns:
        str: Возвращает имя модели без расширения и версий.

    Как работает:
    - Разделяет имя файла по первому вхождению точки (`.`).
    - Последовательно удаляет из имени различные суффиксы, такие как "-v1_5", "-v1", "-q4_0", "_v01", "-v0", "-f16", "-gguf2", "-newbpe".

    Пример:
        >>> get_model_name("gpt4all-j-v1.3-groovy.bin")
        'gpt4all-j-groovy'
    """
```

### `format_models`

```python
def format_models(models: list) -> dict:
    """
    Функция форматирует список моделей в словарь.

    Args:
        models (list): Список моделей.

    Returns:
        dict: Возвращает словарь, где ключом является имя модели, а значением - информация о модели.

    Как работает:
    - Для каждой модели в списке извлекает имя файла, требуемый объем оперативной памяти (`ramrequired`), шаблон промпта (`promptTemplate`) и системный промпт (`systemPrompt`).
    - Формирует словарь, где ключом является имя модели (полученное через функцию `get_model_name`), а значением - словарь с информацией о модели.

    Пример:
        >>> models = [{"filename": "gpt4all-j-v1.3-groovy.bin", "ramrequired": "8 GB", "promptTemplate": "<prompt>", "systemPrompt": "<system>"}]
        >>> formatted_models = format_models(models)
        >>> print(formatted_models)
        {'gpt4all-j-groovy': {'path': 'gpt4all-j-v1.3-groovy.bin', 'ram': '8 GB', 'prompt': '<prompt>', 'system': '<system>'}}
    """
```

### `read_models`

```python
def read_models(file_path: str) -> dict:
    """
    Функция читает данные о моделях из файла.

    Args:
        file_path (str): Путь к файлу с данными о моделях.

    Returns:
        dict: Возвращает словарь с данными о моделях.

    Как работает:
    - Открывает файл по указанному пути в бинарном режиме для чтения.
    - Загружает JSON-данные из файла.

    Пример:
        >>> file_path = "models/models.json"
        >>> models = read_models(file_path)
        >>> print(type(models))
        <class 'dict'>
    """
```

### `save_models`

```python
def save_models(file_path: str, data: dict) -> None:
    """
    Функция сохраняет данные о моделях в файл.

    Args:
        file_path (str): Путь к файлу для сохранения данных.
        data (dict): Данные для сохранения.

    Returns:
        None

    Как работает:
    - Открывает файл по указанному пути для записи.
    - Записывает JSON-данные в файл с отступами для читаемости.

    Пример:
        >>> file_path = "models/models.json"
        >>> data = {"model1": {"path": "path1"}, "model2": {"path": "path2"}}
        >>> save_models(file_path, data)
    """
```

### `get_model_dir`

```python
def get_model_dir() -> str:
    """
    Функция определяет и возвращает путь к директории с моделями.

    Returns:
        str: Возвращает путь к директории с моделями.

    Как работает:
    - Определяет абсолютный путь к текущему файлу.
    - Определяет путь к родительской директории (директории проекта).
    - Формирует путь к директории `models` внутри директории проекта.
    - Если директория не существует, создает её.

    Пример:
        >>> model_dir = get_model_dir()
        >>> print(model_dir)
        '/path/to/project/models'
    """
```

### `get_models`

```python
def get_models() -> dict[str, dict]:
    """
    Функция возвращает словарь с моделями.

    Returns:
        dict[str, dict]: Возвращает словарь, где ключом является имя модели, а значением - информация о модели.

    Как работает:
    - Определяет путь к файлу `models.json` в директории с моделями.
    - Если файл существует, читает данные из файла с помощью функции `read_models`.
    - Если файл не существует, загружает данные с удаленного ресурса с помощью функции `load_models`, сохраняет их в файл с помощью функции `save_models` и возвращает полученные данные.

    Пример:
        >>> models = get_models()
        >>> print(type(models))
        <class 'dict'>
    """