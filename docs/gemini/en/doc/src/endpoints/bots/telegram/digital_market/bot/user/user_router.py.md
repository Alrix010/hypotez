# Модуль `user_router`

## Обзор

Модуль `user_router` предназначен для обработки пользовательских взаимодействий в Telegram-боте цифрового рынка. Он определяет маршруты для обработки команд `/start`, кнопок главного меню (`home`, `about`, `my_profile`, `purchases`) и реализует логику регистрации новых пользователей, отображения информации о магазине, профиле пользователя и истории покупок.

## Подробнее

Модуль содержит обработчики для различных пользовательских действий, таких как:

- Обработка команды `/start` для регистрации и приветствия пользователя.
- Переход на главную страницу.
- Отображение информации о магазине.
- Отображение профиля пользователя с статистикой покупок.
- Отображение списка покупок пользователя.

## Классы

В данном модуле классы отсутствуют.

## Функции

### `cmd_start`

```python
async def cmd_start(message: Message, session_with_commit: AsyncSession):
    """ Функция обрабатывает команду `/start`.

    Args:
        message (Message): Объект сообщения от Telegram.
        session_with_commit (AsyncSession): Сессия базы данных с возможностью коммита.

    Returns:
        None

    Raises:
        Нет.

    Как работает функция:
    - Извлекает `user_id` из объекта `message`.
    - Ищет информацию о пользователе в базе данных по `telegram_id`.
    - Если пользователь найден, приветствует его и отправляет главное меню.
    - Если пользователь не найден, создает новую запись в базе данных и отправляет приветственное сообщение с главным меню.
    """
```

### `page_home`

```python
async def page_home(call: CallbackQuery):
    """ Функция обрабатывает нажатие на кнопку "Домой".

    Args:
        call (CallbackQuery): Объект обратного вызова от Telegram.

    Returns:
        None

    Raises:
        Нет.

    Как работает функция:
    - Отвечает на обратный вызов с текстом "Главная страница".
    - Отправляет приветственное сообщение с главным меню.
    """
```

### `page_about`

```python
async def page_about(call: CallbackQuery):
    """ Функция обрабатывает нажатие на кнопку "О магазине".

    Args:
        call (CallbackQuery): Объект обратного вызова от Telegram.

    Returns:
        None

    Raises:
        Нет.

    Как работает функция:
    - Отвечает на обратный вызов с текстом "О магазине".
    - Отправляет сообщение с информацией о магазине.
    """
```

### `page_about`

```python
async def page_about(call: CallbackQuery, session_without_commit: AsyncSession):
    """ Функция обрабатывает нажатие на кнопку "Мой профиль".

    Args:
        call (CallbackQuery): Объект обратного вызова от Telegram.
        session_without_commit (AsyncSession): Сессия базы данных без возможности коммита.

    Returns:
        None

    Raises:
        Нет.

    Как работает функция:
    - Отвечает на обратный вызов с текстом "Профиль".
    - Получает статистику покупок пользователя из базы данных.
    - Формирует сообщение с информацией о количестве покупок и общей сумме.
    - Если покупок нет, отправляет сообщение об отсутствии покупок.
    """
```

### `page_user_purchases`

```python
async def page_user_purchases(call: CallbackQuery, session_without_commit: AsyncSession):
    """ Функция обрабатывает нажатие на кнопку "Мои покупки".

    Args:
        call (CallbackQuery): Объект обратного вызова от Telegram.
        session_without_commit (AsyncSession): Сессия базы данных без возможности коммита.

    Returns:
        None

    Raises:
        Exception: Если не удается удалить предыдущее сообщение.

    Как работает функция:
    - Отвечает на обратный вызов с текстом "Мои покупки".
    - Пытается удалить предыдущее сообщение пользователя.
    - Получает список покупок пользователя из базы данных.
    - Если покупок нет, отправляет сообщение об отсутствии покупок.
    - Для каждой покупки отправляет информацию о товаре, включая название, описание, цену и закрытое описание.
    - Если у товара есть файл, отправляет файл с информацией о товаре.
    - Отправляет благодарственное сообщение.
    """