# Модуль: Обновление таблицы покупок

## Обзор

Этот модуль содержит скрипт миграции базы данных Alembic, который добавляет столбец `payment_type` в таблицу `purchases` и создает уникальное ограничение для столбца `payment_id`. Он используется для обновления схемы базы данных при изменении структуры данных.

## Более подробная информация

Этот файл является частью системы миграции базы данных Alembic, которая позволяет автоматически и безопасно изменять схему базы данных. В данном случае скрипт добавляет новый столбец `payment_type` в таблицу `purchases`, а также создает уникальное ограничение для столбца `payment_id`. Эти изменения необходимы для поддержки новых требований к данным о покупках.

## Функции

### `upgrade`

**Назначение**: Обновляет схему базы данных, добавляя столбец `payment_type` в таблицу `purchases` и создавая уникальное ограничение для столбца `payment_id`.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- `None`

**Как работает функция**:
- Функция `upgrade` использует операции Alembic для изменения схемы базы данных.
- `op.add_column` добавляет новый столбец `payment_type` типа `String` в таблицу `purchases`.  Параметр `nullable=False` указывает, что столбец не может содержать `NULL` значения.
- `op.create_unique_constraint` создает уникальное ограничение для столбца `payment_id` в таблице `purchases`.

**Примеры**:
```python
# Пример вызова функции upgrade
upgrade()
```

### `downgrade`

**Назначение**: Отменяет изменения, внесенные функцией `upgrade`, удаляя столбец `payment_type` и уникальное ограничение для столбца `payment_id` из таблицы `purchases`.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- `None`

**Как работает функция**:
- Функция `downgrade` использует операции Alembic для отмены изменений, внесенных функцией `upgrade`.
- `op.drop_constraint` удаляет уникальное ограничение для столбца `payment_id` из таблицы `purchases`. Параметр `type_='unique'` указывает, что удаляется именно уникальное ограничение.
- `op.drop_column` удаляет столбец `payment_type` из таблицы `purchases`.

**Примеры**:
```python
# Пример вызова функции downgrade
downgrade()