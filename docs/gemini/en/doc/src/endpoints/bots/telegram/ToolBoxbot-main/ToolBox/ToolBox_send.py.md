# Документация для `ToolBox_send.py`

## Обзор

Этот файл (`ToolBox_send.py`) предназначен для рассылки сообщений пользователям Telegram-бота с использованием промокода. Он подключается к базе данных SQLite для получения списка пользователей и отправляет им сообщения через Telegram Bot API.

## Более подробная информация

Скрипт выполняет следующие действия:

1.  Импортирует необходимые библиотеки: `telebot`, `sqlite3` и `os`.
2.  Загружает переменные окружения из файла `.env` с использованием `load_dotenv()`.
3.  Инициализирует Telegram-бота с использованием токена, полученного из переменной окружения `TOKEN`.
4.  Подключается к базе данных SQLite `UsersData.db`.
5.  Извлекает идентификаторы пользователей из таблицы `users_data_table`, у которых промокод не равен 1.
6.  Перебирает полученные идентификаторы пользователей и отправляет им сообщение с информацией о промокоде.
7.  Обрабатывает возможные исключения при отправке сообщений и логирует результаты отправки.

## Функции

### `send_message_to_users`

```python
def send_message_to_users():
    """ Функция выполняет рассылку сообщений пользователям Telegram-бота с информацией о промокоде.

    Args:
        Нет аргументов.

    Returns:
        None

    Raises:
        telebot.apihelper.ApiException: Если возникает ошибка при отправке сообщения пользователю.
        sqlite3.Error: Если возникает ошибка при работе с базой данных.

    Пример:
        >>> send_message_to_users()
    """
```

**Как работает функция**:

1.  **Подключение к базе данных**: Устанавливает соединение с базой данных SQLite `UsersData.db` и создает курсор для выполнения SQL-запросов.
2.  **Извлечение пользователей**: Выполняет SQL-запрос для получения идентификаторов пользователей из таблицы `users_data_table`, у которых значение поля `promocode` не равно 1. Результат запроса сохраняется в переменной `users`.
3.  **Рассылка сообщений**: Перебирает идентификаторы пользователей, полученные из базы данных. Для каждого пользователя пытается отправить сообщение с информацией о промокоде. Использует `bot.send_message` для отправки сообщения в HTML-формате.
4.  **Обработка исключений**: Если при отправке сообщения возникает исключение (например, пользователь заблокировал бота), оно перехватывается. В случае успеха или ошибки отправки в консоль выводится соответствующая информация.
5.  **Закрытие соединения с базой данных**: После завершения рассылки сообщений закрывает соединение с базой данных.

**Примеры**:

```python
# Пример вызова функции
send_message_to_users()