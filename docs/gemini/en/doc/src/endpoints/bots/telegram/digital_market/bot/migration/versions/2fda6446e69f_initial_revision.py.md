# Модуль для миграции базы данных Telegram-бота Digital Market: Начальная ревизия

## Обзор

Модуль содержит определение начальной ревизии базы данных для Telegram-бота Digital Market. Он использует Alembic для управления миграциями базы данных, включая создание таблиц `categories`, `users`, `products` и `purchases`.

## Детали

Этот модуль предназначен для инициализации структуры базы данных, необходимой для функционирования Telegram-бота Digital Market. Он создает таблицы для категорий, пользователей, товаров и покупок, а также устанавливает необходимые ограничения и внешние ключи.

## Содержание

- [Переменные](#переменные)
- [Функции](#функции)
  - [`upgrade`](#upgrade)
  - [`downgrade`](#downgrade)

## Переменные

- `revision` (str): Идентификатор текущей ревизии: `'2fda6446e69f'`.
- `down_revision` (Union[str, None]): Идентификатор предыдущей ревизии: `'47f559ec82bb'`.
- `branch_labels` (Union[str, Sequence[str], None]): Метки ветвей (в данном случае `None`).
- `depends_on` (Union[str, Sequence[str], None]): Зависимости ревизии (в данном случае `None`).

## Функции

### `upgrade`

```python
def upgrade() -> None:
    """
    Выполняет обновление базы данных до текущей ревизии.
    """
```

**Назначение**:
Функция `upgrade` выполняет операции по созданию таблиц в базе данных, необходимые для работы Telegram-бота Digital Market.

**Как работает**:
Функция использует `alembic.op` для выполнения следующих действий:
- Создает таблицу `categories` с полями:
    - `category_name` (Text): Название категории (не может быть `NULL`).
    - `id` (Integer): Уникальный идентификатор категории (автоинкрементный, первичный ключ).
    - `created_at` (TIMESTAMP): Дата и время создания записи (по умолчанию текущая временная метка).
    - `updated_at` (TIMESTAMP): Дата и время обновления записи (по умолчанию текущая временная метка).
- Создает таблицу `users` с полями:
    - `telegram_id` (BigInteger): Уникальный идентификатор пользователя в Telegram (не может быть `NULL`, уникальное ограничение).
    - `username` (String): Имя пользователя в Telegram (может быть `NULL`).
    - `first_name` (String): Имя пользователя (может быть `NULL`).
    - `last_name` (String): Фамилия пользователя (может быть `NULL`).
    - `id` (Integer): Уникальный идентификатор пользователя (автоинкрементный, первичный ключ).
    - `created_at` (TIMESTAMP): Дата и время создания записи (по умолчанию текущая временная метка).
    - `updated_at` (TIMESTAMP): Дата и время обновления записи (по умолчанию текущая временная метка).
- Создает таблицу `products` с полями:
    - `name` (Text): Название товара (не может быть `NULL`).
    - `description` (Text): Описание товара (не может быть `NULL`).
    - `price` (Integer): Цена товара (не может быть `NULL`).
    - `file_id` (Text): Идентификатор файла товара (может быть `NULL`).
    - `category_id` (Integer): Идентификатор категории товара (не может быть `NULL`, внешний ключ к таблице `categories`).
    - `id` (Integer): Уникальный идентификатор товара (автоинкрементный, первичный ключ).
    - `created_at` (TIMESTAMP): Дата и время создания записи (по умолчанию текущая временная метка).
    - `updated_at` (TIMESTAMP): Дата и время обновления записи (по умолчанию текущая временная метка).
- Создает таблицу `purchases` с полями:
    - `user_id` (Integer): Идентификатор пользователя, совершившего покупку (не может быть `NULL`, внешний ключ к таблице `users`).
    - `product_id` (Integer): Идентификатор купленного товара (не может быть `NULL`, внешний ключ к таблице `products`).
    - `price` (Integer): Цена товара на момент покупки (не может быть `NULL`).
    - `id` (Integer): Уникальный идентификатор покупки (автоинкрементный, первичный ключ).
    - `created_at` (TIMESTAMP): Дата и время создания записи (по умолчанию текущая временная метка).
    - `updated_at` (TIMESTAMP): Дата и время обновления записи (по умолчанию текущая временная метка).

**Примеры**:
Примеры вызова функции `upgrade` отсутствуют, так как она вызывается автоматически Alembic при выполнении миграции.

### `downgrade`

```python
def downgrade() -> None:
    """
    Выполняет откат базы данных до предыдущей ревизии.
    """
```

**Назначение**:
Функция `downgrade` выполняет операции по удалению таблиц из базы данных, чтобы откатить ее до предыдущей ревизии.

**Как работает**:
Функция использует `alembic.op` для выполнения следующих действий:
- Удаляет таблицу `purchases`.
- Удаляет таблицу `products`.
- Удаляет таблицу `users`.
- Удаляет таблицу `categories`.

**Примеры**:
Примеры вызова функции `downgrade` отсутствуют, так как она вызывается автоматически Alembic при выполнении отката миграции.