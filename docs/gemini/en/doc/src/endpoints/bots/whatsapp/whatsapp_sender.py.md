# Модуль для отправки сообщений в WhatsApp

## Обзор

Этот модуль предназначен для автоматической отправки сообщений в WhatsApp с использованием библиотеки `pywhatkit` и `pyautogui`. Он позволяет отправлять заданное количество сообщений на указанный номер телефона в случайное время в заданном интервале часов.

## Подробнее

Модуль использует библиотеку `pywhatkit` для отправки сообщений через веб-интерфейс WhatsApp. `pyautogui` используется для эмуляции нажатия клавиши Enter, чтобы отправить сообщение. Модуль также использует библиотеку `emoji` для добавления эмодзи в сообщения.

## Функции

### `send_whatsapp_message`

```python
def send_whatsapp_message(phone_number, message, hour, minutes):
    """Отправляет сообщение WhatsApp с использованием pywhatkit и pyautogui.

    Args:
        phone_number (str): Номер телефона получателя с кодом страны.
        message (str): Текст сообщения для отправки.
        hour (int): Час отправки сообщения (0-23).
        minutes (int): Минута отправки сообщения (0-59).

    Raises:
        Exception: Если возникает ошибка при отправке сообщения.

    """
```

**Как работает функция:**

1.  Функция `send_whatsapp_message` принимает номер телефона, сообщение, час и минуты в качестве аргументов.
2.  Она использует `pywhatkit.sendwhatmsg` для отправки сообщения в указанное время. Параметр `wait_time` устанавливает время ожидания загрузки веб-интерфейса WhatsApp. `tab_close=True` указывает на необходимость закрытия вкладок.
3.  После отправки сообщения функция ждет 20 секунд для загрузки веб-интерфейса WhatsApp.
4.  Затем используется библиотека `pynput.keyboard` для эмуляции нажатия клавиши Enter, чтобы отправить сообщение.
5.  Если во время отправки сообщения возникает ошибка, она перехватывается, и в консоль выводится сообщение об ошибке.

**Примеры:**

```python
send_whatsapp_message("+79991234567", "Привет! Как дела?", 10, 30)
```

## Переменные

### `messages`

```python
messages = [
    "Hello! How are you? :slightly_smiling_face:",
    "Thinking of you! :heart:",
    "Just wanted to say hi! :waving_hand:",
    "I love you :heart_exclamation:",
    emoji.emojize("Have a wonderful day! :sun:")
]
```

**Описание:**

`messages` - это список строк, содержащий набор сообщений с эмодзи для случайной отправки. Используется библиотека `emoji` для преобразования текстовых представлений эмодзи в соответствующие символы.

## Основной цикл отправки сообщений

1.  Запрашивается номер телефона у пользователя с кодом страны.
2.  Запрашивается количество сообщений для отправки.
3.  Запрашивается начальный и конечный час отправки сообщений.
4.  В цикле, пока количество отправленных сообщений меньше заданного, генерируется случайный час и минута в заданном интервале.
5.  Случайным образом выбирается сообщение из списка `messages`.
6.  Вызывается функция `send_whatsapp_message` для отправки сообщения.
7.  Увеличивается счетчик отправленных сообщений.

**Пример использования:**

```python
# Запрос пользовательского ввода
phone_number = input("Введите номер телефона с кодом страны: ")
num_messages = int(input("Введите количество сообщений для отправки: "))
start_hour = int(input("Введите начальный час (0-23): "))
end_hour = int(input("Введите конечный час (0-23): "))

message_count = 0
while message_count < num_messages:
    random_hour = random.randint(start_hour, end_hour)
    random_minutes = random.randint(0, 59)
    random_message = random.choice(messages)

    send_whatsapp_message(phone_number, random_message, random_hour, random_minutes)
    message_count += 1