# Автоматизированная отправка сообщений WhatsApp

В этом документе описывается процесс создания скрипта на языке Python для автоматической отправки сообщений WhatsApp. Предоставляется информация о необходимых компонентах, процессе разработки, возможных проблемах и решениях.

## Содержание

1.  [Введение](#введение)
2.  [Необходимые компоненты](#необходимые-компоненты)
3.  [Процесс разработки](#процесс-разработки)
    *   [Функция отправки сообщений (`send_whatsapp_message`)](#функция-отправки-сообщений-send_whatsapp_message)
    *   [Банк сообщений](#банк-сообщений)
    *   [Пользовательский ввод](#пользовательский-ввод)
    *   [Основной цикл отправки](#основной-цикл-отправки)
4.  [Возможные проблемы и решения](#возможные-проблемы-и-решения)
5.  [Код (пример)](#код-пример)
6.  [Выполнение скрипта](#выполнение-скрипта)

## Введение

### Назначение

В этом документе описывается процесс разработки автоматизированного скрипта на языке Python, предназначенного для отправки случайных сообщений WhatsApp в течение определенного периода времени.

### Целевая аудитория

Это руководство предназначено для разработчиков, имеющих базовые знания языка Python и понимание работы с командной строкой.

### Предпосылки

Перед использованием этого руководства необходимо установить Python 3.6+ и менеджер пакетов `pip`.

## Необходимые компоненты

### Библиотеки Python

*   `pywhatkit`: Для взаимодействия с веб-версией WhatsApp и отправки сообщений.
*   `pyautogui`: Для автоматизации действий мыши и клавиатуры.
*   `pynput`: Для контроля клавиатурного ввода.
*   `emoji`: Для добавления эмодзи в сообщения.
*   `random`: Для генерации случайных сообщений и времени.
*   `time`: Для управления задержками и временем выполнения.

### Зависимости

Установка указанных библиотек выполняется посредством `pip`:

```bash
pip install pywhatkit pyautogui pynput emoji
```

### Требования к системе

Операционная система с установленным веб-браузером (например, Chrome или Firefox) и возможностью подключения к WhatsApp Web.

## Процесс разработки

### Функция отправки сообщений (`send_whatsapp_message`)

Функция отправляет сообщение WhatsApp с использованием указанных параметров.

**Аргументы:**

*   `phone_number` (str): Номер телефона получателя (с кодом страны).
*   `message` (str): Текст сообщения.
*   `hour` (int): Час отправки сообщения (0-23).
*   `minutes` (int): Минуты отправки сообщения (0-59).

**Реализация:**

1.  Использование `pywhatkit.sendwhatmsg` для инициализации отправки сообщения.
2.  Применение `time.sleep` для задержки загрузки веб-версии WhatsApp.
3.  Применение `pyautogui` и `pynput` для имитации нажатия клавиши "Enter" для отправки сообщения.
4.  Обработка исключений с помощью блока `try...except` для вывода ошибок.

### Банк сообщений

Создание списка строк (`messages`) для хранения сообщений. Использование `emoji.emojize` для добавления эмодзи. Применение `random.choice` для случайного выбора сообщения.

### Пользовательский ввод

Получение количества сообщений (`num_messages`) с помощью функции `input`. Получение начального часа (`start_hour`) и конечного часа (`end_hour`) диапазона отправки с помощью `input`.

### Основной цикл отправки

Цикл `while` выполняется, пока счетчик сообщений (`message_count`) не достигнет заданного количества (`num_messages`). Генерация случайного часа и минут с помощью `random.randint`. Вызов функции `send_whatsapp_message` с полученными данными. Увеличение счетчика сообщений.

## Возможные проблемы и решения

*   **Проблемы с `pywhatkit`:** В случае неудачной автоматической отправки сообщения, использовать `pyautogui` и `pynput` для эмуляции нажатия клавиш и отправки сообщения.
*   **Подключение к WhatsApp Web:** При первом использовании необходимо подключение к веб-версии WhatsApp через веб-браузер.
*   **Динамическая задержка:** Скорость загрузки веб-версии WhatsApp может меняться, поэтому для стабильности увеличьте время задержки.
*   **Зависимость от браузера и версии WhatsApp:** Изменения в браузере или веб-версии WhatsApp могут потребовать корректировки скрипта.

## Код (пример)

```python
# ... (Код ) ...
```

## Выполнение скрипта

*   Сохраните скрипт в файл с расширением `.py`.
*   Выполните скрипт в терминале с помощью команды: `python имя_файла.py`
*   Следуйте инструкциям на экране для ввода необходимых данных.