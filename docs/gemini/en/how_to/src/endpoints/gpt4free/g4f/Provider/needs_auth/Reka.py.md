**Instructions for Generating Code Documentation**

1. **Analyze the Code**: Understand the logic and actions performed by the code snippet.

2. **Create a Step-by-Step Guide**:
    - **Description**: Explain what the code block does.
    - **Execution Steps**: Describe the sequence of actions in the code.
    - **Usage Example**: Provide a code example of how to use the snippet in the project.

3. **Example**:

How to Use This Code Block
========================================================================================

Description
-------------------------
The `Reka` class provides a mechanism for interacting with the Reka.ai API to generate text completions and upload images. It handles authentication, conversation history, and stream responses.

Execution Steps
-------------------------
1. **Initialization**: The class is initialized with basic information about the provider, including the domain, URL, and authentication requirements.
2. **Authentication**: 
    - If an API key is not provided, the class retrieves cookies from the user's browser and attempts to extract an access token from the cookies. 
    - If no cookies are found or the access token is missing, an error is raised, prompting the user to log in or provide an API key.
3. **Conversation History**: The class constructs a conversation history from the provided messages, which includes the message content and type (human or AI).
4. **Image Upload**: If an image is provided, the class uploads the image to the Reka.ai API and updates the conversation history with the image URL and media type.
5. **Completion Generation**: The class sends a POST request to the Reka.ai API with the conversation history, model name, and other parameters.
6. **Stream Handling**: The class iterates through the streamed responses, decoding and yielding each chunk of text. 
7. **Token Management**: The class manages the tokens generated by the API to ensure that each yielded chunk is complete and coherent.

Usage Example
-------------------------

```python
    from hypotez.src.endpoints.gpt4free.g4f.Provider.needs_auth import Reka

    # Initialize the provider
    provider = Reka()

    # Messages to send to the API
    messages = [
        {"role": "user", "content": "Hello, how are you?"},
    ]

    # Generate text completion
    for completion_chunk in provider.create_completion(model="reka", messages=messages, stream=True):
        print(completion_chunk, end='')

    # Upload an image
    image_path = 'path/to/image.jpg'
    image_url = provider.upload_image(api_key='YOUR_API_KEY', image=image_path)
    print(f"Image uploaded successfully: {image_url}")

```

4. **Avoid Vague Terms** like "getting" or "doing". Be specific about what the code does, for example: "checks", "validates", or "sends".