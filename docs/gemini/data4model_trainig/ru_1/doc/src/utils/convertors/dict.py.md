# Модуль для конвертации данных между dict и SimpleNamespace
=================================================================

Модуль содержит функции для рекурсивного преобразования словарей в объекты SimpleNamespace и обратно, а также для экспорта данных в различные форматы.

## Обзор

Модуль `src.utils.convertors.dict` предоставляет набор функций для конвертации данных между различными форматами, такими как словари, объекты `SimpleNamespace`, XML, CSV, JSON, XLS, HTML и PDF. Он включает функции для рекурсивного преобразования словарей в объекты `SimpleNamespace` и обратно, а также для сохранения данных в различных форматах файлов.

## Подробнее

Этот модуль предоставляет инструменты для преобразования и экспорта данных, что может быть полезно при работе с различными источниками данных и форматами файлов. Он включает функции для рекурсивного преобразования словарей в объекты `SimpleNamespace` и обратно, а также для сохранения данных в различных форматах файлов.

## Функции

### `replace_key_in_dict`

**Назначение**: Рекурсивно заменяет ключ в словаре или списке.

**Параметры**:
- `data` (dict | list): Словарь или список, в котором производится замена ключа.
- `old_key` (str): Ключ, который нужно заменить.
- `new_key` (str): Новый ключ.

**Возвращает**:
- `dict`: Обновленный словарь с замененными ключами.

**Как работает функция**:
Функция `replace_key_in_dict` рекурсивно проходит по словарю или списку и заменяет все вхождения `old_key` на `new_key`. Если `data` является словарем, функция перебирает ключи словаря. Если ключ совпадает с `old_key`, он заменяется на `new_key`. Если значением ключа является словарь или список, функция рекурсивно вызывается для этого значения. Если `data` является списком, функция перебирает элементы списка и рекурсивно вызывается для каждого элемента.

**Примеры**:
```python
data = {"old_key": "value"}
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится {"new_key": "value"}

data = {"outer": {"old_key": "value"}}
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится {"outer": {"new_key": "value"}}

data = [{"old_key": "value1"}, {"old_key": "value2"}]
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится [{"new_key": "value1"}, {"new_key": "value2"}]

data = {"outer": [{"inner": {"old_key": "value"}}]}
updated_data = replace_key_in_dict(data, "old_key", "new_key")
# updated_data становится {"outer": [{"inner": {"new_key": "value"}}]}
```

### `dict2pdf`

**Назначение**: Сохраняет данные словаря в PDF-файл.

**Параметры**:
- `data` (dict | SimpleNamespace): Словарь для преобразования в PDF.
- `file_path` (str | Path): Путь к выходному PDF-файлу.

**Как работает функция**:
Функция `dict2pdf` создает PDF-файл из данных словаря. Если `data` является объектом `SimpleNamespace`, он преобразуется в словарь. Затем создается PDF-файл с использованием библиотеки `reportlab`. Функция перебирает элементы словаря и записывает их в PDF-файл. Если места на странице недостаточно, создается новая страница.

### `dict2ns`

**Назначение**: Рекурсивно преобразует словари в объекты `SimpleNamespace`.

**Параметры**:
- `data` (Dict[str, Any] | List[Any]): Данные для преобразования.

**Возвращает**:
- `Any`: Преобразованные данные в виде объекта `SimpleNamespace` или списка объектов `SimpleNamespace`.

**Как работает функция**:
Функция `dict2ns` рекурсивно преобразует словарь в объект `SimpleNamespace`. Если `data` является словарем, функция перебирает элементы словаря. Если значением ключа является словарь, функция рекурсивно вызывается для этого значения. Если значением ключа является список, функция преобразует каждый элемент списка в объект `SimpleNamespace`, если это словарь. Если `data` является списком, функция преобразует каждый элемент списка в объект `SimpleNamespace`, если это словарь.

### `dict2xml`

**Назначение**: Генерирует XML-строку из словаря.

**Параметры**:
- `data` (Dict[str, Any]): Данные для преобразования в XML.
- `encoding` (str, optional): Кодировка данных. По умолчанию `'UTF-8'`.

**Возвращает**:
- `str`: XML-строка, представляющая входной словарь.

**Вызывает исключения**:
- `Exception`: Если предоставлено более одного корневого узла.

**Внутренние функции**:

#### `_process_simple`
**Назначение**: Создает узел для простых типов (int, str).

**Параметры**:
- `doc` (xml.dom.minidom.Document): Объект XML-документа.
- `tag` (str): Имя тега для XML-элемента.
- `tag_value` (Any): Значение тега.

**Возвращает**:
- `xml.dom.minidom.Element`: Узел, представляющий тег и значение.

#### `_process_attr`
**Назначение**: Создает атрибуты для XML-элемента.

**Параметры**:
- `doc` (xml.dom.minidom.Document): Объект XML-документа.
- `attr_value` (Dict[str, Any]): Словарь атрибутов.

**Возвращает**:
- `List[xml.dom.minidom.Attr]`: Список атрибутов для XML-элемента.

#### `_process_complex`
**Назначение**: Создает узлы для сложных типов, таких как списки или словари.

**Параметры**:
- `doc` (xml.dom.minidom.Document): Объект XML-документа.
- `children` (List[Tuple[str, Any]]): Список пар тег-значение.

**Возвращает**:
- `Tuple[List[xml.dom.minidom.Element], List[xml.dom.minidom.Attr]]`: Список дочерних узлов и атрибутов.

#### `_process`
**Назначение**: Генерирует XML DOM-объект для тега и его значения.

**Параметры**:
- `doc` (xml.dom.minidom.Document): Объект XML-документа.
- `tag` (str): Имя тега для XML-элемента.
- `tag_value` (Any): Значение тега.

**Возвращает**:
- `xml.dom.minidom.Element | List[xml.dom.minidom.Element]`: Узел или список узлов для тега и значения.

**Как работает функция**:
Функция `dict2xml` преобразует словарь в XML-строку. Она использует вспомогательные функции для обработки простых и сложных типов данных. Функция `_process_simple` создает XML-узел для простых типов данных, таких как строки, числа и булевы значения. Функция `_process_attr` создает атрибуты для XML-элемента. Функция `_process_complex` создает узлы для сложных типов данных, таких как списки и словари. Функция `_process` выбирает правильную функцию для обработки тега и значения в зависимости от типа данных.

### `dict2csv`

**Назначение**: Сохраняет данные словаря или `SimpleNamespace` в CSV-файл.

**Параметры**:
- `data` (dict | SimpleNamespace): Данные для сохранения в CSV-файл.
- `file_path` (str | Path): Путь к CSV-файлу.

**Возвращает**:
- `bool`: `True`, если файл был успешно сохранен, `False` в противном случае.

**Как работает функция**:
Функция `dict2csv` использует функцию `save_csv_file` из модуля `src.utils.csv` для сохранения данных в CSV-файл.

### `dict2xls`

**Назначение**: Сохраняет данные словаря или `SimpleNamespace` в XLS-файл.

**Параметры**:
- `data` (dict | SimpleNamespace): Данные для сохранения в XLS-файл.
- `file_path` (str | Path): Путь к XLS-файлу.

**Возвращает**:
- `bool`: `True`, если файл был успешно сохранен, `False` в противном случае.

**Как работает функция**:
Функция `dict2xls` использует функцию `save_xls_file` из модуля `src.utils.xls` для сохранения данных в XLS-файл.

### `dict2html`

**Назначение**: Генерирует HTML-таблицу из словаря или объекта `SimpleNamespace`.

**Параметры**:
- `data` (dict | SimpleNamespace): Данные для преобразования в HTML.
- `encoding` (str, optional): Кодировка данных. По умолчанию `'UTF-8'`.

**Возвращает**:
- `str`: HTML-строка, представляющая входной словарь.

**Внутренние функции**:

#### `dict_to_html_table`
**Назначение**: Рекурсивно преобразует словарь в HTML-таблицу.

**Параметры**:
- `data` (dict): Данные словаря для преобразования.
- `depth` (int, optional): Глубина рекурсии, используемая для вложенных таблиц. По умолчанию `0`.

**Возвращает**:
- `str`: HTML-таблица в виде строки.

**Как работает функция**:
Функция `dict2html` преобразует словарь или объект `SimpleNamespace` в HTML-таблицу. Если `data` является объектом `SimpleNamespace`, он преобразуется в словарь. Функция использует рекурсивную функцию `dict_to_html_table` для создания HTML-таблицы из словаря.

### `example_json2xml`

**Назначение**: Пример использования функции `json2xml`.

**Как работает функция**:
Функция `example_json2xml` создает пример JSON-данных и преобразует их в XML с использованием функции `json2xml`. Затем она выводит XML-вывод в консоль.