# Модуль `xml2dict`

## Обзор

Модуль `xml2dict` предоставляет утилиты для преобразования XML данных в словари. Он включает функции для разбора XML строк и преобразования деревьев XML элементов в словарные представления. Модуль предназначен для работы с XML-данными, предоставляя удобный способ доступа к информации, содержащейся в XML-структуре, через словари Python.

## Подробней

Этот модуль содержит функции, которые позволяют преобразовывать XML-данные в формат словаря Python. Это может быть полезно, когда необходимо обрабатывать XML-данные, но при этом удобнее работать со структурой словаря. Модуль включает функции для разбора XML-строк и преобразования деревьев элементов XML в словарные представления.

## Функции

### `_parse_node`

**Назначение**: Преобразует XML-узел в словарь.

**Параметры**:
- `node` (ET.Element): XML-элемент для преобразования.

**Возвращает**:
- `dict | str`: Словарное представление XML-узла или строка, если у узла нет атрибутов или потомков.

**Как работает функция**:
Функция `_parse_node` рекурсивно анализирует XML-узел, преобразуя его атрибуты и дочерние элементы в структуру словаря. Она обрабатывает атрибуты узла, за исключением атрибутов `href` в пространстве имен `http://www.w3.org/1999/xlink`, которые пропускаются. Если у узла есть атрибуты, они сохраняются в словаре под ключом `'attrs'`. Затем функция обрабатывает дочерние элементы узла, рекурсивно вызывая `_parse_node` для каждого из них и сохраняя результаты в словаре. Если у узла нет дочерних элементов, его текстовое содержимое сохраняется в словаре под ключом `'value'`. Если у узла есть только значение (нет атрибутов и дочерних элементов), функция возвращает непосредственно это значение.

**Примеры**:

```python
import xml.etree.ElementTree as ET

xml_string = '<root><element attr1="value1">text</element></root>'
root = ET.fromstring(xml_string)
result = _parse_node(root.find('element'))
print(result)  # Пример вывода: {'attrs': {'attr1': {'value': 'value1', 'xmlns': None}}, 'value': 'text'}

xml_string = '<root><element>text</element></root>'
root = ET.fromstring(xml_string)
result = _parse_node(root.find('element'))
print(result)  # Пример вывода: {'value': 'text'}

xml_string = '<root><element><child>child_text</child></element></root>'
root = ET.fromstring(xml_string)
result = _parse_node(root.find('element'))
print(result)  # Пример вывода: {'child': {'value': 'child_text'}}
```

### `_make_dict`

**Назначение**: Создает новый словарь с тегом и значением.

**Параметры**:
- `tag` (str): Имя тега XML-элемента.
- `value` (any): Значение, связанное с тегом.

**Возвращает**:
- `dict`: Словарь с именем тега в качестве ключа и значением в качестве значения словаря.

**Как работает функция**:
Функция `_make_dict` создает словарь, где ключом является имя тега XML-элемента, а значением - переданное значение. Если имя тега содержит пространство имен (например, `{http://www.w3.org/1999/xlink}href`), функция извлекает пространство имен и сохраняет его вместе со значением в словаре под ключом `'xmlns'`. Это позволяет сохранить информацию о пространстве имен при преобразовании XML в словарь.

**Примеры**:

```python
result = _make_dict('tag', 'value')
print(result)  # Пример вывода: {'tag': 'value'}

result = _make_dict('{http://www.w3.org/1999/xlink}href', 'http://example.com')
print(result)  # Пример вывода: {'href': {'value': 'http://example.com', 'xmlns': 'http://www.w3.org/1999/xlink'}}
```

### `xml2dict`

**Назначение**: Преобразует XML-строку в словарь.

**Параметры**:
- `xml` (str): XML-строка для преобразования.

**Возвращает**:
- `dict`: Словарь, представляющий XML.

**Как работает функция**:
Функция `xml2dict` принимает XML-строку в качестве аргумента, разбирает её с помощью `ET.fromstring` для создания дерева элементов, а затем вызывает функцию `ET2dict` для преобразования дерева элементов в словарь.

**Примеры**:

```python
xml_string = '<root><element>text</element></root>'
result = xml2dict(xml_string)
print(result)  # Пример вывода: {'root': {'element': {'value': 'text'}}}
```

### `ET2dict`

**Назначение**: Преобразует дерево XML-элементов в словарь.

**Параметры**:
- `element_tree` (ET.Element): Дерево XML-элементов.

**Возвращает**:
- `dict`: Словарь, представляющий дерево XML-элементов.

**Как работает функция**:
Функция `ET2dict` принимает дерево XML-элементов в качестве аргумента и вызывает функцию `_make_dict` для преобразования корневого элемента дерева в словарь. Функция использует имя тега корневого элемента в качестве ключа и результат вызова функции `_parse_node` для корневого элемента в качестве значения.

**Примеры**:

```python
import xml.etree.ElementTree as ET

xml_string = '<root><element>text</element></root>'
root = ET.fromstring(xml_string)
result = ET2dict(root)
print(result)  # Пример вывода: {'root': {'element': {'value': 'text'}}}