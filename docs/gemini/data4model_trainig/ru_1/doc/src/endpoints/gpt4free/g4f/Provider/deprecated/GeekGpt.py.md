# Модуль `GeekGpt.py`

## Обзор

Модуль предоставляет класс `GeekGpt`, который является устаревшим провайдером для взаимодействия с API `chat.geekgpt.org`. Он поддерживает модели `gpt-3.5-turbo` и `gpt-4`, а также потоковую передачу данных и историю сообщений.

## Подробней

Этот модуль определяет способ взаимодействия с сервисом GeekGpt для получения ответов от языковых моделей. Он отправляет запросы к API `ai.fakeopen.com` и обрабатывает потоковые ответы, предоставляя результаты по мере их поступления. Важно отметить, что модуль помечен как устаревший (`deprecated`), что может указывать на необходимость его замены или обновления в будущем.

## Классы

### `GeekGpt`

**Описание**: Класс `GeekGpt` является подклассом `AbstractProvider` и предоставляет реализацию для взаимодействия с сервисом GeekGpt.

**Наследует**: `AbstractProvider`

**Атрибуты**:
- `url` (str): URL сервиса GeekGpt (`https://chat.geekgpt.org`).
- `working` (bool): Указывает, работает ли провайдер (в данном случае `False`).
- `supports_message_history` (bool): Указывает, поддерживает ли провайдер историю сообщений (`True`).
- `supports_stream` (bool): Указывает, поддерживает ли провайдер потоковую передачу (`True`).
- `supports_gpt_35_turbo` (bool): Указывает, поддерживает ли провайдер модель `gpt-3.5-turbo` (`True`).
- `supports_gpt_4` (bool): Указывает, поддерживает ли провайдер модель `gpt-4` (`True`).

**Методы**:
- `create_completion`: Создает запрос на завершение текста и обрабатывает ответ от API.

## Методы класса

### `create_completion`

```python
    @classmethod
    def create_completion(
        cls,
        model: str,
        messages: Messages,
        stream: bool,
        **kwargs
    ) -> CreateResult:
        """Создает запрос на завершение текста и обрабатывает ответ от API GeekGpt.

        Args:
            model (str): Название используемой модели. Если не указано, используется `"gpt-3.5-turbo"`.
            messages (Messages): Список сообщений для отправки в API.
            stream (bool): Флаг, указывающий, использовать ли потоковую передачу.
            **kwargs: Дополнительные параметры, такие как `temperature`, `presence_penalty`, `top_p` и `frequency_penalty`.

        Returns:
            CreateResult: Генератор, выдающий фрагменты текста из ответа API.

        Raises:
            RuntimeError: Если возникает ошибка при обработке JSON в ответе API.

        Как работает функция:
        1.  Устанавливает модель по умолчанию, если она не указана.
        2.  Формирует JSON-данные для отправки в API, включая сообщения, модель и параметры.
        3.  Преобразует JSON-данные в строку с использованием `dumps` и указанием разделителей.
        4.  Определяет заголовки запроса, включая токен авторизации и тип контента.
        5.  Отправляет POST-запрос к API `ai.fakeopen.com/v1/chat/completions` с использованием библиотеки `requests`.
        6.  Обрабатывает потоковый ответ от API:
            *   Итерируется по каждой строке ответа.
            *   Проверяет, содержит ли строка `"content"`.
            *   Извлекает JSON-данные из строки, удаляя префикс `"data: "`.
            *   Проверяет, является ли строка сообщением об окончании передачи (`"[DONE]"`).
            *   Извлекает содержимое сообщения из JSON-данных.
            *   Если содержимое присутствует, передает его через yield.
        7.  При возникновении ошибки при обработке JSON, вызывает исключение `RuntimeError` с информацией об ошибке и JSON-данными.

        Внутренние функции:
        - Отсутствуют

        Примеры:
            >>> model = "gpt-3.5-turbo"
            >>> messages = [{"role": "user", "content": "Hello, how are you?"}]
            >>> stream = True
            >>> generator = GeekGpt.create_completion(model=model, messages=messages, stream=stream)
            >>> for chunk in generator:
            ...     print(chunk, end="")
            I'm doing well, thank you for asking. How can I assist you today?
        """
        ...
```

## Параметры класса

- `url` (str): URL-адрес API GeekGpt.
- `working` (bool): Флаг, указывающий, работает ли провайдер.
- `supports_message_history` (bool): Флаг, указывающий, поддерживает ли провайдер историю сообщений.
- `supports_stream` (bool): Флаг, указывающий, поддерживает ли провайдер потоковую передачу.
- `supports_gpt_35_turbo` (bool): Флаг, указывающий, поддерживает ли провайдер модель gpt-3.5-turbo.
- `supports_gpt_4` (bool): Флаг, указывающий, поддерживает ли провайдер модель gpt-4.