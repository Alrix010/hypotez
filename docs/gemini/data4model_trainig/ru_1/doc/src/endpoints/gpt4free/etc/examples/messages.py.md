# Модуль `messages.py`

## Обзор

Модуль `messages.py` предоставляет класс `ConversationHandler`, предназначенный для управления историей разговоров с использованием API g4f. Он позволяет добавлять сообщения пользователя и получать ответы от ассистента, поддерживая контекст беседы.

## Подробней

Этот модуль облегчает взаимодействие с API g4f, предоставляя удобный интерфейс для поддержания истории разговоров. Он может быть использован для создания чат-ботов или других приложений, требующих поддержания контекста беседы.

## Классы

### `ConversationHandler`

**Описание**: Класс для управления историей разговоров и взаимодействия с API g4f.

**Атрибуты**:
- `client`: Экземпляр класса `Client` из модуля `g4f.client`.
- `model` (str): Модель, используемая для генерации ответов (по умолчанию "gpt-4").
- `conversation_history` (list): Список, хранящий историю разговоров в формате словарей.

**Методы**:
- `add_user_message(content)`: Добавляет сообщение пользователя в историю разговоров.
- `get_response()`: Отправляет историю разговоров в API g4f и получает ответ от ассистента.

#### Принцип работы:

1.  **Инициализация**:
    *   При создании экземпляра класса `ConversationHandler` создается клиент `g4f.client.Client()` и задается используемая модель (по умолчанию "gpt-4").
    *   `self.conversation_history` инициализируется как пустой список, предназначенный для хранения истории сообщений.

2.  **Добавление сообщения пользователя**:
    *   Метод `add_user_message(self, content)` добавляет новое сообщение пользователя в `self.conversation_history`.
    *   Сообщение добавляется в виде словаря с ключами `"role": "user"` и `"content": content`.

3.  **Получение ответа**:
    *   Метод `get_response(self)` использует клиент `self.client` для отправки истории сообщений (параметр `messages`) в API `chat.completions.create`.
    *   Полученный ответ анализируется, и извлекается роль и содержание сообщения ассистента.
    *   Сообщение ассистента добавляется в `self.conversation_history` в виде словаря с ключами `"role"` и `"content"`.
    *   Возвращается только текст сообщения ассистента.

## Методы класса

### `__init__(self, model="gpt-4")`

```python
    def __init__(self, model="gpt-4"):
        """
        Инициализирует экземпляр класса ConversationHandler.

        Args:
            model (str): Модель, используемая для генерации ответов (по умолчанию "gpt-4").
        """
        ...
```

**Назначение**: Инициализирует объект `ConversationHandler`, создавая клиента g4f и устанавливая модель.

**Параметры**:
- `model` (str): Модель, используемая для генерации ответов (по умолчанию "gpt-4").

### `add_user_message(self, content)`

```python
    def add_user_message(self, content):
        """
        Добавляет сообщение пользователя в историю разговоров.

        Args:
            content (str): Содержание сообщения пользователя.
        """
        ...
```

**Назначение**: Добавляет сообщение пользователя в историю разговоров.

**Параметры**:
- `content` (str): Содержание сообщения пользователя.

### `get_response(self)`

```python
    def get_response(self):
        """
        Отправляет историю разговоров в API g4f и получает ответ от ассистента.

        Returns:
            str: Содержание сообщения ассистента.
        """
        ...
```

**Назначение**: Получает ответ от ассистента на основе истории разговоров.

**Возвращает**:
- `str`: Содержание сообщения ассистента.

## Примеры

```python
# Пример использования
conversation = ConversationHandler()
conversation.add_user_message("Hello!")
print("Assistant:", conversation.get_response())

conversation.add_user_message("How are you?")
print("Assistant:", conversation.get_response())