# Модуль миграции базы данных: `2fda6446e69f_initial_revision.py`

## Обзор

Модуль содержит скрипт миграции базы данных, используемый Alembic для создания начальной структуры базы данных для Telegram-бота цифрового рынка. Он определяет операции для создания таблиц `categories`, `users`, `products` и `purchases`, а также операции для их удаления при откате миграции.

## Подробней

Этот файл содержит миграцию Alembic, которая определяет структуру базы данных для Telegram-бота цифрового рынка. Он создает таблицы для категорий, пользователей, продуктов и покупок. Alembic используется для управления изменениями схемы базы данных в проекте.

## Классы

В данном модуле классы отсутствуют.

## Функции

### `upgrade`

**Назначение**: Функция выполняет операции по созданию таблиц в базе данных.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют.

**Как работает функция**:

Функция `upgrade` использует объект `op` из библиотеки `alembic` для выполнения операций по созданию таблиц в базе данных. Она создает таблицы `categories`, `users`, `products` и `purchases` с определенными столбцами и ограничениями.

- `op.create_table('categories', ...)`: Создает таблицу `categories` со столбцами `category_name`, `id`, `created_at` и `updated_at`.
- `op.create_table('users', ...)`: Создает таблицу `users` со столбцами `telegram_id`, `username`, `first_name`, `last_name`, `id`, `created_at` и `updated_at`. Устанавливает ограничение уникальности для столбца `telegram_id`.
- `op.create_table('products', ...)`: Создает таблицу `products` со столбцами `name`, `description`, `price`, `file_id`, `category_id`, `id`, `created_at` и `updated_at`. Устанавливает внешний ключ `category_id`, ссылающийся на таблицу `categories`.
- `op.create_table('purchases', ...)`: Создает таблицу `purchases` со столбцами `user_id`, `product_id`, `price`, `id`, `created_at` и `updated_at`. Устанавливает внешние ключи `product_id`, ссылающийся на таблицу `products`, и `user_id`, ссылающийся на таблицу `users`.

**Примеры**:

```python
def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('categories',
    sa.Column('category_name', sa.Text(), nullable=False),
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('created_at', sa.TIMESTAMP(), server_default=sa.text('(CURRENT_TIMESTAMP)'), nullable=False),
    sa.Column('updated_at', sa.TIMESTAMP(), server_default=sa.text('(CURRENT_TIMESTAMP)'), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
```

### `downgrade`

**Назначение**: Функция выполняет операции по удалению таблиц из базы данных.

**Параметры**:
- Отсутствуют.

**Возвращает**:
- `None`

**Вызывает исключения**:
- Отсутствуют.

**Как работает функция**:

Функция `downgrade` использует объект `op` из библиотеки `alembic` для выполнения операций по удалению таблиц из базы данных. Она удаляет таблицы `purchases`, `products`, `users` и `categories`.

- `op.drop_table('purchases')`: Удаляет таблицу `purchases`.
- `op.drop_table('products')`: Удаляет таблицу `products`.
- `op.drop_table('users')`: Удаляет таблицу `users`.
- `op.drop_table('categories')`: Удаляет таблицу `categories`.

**Примеры**:

```python
def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('purchases')
```

## Переменные модуля

- `revision` (str): Идентификатор текущей ревизии миграции.
- `down_revision` (Union[str, None]): Идентификатор предыдущей ревизии миграции.
- `branch_labels` (Union[str, Sequence[str], None]): Метки ветвей, связанные с данной миграцией.
- `depends_on` (Union[str, Sequence[str], None]): Список ревизий, от которых зависит данная миграция.