# Модуль для создания файла SUMMARY.md
## Обзор

Модуль `src.endpoints.hypo69.code_assistant.make_summary` предназначен для автоматического создания файла `SUMMARY.md`, используемого для навигации и организации структуры документации в формате `mdbook`. Он рекурсивно обходит указанную директорию, формируя оглавление на основе найденных `.md` файлов, с возможностью фильтрации по языку (русский или английский).

## Подробнее

Модуль предоставляет функции для подготовки пути к файлу `SUMMARY.md`, рекурсивного обхода директорий и создания файла оглавления с ссылками на документы. Поддерживается фильтрация файлов по языковому признаку, что позволяет создавать отдельные версии документации для разных языков.

## Классы

В данном модуле классы отсутствуют.

## Функции

### `make_summary`

```python
def make_summary(docs_dir: Path, lang: str = 'en') -> None:
    """
    Создает файл SUMMARY.md, рекурсивно обходя папку.

    Args:
        docs_dir (Path): Путь к исходной директории 'src'.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
```

**Назначение**: Создает файл `SUMMARY.md` в указанной директории, используя функцию `_make_summary` для рекурсивного обхода папок и формирования оглавления.

**Параметры**:
- `docs_dir` (Path): Путь к исходной директории, содержащей `.md` файлы.
- `lang` (str, optional): Язык, по которому фильтруются файлы (`'ru'` или `'en'`). По умолчанию `'en'`.

**Возвращает**:
- `None`: Функция ничего не возвращает.

**Как работает функция**:
- Функция формирует путь к файлу `SUMMARY.md` с помощью функции `prepare_summary_path`.
- Создает директорию для файла `SUMMARY.md`, если она не существует.
- Вызывает функцию `_make_summary` для фактического создания и записи содержимого в файл `SUMMARY.md`.

**Примеры**:

```python
from pathlib import Path
#Предположим, что PROJECT_ROOT определен как корень проекта
PROJECT_ROOT = Path(".")  # Укажите текущую директорию в качестве примера
docs_dir = PROJECT_ROOT / 'src'
make_summary(docs_dir, lang='ru')
```

### `_make_summary`

```python
def _make_summary(src_dir: Path, summary_file: Path, lang: str = 'en') -> bool:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
```

**Назначение**: Рекурсивно обходит указанную директорию и создает файл `SUMMARY.md` с перечислением всех `.md` файлов в виде глав.

**Параметры**:
- `src_dir` (Path): Путь к директории с исходными `.md` файлами.
- `summary_file` (Path): Полный путь к файлу `SUMMARY.md`, который будет создан или перезаписан.
- `lang` (str, optional): Язык фильтрации файлов (`'ru'` или `'en'`). По умолчанию `'en'`.

**Возвращает**:
- `bool`: `True`, если файл успешно создан или перезаписан, `False` в случае ошибки.

**Как работает функция**:
- Проверяет, существует ли уже файл `SUMMARY.md`, и, если да, выводит сообщение о его перезаписи.
- Открывает файл `SUMMARY.md` для записи в кодировке UTF-8.
- Записывает заголовок `# Summary` в файл.
- Рекурсивно обходит все `.md` файлы в указанной директории.
- Фильтрует файлы по языку, если указан параметр `lang`.
- Формирует относительный путь к каждому файлу относительно родительской директории `src_dir`.
- Записывает в файл `SUMMARY.md` строку с ссылкой на каждый `.md` файл в формате `-[{path.stem}]({relative_path.as_posix()})`.
- Перехватывает исключения, которые могут возникнуть в процессе записи в файл, и возвращает `False` в случае ошибки.

**Примеры**:

```python
from pathlib import Path

#Предположим, что PROJECT_ROOT определен как корень проекта
PROJECT_ROOT = Path(".")  # Укажите текущую директорию в качестве примера
src_dir = PROJECT_ROOT / 'src'
summary_file = PROJECT_ROOT / 'docs' / 'SUMMARY.md'
result = _make_summary(src_dir, summary_file, lang='ru')
print(f"Файл SUMMARY.md создан: {result}")
```

### `prepare_summary_path`

```python
def prepare_summary_path(src_dir: Path, file_name: str = 'SUMMARY.md') -> Path:
    """
    Формирует путь к файлу, заменяя часть пути 'src' на 'docs' и добавляя имя файла.

    Args:
        src_dir (Path): Исходный путь с 'src'.
        file_name (str): Имя файла, который нужно создать. По умолчанию 'SUMMARY.md'.

    Returns:
        Path: Новый путь к файлу.
    """
```

**Назначение**: Формирует путь к файлу `SUMMARY.md`, заменяя в исходном пути часть `src` на `docs`.

**Параметры**:
- `src_dir` (Path): Исходный путь, содержащий `src`.
- `file_name` (str, optional): Имя файла, которое нужно добавить к пути. По умолчанию `'SUMMARY.md'`.

**Возвращает**:
- `Path`: Новый путь к файлу `SUMMARY.md` в директории `docs`.

**Как работает функция**:
-  Функция использует `PROJECT_ROOT` для определения корня проекта.
-  Формирует новый путь, объединяя корень проекта (`PROJECT_ROOT`), директорию `docs` и имя файла (`file_name`).

**Примеры**:

```python
from pathlib import Path

#Предположим, что PROJECT_ROOT определен как корень проекта
PROJECT_ROOT = Path(".")  # Укажите текущую директорию в качестве примера
src_dir = PROJECT_ROOT / 'src'
summary_file = prepare_summary_path(src_dir)
print(f"Путь к SUMMARY.md: {summary_file}")
```

## Запуск из командной строки

В блоке `if __name__ == '__main__':` реализован парсинг аргументов командной строки, позволяющий запускать модуль как самостоятельную программу.

**Параметры командной строки**:
- `-lang` (str, optional): Язык фильтрации файлов (`'ru'` или `'en'`). По умолчанию `'en'`.
- `src_dir` (str): Путь к исходной директории `src`.

**Пример использования**:

```bash
python make_summary.py -lang ru src
```

Эта команда создаст файл `SUMMARY.md` в директории `docs`, отфильтровав `.md` файлы по русскому языку.