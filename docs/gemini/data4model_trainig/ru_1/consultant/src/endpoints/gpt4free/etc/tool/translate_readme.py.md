### **–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –º–æ–¥—É–ª—è `translate_readme.py`**

=========================================================================================

**–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**:
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º**: 7/10
- **–ü–ª—é—Å—ã**:
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `asyncio` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞.
    - –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è, –ø–µ—Ä–µ–≤–æ–¥–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–∞—Å—Ç–µ–π —Ç–µ–∫—Å—Ç–∞.
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—à–∏–±–æ–∫.
- **–ú–∏–Ω—É—Å—ã**:
    - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ docstring –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π.
    - –ù–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ç–∏–ø–∞–º–∏.
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `print` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–º–µ—Å—Ç–æ `logger`.
    - –ñ—ë—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ `iso`, `language`, `translate_prompt`.
    - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤.
    - –ù–µ –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é**:

1.  **–î–æ–±–∞–≤–∏—Ç—å docstring –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π**:
    - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ docstring –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–µ –µ—ë –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ, –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è.

2.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å logging –≤–º–µ—Å—Ç–æ print**:
    - –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `print` statements –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è `logger` –¥–ª—è –±–æ–ª–µ–µ –≥–∏–±–∫–æ–≥–æ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

3.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π**:
    - –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö —Å–±–æ–µ–≤.

4.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤**:
    - –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.

5.  **–£–±—Ä–∞—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã**:
    - –£–¥–∞–ª–∏—Ç—å –∏–º–ø–æ—Ä—Ç `g4f.debug.logging`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

6.  **–°–¥–µ–ª–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–æ–ª–µ–µ –≥–∏–±–∫–æ–π**:
    - –í—ã–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ `iso`, `language`, `translate_prompt`, `blocklist`, `allowlist`, –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–π.

7.  **–£–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞**:
    - –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤ –∫–æ–¥–∞.

**–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥**:

```python
import asyncio
import sys
from pathlib import Path
from typing import List

sys.path.append(str(Path(__file__).parent.parent.parent))

import g4f
from src.logger import logger

# g4f.debug.logging = True # –£–¥–∞–ª–µ–Ω–æ, —Ç.–∫. –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
from g4f.debug import access_token

provider = g4f.Provider.OpenaiChat

iso: str = 'GE'
language: str = 'german'
translate_prompt: str = f"""
Translate this markdown document to {language}.
Don't translate or change inline code examples.
```md
"""
keep_note: str = 'Keep this: [!Note] as [!Note].\\n'
blocklist: List[str] = [
    '## ¬©Ô∏è Copyright',
    '## üöÄ Providers and Models',
    '## üîó Related GPT4Free Projects'
]
allowlist: List[str] = [
    '### Other',
    '### Models'
]

def read_text(text: str) -> str:
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏–∑ markdown-–±–ª–æ–∫–∞, –Ω–∞—Ö–æ–¥—è—â–µ–≥–æ—Å—è –º–µ–∂–¥—É —Ç–µ–≥–∞–º–∏ ```.

    Args:
        text (str): –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç.

    Returns:
        str: –¢–µ–∫—Å—Ç, –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π –∏–∑ markdown-–±–ª–æ–∫–∞.
    """
    start = end = 0
    new = text.strip().split('\n')
    for i, line in enumerate(new):
        if line.startswith('```'):
            if not start:
                start = i + 1
            end = i
    return '\n'.join(new[start:end]).strip()

async def translate(text: str) -> str:
    """
    –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º g4f.Provider.OpenaiChat.

    Args:
        text (str): –¢–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞.

    Returns:
        str: –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.
    """
    prompt: str = translate_prompt + text.strip() + '\n```'
    if '[!Note]' in text:
        prompt: str = keep_note + prompt
    try:
        result: str = read_text(await provider.create_async(
            model='',
            messages=[{'role': 'user', 'content': prompt}],
            access_token=access_token
        ))
        if text.endswith('```') and not result.endswith('```'):
            result += '\\n```'
        return result
    except Exception as ex:
        logger.error('Error while translating text', ex, exc_info=True)
        return text  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏

async def translate_part(part: str, i: int) -> str:
    """
    –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —á–∞—Å—Ç—å —Ç–µ–∫—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—è—è, –Ω–µ –≤—Ö–æ–¥–∏—Ç –ª–∏ –æ–Ω–∞ –≤ blocklist.

    Args:
        part (str): –ß–∞—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞.
        i (int): –ò–Ω–¥–µ–∫—Å —á–∞—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞.

    Returns:
        str: –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å —Ç–µ–∫—Å—Ç–∞.
    """
    blocklisted: bool = False
    for headline in blocklist:
        if headline in part:
            blocklisted = True
    if blocklisted:
        lines: List[str] = part.split('\n')
        lines[0]: str = await translate(lines[0])
        part: str = '\n'.join(lines)
        for trans in allowlist:
            if trans in part:
                part: str = part.replace(trans, await translate(trans))
    else:
        part: str = await translate(part)
    logger.info(f'[{i}] translated')
    return part

async def translate_readme(readme: str) -> str:
    """
    –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç README.md —Ñ–∞–π–ª –Ω–∞ –∑–∞–¥–∞–Ω–Ω—ã–π —è–∑—ã–∫.

    Args:
        readme (str): –°–æ–¥–µ—Ä–∂–∏–º–æ–µ README.md —Ñ–∞–π–ª–∞.

    Returns:
        str: –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ README.md —Ñ–∞–π–ª–∞.
    """
    parts: List[str] = readme.split('\n## ')
    logger.info(f'{len(parts)} parts...')
    parts: List[str] = await asyncio.gather(
        *[translate_part('## ' + part, i) for i, part in enumerate(parts)]
    )
    return '\\n\\n'.join(parts)

try:
    with open('README.md', 'r', encoding='utf-8') as fp:
        readme: str = fp.read()
except FileNotFoundError as ex:
    logger.error('README.md not found', ex, exc_info=True)
    sys.exit(1)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ 1

logger.info('Translate readme...')
readme: str = asyncio.run(translate_readme(readme))

file: str = f'README-{iso}.md'
try:
    with open(file, 'w', encoding='utf-8') as fp:
        fp.write(readme)
    logger.info(f'"{file}" saved')
except IOError as ex:
    logger.error(f'Error writing to file "{file}"', ex, exc_info=True)
    sys.exit(1)  # –ó–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏ 1