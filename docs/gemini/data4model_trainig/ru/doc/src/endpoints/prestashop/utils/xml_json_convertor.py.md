# Модуль для конвертации XML и JSON данных в PrestaShop
## Обзор

Модуль `xml_json_convertor.py` предоставляет набор утилит для преобразования данных между форматами XML и JSON, что необходимо для работы с PrestaShop. В частности, он включает функции для преобразования JSON в XML и XML в JSON, что упрощает интеграцию данных в PrestaShop.

## Подробней

Модуль содержит функции для преобразования данных из формата JSON в XML и обратно. Эти преобразования используются для обмена данными с PrestaShop, который может потребовать данные в формате XML.

## Функции

### `dict2xml`

```python
def dict2xml(json_obj: dict, root_name: str = "product") -> str:
    """Конвертирует словарь JSON в строку XML.

    Args:
        json_obj (dict): JSON-словарь для преобразования.
        root_name (str, optional): Имя корневого элемента. По умолчанию "product".

    Returns:
        str: XML-представление JSON.
    
    Как работает функция:
    ----------------------
    Функция `dict2xml` принимает JSON-словарь и преобразует его в XML-строку.
    Она использует внутреннюю функцию `build_xml_element` для рекурсивного построения
    XML-элементов на основе данных из JSON. Если ключ начинается с `@`, он обрабатывается
    как атрибут XML-элемента. Если ключ равен `#text`, его значение становится текстовым
    содержимым элемента. Для списков создаются повторяющиеся дочерние элементы.

    Примеры:
        json_data = {"product": {"name": "Test Product", "price": "10.00"}}
        xml_output = dict2xml(json_data)
        print(xml_output)

        json_data = {"product": {"name": "Test Product", "images": [{"url": "img1.jpg"}, {"url": "img2.jpg"}]}}
        xml_output = dict2xml(json_data)
        print(xml_output)
    """
```

### `_parse_node`

```python
def _parse_node(node: ET.Element) -> dict | str:
    """Преобразует XML-узел в словарь.

    Args:
        node (ET.Element): XML-элемент для разбора.

    Returns:
        dict | str: Представление XML-узла в виде словаря или строка, если у узла нет атрибутов или дочерних элементов.

    Как работает функция:
    ----------------------
    Функция `_parse_node` рекурсивно преобразует XML-узел в словарь.
    Она извлекает атрибуты узла, за исключением атрибутов `href`, и сохраняет их в словаре.
    Текстовое содержимое узла также сохраняется. Если у узла есть дочерние элементы,
    они рекурсивно обрабатываются, и их представления добавляются в словарь.
    Если у узла нет атрибутов и дочерних элементов, возвращается только текстовое содержимое.
    """
```

### `_make_dict`

```python
def _make_dict(tag: str, value: any) -> dict:
    """Создает новый словарь с тегом и значением.

    Args:
        tag (str): Имя тега XML-элемента.
        value (any): Значение, связанное с тегом.

    Returns:
        dict: Словарь с именем тега в качестве ключа и значением в качестве значения словаря.

    Как работает функция:
    ----------------------
    Функция `_make_dict` создает словарь, где ключ - это имя тега XML-элемента,
    а значение - это значение, связанное с этим тегом. Если тег содержит пространство имен,
    оно извлекается, и в словарь добавляется информация о пространстве имен.
    """
```

### `xml2dict`

```python
def xml2dict(xml: str) -> dict:
    """Преобразует XML-строку в словарь.

    Args:
        xml (str): XML-строка для разбора.

    Returns:
        dict: Представление XML в виде словаря.

    Как работает функция:
    ----------------------
    Функция `xml2dict` принимает XML-строку и преобразует её в словарь.
    Она использует `ET.fromstring` для создания дерева элементов XML, а затем
    вызывает `ET2dict` для преобразования этого дерева в словарь.
    """
```

### `ET2dict`

```python
def ET2dict(element_tree: ET.Element) -> dict:
    """Преобразует дерево элементов XML в словарь.

    Args:
        element_tree (ET.Element): Дерево элементов XML.

    Returns:
        dict: Представление дерева элементов XML в виде словаря.
    
    Как работает функция:
    ----------------------
    Функция `ET2dict` преобразует дерево элементов XML (полученное, например,
    из `xml.etree.ElementTree`) в словарь. Она вызывает `_make_dict`, чтобы
    создать словарь, где корневой тег дерева элементов является ключом,
    а значением является результат вызова `_parse_node` для корневого элемента.
    """
```

### `presta_fields_to_xml`

```python
def presta_fields_to_xml(presta_fields_dict: dict) -> str:
    """Конвертирует JSON-словарь в XML-строку с фиксированным корневым именем 'prestashop'.

    Args:
        presta_fields_dict (dict): JSON-словарь, содержащий данные (без ключа 'prestashop').

    Returns:
        str: XML-представление JSON в виде строки.

    Как работает функция:
    ----------------------
    Функция `presta_fields_to_xml` принимает JSON-словарь и преобразует его в XML-строку,
    используя "prestashop" в качестве корневого элемента. Она определяет первый ключ в словаре
    (например, 'product', 'category') и использует его как имя дочернего элемента корневого элемента "prestashop".
    Внутренняя функция `build_xml_element` рекурсивно строит XML-элементы на основе данных в JSON.

    Примеры:
        json_data = {"product": {"name": "Test Product", "price": "10.00"}}
        xml_output = presta_fields_to_xml(json_data)
        print(xml_output)
    """