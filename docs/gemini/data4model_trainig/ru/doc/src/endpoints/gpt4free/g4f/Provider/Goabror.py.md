# Модуль Goabror

## Обзор

Модуль `Goabror` предоставляет асинхронный генератор для взаимодействия с API `goabror.uz`. Он позволяет отправлять запросы к API, получать ответы и обрабатывать их, возвращая результаты в виде асинхронного генератора. Этот модуль предназначен для использования в асинхронных приложениях, требующих взаимодействия с API `goabror.uz`.

## Подробней

Модуль содержит класс `Goabror`, который наследует от `AsyncGeneratorProvider` и `ProviderModelMixin`. Он использует библиотеку `aiohttp` для выполнения асинхронных HTTP-запросов. Модуль предназначен для интеграции с другими частями проекта `hypotez`, где требуется взаимодействие с API `goabror.uz` для получения данных. Он также обрабатывает ошибки и возвращает результаты в формате, пригодном для дальнейшей обработки.

## Классы

### `Goabror`

**Описание**: Класс `Goabror` предоставляет функциональность для асинхронного взаимодействия с API `goabror.uz`.

**Наследует**:
- `AsyncGeneratorProvider`: Обеспечивает базовую структуру для асинхронных генераторов.
- `ProviderModelMixin`: Предоставляет методы для работы с моделями провайдера.

**Атрибуты**:
- `url` (str): URL веб-сайта `goabror.uz`.
- `api_endpoint` (str): URL API для взаимодействия.
- `working` (bool): Флаг, указывающий, работает ли провайдер.
- `default_model` (str): Модель, используемая по умолчанию (`gpt-4`).
- `models` (List[str]): Список поддерживаемых моделей (в данном случае только `gpt-4`).

**Методы**:
- `create_async_generator()`: Создает асинхронный генератор для получения ответов от API.

## Методы класса

### `create_async_generator`

```python
@classmethod
async def create_async_generator(
    cls,
    model: str,
    messages: Messages,
    proxy: str = None,
    **kwargs
) -> AsyncResult:
    """
    Создает асинхронный генератор для получения ответов от API goabror.uz.

    Args:
        cls (Type[Goabror]): Ссылка на класс `Goabror`.
        model (str): Модель для использования в запросе.
        messages (Messages): Список сообщений для отправки в запросе.
        proxy (str, optional): Прокси-сервер для использования. По умолчанию `None`.
        **kwargs: Дополнительные аргументы.

    Returns:
        AsyncResult: Асинхронный генератор, возвращающий ответы от API.

    Raises:
        Exception: Если происходит ошибка при выполнении запроса или обработке ответа.

    Внутренние функции:
        - Отсутствуют
    
    Как работает функция:
    1. Формирует заголовки запроса, имитируя запрос от веб-браузера.
    2. Создает асинхронную сессию `aiohttp` с заданными заголовками.
    3. Формирует параметры запроса, включая пользовательский запрос и системный запрос.
    4. Отправляет GET-запрос к API с заданными параметрами и прокси (если указан).
    5. Проверяет статус ответа и вызывает исключение, если статус указывает на ошибку.
    6. Получает текстовый ответ от API.
    7. Пытается преобразовать текстовый ответ в формат JSON.
    8. Если преобразование успешно, извлекает данные из JSON-ответа и возвращает их через генератор.
    9. Если преобразование не удалось, возвращает текстовый ответ через генератор.
    """
```

**Примеры**:

```python
# Пример вызова функции create_async_generator
import asyncio
from typing import List, Dict, AsyncGenerator, Optional

async def main():
    messages: List[Dict[str, str]] = [{"role": "user", "content": "Hello, world!"}]
    async for message in Goabror.create_async_generator(model="gpt-4", messages=messages):
        print(message)

if __name__ == "__main__":
    asyncio.run(main())