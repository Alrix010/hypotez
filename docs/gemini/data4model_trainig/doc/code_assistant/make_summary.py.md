# Модуль `make_summary`

## Обзор

Модуль `make_summary` предназначен для создания файла `SUMMARY.md`, используемого для компиляции документации с помощью `mdbook`. Он рекурсивно обходит указанную директорию и создает оглавление на основе найденных Markdown файлов.

## Подробней

Модуль предоставляет функцию `make_summary`, которая автоматизирует процесс создания файла `SUMMARY.md` с учетом фильтрации файлов по языку. Это позволяет создавать отдельные оглавления для документации на разных языках.

## Функции

### `make_summary`

```python
def make_summary(docs_dir: Path, lang: str = 'en') -> None:
    """
    Создает файл SUMMARY.md, рекурсивно обходя папку.

    Args:
        docs_dir (Path): Путь к исходной директории 'src'.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Назначение**: Создает файл `SUMMARY.md`, рекурсивно обходя указанную директорию и фильтруя файлы по языку.

**Параметры**:
- `docs_dir` (Path): Путь к исходной директории с документацией.
- `lang` (str): Язык фильтрации файлов. Допустимые значения: `'ru'` или `'en'`. По умолчанию `'en'`.

**Как работает функция**:

1.  Формирует путь к файлу `SUMMARY.md` с помощью функции `prepare_summary_path`.
2.  Создает родительские директории для файла `SUMMARY.md`, если они не существуют.
3.  Вызывает функцию `_make_summary` для рекурсивного обхода директории и создания содержимого файла `SUMMARY.md`.

### `_make_summary`

```python
def _make_summary(src_dir: Path, summary_file: Path, lang: str = 'en') -> bool:
    """
    Рекурсивно обходит папку и создает файл SUMMARY.md с главами на основе .md файлов.

    Args:
        src_dir (Path): Путь к папке с исходниками .md.
        summary_file (Path): Путь для сохранения файла SUMMARY.md.
        lang (str): Язык фильтрации файлов. Возможные значения: 'ru' или 'en'.
    """
    ...
```

**Назначение**: Рекурсивно обходит указанную директорию и создает файл `SUMMARY.md` с оглавлением на основе `.md` файлов, отфильтрованных по языку.

**Параметры**:
- `src_dir` (Path): Путь к директории с исходными файлами Markdown.
- `summary_file` (Path): Путь для сохранения файла `SUMMARY.md`.
- `lang` (str): Язык фильтрации файлов. Допустимые значения: `'ru'` или `'en'`. По умолчанию `'en'`.

**Как работает функция**:

1.  Проверяет, существует ли уже файл `SUMMARY.md`, и перезаписывает его, если он существует.
2.  Открывает файл `SUMMARY.md` для записи.
3.  Записывает заголовок `# Summary` в файл.
4.  Рекурсивно обходит директорию `src_dir` в поисках файлов с расширением `.md`.
5.  Фильтрует файлы по языку, пропуская файлы, не соответствующие указанному языку (`'ru'` или `'en'`).
6.  Для каждого отфильтрованного файла формирует относительный путь и добавляет строку в файл `SUMMARY.md` в формате `'- [имя файла](относительный/путь/к/файлу.md)'`.

### `prepare_summary_path`

```python
def prepare_summary_path(src_dir: Path, file_name: str = 'SUMMARY.md') -> Path:
    """
    Формирует путь к файлу, заменяя часть пути 'src' на 'docs' и добавляя имя файла.

    Args:
        src_dir (Path): Исходный путь с 'src'.
        file_name (str): Имя файла, который нужно создать. По умолчанию 'SUMMARY.md'.

    Returns:
        Path: Новый путь к файлу.
    """
    ...
```

**Назначение**: Формирует путь к файлу `SUMMARY.md`, заменяя часть пути `'src'` на `'docs'` и добавляя имя файла.

**Параметры**:
- `src_dir` (Path): Исходный путь к директории с документацией, содержащий `'src'`.
- `file_name` (str): Имя файла, который нужно создать. По умолчанию `'SUMMARY.md'`.

**Возвращает**:
- `Path`: Новый путь к файлу `SUMMARY.md` в директории `'docs'`.

**Как работает функция**:

1.  Формирует новый путь, заменяя `'src'` на `'docs'` в исходном пути.
2.  Добавляет имя файла к новому пути.

## Запуск из командной строки

Модуль можно запустить из командной строки, указав язык фильтрации файлов и путь к исходной директории:

```bash
python make_summary.py -lang <язык> <путь_к_исходной_директории>
```

### Параметры командной строки

*   `-lang` (str): Язык фильтрации файлов (`'ru'` или `'en'`). По умолчанию `'en'`.
*   `src_dir` (str): Путь к исходной директории `'src'`.

### Пример

```bash
python make_summary.py -lang ru src/endpoints/my_module
```

Эта команда создаст файл `SUMMARY.md` в директории `docs/endpoints/my_module`, содержащий оглавление для всех файлов `.ru.md`.

## Зависимости

*   `pathlib`: Для работы с путями к файлам.
*   `argparse`: Для разбора аргументов командной строки.
*   `header`: (предположительно) Для определения корневого пути проекта.

## Замечания

В данном коде используется библиотека `xml.etree.ElementTree`, а не `xml.etree.cElementTree` как указано в исходном коде. Это может повлиять на производительность при работе с большими XML-файлами.
При возникновении ошибок, связанных с правами доступа к файлам или директориям, необходимо убедиться, что у пользователя, запускающего скрипт, есть соответствующие права.
```python
...
```
Данный код указывает на то, что в модуле есть еще не реализованная функциональность.