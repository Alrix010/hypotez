# Модуль для настройки базы данных

## Обзор

Модуль `src.endpoints.bots.telegram.digital_market.bot.dao.database` предназначен для настройки и инициализации базы данных, используемой Telegram-ботом для цифрового магазина.

## Подробней

Модуль использует SQLAlchemy для определения базовой модели, создания асинхронного движка и сессии для работы с базой данных.

## Переменные

*   `engine` (AsyncEngine): Асинхронный движок SQLAlchemy, подключенный к базе данных, URL которой определяется из `database_url`.
*   `async_session_maker` (async_sessionmaker): Фабрика асинхронных сессий, использующая движок `engine`.

## Классы

### `Base`

**Описание**: Базовый класс для моделей SQLAlchemy.

**Наследует**:

*   `AsyncAttrs` из библиотеки `sqlalchemy.ext.asyncio`.
*   `DeclarativeBase` из библиотеки `sqlalchemy.orm`.

**Атрибуты**:

*   `__abstract__` (bool): Указывает, что класс является абстрактным и не должен создавать отдельную таблицу (значение: `True`).
*   `id` (Mapped[int]): ID записи (целое число, первичный ключ, автоинкремент).
*   `created_at` (Mapped[datetime]): Дата и время создания записи (TIMESTAMP, по умолчанию текущее время).
*   `updated_at` (Mapped[datetime]): Дата и время последнего обновления записи (TIMESTAMP, по умолчанию текущее время, обновляется при каждом изменении).

**Свойства**:

*   `__tablename__` (str): Имя таблицы, соответствующей классу (генерируется автоматически на основе имени класса, приведенного к нижнему регистру с добавлением суффикса `s`).

**Методы**:

*   `to_dict(self) -> dict`: Преобразует объект в словарь.

## Как работает модуль

1.  Создается асинхронный движок SQLAlchemy, подключенный к базе данных, URL которой определяется из `database_url`.
2.  Определяется базовый класс `Base` для моделей SQLAlchemy, который включает общие поля `id`, `created_at` и `updated_at`.
3.  Указывается, что базовый класс является абстрактным и не должен создавать отдельную таблицу.
4.  Определяется динамическое имя таблицы на основе имени класса.
5.  Добавляется метод `to_dict` для преобразования объекта в словарь.