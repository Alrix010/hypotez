# Модуль нейронных сетей

## Обзор

Модуль `src.endpoints.bots.telegram.ToolBoxbot-main/ToolBox/ToolBox_n_networks.py` содержит классы и функции для взаимодействия с различными нейронными сетями.

## Подробней

Модуль предоставляет функциональность для генерации изображений с использованием FLUX.1-schnell, а также для взаимодействия с моделями GPT-4o-mini и Mistral через API.

## Классы

### `neural_networks`

**Описание**: Класс для работы с нейронными сетями.

**Методы**:

*   `_FLUX_schnell(self, prompt: str, size: list[int, int], seed: int, num_inference_steps: int) -> str | None`: Генерирует изображение с использованием FLUX.1-schnell.
*   `__mistral_large_2407(self, prompt: list[dict[str, str]]) -> tuple[str, int, int] | str`: Взаимодействует с моделью Mistral large 2407 для генерации текста.
*   `_free_gpt_4o_mini(self, prompt: list[dict[str, str]]) -> tuple[str, int, int] | str`: Взаимодействует с моделью GPT-4o-mini для генерации текста.

## Методы класса `neural_networks`

### `_FLUX_schnell`

```python
def _FLUX_schnell(self, prompt: str, size: list[int, int], seed: int, num_inference_steps: int) -> str|None:
```

**Назначение**: Генерирует изображение с использованием FLUX.1-schnell.

**Параметры**:

*   `prompt` (str): Текстовое описание изображения.
*   `size` (list[int, int]): Размеры изображения (ширина и высота).
*   `seed` (int): Зерно для генерации случайных чисел.
*   `num_inference_steps` (int): Количество шагов для генерации изображения.

**Возвращает**:

*   `str | None`: Объект `Image` (изображение) или `None` в случае ошибки.

**Как работает функция**:

1.  Формирует полезную нагрузку (payload) с параметрами для запроса к API FLUX.1-schnell.
2.  Выполняет POST-запрос к API Hugging Face.
3.  Если запрос успешен (код состояния 200), открывает изображение из ответа и возвращает его.
4.  В случае ошибки возвращает `None`.

### `__mistral_large_2407`

```python
def __mistral_large_2407(self, prompt: list[dict[str, str]]) -> tuple[str, int, int]|str:
```

**Назначение**: Взаимодействует с моделью Mistral large 2407 для генерации текста.

**Параметры**:

*   `prompt` (list[dict[str, str]]): Список сообщений для отправки в модель.

**Возвращает**:

*   `tuple[str, int, int] | str`: Ответ модели, количество токенов в запросе и ответе, или сообщение об ошибке.

**Как работает функция**:

1.  Формирует данные запроса, включая сообщения, температуру, top\_p и максимальное количество токенов.
2.  Отправляет POST-запрос к API Mistral.
3.  Извлекает ответ, количество токенов в запросе и ответе из ответа API.

### `_free_gpt_4o_mini`

```python
def _free_gpt_4o_mini(self, prompt: list[dict[str, str]]) -> tuple[str, int, int]|str:
```

**Назначение**: Взаимодействует с моделью GPT-4o-mini для генерации текста.

**Параметры**:

*   `prompt` (list[dict[str, str]]): Список сообщений для отправки в модель.

**Возвращает**:

*   `tuple[str, int, int] | str`: Ответ модели, количество токенов в запросе и ответе, или результат вызова `__mistral_large_2407` в случае ошибки.

**Как работает функция**:

1.  Формирует данные запроса, включая сообщения, температуру, top\_p и максимальное количество токенов.
2.  Выполняет POST-запрос к API GPT-4o-mini на сервере Azure.
3.  Если запрос успешен (код состояния 200), извлекает ответ, количество токенов в запросе и ответе из ответа API.
4.  В случае ошибки вызывает функцию `__mistral_large_2407` и возвращает ее результат.