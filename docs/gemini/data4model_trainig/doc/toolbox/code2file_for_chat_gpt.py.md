# Модуль `code2file_for_chat_gpt`

## Обзор

Этот модуль предназначен для рекурсивного чтения и обработки текстовых файлов и файлов данных в указанном каталоге. Он объединяет содержимое этих файлов в один или несколько выходных файлов, с возможностью удаления блоков с тройными кавычками из Python-файлов. Модуль также включает функции для очистки HTML-содержимого и удаления содержимого директорий.

## Подробней

Модуль содержит функции для работы с файловой системой, обработки текста и очистки содержимого файлов. Он может быть использован для подготовки данных для обработки в других инструментах, таких как ChatGPT.

## Функции

### `clean_html`

```python
def clean_html(content: str) -> str:
    """Удаляет HTML-теги из содержимого.

    Args:
        content (str): HTML-содержимое для очистки.

    Returns:
        str: Содержимое без HTML-тегов.

    Пример:
        >>> clean_html('<p>Hello, World!</p>')
        'Hello, World!'
    """
    ...
```

**Назначение**: Функция `clean_html` предназначена для удаления HTML-тегов из предоставленного содержимого. Она использует библиотеку `BeautifulSoup` для парсинга HTML и извлечения текста без тегов.

**Параметры**:
- `content` (str): HTML-содержимое, которое необходимо очистить от тегов.

**Возвращает**:
- `str`: Текст без HTML-тегов.

**Как работает функция**:
1.  Функция принимает строку `content`, содержащую HTML-код.
2.  Создается объект `BeautifulSoup` для парсинга HTML-кода.
3.  Извлекается текст из HTML-кода с помощью метода `get_text()`.
4.  Возвращается очищенный текст.

**Примеры**:

```python
clean_html('<p>Hello, World!</p>')
```

### `remove_docstrings`

```python
def remove_docstrings(content: str) -> str:
    """Удаляет все блоки с тройными кавычками `"""` и `'''` из текста.

    Args:
        content (str): Текстовое содержимое, из которого нужно удалить блоки с тройными кавычками.

    Returns:
        str: Текст без блоков с тройными кавычками.

    Пример:
        >>> remove_docstrings('\'\'\'def foo():\n    """This is a docstring"""\n    pass\'\'\')
        'def foo():\n    pass'
    """
    ...
```

**Назначение**: Функция `remove_docstrings` предназначена для удаления всех блоков с тройными кавычками (`"""` и `'''`) из предоставленного текста. Это используется для удаления docstrings из Python-кода.

**Параметры**:
- `content` (str): Текстовое содержимое, из которого нужно удалить блоки с тройными кавычками.

**Возвращает**:
- `str`: Текст без блоков с тройными кавычками.

**Как работает функция**:
1.  Функция принимает строку `content`, содержащую текст.
2.  Используются регулярные выражения для поиска и удаления многострочных docstrings, заключенных в тройные двойные кавычки (`"""`).
3.  Используются регулярные выражения для поиска и удаления многострочных docstrings, заключенных в тройные одинарные кавычки (`'''`).
4.  Возвращается текст без docstrings.

**Примеры**:

```python
remove_docstrings('\'\'\'def foo():\n    """This is a docstring"""\n    pass\'\'\')
```

### `delete_directory_contents`

```python
def delete_directory_contents(directory: Path) -> None:
    """Рекурсивно удаляет все содержимое указанной директории.

    Args:
        directory (Path): Путь к директории, содержимое которой нужно удалить.

    Returns:
        None

    Пример:
        >>> delete_directory_contents(Path('../tmp/chat_gpt/aliexpress'))
    """
    ...
```

**Назначение**: Функция `delete_directory_contents` предназначена для рекурсивного удаления всего содержимого указанной директории.

**Параметры**:
- `directory` (Path): Объект `Path`, представляющий путь к директории, содержимое которой необходимо удалить.

**Возвращает**:
- None

**Как работает функция**:
1.  Функция принимает объект `Path`, указывающий на директорию.
2.  Перебирает все элементы (файлы и поддиректории) внутри директории.
3.  Если элемент является директорией, рекурсивно вызывает `delete_directory_contents` для этой директории, а затем пытается удалить саму директорию.
4.  Если элемент является файлом, пытается удалить файл.
5.  В случае возникновения ошибок при удалении директории или файла, записывает информацию об ошибке в лог.

**Примеры**:

```python
delete_directory_contents(Path('../tmp/chat_gpt/aliexpress'))
```

### `read_text_files`

```python
def read_text_files(
    directory: str, output_file: str, remove_docs: bool = False, max_chars: int = 2000
) -> None:
    """Читает все указанные Python файлы в каталоге и сохраняет объединенный текст в несколько файлов,
    если размер содержания превышает 2000 символов.

    Args:
        directory (str): Каталог для поиска файлов.
        output_file (str): Базовое имя файла для сохранения объединенного текста.
        remove_docs (bool): Если `True`, удаляет блоки с тройными кавычками из текста. По умолчанию `False`.
        max_chars (int): Максимальное количество символов для каждого файла. По умолчанию 2000.

    Returns:
        None

    Пример:
        >>> read_text_files('src', 'output.txt', remove_docs=True)
    """
    ...
```

**Назначение**: Функция `read_text_files` предназначена для чтения всех Python-файлов в указанном каталоге, объединения их содержимого и сохранения в один или несколько выходных файлов. Если общий размер содержимого превышает заданное максимальное количество символов, создается новый файл для продолжения записи. Функция также может удалять docstrings из файлов.

**Параметры**:
- `directory` (str): Путь к каталогу, в котором нужно искать файлы.
- `output_file` (str): Базовое имя файла для сохранения объединенного текста. Если необходимо создать несколько файлов, к имени будет добавлен номер.
- `remove_docs` (bool, optional): Если `True`, из содержимого файлов будут удалены docstrings. По умолчанию `False`.
- `max_chars` (int, optional): Максимальное количество символов, которое может содержать один выходной файл. По умолчанию `2000`.

**Как работает функция**:
1.  Функция принимает путь к директории, базовое имя выходного файла, флаг для удаления docstrings и максимальное количество символов в файле.
2.  Создает необходимые директории для выходных файлов.
3.  Организует рекурсивный обход указанной директории.
4.  Для каждого найденного Python-файла:
    -   Читает содержимое файла.
    -   Удаляет docstrings, если установлен флаг `remove_docs`.
    -   Проверяет, не превышает ли добавление содержимого файла максимальное количество символов для текущего выходного файла. Если превышает, создает новый файл.
    -   Записывает содержимое файла в выходной файл, предваряя его именем файла.
5.  В случае возникновения ошибок при чтении файлов, записывает информацию об ошибке в лог.

**Примеры**:

```python
read_text_files('src', 'output.txt', remove_docs=True)
```

## Переменные

- `EXCLUDE_DIRS`: Список директорий, которые исключаются из обработки при обходе каталогов.
- `EXCLUDE_EXTENSIONS`: Список расширений файлов, которые исключаются из обработки.