## Модуль Telegram-бота

```rst
.. module:: src.endpoints.bots.telegram
```

[Root ↑](https://github.com/hypo69/hypotez/blob/master/README.MD)
[src](https://github.com/hypo69/hypotez/blob/master/src/readme.ru.md) /
[endpoints](https://github.com/hypo69/hypotez/blob/master/src/endpoints/readme.ru.md) /
[bots](https://github.com/hypo69/hypotez/blob/master/src/endpoints/bots/readme.ru.md)
[Русский](https://github.com/hypo69/hypotez/blob/master/src/bots/telegram/readme.ru.md)

Telegram Bot
=============

Бот выполняет несколько функций, связанных с обработкой команд, обработкой голосовых сообщений
и взаимодействием с пользователями в Telegram.

Вот краткое описание основных функций и команд, которые реализует этот бот:

### Основные функции и команды бота:

1.  **Инициализация бота:**

    *   Бот инициализируется с токеном, который используется для аутентификации бота в Telegram API.
2.  **Команды:**

    *   `/start`: Отправляет приветственное сообщение пользователю.
    *   `/help`: Предоставляет список доступных команд.
    *   `/sendpdf`: Отправляет PDF-файл пользователю.
3.  **Обработка сообщений:**

    *   Бот обрабатывает входящие текстовые сообщения, голосовые сообщения и файлы документов.
    *   Для голосовых сообщений бот транскрибирует аудио (в настоящее время это функция-заполнитель).
    *   Для файлов документов бот считывает содержимое текстового документа.
4.  **Обработка голосовых сообщений:**

    *   Бот загружает файл голосового сообщения, сохраняет его локально и пытается транскрибировать его с помощью службы распознавания речи (в настоящее время это функция-заполнитель).
5.  **Обработка документов:**

    *   Бот загружает файл документа, сохраняет его локально и считывает содержимое текстового документа.
6.  **Обработка текстовых сообщений:**

    *   Бот просто возвращает текст, полученный от пользователя.

### Основные модули и библиотеки:

*   `python-telegram-bot`: Основная библиотека для создания Telegram-ботов.
*   `pathlib`: Для работы с путями к файлам.
*   `tempfile`: Для создания временных файлов.
*   `asyncio`: Для асинхронного выполнения задач.
*   `requests`: Для скачивания файлов.
*   `src.utils.convertors.tts`: Для распознавания речи и преобразования текста в речь.
*   `src.utils.file`: Для чтения текстовых файлов.

### Класс и методы:

*   **Класс TelegramBot:**

    *   `__init__(self, token: str)`: Инициализирует бота с токеном и регистрирует обработчики.
    *   `register_handlers(self)`: Регистрирует обработчики команд и сообщений.
    *   `start(self, update: Update, context: CallbackContext)`: Обрабатывает команду `/start`.
    *   `help_command(self, update: Update, context: CallbackContext)`: Обрабатывает команду `/help`.
    *   `send_pdf(self, pdf_file: str | Path)`: Обрабатывает команду `/sendpdf` для отправки PDF-файла.
    *   `handle_voice(self, update: Update, context: CallbackContext)`: Обрабатывает голосовые сообщения и транскрибирует аудио.
    *   `transcribe_voice(self, file_path: Path) -> str`: Транскрибирует голосовые сообщения (функция-заполнитель).
    *   `handle_document(self, update: Update, context: CallbackContext) -> str`: Обрабатывает файлы документов и считывает их содержимое.
    *   `handle_message(self, update: Update, context: CallbackContext) -> str`: Обрабатывает текстовые сообщения и возвращает полученный текст.

### Основная функция:

*   **main()**: Инициализирует бота, регистрирует обработчики команд и сообщений и запускает бота с помощью `run_polling()`.