# Модуль для выполнения криптографических операций

## Обзор

Модуль `src.endpoints.bots.google_drive.mega.crypto` предоставляет набор функций для выполнения криптографических операций, используемых для работы с сервисом Mega.

## Подробней

Модуль содержит функции для шифрования и дешифрования данных с использованием алгоритма AES в режиме CBC, а также функции для вычисления хешей и подготовки ключей.

## Функции

### `aes_cbc_encrypt`

```python
def aes_cbc_encrypt(data, key):
```

**Назначение**: Шифрует данные с использованием алгоритма AES в режиме CBC.

**Параметры**:

*   `data`: Данные для шифрования.
*   `key`: Ключ шифрования.

**Возвращает**:

*   Зашифрованные данные.

### `aes_cbc_decrypt`

```python
def aes_cbc_decrypt(data, key):
```

**Назначение**: Дешифрует данные с использованием алгоритма AES в режиме CBC.

**Параметры**:

*   `data`: Данные для дешифрования.
*   `key`: Ключ дешифрования.

**Возвращает**:

*   Дешифрованные данные.

### `aes_cbc_encrypt_a32`

```python
def aes_cbc_encrypt_a32(data, key):
```

**Назначение**: Шифрует данные в формате a32 с использованием алгоритма AES в режиме CBC.

**Параметры**:

*   `data`: Данные для шифрования в формате a32.
*   `key`: Ключ шифрования в формате a32.

**Возвращает**:

*   Зашифрованные данные в формате a32.

**Как работает функция**:

1. Преобразует входные данные и ключ из формата a32 в строку.
2.  Шифрует данные с использованием функции `aes_cbc_encrypt`.
3.  Преобразует зашифрованные данные обратно в формат a32.

### `aes_cbc_decrypt_a32`

```python
def aes_cbc_decrypt_a32(data, key):
```

**Назначение**: Дешифрует данные в формате a32 с использованием алгоритма AES в режиме CBC.

**Параметры**:

*   `data`: Данные для дешифрования в формате a32.
*   `key`: Ключ дешифрования в формате a32.

**Возвращает**:

*   Дешифрованные данные в формате a32.
**Как работает функция**:
1. Преобразует входные данные и ключ из формата a32 в строку.
2. Дешифрует данные с использованием функции `aes_cbc_decrypt`.
3. Преобразует дешифрованные данные обратно в формат a32.

### `stringhash`

```python
def stringhash(s, aeskey):
```

**Назначение**: Вычисляет хеш строки.

**Параметры**:

*   `s`: Строка для хеширования.
*   `aeskey`: Ключ AES.

**Возвращает**:

*   Хеш строки в формате base64.

**Как работает функция**:

1.  Преобразует строку в формат a32.
2.  Инициализирует хеш-значение.
3.  Итерируется по символам строки и обновляет хеш-значение.
4.  Выполняет несколько раундов шифрования хеш-значения с использованием AES.
5.  Преобразует хеш-значение в формат base64.

### `prepare_key`

```python
def prepare_key(a):
```

**Назначение**: Подготавливает ключ для шифрования.

**Параметры**:

*   `a`: Список целых чисел.

**Возвращает**:

*   Подготовленный ключ.

**Как работает функция**:

1.  Инициализирует первичный ключ.
2.  Итерируется несколько раз, шифруя первичный ключ с использованием входного списка.

### `encrypt_key`

```python
def encrypt_key(a, key):
```

**Назначение**: Шифрует ключ.

**Параметры**:

*   `a`: Ключ для шифрования.
*   `key`: Ключ шифрования.

**Возвращает**:

*   Зашифрованный ключ.

**Как работает функция**:

1.  Разбивает ключ на блоки по 4 элемента и шифрует каждый блок с использованием AES.

### `decrypt_key`

```python
def decrypt_key(a, key):
```

**Назначение**: Дешифрует ключ.

**Параметры**:

*   `a`: Ключ для дешифрования.
*   `key`: Ключ дешифрования.

**Возвращает**:

*   Дешифрованный ключ.

**Как работает функция**:

1.  Разбивает ключ на блоки по 4 элемента и дешифрует каждый блок с использованием AES.

### `enc_attr`

```python
def enc_attr(attr, key):
```

**Назначение**: Шифрует атрибуты.

**Параметры**:

*   `attr`: Атрибуты для шифрования.
*   `key`: Ключ шифрования.

**Возвращает**:

*   Зашифрованные атрибуты.

**Как работает функция**:

1.  Преобразует атрибуты в JSON-строку.
2.  Дополняет строку до кратной 16 байтам.
3.  Шифрует строку с использованием AES.

### `dec_attr`

```python
def dec_attr(attr, key):
```

**Назначение**: Дешифрует атрибуты.

**Параметры**:

*   `attr`: Атрибуты для дешифрования.
*   `key`: Ключ дешифрования.

**Возвращает**:

*   Дешифрованные атрибуты.

**Как работает функция**:

1.  Дешифрует атрибуты с использованием AES.
2.  Удаляет завершающие нулевые байты.
3.  Преобразует JSON-строку в объект Python.