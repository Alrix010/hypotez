# Модуль провайдера ChatgptLogin

## Обзор

Модуль `src.endpoints.freegpt-webui-ru/g4f/Provider/Providers/ChatgptLogin.py` предоставляет реализацию провайдера ChatgptLogin для взаимодействия с моделью GPT-3.5 Turbo.

## Подробней

Модуль содержит функции для создания завершений (completions) с использованием API ChatgptLogin.

## Переменные

*   `url` (str): URL API ChatgptLogin (значение: `'https://chatgptlogin.ac'` ).
*   `model` (list): Список поддерживаемых моделей (значение: `['gpt-3.5-turbo']`).
*   `supports_stream` (bool): Указывает, поддерживает ли провайдер потоковую передачу (значение: `False`).
*   `needs_auth` (bool): Указывает, требует ли провайдер аутентификацию (значение: `False`).

## Функции

### `_create_completion`

```python
def _create_completion(model: str, messages: list, stream: bool, **kwargs):
```

**Назначение**: Функция для создания завершения (completion).

**Параметры**:

*   `model` (str): Имя модели.
*   `messages` (list): Список сообщений.
*   `stream` (bool): Указывает, использовать ли потоковую передачу.
*   `**kwargs`: Дополнительные аргументы.

**Как работает функция**:

1.  Определяет функцию `get_nonce` для получения nonce с веб-страницы.
2.  Определяет функцию `transform` для преобразования сообщений в формат HTML.
3.  Определяет заголовки для HTTP-запроса.
4.  Формирует данные для отправки в API.
5.  Выполняет POST-запрос к API ChatgptLogin.
6.  Извлекает ответ из JSON и возвращает его.

### `get_nonce` (внутренняя функция)

```python
def get_nonce():
```

**Назначение**: Получает nonce с веб-страницы.

**Как работает функция**:

1.  Выполняет GET-запрос к `https://chatgptlogin.ac/use-chatgpt-free/`.
2.  Извлекает nonce из ответа HTML с использованием регулярного выражения.
3.  Декодирует из base64
   4. Извлекает nonce из декодированной строки с использованием регулярного выражения.

### `transform` (внутренняя функция)

```python
def transform(messages: list) -> list:
```

**Назначение**: Преобразует сообщения в формат HTML.

**Параметры**:

*   `messages` (list): Список сообщений.

**Возвращает**:

*   `list`: Список сообщений в формате HTML.

**Как работает функция**:

1.  Определяет функцию `html_encode` для кодирования специальных символов в HTML.
2.  Преобразует каждое сообщение в формат HTML, используя функцию `html_encode`.

### `html_encode` (внутренняя функция)

```python
def html_encode(string: str) -> str:
```

**Назначение**: Кодирует специальные символы в HTML.

**Параметры**:

*   `string` (str): Строка для кодирования.

**Возвращает**:

*   `str`: Строка с закодированными символами.

**Как работает функция**:

1.  Заменяет специальные символы в строке на их HTML-эквиваленты.