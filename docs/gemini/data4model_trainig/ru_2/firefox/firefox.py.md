### Анализ кода `hypotez/src/webdriver/firefox/firefox.py.md`

```rst
.. module:: src.webdriver.firefox
```

# Модуль Firefox WebDriver для Selenium

Этот модуль предоставляет пользовательскую реализацию Firefox WebDriver с использованием Selenium. Он интегрирует настройки конфигурации, определённые в файле `firefox.json`, такие как user-agent и настройки профиля браузера, чтобы обеспечить гибкие и автоматизированные взаимодействия с браузером.

## Ключевые особенности

*   **Централизованная конфигурация**: Конфигурация управляется через файл `firefox.json`.
*   **Множественные профили браузера**: Поддерживает несколько профилей браузера, что позволяет настраивать различные параметры для тестирования.
*   **Улучшенное логирование и обработка ошибок**: Предоставляет подробные логи для инициализации, проблем с конфигурацией и ошибок WebDriver.
*   **Возможность передачи пользовательских опций**: Поддерживает передачу пользовательских опций при инициализации WebDriver.

## Требования

Перед использованием этого WebDriver убедитесь, что установлены следующие зависимости:

*   Python 3.x
*   Selenium
*   Fake User Agent
*   WebDriver бинарник для Firefox (например, `geckodriver`)

Установите необходимые зависимости Python:

```bash
pip install selenium fake_useragent
```

Кроме того, убедитесь, что бинарник `geckodriver` доступен в `PATH` вашей системы или укажите путь к нему в конфигурации.

## Конфигурация

Конфигурация для Firefox WebDriver хранится в файле `firefox.json`. Ниже приведён пример структуры конфигурационного файла и его описание:

### Пример конфигурации (`firefox.json`)

```json
{
  "options": ["--kiosk", "--headless"],
  "profile_directory": {
    "os": "%LOCALAPPDATA%\\Mozilla\\Firefox\\Profiles\\default",
    "internal": "webdriver\\firefox\\profiles\\default"
  },
  "executable_path": {
    "firefox_binary": "bin\\\\webdrivers\\\\firefox\\\\ff\\\\core-127.0.2\\\\firefox.exe",
    "geckodriver": "bin\\\\webdrivers\\\\firefox\\\\gecko\\\\33\\\\geckodriver.exe"
  },
  "headers": {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
  },
  "proxy_enabled": false
}
```

### Описание полей конфигурации

#### 1. `options`

Список аргументов командной строки, передаваемых в Firefox. Примеры:

*   `--kiosk`: Запуск браузера в режиме киоска.
*   `--headless`: Запуск браузера в безголовом режиме.

#### 2. `profile_directory`

Пути к директориям с пользовательскими данными Firefox для различных сред:

*   **os**: Путь к каталогу пользовательских данных по умолчанию (обычно для систем Windows).
*   **internal**: Внутренний путь для профиля WebDriver по умолчанию.

#### 3. `executable_path`

Пути к исполняемым файлам Firefox:

*   **firefox\_binary**: Путь к бинарному файлу Firefox.
*   **geckodriver**: Путь к исполняемому файлу GeckoDriver.

#### 4. `headers`

Пользовательские HTTP-заголовки, используемые в запросах браузера:

*   **User-Agent**: Устанавливает строку user-agent для браузера.
*   **Accept**: Устанавливает типы данных, которые браузер готов принять.

#### 5. `proxy_enabled`

Булевое значение, указывающее, следует ли использовать прокси-сервер для WebDriver. По умолчанию установлено в `false`.

## Использование

Чтобы использовать `Firefox` WebDriver в своём проекте, просто импортируйте его и инициализируйте:

```python
from src.webdriver.firefox import Firefox

# Инициализация Firefox WebDriver с настройками user-agent и пользовательскими опциями
browser = Firefox(user_agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64)", options=["--headless"])

# Открытие веб-сайта
browser.get("https://www.example.com")

# Закрытие браузера
browser.quit()
```

Класс `Firefox` автоматически загружает настройки из файла `firefox.json` и использует их для конфигурации WebDriver. Вы также можете указать пользовательский user-agent и передать дополнительные опции при инициализации WebDriver.

### Паттерн Singleton

WebDriver для `Firefox` использует паттерн Singleton. Это означает, что будет создан только один экземпляр WebDriver. Если экземпляр уже существует, будет использован тот же экземпляр и откроется новое окно.

## Логирование и отладка

Класс WebDriver использует `logger` из `src.logger` для логирования ошибок, предупреждений и общей информации. Все проблемы, возникающие при инициализации, конфигурации или выполнении, будут записываться в логи для удобства отладки.

### Пример логов

*   **Ошибка при инициализации WebDriver**: `Ошибка при инициализации Chrome WebDriver: <детали ошибки>`
*   **Проблемы с конфигурацией**: `Ошибка в файле firefox.json: <детали проблемы>`

## Лицензия

Этот проект лицензирован на условиях MIT License. См. файл [LICENSE](../../LICENSE) для подробностей.