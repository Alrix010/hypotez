# Модуль для создания index.rst

## Обзор

Модуль предназначен для автоматического создания файла `index.rst` в директории `docs`, который содержит перечень всех Python-файлов в проекте, что упрощает процесс генерации документации с помощью Sphinx.

## Подробнее

Этот модуль рекурсивно обходит все поддиректории начиная с указанной, находит все файлы с расширением `.py` и создает файл `index.rst` в директории `docs`. Файл `index.rst` содержит структуру `toctree`, которая используется Sphinx для создания навигации по документации. Модуль также исключает файлы, содержащие символы `(` и `)` в имени. Логи выполнения записываются с использованием модуля `logger`.

## Функции

### `create_index_rst`

```python
def create_index_rst(start_dir: str) -> None:
    """ Recursively traverses all subdirectories from the start directory, reads all *.py files,
    and creates an index.rst file in the `docs` directory that lists all these files in a toctree format. Logs the process throughout.

    Args:
        start_dir (str): The root directory to start the traversal from.

    Returns:
        None

    Example:
        >>> create_index_rst(os.getcwd())
    """
    ...
```

**Назначение**:
Функция `create_index_rst` рекурсивно обходит все поддиректории начиная с указанной, находит все файлы с расширением `.py` и создает файл `index.rst` в директории `docs`, который содержит перечень всех этих файлов в формате `toctree`.

**Параметры**:

-   `start_dir` (str): Корневая директория, с которой начинается обход.

**Возвращает**:

-   `None`

**Как работает функция**:

1.  Формирует объекты `Path` для исходной директории (`start_path`), директории `docs` и файла `index.rst`.
2.  Проверяет, существует ли директория `docs`, и создает ее, если она отсутствует.
3.  Открывает файл `index.rst` для записи и записывает в него заголовок `toctree` с настройками `maxdepth` и `caption`.
4.  Рекурсивно обходит все поддиректории начиная с `start_path`.
5.  Для каждой директории находит все файлы с расширением `.py`, исключая файлы, содержащие символы `(` и `)` в имени.
6.  Для каждого найденного файла формирует относительный путь и записывает его в файл `index.rst` в формате, требуемом для `toctree`.
7.  Если в указанной директории не найдено ни одного Python-файла, выводит соответствующее сообщение в лог.
8.  В случае возникновения ошибок логирует информацию об ошибке и выбрасывает исключение.

## Примеры

### Пример использования модуля

```python
import os
from pathlib import Path
from dev_utils.create_index_rst import create_index_rst
import header

if __name__ == "__main__":
    create_index_rst(Path(header.__root__, 'src'))
```

Этот код выполняет следующие действия:

1.  Импортирует необходимые модули и функции.
2.  Вызывает функцию `create_index_rst`, передавая ей путь к директории `src` для создания `index.rst` файла.

### Пример содержимого файла index.rst

```rst
.. toctree::
   :maxdepth: 2
   :caption: Содержание:

   module1
   module2

   subdir/module3

```

Этот файл содержит базовую структуру `toctree`, которая указывает Sphinx, какие файлы следует включить в документацию и как организовать навигацию.