### Анализ кода `hypotez/src/utils/xml.py.md`

## Обзор

Модуль предназначен для работы с XML-файлами, включая очистку от пустых элементов и сохранение с форматированием.

## Подробнее

Этот модуль предоставляет функции для обработки XML-данных, такие как очистка пустых элементов и сохранение в файл с отступами для улучшения читаемости. Он использует библиотеки `xml.etree.ElementTree` для парсинга и манипулирования XML и `xml.dom.minidom` для форматирования XML-данных.

## Функции

### `clean_empty_cdata`

```python
def clean_empty_cdata(xml_string: str) -> str:
    """! Cleans empty CDATA sections and unnecessary whitespace in XML string.

    Args:
        xml_string (str): Raw XML content.

    Returns:
        str: Cleaned and formatted XML content.
    """
    ...
```

**Назначение**:
Очищает пустые CDATA-секции и лишние пробелы в XML-строке.

**Параметры**:

*   `xml_string` (str): Исходное XML-содержимое.

**Возвращает**:

*   `str`: Очищенное и отформатированное XML-содержимое.

**Как работает функция**:

1.  Парсит XML-строку с помощью `ET.fromstring()`.
2.  Определяет рекурсивную функцию `remove_empty_elements` для удаления пустых элементов:

    *   Для каждого дочернего элемента рекурсивно вызывает `remove_empty_elements`.
    *   Если у дочернего элемента нет текста (или текст состоит только из пробелов), нет атрибутов и нет дочерних элементов, удаляет его из родительского элемента.
3.  Преобразует очищенное XML-дерево обратно в строку с помощью `ET.tostring()`.
4.  Удаляет лишние пробелы между тегами с помощью регулярного выражения `re.sub(r">\s+<", "><", cleaned_xml)`.
5.  Возвращает очищенную и отформатированную XML-строку.

### `save_xml`

```python
def save_xml(xml_string: str, file_path: str) -> None:
    """! Saves cleaned XML data from a string to a file with indentation.

    Args:
        xml_string (str): XML content as a string.
        file_path (str): Path to the output file.

    Returns:
        None
    """
    ...
```

**Назначение**:
Сохраняет очищенные XML-данные из строки в файл с отступами.

**Параметры**:

*   `xml_string` (str): XML-содержимое в виде строки.
*   `file_path` (str): Путь к выходному файлу.

**Возвращает**:

*   `None`

**Как работает функция**:

1.  Очищает XML-строку от пустых элементов с помощью функции `clean_empty_cdata()`.
2.  Парсит очищенную XML-строку с помощью `ET.fromstring()`.
3.  Преобразует XML-дерево в строку с отступами с помощью `minidom.parseString()` и `toprettyxml()`.
4.  Записывает отформатированную XML-строку в файл.

## Переменные

Отсутствуют.

## Примеры использования

```python
from src.utils.xml import save_xml, clean_empty_cdata

# Пример использования
xml_data = """<root><item>Value</item><item attr="test">Another</item></root>"""
save_xml(xml_data, "output.xml")
```

## Зависимости

*   `xml.etree.ElementTree`: Для парсинга и манипулирования XML.
*   `xml.dom.minidom`: Для форматирования XML с отступами.
*   `re`: Для работы с регулярными выражениями (удаление пробелов).

## Взаимосвязи с другими частями проекта

Модуль `xml.py` предоставляет утилиты для работы с XML-файлами, которые могут использоваться в различных частях проекта `hypotez`, где требуется обработка XML-данных, например, для чтения конфигурационных файлов или обмена данными с внешними сервисами.