# Модуль логирования

## Обзор

Модуль `src.logger.logger` предоставляет класс `Logger` для организации логирования в проекте `hypotez`. Он реализует паттерн Singleton и поддерживает логирование в консоль, файлы (информационные, отладочные, ошибки) и в JSON-формате.

## Подробнее

Этот модуль предназначен для централизованного управления логированием в проекте. Он обеспечивает гибкую настройку логирования, позволяя записывать сообщения разных уровней (INFO, DEBUG, ERROR, CRITICAL) в разные файлы и консоль. Использование паттерна Singleton гарантирует, что в приложении будет только один экземпляр логгера.

## Классы

### `SingletonMeta`

```python
class SingletonMeta(type):
    """Metaclass for Singleton pattern implementation."""
    ...
```

**Описание**: Метакласс для реализации паттерна Singleton.

**Как работает**:
-   Гарантирует, что у класса будет только один экземпляр. При первом вызове класса создается экземпляр, а при последующих вызовах возвращается существующий экземпляр.
-   Использует блокировку (`threading.Lock`) для обеспечения потокобезопасности при создании экземпляра.

### `JsonFormatter`

```python
class JsonFormatter(logging.Formatter):
    """Custom formatter for logging in JSON format."""
    ...
```

**Описание**: Пользовательский форматтер для логирования в JSON-формате.

**Наследует**:

*   `logging.Formatter`

**Методы**:

*   `format(self, record)`: Форматирует запись журнала в JSON-формат.

### `Logger`

```python
class Logger(metaclass=SingletonMeta):
    """Logger class implementing Singleton pattern with console, file, and JSON logging."""
    ...
```

**Описание**: Класс логгера, реализующий паттерн Singleton с логированием в консоль, файлы и JSON.

**Атрибуты**:

*   `log_files_path` (Path): Путь к директории с файлами логов.
*   `info_log_path` (Path): Путь к файлу информационных логов.
*   `debug_log_path` (Path): Путь к файлу отладочных логов.
*   `errors_log_path` (Path): Путь к файлу логов ошибок.
*   `json_log_path` (Path): Путь к файлу логов в формате JSON.

**Методы**:

*   `__init__(self, info_log_path: Optional[str] = None, debug_log_path: Optional[str] = None, errors_log_path: Optional[str] = None, json_log_path: Optional[str] = None)`: Инициализирует экземпляр класса `Logger`.
*   `_format_message(self, message, ex=None, color: Optional[Tuple[str, str]] = None, level=None)`: Форматирует сообщение для логирования с учетом уровня логирования, добавления цветного выделения и информации об исключении.
*   `_ex_full_info(self, ex)`: Формирует строку с полной информацией об исключении, включая имя файла, функцию и номер строки.
*   `log(self, level, message, ex=None, exc_info=False, color: Optional[Tuple[str, str]] = None)`: Общий метод для логирования сообщений на указанном уровне с возможностью добавления цветного выделения.
*   Методы `info`, `success`, `warning`, `debug`, `exception`, `error`, `critical`: Методы для логирования сообщений на соответствующих уровнях с предустановленными цветами.

## Константы

### `TEXT_COLORS`

**Назначение**:
Словарь, содержащий соответствие между названиями цветов текста и кодами цветов `colorama`.

### `BG_COLORS`

**Назначение**:
Словарь, содержащий соответствие между названиями цветов фона и кодами цветов `colorama`.

### `LOG_SYMBOLS`

**Назначение**:
Словарь, содержащий соответствие между уровнями логирования и символами Unicode.

## Примеры использования

```python
from src.logger.logger import logger

logger.info("Это информационное сообщение")
logger.warning("Это предупреждение", text_color="yellow")
try:
    1 / 0
except Exception as ex:
    logger.error("Произошла ошибка при делении на ноль", ex, exc_info=True)
```

## Зависимости

-   `logging`: Стандартный модуль Python для логирования.
-   `colorama`: Для добавления цветов в вывод в консоль.
-   `datetime`: Для работы с датой и временем.
-   `json`: Для работы с JSON-форматом.
-   `inspect`: Для получения информации о стеке вызовов и функциях.
-   `threading`: Для обеспечения потокобезопасности при создании экземпляра логгера.
-   `pathlib.Path`: Для работы с путями к файлам.
-   `typing.Optional, typing.Tuple`:  Для указания типов
-   `types.SimpleNamespace`: Для простого создания объектов с атрибутами на основе словаря.
-   `header`: Модуль, определяющий корневой каталог проекта.

## Взаимосвязи с другими частями проекта

*   Модуль `logger.py` предоставляет централизованный механизм логирования, который используется другими модулями проекта для записи информации о работе приложения, ошибок и отладочной информации.
*   Подсистема Beeper (`src.logger.beeper`)